(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-515e509d"],{6790:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0}},[e._l(e.column,(function(t){return t.isSearch?a("el-form-item",{key:t.key,attrs:{label:t.label,prop:t.key}},[a("el-input",{attrs:{placeholder:t.label,clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1):e._e()})),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],2),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:project:add"],expression:"['system:project:add']"}],attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:project:remove"],expression:"['system:project:remove']"}],attrs:{type:"danger",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1)],1),e.tableList.length>0?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-row",{attrs:{gutter:10}},e._l(e.tableList,(function(t){return a("el-col",{key:t.name,staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,sm:12,md:8,lg:8,xl:6}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",staticStyle:{overflow:"hidden",position:"relative"},attrs:{slot:"header"},slot:"header"},[a("el-checkbox",{staticStyle:{"margin-right":"0"},on:{change:function(a){return e.handleSelectionChange(a,t)}}}),a("el-button",{staticClass:"card-title",attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t)}}},[e._v(e._s(t.title))]),e.currProject===t.name?[a("label",{staticClass:"status-label",style:"background:"+e.theme+";"},[a("i",{staticClass:"el-icon-upload-success el-icon-check status-check"})])]:e._e()],2),a("el-container",[t.logo?a("el-aside",{staticStyle:{width:"80px","background-color":"unset",padding:"0px"}},[a("ImagePreview",{attrs:{src:t.logo}})],1):e._e(),a("el-main",{staticStyle:{padding:"0px 0px 0px 5px"}},[a("div",{staticClass:"card-row"},[a("span",{staticClass:"card-row-header"},[e._v("项目标识: ")]),e._v(e._s(t.name)+" ")]),e._l(e.column,(function(i){return a("div",{key:i.key,staticClass:"card-row"},[a("span",{staticClass:"card-row-header"},[e._v(e._s(i.label)+": ")]),e._v(e._s(e.getValue(t,i))+" ")])})),a("div",{staticClass:"card-row"},[a("span",{staticClass:"card-row-header"},[e._v("行业分类: ")]),a("dict-tag",{attrs:{options:e.dict.type.iot_category,value:t.category}})],1),a("div",{staticClass:"card-row"},[a("span",{staticClass:"card-row-header"},[e._v("创建时间: ")]),e._v(e._s(e.parseTime(t.createTime))+" ")]),a("div",{staticClass:"card-row"})],2)],1),a("div",{staticClass:"card-row",staticStyle:{float:"right"}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:project:query"],expression:"['system:project:query']"}],attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){return e.handleUpdate(t)}}},[e._v("编辑")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:config:query"],expression:"['system:config:query']"}],attrs:{type:"text",icon:"el-icon-setting"},on:{click:function(a){return e.handleConfig(t)}}},[e._v("配置")]),e.currProject!==t.name?a("el-button",{attrs:{type:"text",icon:"el-icon-s-home"},on:{click:function(a){return e.goProject("change",t)}}},[e._v("访问")]):a("el-button",{attrs:{type:"text",icon:"el-icon-close"},on:{click:function(a){return e.goProject("logout",t)}}},[e._v("退出")])],1)],1)],1)})),1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1):a("el-empty",{attrs:{description:"无项目"}}),a("el-drawer",{attrs:{title:e.title,visible:e.open,direction:"rtl",size:"40%"},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"createForm",staticStyle:{padding:"10px"},attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"项目标识",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入项目标识"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"项目名称",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"所属公司",prop:"productType"}},[a("el-input",{model:{value:e.form.company,callback:function(t){e.$set(e.form,"company",t)},expression:"form.company"}})],1),a("el-form-item",{attrs:{label:"项目图标",prop:"logo"}},[a("ImageUpload",{attrs:{limit:1,value:e.form.logo},on:{input:e.handleFile}})],1),a("el-form-item",{attrs:{label:"行业分类",prop:"category"}},[a("el-select",{attrs:{placeholder:"请选择行业分类"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.dict.type.iot_category,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addCategory}})],1),a("el-form-item",{attrs:{label:"是否禁用",prop:"status"}},[a("el-switch",{attrs:{"active-value":"0","inactive-value":"1"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1),a("el-form-item",{attrs:{label:"访问域名",prop:"domain"}},[a("el-input",{attrs:{placeholder:"访问域名"},model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)],1)},r=[],s=(a("4de4"),a("d3b7"),a("d81d"),a("b0c0"),a("5a98")),o=(a("caad"),a("2532"),a("4360"));function n(e){if(e&&e instanceof Array&&e.length>0){var t=o["a"].getters&&o["a"].getters.permissions,a=e,i="*:*:*",r=t.some((function(e){return i===e||a.includes(e)}));return!!r}return console.error("need roles! Like checkPermi=\"['system:user:add','system:user:edit']\""),!1}var l=a("870c"),c=a("a6e8"),u={name:"Project",dicts:["sys_normal_disable","iot_category"],data:function(){return{table:"project",desc:"项目",loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,tableList:[],title:"",selection:[],open:!1,column:[],queryParams:{pageNum:1,pageSize:10},currProject:void 0,form:{},rules:{name:[{required:!0,validator:c["h"],message:"项目标识只能为0-9、a-z、A-Z",trigger:"blur"}],title:[{required:!0,message:"项目名称不能为空",trigger:"blur"}]}}},computed:{theme:function(){return this.$store.state.settings.theme}},created:function(){var e=this.$route.params.project;this.currProject=Object(l["a"])(e),this.column=[{label:"项目名称",key:"title",isSearch:!0,regx:!0},{label:"所属公司",key:"company",isSearch:!0,regx:!0}],this.getList()},methods:{checkPermi:n,getValue:function(e,t){return e[t.key]},getList:function(){var e=this;this.loading=!0;var t={pageNum:this.queryParams.pageNum,pageSize:this.queryParams.pageSize};this.column.filter((function(e){if(e.isSearch&&e.value&&""!==e){var a=e.regx?e.key+"[like]":e.key;t[a]=e.value}})),Object(s["k"])(this.table,t).then((function(t){e.tableList=t.rows,e.total=t.total,e.loading=!1}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={name:void 0,title:void 0,company:void 0,category:"0",status:"0",remark:void 0},this.resetForm("createForm")},handleQuery:function(){var e=this;this.column.filter((function(t){t.isSearch&&(t.value&&""!==t?e.queryParams[t.key]=t.value:e.queryParams[t.key]=void 0)})),this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e,t){e?this.selection.push(t):this.selection=this.selection.filter((function(e){return e.id!==t.id})),this.ids=this.selection.map((function(e){return e.id})),this.single=1!==this.selection.length,this.multiple=!this.selection.length},handleAdd:function(){this.reset(),this.open=!0,this.title="添加"+this.desc},handleUpdate:function(e){var t=this;this.reset();var a=e.id;this.loading=!0,Object(s["g"])(this.table,a).then((function(e){t.form=e.data,t.loading=!1,t.open=!0,t.title="修改"+t.desc}))},handleFile:function(e){this.form.logo=e},submitForm:function(){var e=this;this.$refs["queryForm"].validate((function(t){t&&(void 0!==e.form.id?Object(s["l"])(e.table,e.form).then((function(t){e.$modal.msgSuccess("修改成功"),e.open=!1,e.getList()})):Object(s["a"])(e.table,e.form).then((function(t){e.$modal.msgSuccess("新增成功"),e.open=!1,e.getList()})))}))},handleConfig:function(e){var t=this.$route.params.project;t?this.$router.push({path:"/"+t+"/project/config",query:{projectId:e.id}}):this.$router.push({path:"/project/config",query:{projectId:e.id}})},goProject:function(e,t){"logout"===e?this.$store.dispatch("LogOut").then((function(){location.href="/"+Object(l["i"])(t.name)+"/login"})):location.href="/"+Object(l["i"])(t.name)+"/index"},handleDelete:function(e){var t=this,a=e.id||this.ids,i=this.table;this.$modal.confirm("是否确认删除"+this.desc+'ID为"'+a+'"的数据项？').then((function(){return Object(s["b"])(i,a)})).then((function(){t.getList(),t.$modal.msgSuccess("删除成功")})).catch((function(){}))},addCategory:function(){var e=this.$route.params.project;e?this.$router.push({path:"/"+e+"/system/dict-data/index/iot_category"}):this.$router.push({path:"/system/dict-data/index/iot_category"})}}},m=u,d=(a("adc3"),a("2877")),p=Object(d["a"])(m,i,r,!1,null,"6237e6aa",null);t["default"]=p.exports},"7fb2":function(e,t,a){},adc3:function(e,t,a){"use strict";a("7fb2")}}]);