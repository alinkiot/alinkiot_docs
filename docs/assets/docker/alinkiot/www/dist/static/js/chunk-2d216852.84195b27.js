(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216852"],{c38d:function(e,t,i){"use strict";(function(e,i){var n,o,a,r;function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(){l=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",r=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(x){d=function(e,t,i){return e[t]=i}}function c(e,t,i,o){var a=t&&t.prototype instanceof p?t:p,r=Object.create(a.prototype),s=new E(o||[]);return n(r,"_invoke",{value:C(e,i,s)}),r}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(x){return{type:"throw",arg:x}}}e.wrap=c;var m={};function p(){}function h(){}function f(){}var g={};d(g,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(P([])));y&&y!==t&&i.call(y,a)&&(g=y);var S=f.prototype=p.prototype=Object.create(g);function _(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function o(n,a,r,s){var d=u(e[n],e,a);if("throw"!==d.type){var l=d.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){o("next",e,r,s)}),(function(e){o("throw",e,r,s)})):t.resolve(c).then((function(e){l.value=e,r(l)}),(function(e){return o("throw",e,r,s)}))}s(d.arg)}var a;n(this,"_invoke",{value:function(e,i){function n(){return new t((function(t,n){o(e,i,t,n)}))}return a=a?a.then(n,n):n()}})}function C(e,t,i){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return I()}for(i.method=o,i.arg=a;;){var r=i.delegate;if(r){var s=T(r,i);if(s){if(s===m)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var d=u(e,t,i);if("normal"===d.type){if(n=i.done?"completed":"suspendedYield",d.arg===m)continue;return{value:d.arg,done:i.done}}"throw"===d.type&&(n="completed",i.method="throw",i.arg=d.arg)}}}function T(e,t){var i=t.method,n=e.iterator[i];if(void 0===n)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var o=u(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return h.prototype=f,n(S,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:h,configurable:!0}),h.displayName=d(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,d(e,s,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},_(b.prototype),d(b.prototype,r,(function(){return this})),e.AsyncIterator=b,e.async=function(t,i,n,o,a){void 0===a&&(a=Promise);var r=new b(c(t,i,n,o),a);return e.isGeneratorFunction(i)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},_(S),d(S,s,"Generator"),d(S,a,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var n in t)i.push(n);return i.reverse(),function e(){for(;i.length;){var n=i.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=P,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return r.type="throw",r.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],r=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),d=i.call(a,"finallyLoc");if(s&&d){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=e,r.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),k(i),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var o=n.arg;k(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:P(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),m}},e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t,i,n,o,a,r){try{var s=e[a](r),d=s.value}catch(l){return void i(l)}s.done?t(d):Promise.resolve(d).then(n,o)}function m(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var a=e.apply(t,i);function r(e){u(a,n,o,r,s,"next",e)}function s(e){u(a,n,o,r,s,"throw",e)}r(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function f(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function g(e,t,i){return t=b(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t){if(e){if("string"===typeof e)return y(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function S(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=v(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){s=!0,a=e},f:function(){try{r||null==i.return||i.return()}finally{if(s)throw a}}}}function _(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function b(e){var t=_(e,"string");return"symbol"===typeof t?t:String(t)}var C=function(){function e(t,i){p(this,e),this.coreX=t,this.coreY=i}return f(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}}]),e}();Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var T=function(e,t,i){var n=document.getElementsByTagName("head")[0].getElementsByTagName("script"),o=!1;if(i)o=i();else for(var a=0;a<n.length;a++)n[a].getAttribute("src")==e&&(o=!0,n[a].readyState?n[a].onreadystatechange=function(){"complete"!=n[a].readyState&&"loaded"!=n[a].readyState||(n[a].onreadystatechange=null,t())}:n[a].onload=function(){t()});if(o)setTimeout((function(){t()}),15);else{var r=document.createElement("script");r.setAttribute("src",e),r.setAttribute("crossorigin",!0),r.onload=t,document.getElementsByTagName("head")[0].appendChild(r)}},w=function(e,t){for(var i=document.getElementsByTagName("head")[0].getElementsByTagName("link"),n=!1,o=0;o<i.length;o++)i[o].getAttribute("href")==e&&(n=!0);if(!n){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href=e,a.onload=t,document.getElementsByTagName("head")[0].appendChild(a)}},k=function(e){return!!e&&("object"===c(e)||"function"===typeof e)&&"function"===typeof e.then},E=function(e,t){var i=new RegExp("(\\?|#|&)"+e+"=(.*?)(#|&|$)"),n=(t||window.location.href).match(i);return decodeURIComponent(n?n[2]:"")},P=function(e,t){var i=t.parentNode;i.lastChild==t?i.appendChild(e):i.insertBefore(e,t.nextSibling)},I=function(e){console.log("requestFullScreen",document.getElementById(e));var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if("undefined"!==typeof window.ActiveXObject){var i=new window.ActiveXObject("WScript.Shell");null!==i&&i.SendKeys("{F11}")}},x=function(e){var t=document.documentElement.clientWidth,i=document.documentElement.clientHeight,n=e,o="";o+="width:"+i+"px;",o+="height:"+t+"px;",o+="-webkit-transform: rotate(90.001deg); transform: rotate(90.001deg);",o+="-webkit-transform-origin: "+t/2+"px "+t/2+"px;",o+="transform-origin: "+t/2+"px "+t/2+"px;",o+="position: fixed;top: 0;left: 0;z-index:10",n.style.cssText=o},R=function(e){I(e);var t=new Promise((function(e,t){var i=setInterval((function(){var t=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;if(t)return clearInterval(i),e(!0)}),100),n=setTimeout((function(){var e=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;e||t(!1),clearTimeout(n)}),2e3)}));return t},A=function(e,t,i){var n="";n+="width:"+t+"px;",n+="height:"+i+"px;",n+="-webkit-transform: none; transform: none;",n+="-webkit-transform-origin: 0 0;",n+="transform-origin: 0 0;",e.style.cssText=n},D=function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()},B=function(e){D();var t=new Promise((function(e,t){var i=setInterval((function(){var t=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;if(!t)return clearInterval(i),e(!0)}),50),n=setTimeout((function(){var e=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;e&&t(!1),clearTimeout(n)}),2e3)}));return t},j=function(e){var t=e.split("/")[3],i=e.split("/")[4].split(".")[0],n=2===e.split("/")[2].split("@").length?e.split("/")[2].split("@")[0]:"",o=-1!==e.indexOf(".hd"),a=e.split("/")[4].split(".")[e.split("/")[4].split(".").length-1].split("?")[0];return"rec"===a&&-1!==e.indexOf(".cloud.rec")&&(a="cloud.rec"),{deviceSerial:t,channelNo:i,validCode:n,hd:o,type:a}};function L(e){if("string"===typeof e)try{var t=JSON.parse(e);return!("object"!==c(t)||!t)}catch(i){return!1}console.log("It is not a string!")}var M=function(e,t,i,n,o,a){var r=e,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState&&200==s.status)if(L(s.responseText)){var e=JSON.parse(s.responseText);o(e)}else o(s.responseText)},s.open(t,r,!0);var d=new FormData;for(var l in i)d.append(l,i[l]);if(n&&"object"===c(n))for(var l in n)s.setRequestHeader(l,n[l]);s.send(d)},N=function(){return!!window&&navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone|Opera Mini)/i)},F=function(){function e(t,i){var n=this;p(this,e),T("https://open.ys7.com/assets/ezuikit_v3.4/js/hls.js",(function(){console.log("加载hls.min.js成功",window.Hls),console.log("isSupportHls",window.Hls.isSupported()),window.Hls.isSupported()&&n.initHLS(t,i)}),(function(){return!!window.Hls}))}return f(e,[{key:"toString",value:function(){return"hls ".concat(this.coreX,"-").concat(this.coreY)}},{key:"initHLS",value:function(e,t){var i=document.getElementById(e),n=new window.Hls({defaultAudioCodec:"mp4a.40.2"});n.loadSource(t),n.attachMedia(i),n.on(window.Hls.Events.MANIFEST_PARSED,(function(){i.play()})),n.on(window.Hls.Events.ERROR,(function(e,t){if(t.fatal)switch(t.type){case window.Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),n.startLoad();break;case window.Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),n.recoverMediaError();break;default:n.destroy();break}})),this.hls=n,this.video=i,this.hlsUrl=t}},{key:"play",value:function(){console.log("执行hls播放",this.video),this.hls.startLoad(),this.video.play()}},{key:"stop",value:function(){this.video.pause(),this.hls.stopLoad()}}]),e}();!function(e,t){i.exports=t()}(self,()=>(()=>{var e={99:e=>{var t,i="object"==typeof Reflect?Reflect:null,n=i&&"function"==typeof i.apply?i.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(i,n){function o(i){e.removeListener(t,a),n(i)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",o),i([].slice.call(arguments))}f(e,t,a,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&f(e,"error",t,i)}(e,o,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var r=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,i,n){var o,a,r,l;if(s(i),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),a=e._events),r=a[t]),void 0===r)r=a[t]=i,++e._eventsCount;else if("function"==typeof r?r=a[t]=n?[i,r]:[r,i]:n?r.unshift(i):r.push(i),(o=d(e))>0&&r.length>o&&!r.warned){r.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=r.length,l=c,console&&console.warn&&console.warn(l)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},o=c.bind(n);return o.listener=i,n.wrapFn=o,o}function m(e,t,i){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?i?[o.listener||o]:[o]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(o):h(o,o.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function h(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function f(e,t,i,n){if("function"==typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(a){n.once&&e.removeEventListener(t,o),i(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");r=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var o="error"===e,a=this._events;if(void 0!==a)o=o&&void 0===a.error;else if(!o)return!1;if(o){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var s=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw s.context=r,s}var d=a[e];if(void 0===d)return!1;if("function"==typeof d)n(d,this,t);else{var l=d.length,c=h(d,l);for(i=0;i<l;++i)n(c[i],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return s(t),this.on(e,u(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,u(this,e,t)),this},a.prototype.removeListener=function(e,t){var i,n,o,a,r;if(s(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(o=-1,a=i.length-1;a>=0;a--)if(i[a]===t||i[a].listener===t){r=i[a].listener,o=a;break}if(o<0)return this;0===o?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,o),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,r||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var o,a=Object.keys(i);for(n=0;n<a.length;++n)"removeListener"!==(o=a[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return m(this,e,!0)},a.prototype.rawListeners=function(e){return m(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},994:(e,t,i)=>{i.d(t,{Z:()=>n});const n=class{constructor(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}isComplete(){const e=!this.hasAudio||this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!this.hasVideo||this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&e&&t}isSeekable(){return this.hasKeyframesIndex}getNearestKeyframe(e){if(null==this.keyframesIndex)return null;const t=this.keyframesIndex,i=this._search(t.times,e);return{index:i,milliseconds:t.times[i],fileposition:t.filepositions[i]}}_search(e,t){let i=0;const n=e.length-1;let o=0,a=0,r=n;for(t<e[0]&&(i=0,a=r+1);a<=r;){if(o=a+Math.floor((r-a)/2),o===n||t>=e[o]&&t<e[o+1]){i=o;break}e[o]<t?a=o+1:r=o-1}return i}}},68:(e,t,i)=>{i.d(t,{J1:()=>r,Vn:()=>a,Wk:()=>n,Yy:()=>o});class n{constructor(e,t,i,n,o){this.dts=e,this.pts=t,this.duration=i,this.originalDts=n,this.isSyncPoint=o,this.fileposition=null}}class o{constructor(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}appendSyncPoint(e){e.isSyncPoint=!0,this.syncPoints.push(e)}}class a{constructor(){this._list=[]}clear(){this._list=[]}appendArray(e){const t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))}getLastSyncPointBeforeDts(e){if(0===this._list.length)return null;const t=this._list;let i=0;const n=t.length-1;let o=0,a=0,r=n;for(e<t[0].dts&&(i=0,a=r+1);a<=r;){if(o=a+Math.floor((r-a)/2),o===n||e>=t[o].dts&&e<t[o+1].dts){i=o;break}t[o].dts<e?a=o+1:r=o-1}return this._list[i]}}class r{constructor(e){this._type=e,this._list=[],this._lastAppendLocation=-1}get type(){return this._type}get length(){return this._list.length}isEmpty(){return 0===this._list.length}clear(){this._list=[],this._lastAppendLocation=-1}_searchNearestSegmentBefore(e){var t;const i=this._list;if(0===i.length)return-2;const n=i.length-1;let o=0,a=0,r=n,s=0;if(e<i[0].originalBeginDts)return s=-1,s;for(;a<=r;){if(o=a+Math.floor((r-a)/2),o===n||e>((null===(t=i[o].lastSample)||void 0===t?void 0:t.originalDts)||0)&&e<i[o+1].originalBeginDts){s=o;break}i[o].originalBeginDts<e?a=o+1:r=o-1}return s}_searchNearestSegmentAfter(e){return this._searchNearestSegmentBefore(e)+1}append(e){var t,i;const n=this._list,o=e,a=this._lastAppendLocation;let r=0;-1!==a&&a<n.length&&o.originalBeginDts>=((null===(i=null===(t=n[a])||void 0===t?void 0:t.lastSample)||void 0===i?void 0:i.originalDts)||0)&&(a===n.length-1||a<n.length-1&&o.originalBeginDts<n[a+1].originalBeginDts)?r=a+1:n.length>0&&(r=this._searchNearestSegmentBefore(o.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,o)}getLastSegmentBefore(e){const t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null}getLastSampleBefore(e){const t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null}getLastSyncPointBefore(e){let t=this._searchNearestSegmentBefore(e),i=this._list[t].syncPoints;for(;0===i.length&&t>0;)t--,i=this._list[t].syncPoints;return i.length>0?i[i.length-1]:null}}},943:(e,t,i)=>{i.d(t,{Z:()=>De});var n=i(99),o=i(645),a=i(479),r=i(994);function s(e,t,i){const n=e;if(t+i<n.length){for(;i--;)if(128!=(192&n[++t]))return!1;return!0}return!1}const d=function(e){const t=[],i=e;let n=0;const o=e.length;for(;n<o;)if(i[n]<128)t.push(String.fromCharCode(i[n])),++n;else{if(i[n]<192);else if(i[n]<224){if(s(i,n,1)){const e=(31&i[n])<<6|63&i[n+1];if(e>=128){t.push(String.fromCharCode(65535&e)),n+=2;continue}}}else if(i[n]<240){if(s(i,n,2)){const e=(15&i[n])<<12|(63&i[n+1])<<6|63&i[n+2];if(e>=2048&&55296!=(63488&e)){t.push(String.fromCharCode(65535&e)),n+=3;continue}}}else if(i[n]<248&&s(i,n,3)){let e=(7&i[n])<<18|(63&i[n+1])<<12|(63&i[n+2])<<6|63&i[n+3];if(e>65536&&e<1114112){e-=65536,t.push(String.fromCharCode(e>>>10|55296)),t.push(String.fromCharCode(1023&e|56320)),n+=4;continue}}t.push(String.fromCharCode(65533)),++n}return t.join("")};var l=i(411);const c=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}();class u{static parseScriptData(e,t,i){const n={};try{const o=u.parseValue(e,t,i),a=u.parseValue(e,t+o.size,i-o.size);n[o.data]=a.data}catch(e){o.Z.e("AMF",e.toString())}return n}static parseObject(e,t,i){if(i<3)throw new l.rT("Data not enough when parse ScriptDataObject");const n=u.parseString(e,t,i),o=u.parseValue(e,t+n.size,i-n.size),a=o.objectEnd;return{data:{name:n.data,value:o.data},size:n.size+o.size,objectEnd:a}}static parseVariable(e,t,i){return u.parseObject(e,t,i)}static parseString(e,t,i){if(i<2)throw new l.rT("Data not enough when parse String");const n=new DataView(e,t,i).getUint16(0,!c);let o;return o=n>0?d(new Uint8Array(e,t+2,n)):"",{data:o,size:2+n}}static parseLongString(e,t,i){if(i<4)throw new l.rT("Data not enough when parse LongString");const n=new DataView(e,t,i).getUint32(0,!c);let o;return o=n>0?d(new Uint8Array(e,t+4,n)):"",{data:o,size:4+n}}static parseDate(e,t,i){if(i<10)throw new l.rT("Data size invalid when parse Date");const n=new DataView(e,t,i);let o=n.getFloat64(0,!c);return o+=60*n.getInt16(8,!c)*1e3,{data:new Date(o),size:10}}static parseValue(e,t,i){if(i<1)throw new l.rT("Data not enough when parse Value");const n=new DataView(e,t,i);let a=1;const r=n.getUint8(0);let s,d=!1;try{switch(r){case 0:s=n.getFloat64(1,!c),a+=8;break;case 1:s=!!n.getUint8(1),a+=1;break;case 2:{const n=u.parseString(e,t+1,i-1);s=n.data,a+=n.size;break}case 3:{s={};let o=0;for(9==(16777215&n.getUint32(i-4,!c))&&(o=3);a<i-4;){const n=u.parseObject(e,t+a,i-a-o);if(n.objectEnd)break;s[n.data.name]=n.data.value,a+=n.size}a<=i-3&&9===(16777215&n.getUint32(a-1,!c))&&(a+=3);break}case 8:{s={},a+=4;let o=0;for(9==(16777215&n.getUint32(i-4,!c))&&(o=3);a<i-8;){const n=u.parseVariable(e,t+a,i-a-o);if(n.objectEnd)break;s[n.data.name]=n.data.value,a+=n.size}a<=i-3&&9===(16777215&n.getUint32(a-1,!c))&&(a+=3);break}case 9:s=void 0,a=1,d=!0;break;case 10:{s=[];const o=n.getUint32(1,!c);a+=4;for(let n=0;n<o;n++){const n=u.parseValue(e,t+a,i-a);s.push(n.data),a+=n.size}break}case 11:{const n=u.parseDate(e,t+1,i-1);s=n.data,a+=n.size;break}case 12:{const n=u.parseString(e,t+1,i-1);s=n.data,a+=n.size;break}default:a=i,o.Z.w("AMF","Unsupported AMF value type "+r.toString())}}catch(e){o.Z.e("AMF",e.toString())}return{data:s,size:a,objectEnd:d}}}const m=u,p=class{constructor(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}destroy(){this._buffer=null}_fillCurrentWord(){var e;const t=this._total_bytes-this._buffer_index;if(t<=0)throw new l.rT("ExpGolomb: _fillCurrentWord() but no bytes available");const i=Math.min(4,t),n=new Uint8Array(4);n.set(null===(e=this._buffer)||void 0===e?void 0:e.subarray(this._buffer_index,this._buffer_index+i)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=i,this._current_word_bits_left=8*i}readBits(e){if(e>32)throw new l.OC("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){const t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}let t=this._current_word_bits_left?this._current_word:0;t>>>=32-this._current_word_bits_left;const i=e-this._current_word_bits_left;this._fillCurrentWord();const n=Math.min(i,this._current_word_bits_left),o=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,t=t<<n|o,t}readBool(){return 1===this.readBits(1)}readByte(){return this.readBits(8)}_skipLeadingZero(){let e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}readUEG(){const e=this._skipLeadingZero();return this.readBits(e+1)-1}readSEG(){const e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}};class h{static _ebsp2rbsp(e){const t=e,i=t.byteLength,n=new Uint8Array(i);let o=0;for(let a=0;a<i;a++)a>=2&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(n[o]=t[a],o++);return new Uint8Array(n.buffer,0,o)}static parseSPS(e){const t=e.subarray(1,4);let i="avc1.";for(let p=0;p<3;p++){let e=t[p].toString(16);e.length<2&&(e="0"+e),i+=e}const n=h._ebsp2rbsp(e);let o=new p(n);o.readByte();const a=o.readByte();o.readByte();const r=o.readByte();o.readUEG();const s=h.getProfileString(a),d=h.getLevelString(r);let l=1,c=420;const u=[0,420,422,444];let m=8,f=8;if((100===a||110===a||122===a||244===a||44===a||83===a||86===a||118===a||128===a||138===a||144===a)&&(l=o.readUEG(),3===l&&o.readBits(1),l<=3&&(c=u[l]),m=o.readUEG()+8,f=o.readUEG()+8,o.readBits(1),o.readBool())){const e=3!==l?8:12;for(let t=0;t<e;t++)o.readBool()&&(t<6?h._skipScalingList(o,16):h._skipScalingList(o,64))}o.readUEG();const g=o.readUEG();if(0===g)o.readUEG();else if(1===g){o.readBits(1),o.readSEG(),o.readSEG();const e=o.readUEG();for(let t=0;t<e;t++)o.readSEG()}const v=o.readUEG();o.readBits(1);const y=o.readUEG(),S=o.readUEG(),_=o.readBits(1);0===_&&o.readBits(1),o.readBits(1);let b=0,C=0,T=0,w=0;o.readBool()&&(b=o.readUEG(),C=o.readUEG(),T=o.readUEG(),w=o.readUEG());let k=1,E=1,P=0,I=!0,x=0,R=0;if(o.readBool()){if(o.readBool()){const e=o.readByte();e>0&&e<16?(k=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][e-1],E=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][e-1]):255===e&&(k=o.readByte()<<8|o.readByte(),E=o.readByte()<<8|o.readByte())}if(o.readBool()&&o.readBool(),o.readBool()&&(o.readBits(4),o.readBool()&&o.readBits(24)),o.readBool()&&(o.readUEG(),o.readUEG()),o.readBool()){const e=o.readBits(32),t=o.readBits(32);I=o.readBool(),x=t,R=2*e,P=x/R}}let A=1;1===k&&1===E||(A=k/E);let D=0,B=0;0===l?(D=1,B=2-_):(D=3===l?1:2,B=(1===l?2:1)*(2-_));let j=16*(y+1),L=16*(S+1)*(2-_);j-=(b+C)*D,L-=(T+w)*B;const M=Math.ceil(j*A);return o.destroy(),o=null,{codec_mimetype:i,profile_idc:a,level_idc:r,profile_string:s,level_string:d,chroma_format_idc:l,bit_depth:m,bit_depth_luma:m,bit_depth_chroma:f,ref_frames:v,chroma_format:c,chroma_format_string:h.getChromaFormatString(c),frame_rate:{fixed:I,fps:P,fps_den:R,fps_num:x},sar_ratio:{width:k,height:E},codec_size:{width:j,height:L},present_size:{width:M,height:L}}}static _skipScalingList(e,t){let i=8,n=8,o=0;for(let a=0;a<t;a++)0!==n&&(o=e.readSEG(),n=(i+o+256)%256),i=0===n?i:n}static getProfileString(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}static getLevelString(e){return(e/10).toFixed(1)}static getChromaFormatString(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}}const f=h;var g=i(898);class v{static _ebsp2rbsp(e){const t=e,i=t.byteLength,n=new Uint8Array(i);let o=0;for(let a=0;a<i;a++)a>=2&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(n[o]=t[a],o++);return new Uint8Array(n.buffer,0,o)}static parseVPS(e){const t=v._ebsp2rbsp(e),i=new p(t);return i.readByte(),i.readByte(),i.readBits(4),i.readBits(2),i.readBits(6),{num_temporal_layers:i.readBits(3)+1,temporal_id_nested:i.readBool()}}static parseSPS(e){const t=v._ebsp2rbsp(e);let i=new p(t);i.readByte(),i.readByte();let n=0,o=0,a=0,r=0;i.readBits(4);const s=i.readBits(3),d=(i.readBool(),i.readBits(2)),l=i.readBool(),c=i.readBits(5),u=i.readByte(),m=i.readByte(),h=i.readByte(),f=i.readByte(),g=i.readByte(),y=i.readByte(),S=i.readByte(),_=i.readByte(),b=i.readByte(),C=i.readByte(),T=i.readByte(),w=[],k=[];for(let p=0;p<s;p++)w.push(i.readBool()),k.push(i.readBool());if(s>0)for(let p=s;p<8;p++)i.readBits(2);for(let p=0;p<s;p++)w[p]&&(i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte()),k[p]&&i.readByte();i.readUEG();const E=i.readUEG();3===E&&i.readBits(1);const P=i.readUEG(),I=i.readUEG();i.readBool()&&(n+=i.readUEG(),o+=i.readUEG(),a+=i.readUEG(),r+=i.readUEG());const x=i.readUEG(),R=i.readUEG(),A=i.readUEG();for(let p=i.readBool()?0:s;p<=s;p++)i.readUEG(),i.readUEG(),i.readUEG();if(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readBool()&&i.readBool())for(let p=0;p<4;p++)for(let e=0;e<(3===p?2:6);e++)if(i.readBool()){const e=Math.min(64,1<<4+(p<<1));p>1&&i.readSEG();for(let t=0;t<e;t++)i.readSEG()}else i.readUEG();i.readBool(),i.readBool(),i.readBool()&&(i.readByte(),i.readUEG(),i.readUEG(),i.readBool());const D=i.readUEG();let B=0;for(let p=0;p<D;p++){let e=!1;if(0!==p&&(e=i.readBool()),e){p===D&&i.readUEG(),i.readBool(),i.readUEG();let e=0;for(let t=0;t<=B;t++){const t=i.readBool();let n=!1;t||(n=i.readBool()),(t||n)&&e++}B=e}else{const e=i.readUEG(),t=i.readUEG();B=e+t;for(let n=0;n<e;n++)i.readUEG(),i.readBool();for(let n=0;n<t;n++)i.readUEG(),i.readBool()}}if(i.readBool()){const e=i.readUEG();for(let t=0;t<e;t++){for(let e=0;e<A+4;e++)i.readBits(1);i.readBits(1)}}let j=!1,L=0,M=1,N=1,F=!1,z=1,O=1;if(i.readBool(),i.readBool(),i.readBool()){if(i.readBool()){const e=i.readByte();e>0&&e<=16?(M=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][e-1],N=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][e-1]):255===e&&(M=i.readBits(16),N=i.readBits(16))}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(3),i.readBool(),i.readBool()&&(i.readByte(),i.readByte(),i.readByte())),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool(),i.readBool(),i.readBool(),j=i.readBool(),j&&(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG()),i.readBool()&&(z=i.readBits(32),O=i.readBits(32),i.readBool()&&i.readUEG(),i.readBool())){let e=!1,t=!1,n=!1;e=i.readBool(),t=i.readBool(),(e||t)&&(n=i.readBool(),n&&(i.readByte(),i.readBits(5),i.readBool(),i.readBits(5)),i.readBits(4),i.readBits(4),n&&i.readBits(4),i.readBits(5),i.readBits(5),i.readBits(5));for(let o=0;o<=s;o++){const o=i.readBool();F=o;let a=!1,r=1;o||(a=i.readBool());let s=!1;if(a?i.readSEG():s=i.readBool(),s||(r=i.readUEG()+1),e)for(let e=0;e<r;e++)i.readUEG(),i.readUEG(),n&&(i.readUEG(),i.readUEG());if(t)for(let e=0;e<r;e++)i.readUEG(),i.readUEG(),n&&(i.readUEG(),i.readUEG())}}i.readBool()&&(i.readBool(),i.readBool(),i.readBool(),L=i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG())}i.readBool();const U=`hvc1.${c}.1.L${T}.B0`,Z=P-(n+o)*(1===E||2===E?2:1),V=I-(a+r)*(1===E?2:1);let H=1;return 1!==M&&1!==N&&(H=M/N),i.destroy(),i=null,{codec_mimetype:U,level_string:v.getLevelString(T),profile_idc:c,bit_depth:x+8,ref_frames:1,chroma_format:E,chroma_format_string:v.getChromaFormatString(E),general_level_idc:T,general_profile_space:d,general_tier_flag:l,general_profile_idc:c,general_profile_compatibility_flags_1:u,general_profile_compatibility_flags_2:m,general_profile_compatibility_flags_3:h,general_profile_compatibility_flags_4:f,general_constraint_indicator_flags_1:g,general_constraint_indicator_flags_2:y,general_constraint_indicator_flags_3:S,general_constraint_indicator_flags_4:_,general_constraint_indicator_flags_5:b,general_constraint_indicator_flags_6:C,min_spatial_segmentation_idc:L,constant_frame_rate:0,chroma_format_idc:E,bit_depth_luma_minus8:x,bit_depth_chroma_minus8:R,frame_rate:{fixed:F,fps:O/z,fps_den:z,fps_num:O},sar_ratio:{width:M,height:N},codec_size:{width:Z,height:V},present_size:{width:Z*H,height:V}}}static parsePPS(e){const t=v._ebsp2rbsp(e),i=new p(t);i.readByte(),i.readByte(),i.readUEG(),i.readUEG(),i.readBool(),i.readBool(),i.readBits(3),i.readBool(),i.readBool(),i.readUEG(),i.readUEG(),i.readSEG(),i.readBool(),i.readBool(),i.readBool()&&i.readUEG(),i.readSEG(),i.readSEG(),i.readBool(),i.readBool(),i.readBool(),i.readBool();const n=i.readBool(),o=i.readBool();let a=1;return o&&n?a=0:o?a=3:n&&(a=2),{parallelismType:a}}static getChromaFormatString(e){switch(e){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}}static getProfileString(e){switch(e){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}}static getLevelString(e){return(e/30).toFixed(1)}}const y=v;function S(e){return e.byteOffset%2==0&&e.byteLength%2==0}function _(e){return e.byteOffset%4==0&&e.byteLength%4==0}function b(e,t){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}const C=function(e,t){return e.byteLength===t.byteLength&&(_(e)&&_(t)?function(e,t){return b(new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4))}(e,t):S(e)&&S(t)?function(e,t){return b(new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2))}(e,t):function(e,t){return b(e,t)}(e,t))};class T{static parseOBUs(e){let t=null;for(let i=0;i<e.byteLength;){e[i];const n=(120&e[i])>>3,o=0!=(4&e[i]),a=0!=(2&e[i]);e[i],i+=1,o&&(i+=1);let r=Number.POSITIVE_INFINITY;if(a){r=0;for(let t=0;r|=(127&e[i])<<7*t,i+=1,0!=(128&e[i]);t++);}1===n&&(t=T.parseSeuqneceHeader(e.subarray(i,i+r))),i+=r}return t}static parseSeuqneceHeader(e){let t=new p(e);const i=t.readBits(3),n=(t.readBool(),t.readBool());let o=!0,a=0,r=0;const s=[];if(n)s.push({operating_point_idc:0,level:t.readBits(5),tier:0});else{if(t.readBool()){const e=t.readBits(32),i=t.readBits(32),n=t.readBool();if(n){let e=0;for(;;){if(0!==t.readBits(1))break;e+=1}e>=32||t.readBits(e)}r=e,a=i,o=n,t.readBool()&&(t.readBits(5),t.readBits(32),t.readBits(5),t.readBits(5))}const e=t.readBool(),i=t.readBits(5);for(let n=0;n<=i;n++){const i=t.readBits(12),n=t.readBits(5),o=n>7?t.readBits(1):0;s.push({operating_point_idc:i,level:n,tier:o}),e&&t.readBool()&&t.readBits(4)}}const{level:d,tier:l}=s[0],c=t.readBits(4),u=t.readBits(4),m=t.readBits(c+1)+1,h=t.readBits(u+1)+1;let f=!1;n||(f=t.readBool()),f&&(t.readBits(4),t.readBits(4)),t.readBool(),t.readBool(),t.readBool();let g=!1,v=2;n||(t.readBool(),t.readBool(),t.readBool(),t.readBool(),g=t.readBool(),g&&(t.readBool(),t.readBool()),v=t.readBool()?2:t.readBits(1),v&&(t.readBool()||t.readBits(1)),g&&t.readBits(3)),t.readBool(),t.readBool(),t.readBool();const y=t.readBool();let S=8;S=2===i&&y?t.readBool()?12:10:y?10:8;let _=!1;1!==i&&(_=t.readBool()),t.readBool()&&(t.readBits(8),t.readBits(8),t.readBits(8));let b=1,C=1;return _?(t.readBits(1),b=1,C=1):(t.readBits(1),0===i?(b=1,C=1):1===i?(b=0,C=0):12===S?t.readBits(1)&&t.readBits(1):(b=1,C=0),b&&C&&t.readBits(2),t.readBits(1)),t.readBool(),t.destroy(),t=null,{codec_mimetype:`av01.${i}.${T.getLevelString(d,l)}.${S.toString(10).padStart(2,"0")}`,level:d,tier:l,level_string:T.getLevelString(d,l),profile_idc:i,profile_string:""+i,bit_depth:S,ref_frames:1,chroma_format:T.getChromaFormat(_,b,C),chroma_format_string:T.getChromaFormatString(_,b,C),frame_rate:{fixed:o,fps:a/r,fps_den:r,fps_num:a},sar_ratio:{width:1,height:1},codec_size:{width:m,height:h},present_size:{width:1*m,height:h}}}static getLevelString(e,t){return`${e.toString(10).padStart(2,"0")}${0===t?"M":"H"}`}static getChromaFormat(e,t,i){return e?0:0===t&&0===i?3:1===t&&0===i?2:1===t&&1===i?1:Number.NaN}static getChromaFormatString(e,t,i){return e?"4:0:0":0===t&&0===i?"4:4:4":1===t&&0===i?"4:2:2":1===t&&1===i?"4:2:0":"Unknown"}}const w=T;class k{constructor(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new r.Z,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}destroy(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null}static probe(e){const t=new Uint8Array(e);if(t.byteLength<9)return{needMoreData:!0};const i={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return i;const n=(4&t[4])>>>2!=0,o=0!=(1&t[4]),a=(r=t)[s=5]<<24|r[s+1]<<16|r[s+2]<<8|r[s+3];var r,s;return a<9?i:{match:!0,consumed:a,dataOffset:a,hasAudioTrack:n,hasVideoTrack:o}}bindDataSource(e){return e.onDataArrival=this.parseChunks.bind(this),this}get onTrackMetadata(){return this._onTrackMetadata}set onTrackMetadata(e){this._onTrackMetadata=e}get onMediaInfo(){return this._onMediaInfo}set onMediaInfo(e){this._onMediaInfo=e}get onMetaDataArrived(){return this._onMetaDataArrived}set onMetaDataArrived(e){this._onMetaDataArrived=e}get onScriptDataArrived(){return this._onScriptDataArrived}set onScriptDataArrived(e){this._onScriptDataArrived=e}get onError(){return this._onError}set onError(e){this._onError=e}get onDataAvailable(){return this._onDataAvailable}set onDataAvailable(e){this._onDataAvailable=e}get timestampBase(){return this._timestampBase}set timestampBase(e){this._timestampBase=e}get overridedDuration(){return this._duration}set overridedDuration(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo&&(this._mediaInfo.duration=e)}set overridedHasAudio(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo&&(this._mediaInfo.hasAudio=e)}set overridedHasVideo(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo&&(this._mediaInfo.hasVideo=e)}resetMediaInfo(){this._mediaInfo=new r.Z}_isInitialMetadataDispatched(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched}parseChunks(e,t){var i,n;if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new l.rT("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");let a=0;const r=this._littleEndian;if(0===t){if(!(e.byteLength>13))return 0;{const t=k.probe(e);a=(null==t?void 0:t.dataOffset)||0}}for(this._firstParse&&(this._firstParse=!1,t+a!==this._dataOffset&&o.Z.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==new DataView(e,a).getUint32(0,!r)&&o.Z.w(this.TAG,"PrevTagSize0 !== 0 !!!"),a+=4);a<e.byteLength;){this._dispatch=!0;const i=new DataView(e,a);if(a+11+4>e.byteLength)break;const n=i.getUint8(0),s=16777215&i.getUint32(0,!r);if(a+11+s+4>e.byteLength)break;if(8!==n&&9!==n&&18!==n){o.Z.w(this.TAG,`Unsupported tag type ${n}, skipped`),a+=11+s+4;continue}const d=i.getUint8(4),l=i.getUint8(5),c=i.getUint8(6)|l<<8|d<<16|i.getUint8(7)<<24;0!==(16777215&i.getUint32(7,!r))&&o.Z.w(this.TAG,"Meet tag which has StreamID != 0!");const u=a+11;switch(n){case 8:this._parseAudioData(e,u,s,c);break;case 9:this._parseVideoData(e,u,s,c,t+a);break;case 18:this._parseScriptData(e,u,s)}const m=i.getUint32(11+s,!r);m!==11+s&&o.Z.w(this.TAG,"Invalid PrevTagSize "+m),a+=11+s+4}return this._isInitialMetadataDispatched()&&this._dispatch&&((null===(i=this._audioTrack)||void 0===i?void 0:i.length)||(null===(n=this._videoTrack)||void 0===n?void 0:n.length))&&this._onDataAvailable(this._audioTrack,this._videoTrack),a}_parseScriptData(e,t,i){var n,a,r;const s=m.parseScriptData(e,t,i);if(s.hasOwnProperty("onMetaData")){if(null==s.onMetaData||"object"!=typeof s.onMetaData)return void o.Z.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&o.Z.w(this.TAG,"Found another onMetaData tag!"),this._metadata=s;const e=null===(n=this._metadata)||void 0===n?void 0:n.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},e)),"boolean"==typeof(null==e?void 0:e.hasAudio)&&(this._hasAudioFlagOverrided||(this._hasAudio=e.hasAudio,this._mediaInfo&&(this._mediaInfo.hasAudio=this._hasAudio))),"boolean"==typeof(null==e?void 0:e.hasVideo)&&(this._hasVideoFlagOverrided||(this._hasVideo=e.hasVideo,this._mediaInfo&&(this._mediaInfo.hasVideo=this._hasVideo))),"number"==typeof(null==e?void 0:e.audiodatarate)&&this._mediaInfo&&(this._mediaInfo.audioDataRate=e.audiodatarate),"number"==typeof(null==e?void 0:e.videodatarate)&&this._mediaInfo&&(this._mediaInfo.videoDataRate=e.videodatarate),"number"==typeof(null==e?void 0:e.width)&&this._mediaInfo&&(this._mediaInfo.width=e.width),"number"==typeof(null==e?void 0:e.height)&&this._mediaInfo&&(this._mediaInfo.height=e.height),"number"==typeof(null==e?void 0:e.duration)){if(!this._durationOverrided){const t=Math.floor(e.duration*this._timescale);this._duration=t,this._mediaInfo&&(this._mediaInfo.duration=t)}}else this._mediaInfo&&(this._mediaInfo.duration=0);if("number"==typeof(null==e?void 0:e.framerate)){const t=Math.floor(1e3*e.framerate);if(t>0){const e=t/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=e,this._referenceFrameRate.fps_num=t,this._referenceFrameRate.fps_den=1e3,this._mediaInfo&&(this._mediaInfo.fps=e)}}if("object"==typeof(null==e?void 0:e.keyframes)){this._mediaInfo&&(this._mediaInfo.hasKeyframesIndex=!0);const t=e.keyframes;this._mediaInfo&&(this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(t)),e.keyframes=null}else this._mediaInfo&&(this._mediaInfo.hasKeyframesIndex=!1);this._dispatch=!1,this._mediaInfo&&(this._mediaInfo.metadata=e),o.Z.v(this.TAG,"Parsed onMetaData"),(null===(a=this._mediaInfo)||void 0===a?void 0:a.isComplete())&&(null===(r=this._onMediaInfo)||void 0===r||r.call(this,this._mediaInfo))}Object.keys(s).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},s))}_parseKeyframesIndex(e){const t=[],i=[];for(let n=1;n<e.times.length;n++){const o=this._timestampBase+Math.floor(1e3*e.times[n]);t.push(o),i.push(e.filepositions[n])}return{times:t,filepositions:i}}_parseAudioData(e,t,i,n){var a,r,s,d,l,c,u,m,p,h;if(i<=1)return void o.Z.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");if(this._hasAudioFlagOverrided&&!1===this._hasAudio)return;this._littleEndian;const f=new DataView(e,t,i).getUint8(0),v=f>>>4;if(2!==v&&10!==v)return void(null===(a=this._onError)||void 0===a||a.call(this,g.Z.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+v));let y=0;const S=(12&f)>>>2;if(!(S>=0&&S<=4))return void(null===(r=this._onError)||void 0===r||r.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+S));y=this._flvSoundRateTable[S];const _=1&f;let b=this._audioMetadata;const T=this._audioTrack;if(b||(!1!==this._hasAudio||this._hasAudioFlagOverrided||(this._hasAudio=!0,this._mediaInfo&&(this._mediaInfo.hasAudio=!0)),b=this._audioMetadata={},b.type="audio",b.id=null==T?void 0:T.id,b.timescale=this._timescale,b.duration=this._duration,b.audioSampleRate=y,b.channelCount=0===_?1:2),10===v){const a=this._parseAACAudioData(e,t+1,i-1);if(void 0===a)return;if(0===(null==a?void 0:a.packetType)){if(null==b?void 0:b.config){if(C(a.data.config,null==b?void 0:b.config))return;o.Z.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}const e=a.data;b.audioSampleRate=null==e?void 0:e.samplingRate,b.channelCount=null==e?void 0:e.channelCount,b.codec=null==e?void 0:e.codec,b.originalCodec=null==e?void 0:e.originalCodec,b.config=null==e?void 0:e.config,b.refSampleDuration=1024/b.audioSampleRate*b.timescale,o.Z.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&((null===(s=this._audioTrack)||void 0===s?void 0:s.length)||(null===(d=this._videoTrack)||void 0===d?void 0:d.length))&&(null===(l=this._onDataAvailable)||void 0===l||l.call(this,this._audioTrack,this._videoTrack)):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,null===(c=this._onTrackMetadata)||void 0===c||c.call(this,"audio",b);const t=this._mediaInfo;t.audioCodec=b.originalCodec||"",t.audioSampleRate=b.audioSampleRate,t.audioChannelCount=b.channelCount,t.hasVideo?null!=t.videoCodec&&(t.mimeType='video/x-flv; codecs="'+t.videoCodec+","+t.audioCodec+'"'):t.mimeType='video/x-flv; codecs="'+t.audioCodec+'"',(null==t?void 0:t.isComplete())&&(null===(u=this._onMediaInfo)||void 0===u||u.call(this,t))}else if(1===a.packetType){const e=this._timestampBase+n,t={unit:a.data,length:a.data.byteLength,dts:e,pts:e};T&&(null==T||T.samples.push(t),T.length+=(null===(m=null==a?void 0:a.data)||void 0===m?void 0:m.length)||0)}else o.Z.e(this.TAG,"Flv: Unsupported AAC data type "+a.packetType)}else if(2===v){if(!b.codec){const n=this._parseMP3AudioData(e,t+1,i-1,!0);if(void 0===n)return;b.audioSampleRate=n.samplingRate,b.channelCount=n.channelCount,b.codec=n.codec,b.originalCodec=n.originalCodec,b.refSampleDuration=1152/b.audioSampleRate*b.timescale,o.Z.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,null===(p=this._onTrackMetadata)||void 0===p||p.call(this,"audio",b);const a=this._mediaInfo;a.audioCodec=b.codec,a.audioSampleRate=b.audioSampleRate,a.audioChannelCount=b.channelCount,a.audioDataRate=n.bitRate,(null==a?void 0:a.hasVideo)?null!=a.videoCodec&&(a.mimeType='video/x-flv; codecs="'+a.videoCodec+","+a.audioCodec+'"'):a.mimeType='video/x-flv; codecs="'+a.audioCodec+'"',a.isComplete()&&(null===(h=this._onMediaInfo)||void 0===h||h.call(this,a))}const a=this._parseMP3AudioData(e,t+1,i-1,!1);if(void 0===a)return;const r=this._timestampBase+n,s={unit:a,length:a.byteLength,dts:r,pts:r};null==T||T.samples.push(s),T&&(T.length+=a.length)}}_parseAACAudioData(e,t,i){if(i<=1)return void o.Z.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");const n={},a=new Uint8Array(e,t,i);return n.packetType=a[0],0===a[0]?n.data=this._parseAACAudioSpecificConfig(e,t+1,i-1):n.data=a.subarray(1),n}_parseAACAudioSpecificConfig(e,t,i){var n,o;const a=new Uint8Array(e,t,i);let r=null,s=0,d=0,l=0,c=null;if(s=d=a[0]>>>3,l=(7&a[0])<<1|a[1]>>>7,l<0||l>=this._mpegSamplingRates.length)return void(null===(n=this._onError)||void 0===n||n.call(this,g.Z.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!"));const u=this._mpegSamplingRates[l],m=(120&a[1])>>>3;if(m<0||m>=8)return void(null===(o=this._onError)||void 0===o||o.call(this,g.Z.FORMAT_ERROR,"Flv: AAC invalid channel configuration"));5===s&&(c=(7&a[1])<<1|a[2]>>>7,a[2]);const p=self.navigator.userAgent.toLowerCase();return p.includes("firefox")?l>=6?(s=5,r=new Array(4),c=l-3):(s=2,r=new Array(2),c=l):p.includes("android")?(s=2,r=new Array(2),c=l):(s=5,c=l,r=new Array(4),l>=6?c=l-3:1===m&&(s=2,r=new Array(2),c=l)),r[0]=s<<3,r[0]|=(15&l)>>>1,r[1]=(15&l)<<7,r[1]|=(15&m)<<3,5===s&&(r[1]|=(15&c)>>>1,r[2]=(1&c)<<7,r[2]|=8,r[3]=0),{config:r,samplingRate:u,channelCount:m,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+d}}_parseMP3AudioData(e,t,i,n){if(i<4)return void o.Z.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");this._littleEndian;const a=new Uint8Array(e,t,i);let r;if(n){if(255!==a[0])return;const e=a[1]>>>3&3,t=(6&a[1])>>1,i=(240&a[2])>>>4,n=(12&a[2])>>>2,o=3!==(a[3]>>>6&3)?2:1;let s=0,d=0;const l="mp3";switch(e){case 0:s=this._mpegAudioV25SampleRateTable[n];break;case 2:s=this._mpegAudioV20SampleRateTable[n];break;case 3:s=this._mpegAudioV10SampleRateTable[n]}switch(t){case 1:i<this._mpegAudioL3BitRateTable.length&&(d=this._mpegAudioL3BitRateTable[i]);break;case 2:i<this._mpegAudioL2BitRateTable.length&&(d=this._mpegAudioL2BitRateTable[i]);break;case 3:i<this._mpegAudioL1BitRateTable.length&&(d=this._mpegAudioL1BitRateTable[i])}r={bitRate:d,samplingRate:s,channelCount:o,codec:l,originalCodec:l}}else r=a;return r}_parseVideoData(e,t,i,n,a){var r,s;if(i<=1)return void o.Z.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");if(this._hasVideoFlagOverrided&&!1===this._hasVideo)return;const d=new Uint8Array(e,t,i)[0],l=(112&d)>>>4;if(0!=(128&d)){const o=15&d,r=String.fromCharCode(...new Uint8Array(e,t,i).slice(1,5));"hvc1"===r?this._parseEnhancedHEVCVideoPacket(e,t+5,i-5,n,a,l,o):"av01"===r?this._parseEnhancedAV1VideoPacket(e,t+5,i-5,n,a,l,o):null===(s=this._onError)||void 0===s||s.call(this,g.Z.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+r)}else{const o=15&d;7===o?this._parseAVCVideoPacket(e,t+1,i-1,n,a,l):12===o?this._parseHEVCVideoPacket(e,t+1,i-1,n,a,l):null===(r=this._onError)||void 0===r||r.call(this,g.Z.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+o)}}_parseAVCVideoPacket(e,t,i,n,a,r){var s;if(i<4)return void o.Z.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");const d=this._littleEndian,l=new DataView(e,t,i),c=l.getUint8(0),u=(16777215&l.getUint32(0,!d))<<8>>8;0===c?this._parseAVCDecoderConfigurationRecord(e,t+4,i-4):1===c?this._parseAVCVideoData(e,t+4,i-4,n,a,r,u):2===c||null===(s=this._onError)||void 0===s||s.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid video packet type "+c)}_parseHEVCVideoPacket(e,t,i,n,a,r){var s;if(i<4)return void o.Z.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");const d=this._littleEndian,l=new DataView(e,t,i),c=l.getUint8(0),u=(16777215&l.getUint32(0,!d))<<8>>8;0===c?this._parseHEVCDecoderConfigurationRecord(e,t+4,i-4):1===c?this._parseHEVCVideoData(e,t+4,i-4,n,a,r,u):2===c||null===(s=this._onError)||void 0===s||s.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid video packet type "+c)}_parseEnhancedHEVCVideoPacket(e,t,i,n,o,a,r){var s;const d=this._littleEndian,l=new DataView(e,t,i);if(0===r)this._parseHEVCDecoderConfigurationRecord(e,t,i);else if(1===r){const r=(4294967040&l.getUint32(0,!d))>>8;this._parseHEVCVideoData(e,t+3,i-3,n,o,a,r)}else 3===r?this._parseHEVCVideoData(e,t,i,n,o,a,0):2===r||null===(s=this._onError)||void 0===s||s.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid video packet type "+r)}_parseEnhancedAV1VideoPacket(e,t,i,n,o,a,r){var s,d;this._littleEndian,0===r?this._parseAV1CodecConfigurationRecord(e,t,i):1===r?this._parseAV1VideoData(e,t,i,n,o,a,0):5===r?null===(s=this._onError)||void 0===s||s.call(this,g.Z.FORMAT_ERROR,"Flv: Not Suported MP2T AV1 video packet type "+r):2===r||null===(d=this._onError)||void 0===d||d.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid video packet type "+r)}_parseAVCDecoderConfigurationRecord(e,t,i){var n,a,r,s,d,l,c,u,m,p,h;if(i<7)return void o.Z.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");let v=this._videoMetadata;const y=this._videoTrack,S=this._littleEndian,_=new DataView(e,t,i);if(v){if(void 0!==v.avcc){const n=new Uint8Array(e,t,i);if(C(n,v.avcc))return;o.Z.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1!==this._hasVideo||this._hasVideoFlagOverrided||(this._hasVideo=!0,this._mediaInfo&&(this._mediaInfo.hasVideo=!0)),v=this._videoMetadata={},v.type="video",v.id=null==y?void 0:y.id,v.timescale=this._timescale,v.duration=this._duration;const b=_.getUint8(0),T=_.getUint8(1);if(_.getUint8(2),_.getUint8(3),1!==b||0===T)return void(null===(n=this._onError)||void 0===n||n.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord"));if(this._naluLengthSize=1+(3&_.getUint8(4)),3!==this._naluLengthSize&&4!==this._naluLengthSize)return void(null===(a=this._onError)||void 0===a||a.call(this,g.Z.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1)));const w=31&_.getUint8(5);if(0===w)return void(null===(r=this._onError)||void 0===r||r.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS"));w>1&&o.Z.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+w);let k=6;for(let o=0;o<w;o++){const i=_.getUint16(k,!S);if(k+=2,0===i)continue;const n=new Uint8Array(e,t+k,i);k+=i;const a=f.parseSPS(n);if(0!==o)continue;v.codecWidth=a.codec_size.width,v.codecHeight=a.codec_size.height,v.presentWidth=a.present_size.width,v.presentHeight=a.present_size.height,v.profile=a.profile_string,v.level=a.level_string,v.bitDepth=a.bit_depth,v.chromaFormat=a.chroma_format,v.sarRatio=a.sar_ratio,v.frameRate=a.frame_rate,a.frame_rate.fixed&&0!==a.frame_rate.fps_num&&0!==a.frame_rate.fps_den||(v.frameRate=this._referenceFrameRate);const r=null===(s=v.frameRate)||void 0===s?void 0:s.fps_den,c=null===(d=v.frameRate)||void 0===d?void 0:d.fps_num;v.refSampleDuration=v.timescale*(r/c);const u=n.subarray(1,4);let m="avc1.";for(let e=0;e<3;e++){let t=u[e].toString(16);t.length<2&&(t="0"+t),m+=t}v.codec=m;const p=this._mediaInfo;p.width=v.codecWidth,p.height=v.codecHeight,p.fps=v.frameRate.fps,p.profile=v.profile,p.level=v.level,p.refFrames=a.ref_frames,p.chromaFormat=a.chroma_format_string,p.sarNum=v.sarRatio.width,p.sarDen=v.sarRatio.height,p.videoCodec=m,p.hasAudio?null!=p.audioCodec&&(p.mimeType='video/x-flv; codecs="'+p.videoCodec+","+p.audioCodec+'"'):p.mimeType='video/x-flv; codecs="'+p.videoCodec+'"',p.isComplete()&&(null===(l=this._onMediaInfo)||void 0===l||l.call(this,p))}const E=_.getUint8(k);if(0!==E){E>1&&o.Z.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+E),k++;for(let e=0;e<E;e++){const e=_.getUint16(k,!S);k+=2,0!==e&&(k+=e)}v.avcc=new Uint8Array(i),v.avcc.set(new Uint8Array(e,t,i),0),o.Z.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&((null===(u=this._audioTrack)||void 0===u?void 0:u.length)||(null===(m=this._videoTrack)||void 0===m?void 0:m.length))&&(null===(p=this._onDataAvailable)||void 0===p||p.call(this,this._audioTrack,this._videoTrack)):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,null===(h=this._onTrackMetadata)||void 0===h||h.call(this,"video",v)}else null===(c=this._onError)||void 0===c||c.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}_parseHEVCDecoderConfigurationRecord(e,t,i){var n,a,r,s,d,l,c;if(i<22)return void o.Z.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");let u=this._videoMetadata;const m=this._videoTrack,p=this._littleEndian,h=new DataView(e,t,i);if(u){if(void 0!==u.hvcc){const n=new Uint8Array(e,t,i);if(C(n,u.hvcc))return;o.Z.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1!==this._hasVideo||this._hasVideoFlagOverrided||(this._hasVideo=!0,this._mediaInfo&&(this._mediaInfo.hasVideo=!0)),u=this._videoMetadata={},u.type="video",u.id=null==m?void 0:m.id,u.timescale=this._timescale,u.duration=this._duration;const f=h.getUint8(0),v=31&h.getUint8(1);if(1!==f||0===v)return void(null===(n=this._onError)||void 0===n||n.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord"));if(this._naluLengthSize=1+(3&h.getUint8(21)),3!==this._naluLengthSize&&4!==this._naluLengthSize)return void(null===(a=this._onError)||void 0===a||a.call(this,g.Z.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1)));const S=h.getUint8(22);for(let o=0,g=23;o<S;o++){const i=63&h.getUint8(g+0),n=h.getUint16(g+1,!p);g+=3;for(let o=0;o<n;o++){const n=h.getUint16(g+0,!p);if(0===o)if(33===i){g+=2;const i=new Uint8Array(e,t+g,n),o=y.parseSPS(i);u.codecWidth=o.codec_size.width,u.codecHeight=o.codec_size.height,u.presentWidth=o.present_size.width,u.presentHeight=o.present_size.height,u.profile=null==o?void 0:o.profile_string,u.level=o.level_string,u.bitDepth=o.bit_depth,u.chromaFormat=o.chroma_format,u.sarRatio=o.sar_ratio,u.frameRate=o.frame_rate,o.frame_rate.fixed&&0!==o.frame_rate.fps_num&&0!==o.frame_rate.fps_den||(u.frameRate=this._referenceFrameRate);const a=u.frameRate.fps_den,s=u.frameRate.fps_num;u.refSampleDuration=u.timescale*(a/s),u.codec=o.codec_mimetype;const d=this._mediaInfo;d.width=u.codecWidth,d.height=u.codecHeight,d.fps=u.frameRate.fps,d.profile=u.profile,d.level=u.level,d.refFrames=o.ref_frames,d.chromaFormat=o.chroma_format_string,d.sarNum=u.sarRatio.width,d.sarDen=u.sarRatio.height,d.videoCodec=o.codec_mimetype,d.hasAudio?null!=d.audioCodec&&(d.mimeType='video/x-flv; codecs="'+d.videoCodec+","+d.audioCodec+'"'):d.mimeType='video/x-flv; codecs="'+d.videoCodec+'"',d.isComplete()&&(null===(r=this._onMediaInfo)||void 0===r||r.call(this,d)),g+=n}else g+=2+n;else g+=2+n}}u.hvcc=new Uint8Array(i),u.hvcc.set(new Uint8Array(e,t,i),0),o.Z.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&((null===(s=this._audioTrack)||void 0===s?void 0:s.length)||(null===(d=this._videoTrack)||void 0===d?void 0:d.length))&&(null===(l=this._onDataAvailable)||void 0===l||l.call(this,this._audioTrack,this._videoTrack)):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,null===(c=this._onTrackMetadata)||void 0===c||c.call(this,"video",u)}_parseAV1CodecConfigurationRecord(e,t,i){var n,a,r,s,d,l,c,u,m,p,h;if(i<4)return void o.Z.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");let f=this._videoMetadata;const v=this._videoTrack,y=(this._littleEndian,new DataView(e,t,i));f?void 0!==f.av1c&&o.Z.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(!1!==this._hasVideo||this._hasVideoFlagOverrided||(this._hasVideo=!0,this._mediaInfo&&(this._mediaInfo.hasVideo=!0)),f=this._videoMetadata={},f.type="video",f.id=null==v?void 0:v.id,f.timescale=this._timescale,f.duration=this._duration);const S=127&y.getUint8(0);if(y.getUint8(1),y.getUint8(1),y.getUint8(2),1!==S)return void(null===(n=this._onError)||void 0===n||n.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord"));const _=w.parseOBUs(new Uint8Array(e,t+4,i-4));if(null==_)return void(null===(a=this._onError)||void 0===a||a.call(this,g.Z.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord"));f.codecWidth=null===(r=null==_?void 0:_.codec_size)||void 0===r?void 0:r.width,f.codecHeight=null===(s=null==_?void 0:_.codec_size)||void 0===s?void 0:s.height,f.presentWidth=null===(d=null==_?void 0:_.present_size)||void 0===d?void 0:d.width,f.presentHeight=null===(l=null==_?void 0:_.present_size)||void 0===l?void 0:l.height,f.profile=_.profile_string,f.level=_.level_string,f.bitDepth=_.bit_depth,f.chromaFormat=_.chroma_format,f.sarRatio=_.sar_ratio,f.frameRate=_.frame_rate,_.frame_rate.fixed&&0!==_.frame_rate.fps_num&&0!==_.frame_rate.fps_den||(f.frameRate=this._referenceFrameRate);const b=f.frameRate.fps_den,C=f.frameRate.fps_num;f.refSampleDuration=f.timescale*(b/C),f.codec=_.codec_mimetype;const T=this._mediaInfo;T.width=f.codecWidth,T.height=f.codecHeight,T.fps=f.frameRate.fps,T.profile=f.profile,T.level=f.level,T.refFrames=_.ref_frames,T.chromaFormat=_.chroma_format_string,T.sarNum=f.sarRatio.width,T.sarDen=f.sarRatio.height,T.videoCodec=_.codec_mimetype,T.hasAudio?null!=T.audioCodec&&(T.mimeType='video/x-flv; codecs="'+T.videoCodec+","+T.audioCodec+'"'):T.mimeType='video/x-flv; codecs="'+T.videoCodec+'"',T.isComplete()&&(null===(c=this._onMediaInfo)||void 0===c||c.call(this,T)),f.av1c=new Uint8Array(i),f.av1c.set(new Uint8Array(e,t,i),0),o.Z.v(this.TAG,"Parsed AV1CodecConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&((null===(u=this._audioTrack)||void 0===u?void 0:u.length)||(null===(m=this._videoTrack)||void 0===m?void 0:m.length))&&(null===(p=this._onDataAvailable)||void 0===p||p.call(this,this._audioTrack,this._videoTrack)):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,null===(h=this._onTrackMetadata)||void 0===h||h.call(this,"video",f)}_parseAVCVideoData(e,t,i,n,a,r,s){const d=this._littleEndian,l=new DataView(e,t,i),c=[];let u=0,m=0;const p=this._naluLengthSize,h=this._timestampBase+n;let f=1===r;for(;m<i;){if(m+4>=i){o.Z.w(this.TAG,`Malformed Nalu near timestamp ${h}, offset = ${m}, dataSize = ${i}`);break}let n=l.getUint32(m,!d);if(3===p&&(n>>>=8),n>i-p)return void o.Z.w(this.TAG,`Malformed Nalus near timestamp ${h}, NaluSize > DataSize!`);const a=31&l.getUint8(m+p);5===a&&(f=!0);const r=new Uint8Array(e,t+m,p+n),s={type:a,data:r};c.push(s),u+=r.byteLength,m+=p+n}if(c.length){const e=this._videoTrack,t={units:c,length:u,isKeyframe:f,dts:h,cts:s,pts:h+s};f&&(t.fileposition=a),e&&(e.samples.push(t),e.length+=u)}}_parseHEVCVideoData(e,t,i,n,a,r,s){const d=this._littleEndian,l=new DataView(e,t,i),c=[];let u=0,m=0;const p=this._naluLengthSize,h=this._timestampBase+n;let f=1===r;for(;m<i;){if(m+4>=i){o.Z.w(this.TAG,`Malformed Nalu near timestamp ${h}, offset = ${m}, dataSize = ${i}`);break}let n=l.getUint32(m,!d);if(3===p&&(n>>>=8),n>i-p)return void o.Z.w(this.TAG,`Malformed Nalus near timestamp ${h}, NaluSize > DataSize!`);const a=31&l.getUint8(m+p);19!==a&&20!==a||(f=!0);const r=new Uint8Array(e,t+m,p+n),s={type:a,data:r};c.push(s),u+=r.byteLength,m+=p+n}if(c.length){const e=this._videoTrack,t={units:c,length:u,isKeyframe:f,dts:h,cts:s,pts:h+s};f&&(t.fileposition=a),e&&(null==e||e.samples.push(t),e.length+=u)}}_parseAV1VideoData(e,t,i,n,o,a,r){this._littleEndian;const s=[];let d=0;const l=this._timestampBase+n,c=1===a;if(d=i,s.push({unitType:0,data:new Uint8Array(e,t+0,i)}),s.length){const e=this._videoTrack,t={units:s,length:d,isKeyframe:c,dts:l,cts:r,pts:l+r};c&&(t.fileposition=o),e&&(null==e||e.samples.push(t),e.length+=d)}}}const E=k;class P{constructor(){}destroy(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null}}class I{constructor(){this.program_pmt_pid={}}}var x,R,A,D;!function(e){e[e.kMPEG1Audio=3]="kMPEG1Audio",e[e.kMPEG2Audio=4]="kMPEG2Audio",e[e.kPESPrivateData=6]="kPESPrivateData",e[e.kADTSAAC=15]="kADTSAAC",e[e.kLOASAAC=17]="kLOASAAC",e[e.kAC3=129]="kAC3",e[e.kEAC3=135]="kEAC3",e[e.kID3=21]="kID3",e[e.kSCTE35=134]="kSCTE35",e[e.kH264=27]="kH264",e[e.kH265=36]="kH265"}(x||(x={}));class B{constructor(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.scte_35_pids={},this.smpte2038_pids={}}}class j{}class L{}class M{constructor(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0,this.random_access_indicator=0}}!function(e){e[e.kUnspecified=0]="kUnspecified",e[e.kSliceNonIDR=1]="kSliceNonIDR",e[e.kSliceDPA=2]="kSliceDPA",e[e.kSliceDPB=3]="kSliceDPB",e[e.kSliceDPC=4]="kSliceDPC",e[e.kSliceIDR=5]="kSliceIDR",e[e.kSliceSEI=6]="kSliceSEI",e[e.kSliceSPS=7]="kSliceSPS",e[e.kSlicePPS=8]="kSlicePPS",e[e.kSliceAUD=9]="kSliceAUD",e[e.kEndOfSequence=10]="kEndOfSequence",e[e.kEndOfStream=11]="kEndOfStream",e[e.kFiller=12]="kFiller",e[e.kSPSExt=13]="kSPSExt",e[e.kReserved0=14]="kReserved0"}(R||(R={}));class N{}class F{constructor(e){const t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)}}class z{constructor(e){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&o.Z.e(this.TAG,"Could not find H264 startcode until payload end!")}findNextStartCodeOffset(e){let t=e;const i=this.data_;for(;;){if(t+3>=i.byteLength)return this.eof_flag_=!0,i.byteLength;const e=i[t+0]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3],n=i[t+0]<<16|i[t+1]<<8|i[t+2];if(1===e||1===n)return t;t++}}readNextNaluPayload(){const e=this.data_;let t=null;for(;null==t&&!this.eof_flag_;){let i=this.current_startcode_offset_;i+=1===(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])?4:3;const n=31&e[i],o=(128&e[i])>>>7,a=this.findNextStartCodeOffset(i);if(this.current_startcode_offset_=a,n>=R.kReserved0)continue;if(0!==o)continue;const r=e.subarray(i,a);t=new N,t.type=n,t.data=r}return t}}class O{constructor(e,t,i){let n=8+e.byteLength+1+2+t.byteLength,o=!1;66!==e[3]&&77!==e[3]&&88!==e[3]&&(o=!0,n+=4);const a=this.data=new Uint8Array(n);a[0]=1,a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=255,a[5]=225;const r=e.byteLength;a[6]=r>>>8,a[7]=255&r;let s=8;a.set(e,8),s+=r,a[s]=1;const d=t.byteLength;a[s+1]=d>>>8,a[s+2]=255&d,a.set(t,s+3),s+=3+d,o&&(a[s]=252|i.chroma_format_idc,a[s+1]=248|i.bit_depth_luma-8,a[s+2]=248|i.bit_depth_chroma-8,a[s+3]=0,s+=4)}getData(){return this.data}}!function(e){e[e.kNull=0]="kNull",e[e.kAACMain=1]="kAACMain",e[e.kAAC_LC=2]="kAAC_LC",e[e.kAAC_SSR=3]="kAAC_SSR",e[e.kAAC_LTP=4]="kAAC_LTP",e[e.kAAC_SBR=5]="kAAC_SBR",e[e.kAAC_Scalable=6]="kAAC_Scalable",e[e.kLayer1=32]="kLayer1",e[e.kLayer2=33]="kLayer2",e[e.kLayer3=34]="kLayer3"}(A||(A={})),function(e){e[e.k96000Hz=0]="k96000Hz",e[e.k88200Hz=1]="k88200Hz",e[e.k64000Hz=2]="k64000Hz",e[e.k48000Hz=3]="k48000Hz",e[e.k44100Hz=4]="k44100Hz",e[e.k32000Hz=5]="k32000Hz",e[e.k24000Hz=6]="k24000Hz",e[e.k22050Hz=7]="k22050Hz",e[e.k16000Hz=8]="k16000Hz",e[e.k12000Hz=9]="k12000Hz",e[e.k11025Hz=10]="k11025Hz",e[e.k8000Hz=11]="k8000Hz",e[e.k7350Hz=12]="k7350Hz"}(D||(D={}));const U=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];class Z{}class V extends Z{}class H{constructor(e){this.TAG="AACADTSParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&o.Z.e(this.TAG,"Could not found ADTS syncword until payload end")}findNextSyncwordOffset(e){let t=e;const i=this.data_;for(;;){if(t+7>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(4095===(i[t+0]<<8|i[t+1])>>>4)return t;t++}}readNextAACFrame(){const e=this.data_;let t=null;for(;null==t&&!this.eof_flag_;){let i=this.current_syncword_offset_;const n=(8&e[i+1])>>>3,o=(6&e[i+1])>>>1,a=1&e[i+1],r=(192&e[i+2])>>>6,s=(60&e[i+2])>>>2,d=(1&e[i+2])<<2|(192&e[i+3])>>>6,l=(3&e[i+3])<<11|e[i+4]<<3|(224&e[i+5])>>>5;if(e[i+6],i+l>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}const c=1===a?7:9,u=l-c;i+=c;const m=this.findNextSyncwordOffset(i+u);if(this.current_syncword_offset_=m,0!==n&&1!==n||0!==o)continue;const p=e.subarray(i,i+u);t=new Z,t.audio_object_type=r+1,t.sampling_freq_index=s,t.sampling_frequency=U[s],t.channel_config=d,t.data=p}return t}hasIncompleteData(){return this.has_last_incomplete_data}getIncompleteData(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null}}class G{constructor(e){this.TAG="AACLOASParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&o.Z.e(this.TAG,"Could not found LOAS syncword until payload end")}findNextSyncwordOffset(e){let t=e;const i=this.data_;for(;;){if(t+1>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(695===(i[t+0]<<3|i[t+1]>>>5))return t;t++}}getLATMValue(e){const t=e.readBits(2);let i=0;for(let n=0;n<=t;n++)i<<=8,i|=e.readByte();return i}readNextAACFrame(e){const t=this.data_;let i=null;for(;null==i&&!this.eof_flag_;){const n=this.current_syncword_offset_,a=(31&t[n+1])<<8|t[n+2];if(n+3+a>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}const r=new p(t.subarray(n+3,n+3+a));let s=null;if(r.readBool()){if(null==e){o.Z.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(n+3+a),r.destroy();continue}s=e}else{const e=r.readBool();if(e&&r.readBool()){o.Z.e(this.TAG,"audioMuxVersionA is Not Supported"),r.destroy();break}if(e&&this.getLATMValue(r),!r.readBool()){o.Z.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),r.destroy();break}if(0!==r.readBits(6)){o.Z.e(this.TAG,"more than 2 numSubFrames Not Supported"),r.destroy();break}if(0!==r.readBits(4)){o.Z.e(this.TAG,"more than 2 numProgram Not Supported"),r.destroy();break}if(0!==r.readBits(3)){o.Z.e(this.TAG,"more than 2 numLayer Not Supported"),r.destroy();break}let t=e?this.getLATMValue(r):0;const i=r.readBits(5);t-=5;const n=r.readBits(4);t-=4;const a=r.readBits(4);t-=4,r.readBits(3),t-=3,t>0&&r.readBits(t);const d=r.readBits(3);if(0!==d){o.Z.e(this.TAG,`frameLengthType = ${d}. Only frameLengthType = 0 Supported`),r.destroy();break}r.readByte();const l=r.readBool();if(l)if(e)this.getLATMValue(r);else{let e=0;for(;;){e<<=8;const t=r.readBool();if(e+=r.readByte(),!t)break}console.log(e)}r.readBool()&&r.readByte(),s=new V,s.audio_object_type=i,s.sampling_freq_index=n,s.sampling_frequency=U[s.sampling_freq_index],s.channel_config=a,s.other_data_present=l}let d=0;for(;;){const e=r.readByte();if(d+=e,255!==e)break}const l=new Uint8Array(d);for(let e=0;e<d;e++)l[e]=r.readByte();i=new V,i.audio_object_type=s.audio_object_type,i.sampling_freq_index=s.sampling_freq_index,i.sampling_frequency=U[s.sampling_freq_index],i.channel_config=s.channel_config,i.other_data_present=s.other_data_present,i.data=l,this.current_syncword_offset_=this.findNextSyncwordOffset(n+3+a)}return i}hasIncompleteData(){return this.has_last_incomplete_data}getIncompleteData(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null}}class W{constructor(e){let t=[];const i=e.audio_object_type;let n=e.audio_object_type;const o=e.sampling_freq_index,a=e.channel_config;let r=0;const s=navigator.userAgent.toLowerCase();s.includes("firefox")?o>=6?(n=5,t=new Array(4),r=o-3):(n=2,t=new Array(2),r=o):s.includes("android")?(n=2,t=new Array(2),r=o):(n=5,r=o,t=new Array(4),o>=6?r=o-3:1===a&&(n=2,t=new Array(2),r=o)),t[0]=n<<3,t[0]|=(15&o)>>>1,t[1]=(15&o)<<7,t[1]|=(15&a)<<3,5===n&&(t[1]|=(15&r)>>>1,t[2]=(1&r)<<7,t[2]|=8,t[3]=0),this.config=t,this.sampling_rate=U[o],this.channel_count=a,this.codec_mimetype="mp4a.40."+n.toString(),this.original_codec_mimetype="mp4a.40."+i.toString()}}class q{}class K{}var J;!function(e){e[e.kSpliceNull=0]="kSpliceNull",e[e.kSpliceSchedule=4]="kSpliceSchedule",e[e.kSpliceInsert=5]="kSpliceInsert",e[e.kTimeSignal=6]="kTimeSignal",e[e.kBandwidthReservation=7]="kBandwidthReservation",e[e.kPrivateCommand=255]="kPrivateCommand"}(J||(J={}));const $=e=>{const t=e.readBool();return t?(e.readBits(6),{time_specified_flag:t,pts_time:4*e.readBits(31)+e.readBits(2)}):(e.readBits(7),{time_specified_flag:t})},X=e=>{const t=e.readBool();return e.readBits(6),{auto_return:t,duration:4*e.readBits(31)+e.readBits(2)}},Y=(e,t)=>{const i=t.readBits(8);return e?{component_tag:i}:{component_tag:i,splice_time:$(t)}},Q=e=>({component_tag:e.readBits(8),utc_splice_time:e.readBits(32)}),ee=e=>{const t=e.readBits(32),i=e.readBool();e.readBits(7);const n={splice_event_id:t,splice_event_cancel_indicator:i};if(i)return n;if(n.out_of_network_indicator=e.readBool(),n.program_splice_flag=e.readBool(),n.duration_flag=e.readBool(),e.readBits(5),n.program_splice_flag)n.utc_splice_time=e.readBits(32);else{n.component_count=e.readBits(8),n.components=[];for(let t=0;t<n.component_count;t++)n.components.push(Q(e))}return n.duration_flag&&(n.break_duration=X(e)),n.unique_program_id=e.readBits(16),n.avail_num=e.readBits(8),n.avails_expected=e.readBits(8),n},te=(e,t,i,n)=>({descriptor_tag:e,descriptor_length:t,identifier:i,provider_avail_id:n.readBits(32)}),ie=(e,t,i,n)=>{const o=n.readBits(8),a=n.readBits(3);n.readBits(5);let r="";for(let s=0;s<a;s++)r+=String.fromCharCode(n.readBits(8));return{descriptor_tag:e,descriptor_length:t,identifier:i,preroll:o,dtmf_count:a,DTMF_char:r}},ne=e=>{const t=e.readBits(8);return e.readBits(7),{component_tag:t,pts_offset:4*e.readBits(31)+e.readBits(2)}},oe=(e,t,i,n)=>{const o=n.readBits(32),a=n.readBool();n.readBits(7);const r={descriptor_tag:e,descriptor_length:t,identifier:i,segmentation_event_id:o,segmentation_event_cancel_indicator:a};if(a)return r;if(r.program_segmentation_flag=n.readBool(),r.segmentation_duration_flag=n.readBool(),r.delivery_not_restricted_flag=n.readBool(),r.delivery_not_restricted_flag?n.readBits(5):(r.web_delivery_allowed_flag=n.readBool(),r.no_regional_blackout_flag=n.readBool(),r.archive_allowed_flag=n.readBool(),r.device_restrictions=n.readBits(2)),!r.program_segmentation_flag){r.component_count=n.readBits(8),r.components=[];for(let e=0;e<r.component_count;e++)r.components.push(ne(n))}r.segmentation_duration_flag&&(r.segmentation_duration=n.readBits(40)),r.segmentation_upid_type=n.readBits(8),r.segmentation_upid_length=n.readBits(8);{const e=new Uint8Array(r.segmentation_upid_length);for(let t=0;t<r.segmentation_upid_length;t++)e[t]=n.readBits(8);r.segmentation_upid=e.buffer}return r.segmentation_type_id=n.readBits(8),r.segment_num=n.readBits(8),r.segments_expected=n.readBits(8),52!==r.segmentation_type_id&&54!==r.segmentation_type_id&&56!==r.segmentation_type_id&&58!==r.segmentation_type_id||(r.sub_segment_num=n.readBits(8),r.sub_segments_expected=n.readBits(8)),r},ae=(e,t,i,n)=>({descriptor_tag:e,descriptor_length:t,identifier:i,TAI_seconds:n.readBits(48),TAI_ns:n.readBits(32),UTC_offset:n.readBits(16)}),re=e=>({component_tag:e.readBits(8),ISO_code:String.fromCharCode(e.readBits(8),e.readBits(8),e.readBits(8)),Bit_Stream_Mode:e.readBits(3),Num_Channels:e.readBits(4),Full_Srvc_Audio:e.readBool()}),se=(e,t,i,n)=>{const o=n.readBits(4),a=[];for(let r=0;r<o;r++)a.push(re(n));return{descriptor_tag:e,descriptor_length:t,identifier:i,audio_count:o,components:a}},de=e=>{var t,i,n,o,a,r;const s=new p(e),d=s.readBits(8),l=s.readBool(),c=s.readBool();s.readBits(2);const u=s.readBits(12),m=s.readBits(8),h=s.readBool(),f=s.readBits(6),g=4*s.readBits(31)+s.readBits(2),v=s.readBits(8),y=s.readBits(12),S=s.readBits(12),_=s.readBits(8);let b=null;_===J.kSpliceNull?b={}:_===J.kSpliceSchedule?b=(e=>{const t=e.readBits(8),i=[];for(let n=0;n<t;n++)i.push(ee(e));return{splice_count:t,events:i}})(s):_===J.kSpliceInsert?b=(e=>{const t=e.readBits(32),i=e.readBool();e.readBits(7);const n={splice_event_id:t,splice_event_cancel_indicator:i};if(i)return n;if(n.out_of_network_indicator=e.readBool(),n.program_splice_flag=e.readBool(),n.duration_flag=e.readBool(),n.splice_immediate_flag=e.readBool(),e.readBits(4),n.program_splice_flag&&!n.splice_immediate_flag&&(n.splice_time=$(e)),!n.program_splice_flag){n.component_count=e.readBits(8),n.components=[];for(let t=0;t<n.component_count;t++)n.components.push(Y(n.splice_immediate_flag,e))}return n.duration_flag&&(n.break_duration=X(e)),n.unique_program_id=e.readBits(16),n.avail_num=e.readBits(8),n.avails_expected=e.readBits(8),n})(s):_===J.kTimeSignal?b=(e=>({splice_time:$(e)}))(s):_===J.kBandwidthReservation?b={}:_===J.kPrivateCommand?b=((e,t)=>{const i=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)),n=new Uint8Array(e-4);for(let o=0;o<e-4;o++)n[o]=t.readBits(8);return{identifier:i,private_data:n.buffer}})(S,s):s.readBits(8*S);const C=[],T=s.readBits(16);for(let p=0;p<T;){const e=s.readBits(8),t=s.readBits(8),i=String.fromCharCode(s.readBits(8),s.readBits(8),s.readBits(8),s.readBits(8));0===e?C.push(te(e,t,i,s)):1===e?C.push(ie(e,t,i,s)):2===e?C.push(oe(e,t,i,s)):3===e?C.push(ae(e,t,i,s)):4===e?C.push(se(e,t,i,s)):s.readBits(8*(t-4)),p+=2+t}const w={table_id:d,section_syntax_indicator:l,private_indicator:c,section_length:u,protocol_version:m,encrypted_packet:h,encryption_algorithm:f,pts_adjustment:g,cw_index:v,tier:y,splice_command_length:S,splice_command_type:_,splice_command:b,descriptor_loop_length:T,splice_descriptors:C,E_CRC32:h?s.readBits(32):void 0,CRC32:s.readBits(32)};if(_===J.kSpliceInsert){const s=b;if(s.splice_event_cancel_indicator)return{splice_command_type:_,detail:w,data:e};if(s.program_splice_flag&&!s.splice_immediate_flag){const a=s.duration_flag?null===(t=null==s?void 0:s.break_duration)||void 0===t?void 0:t.auto_return:void 0,r=s.duration_flag?((null===(i=null==s?void 0:s.break_duration)||void 0===i?void 0:i.duration)||0)/90:void 0;return(null===(n=s.splice_time)||void 0===n?void 0:n.time_specified_flag)?{splice_command_type:_,pts:(g+((null===(o=null==s?void 0:s.splice_time)||void 0===o?void 0:o.pts_time)||0))%Math.pow(2,33),auto_return:a,duraiton:r,detail:w,data:e}:{splice_command_type:_,auto_return:a,duraiton:r,detail:w,data:e}}return{splice_command_type:_,auto_return:s.duration_flag?null===(a=s.break_duration)||void 0===a?void 0:a.auto_return:void 0,duraiton:s.duration_flag?((null===(r=s.break_duration)||void 0===r?void 0:r.duration)||0)/90:void 0,detail:w,data:e}}if(_===J.kTimeSignal){const t=b;return t.splice_time.time_specified_flag?{splice_command_type:_,pts:(g+(t.splice_time.pts_time||0))%Math.pow(2,33),detail:w,data:e}:{splice_command_type:_,detail:w,data:e}}return{splice_command_type:_,detail:w,data:e}};var le;!function(e){e[e.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",e[e.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",e[e.kSliceCRA_NUT=21]="kSliceCRA_NUT",e[e.kSliceVPS=32]="kSliceVPS",e[e.kSliceSPS=33]="kSliceSPS",e[e.kSlicePPS=34]="kSlicePPS",e[e.kSliceAUD=35]="kSliceAUD"}(le||(le={}));class ce{}class ue{constructor(e){const t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)}}class me{constructor(e){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&o.Z.e(this.TAG,"Could not find H265 startcode until payload end!")}findNextStartCodeOffset(e){let t=e;const i=this.data_;for(;;){if(t+3>=i.byteLength)return this.eof_flag_=!0,i.byteLength;const e=i[t+0]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3],n=i[t+0]<<16|i[t+1]<<8|i[t+2];if(1===e||1===n)return t;t++}}readNextNaluPayload(){const e=this.data_;let t=null;for(;null==t&&!this.eof_flag_;){let i=this.current_startcode_offset_;i+=1===(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])?4:3;const n=e[i]>>1&63,o=(128&e[i])>>>7,a=this.findNextStartCodeOffset(i);if(this.current_startcode_offset_=a,0!==o)continue;const r=e.subarray(i,a);t=new ce,t.type=n,t.data=r}return t}}class pe{constructor(e,t,i,n){const o=23+(5+e.byteLength)+(5+t.byteLength)+(5+i.byteLength),a=this.data=new Uint8Array(o);a[0]=1,a[1]=(3&n.general_profile_space)<<6|(n.general_tier_flag?1:0)<<5|31&n.general_profile_idc,a[2]=n.general_profile_compatibility_flags_1,a[3]=n.general_profile_compatibility_flags_2,a[4]=n.general_profile_compatibility_flags_3,a[5]=n.general_profile_compatibility_flags_4,a[6]=n.general_constraint_indicator_flags_1,a[7]=n.general_constraint_indicator_flags_2,a[8]=n.general_constraint_indicator_flags_3,a[9]=n.general_constraint_indicator_flags_4,a[10]=n.general_constraint_indicator_flags_5,a[11]=n.general_constraint_indicator_flags_6,a[12]=n.general_level_idc,a[13]=240|(3840&n.min_spatial_segmentation_idc)>>8,a[14]=255&n.min_spatial_segmentation_idc,a[15]=252|3&n.parallelismType,a[16]=252|3&n.chroma_format_idc,a[17]=248|7&n.bit_depth_luma_minus8,a[18]=248|7&n.bit_depth_chroma_minus8,a[19]=0,a[20]=0,a[21]=(3&n.constant_frame_rate)<<6|(7&n.num_temporal_layers)<<3|(n.temporal_id_nested?1:0)<<2|3,a[22]=3,a[23]=128|le.kSliceVPS,a[24]=0,a[25]=1,a[26]=(65280&e.byteLength)>>8,a[27]=(255&e.byteLength)>>0,a.set(e,28),a[23+(5+e.byteLength)+0]=128|le.kSliceSPS,a[23+(5+e.byteLength)+1]=0,a[23+(5+e.byteLength)+2]=1,a[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,a[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,a.set(t,23+(5+e.byteLength)+5),a[23+(5+e.byteLength+5+t.byteLength)+0]=128|le.kSlicePPS,a[23+(5+e.byteLength+5+t.byteLength)+1]=0,a[23+(5+e.byteLength+5+t.byteLength)+2]=1,a[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&i.byteLength)>>8,a[23+(5+e.byteLength+5+t.byteLength)+4]=(255&i.byteLength)>>0,a.set(i,23+(5+e.byteLength+5+t.byteLength)+5)}getData(){return this.data}}class he{}class fe{}class ge{}const ve=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]];class ye{constructor(e){this.TAG="AC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&o.Z.e(this.TAG,"Could not found AC3 syncword until payload end")}findNextSyncwordOffset(e){let t=e;const i=this.data_;for(;;){if(t+7>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(2935===(i[t+0]<<8|i[t+1]<<0))return t;t++}}readNextAC3Frame(){const e=this.data_;let t=null;for(;null==t&&!this.eof_flag_;){const i=this.current_syncword_offset_,n=e[i+4]>>6,o=[48e3,44200,33e3][n],a=63&e[i+4],r=2*ve[n][a];if(i+r>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}const s=this.findNextSyncwordOffset(i+r);this.current_syncword_offset_=s;const d=e[i+5]>>3,l=7&e[i+5],c=e[i+6]>>5;let u=0;0!=(1&c)&&1!==c&&(u+=2),0!=(4&c)&&(u+=2),2===c&&(u+=2);const m=(e[i+6]<<8|e[i+7]<<0)>>12-u&1,p=[2,1,2,3,3,4,4,5][c]+m;t=new ge,t.sampling_frequency=o,t.channel_count=p,t.channel_mode=c,t.bit_stream_identification=d,t.low_frequency_effects_channel_on=m,t.bit_stream_mode=l,t.frame_size_code=a,t.data=e.subarray(i,i+r)}return t}hasIncompleteData(){return this.has_last_incomplete_data}getIncompleteData(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null}}class Se{constructor(e){let t=[];t=[e.sampling_rate_code<<6|e.bit_stream_identification<<1|e.bit_stream_mode>>2,(3&e.bit_stream_mode)<<6|e.channel_mode<<3|e.low_frequency_effects_channel_on<<2|e.frame_size_code>>4,e.frame_size_code<<4&224],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.bit_stream_mode=e.bit_stream_mode,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"}}class _e{}class be{constructor(e){this.TAG="EAC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&o.Z.e(this.TAG,"Could not found AC3 syncword until payload end")}findNextSyncwordOffset(e){let t=e;const i=this.data_;for(;;){if(t+7>=i.byteLength)return this.eof_flag_=!0,i.byteLength;if(2935===(i[t+0]<<8|i[t+1]<<0))return t;t++}}readNextEAC3Frame(){const e=this.data_;let t=null;for(;null==t&&!this.eof_flag_;){const i=this.current_syncword_offset_,n=new p(e.subarray(i+2)),o=(n.readBits(2),n.readBits(3),n.readBits(11)+1<<1);let a=n.readBits(2),r=null,s=null;3===a?(a=n.readBits(2),r=[24e3,22060,16e3][a],s=3):(r=[48e3,44100,32e3][a],s=n.readBits(2));const d=n.readBits(3),l=n.readBits(1),c=n.readBits(5);if(i+o>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}const u=this.findNextSyncwordOffset(i+o);this.current_syncword_offset_=u;const m=[2,1,2,3,3,4,4,5][d]+l;n.destroy(),t=new _e,t.sampling_frequency=r,t.channel_count=m,t.channel_mode=d,t.bit_stream_identification=c,t.low_frequency_effects_channel_on=l,t.frame_size=o,t.num_blks=[1,2,3,6][s],t.data=e.subarray(i,i+o)}return t}hasIncompleteData(){return this.has_last_incomplete_data}getIncompleteData(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null}}class Ce{constructor(e){let t=[];const i=Math.floor(e.frame_size*e.sampling_frequency/(16*e.num_blks));t=[255&i,248&i,e.sampling_rate_code<<6|e.bit_stream_identification<<1|0,0|e.channel_mode<<1|e.low_frequency_effects_channel_on<<0,0],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.num_blks=e.num_blks,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"}}const Te=class extends P{constructor(e,t){super(),this.TAG="TSDemuxer",this.first_parse_=!0,this.media_info_=new r.Z,this.timescale_=90,this.duration_=0,this.current_pmt_pid_=-1,this.program_pmt_map_={},this.pes_slice_queues_={},this.section_slice_queues_={},this.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},this.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},this.aac_last_sample_pts_=void 0,this.aac_last_incomplete_data_=null,this.has_video_=!1,this.has_audio_=!1,this.video_init_segment_dispatched_=!1,this.audio_init_segment_dispatched_=!1,this.video_metadata_changed_=!1,this.audio_metadata_changed_=!1,this.loas_previous_frame=null,this.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this.ts_packet_size_=e.ts_packet_size,this.sync_offset_=e.sync_offset,this.config_=t}destroy(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,super.destroy()}static probe(e){const t=new Uint8Array(e);let i=-1,n=188;if(t.byteLength<=3*n)return{needMoreData:!0};for(;-1===i;){const e=Math.min(1e3,t.byteLength-3*n);for(let o=0;o<e;){if(71===t[o]&&71===t[o+n]&&71===t[o+2*n]){i=o;break}o++}if(-1===i)if(188===n)n=192;else{if(192!==n)break;n=204}}return-1===i?{match:!1}:(192===n&&i>=4?(o.Z.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),i-=4):204===n&&o.Z.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:n,sync_offset:i})}bindDataSource(e){return e.onDataArrival=this.parseChunks.bind(this),this}resetMediaInfo(){this.media_info_=new r.Z}parseChunks(e,t){var i;if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new l.rT("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");let n=0;for(this.first_parse_&&(this.first_parse_=!1,n=this.sync_offset_);n+this.ts_packet_size_<=e.byteLength;){const a=t+n;192===this.ts_packet_size_&&(n+=4);const r=new Uint8Array(e,n,188),s=r[0];if(71!==s){o.Z.e(this.TAG,`sync_byte = ${s}, not 0x47`);break}const d=(64&r[1])>>>6,l=(r[1],(31&r[1])<<8|r[2]),c=(48&r[3])>>>4,u=15&r[3];let m={},p=4;if(2===c||3===c){const t=r[4];if(5+t===188){n+=188,204===this.ts_packet_size_&&(n+=16);continue}t>0&&(m=this.parseAdaptationField(e,n+4,1+t)),p=5+t}if(1===c||3===c)if(0===l||l===this.current_pmt_pid_||void 0!==this.pmt_&&this.pmt_.pid_stream_type[l]===x.kSCTE35){const t=188-p;this.handleSectionSlice(e,n+p,t,{pid:l,file_position:a,payload_unit_start_indicator:d,continuity_conunter:u,random_access_indicator:m.random_access_indicator})}else if(void 0!==(null===(i=this.pmt_)||void 0===i?void 0:i.pid_stream_type[l])){const t=188-p,i=this.pmt_.pid_stream_type[l];(l===this.pmt_.common_pids.h264||l===this.pmt_.common_pids.h265||l===this.pmt_.common_pids.adts_aac||l===this.pmt_.common_pids.loas_aac||l===this.pmt_.common_pids.ac3||l===this.pmt_.common_pids.eac3||l===this.pmt_.common_pids.opus||l===this.pmt_.common_pids.mp3||this.pmt_.pes_private_data_pids[l]||this.pmt_.timed_id3_pids[l])&&this.handlePESSlice(e,n+p,t,{pid:l,stream_type:i,file_position:a,payload_unit_start_indicator:d,continuity_conunter:u,random_access_indicator:m.random_access_indicator})}n+=188,204===this.ts_packet_size_&&(n+=16)}return this.dispatchAudioVideoMediaSegment(),n}parseAdaptationField(e,t,i){const n=new Uint8Array(e,t,i),a=n[0];return a>0?a>183?(o.Z.w(this.TAG,"Illegal adaptation_field_length: "+a),{}):{discontinuity_indicator:(128&n[1])>>>7,random_access_indicator:(64&n[1])>>>6,elementary_stream_priority_indicator:(32&n[1])>>>5}:{}}handleSectionSlice(e,t,i,n){const o=new Uint8Array(e,t,i);let a=this.section_slice_queues_?this.section_slice_queues_[n.pid]:{};if(n.payload_unit_start_indicator){const r=o[0];if(void 0!==a&&0!==(null==a?void 0:a.total_length)){const o=new Uint8Array(e,t+1,Math.min(i,r));a.slices.push(o),a.total_length+=o.byteLength,a.total_length===a.expected_length?this.emitSectionSlices(a,n):this.clearSlices(a,n)}for(let s=1+r;s<o.byteLength;){if(255===o[s+0])break;const r=(15&o[s+1])<<8|o[s+2];this.section_slice_queues_&&(this.section_slice_queues_[n.pid]=new M,a=this.section_slice_queues_[n.pid]),a.expected_length=r+3,a.file_position=n.file_position,a.random_access_indicator=n.random_access_indicator;const d=new Uint8Array(e,t+s,Math.min(i-s,a.expected_length-a.total_length));a.slices.push(d),a.total_length+=d.byteLength,a.total_length===a.expected_length?this.emitSectionSlices(a,n):a.total_length>=a.expected_length&&this.clearSlices(a,n),s+=d.byteLength}}else if(void 0!==a&&0!==a.total_length){const o=new Uint8Array(e,t,Math.min(i,a.expected_length-a.total_length));a.slices.push(o),a.total_length+=o.byteLength,a.total_length===a.expected_length?this.emitSectionSlices(a,n):a.total_length>=a.expected_length&&this.clearSlices(a,n)}}handlePESSlice(e,t,i,n){const a=new Uint8Array(e,t,i),r=a[0]<<16|a[1]<<8|a[2],s=(a[3],a[4]<<8|a[5]);if(n.payload_unit_start_indicator){if(1!==r)return void o.Z.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value "+r);const e=this.pes_slice_queues_[n.pid];e&&(0===e.expected_length||e.expected_length===e.total_length?this.emitPESSlices(e,n):this.clearSlices(e,n)),this.pes_slice_queues_&&(this.pes_slice_queues_[n.pid]=new M,this.pes_slice_queues_[n.pid].file_position=n.file_position,this.pes_slice_queues_[n.pid].random_access_indicator=n.random_access_indicator)}if(void 0===this.pes_slice_queues_[n.pid])return;const d=this.pes_slice_queues_[n.pid];d.slices.push(a),n.payload_unit_start_indicator&&(d.expected_length=0===s?0:s+6),d.total_length+=a.byteLength,d.expected_length>0&&d.expected_length===d.total_length?this.emitPESSlices(d,n):d.expected_length>0&&d.expected_length<d.total_length&&this.clearSlices(d,n)}emitSectionSlices(e,t){const i=new Uint8Array(e.total_length);for(let o=0,a=0;o<e.slices.length;o++){const t=e.slices[o];i.set(t,a),a+=t.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;const n=new L;n.pid=t.pid,n.data=i,n.file_position=e.file_position,n.random_access_indicator=e.random_access_indicator,this.parseSection(n)}emitPESSlices(e,t){const i=new Uint8Array(e.total_length);for(let o=0,a=0;o<e.slices.length;o++){const t=e.slices[o];i.set(t,a),a+=t.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;const n=new j;n.pid=t.pid,n.data=i,n.stream_type=t.stream_type,n.file_position=e.file_position,n.random_access_indicator=e.random_access_indicator,this.parsePES(n)}clearSlices(e,t){e.slices=[],e.expected_length=-1,e.total_length=0}parseSection(e){var t;const i=e.data,n=e.pid;0===n?this.parsePAT(i):n===this.current_pmt_pid_?this.parsePMT(i):(null===(t=this.pmt_)||void 0===t?void 0:t.scte_35_pids[n])&&this.parseSCTE35(i)}parsePES(e){const t=e.data,i=t[0]<<16|t[1]<<8|t[2],n=t[3],a=t[4]<<8|t[5];if(1===i){if(188!==n&&190!==n&&191!==n&&240!==n&&241!==n&&255!==n&&242!==n&&248!==n){t[6];const i=(192&t[7])>>>6,r=t[8];let s,d;2!==i&&3!==i||(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,d=3===i?536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2:s);const l=9+r;let c;if(0!==a){if(a<3+r)return void o.Z.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");c=a-3-r}else c=t.byteLength-l;const u=t.subarray(l,l+c);switch(e.stream_type){case x.kMPEG1Audio:case x.kMPEG2Audio:this.parseMP3Payload(u,s);break;case x.kPESPrivateData:this.pmt_.common_pids.opus===e.pid?this.parseOpusPayload(u,s):this.pmt_.common_pids.ac3===e.pid?this.parseAC3Payload(u,s):this.pmt_.common_pids.eac3===e.pid?this.parseEAC3Payload(u,s):this.pmt_.smpte2038_pids[e.pid]?this.parseSMPTE2038MetadataPayload(u,s,d,e.pid,n):this.parsePESPrivateDataPayload(u,s,d,e.pid,n);break;case x.kADTSAAC:this.parseADTSAACPayload(u,s);break;case x.kLOASAAC:this.parseLOASAACPayload(u,s);break;case x.kAC3:this.parseAC3Payload(u,s);break;case x.kEAC3:this.parseEAC3Payload(u,s);break;case x.kID3:this.parseTimedID3MetadataPayload(u,s,d,e.pid,n);break;case x.kH264:this.parseH264Payload(u,s,d,e.file_position,e.random_access_indicator);break;case x.kH265:this.parseH265Payload(u,s,d,e.file_position,e.random_access_indicator)}}else if((188===n||191===n||240===n||241===n||255===n||242===n||248===n)&&e.stream_type===x.kPESPrivateData){const i=6;let o;o=0!==a?a:t.byteLength-i;const r=t.subarray(i,i+o);this.parsePESPrivateDataPayload(r,void 0,void 0,e.pid,n)}}else o.Z.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value "+i)}parsePAT(e){const t=e[0];if(0!==t)return void o.Z.e(this.TAG,`parsePAT: table_id ${t} is not corresponded to PAT!`);const i=(15&e[1])<<8|e[2],n=(e[3],e[4],(62&e[5])>>>1),a=1&e[5],r=e[6];e[7];let s=null;if(1===a&&0===r)s=new I,s.version_number=n;else if(s=this.pat_,null==s)return;const d=i-5-4;let l=-1,c=-1;for(let o=8;o<8+d;o+=4){const t=e[o]<<8|e[o+1],i=(31&e[o+2])<<8|e[o+3];0===t?s.network_pid=i:(s.program_pmt_pid[t]=i,-1===l&&(l=t),-1===c&&(c=i))}1===a&&0===r&&(void 0===this.pat_&&o.Z.v(this.TAG,"Parsed first PAT: "+JSON.stringify(s)),this.pat_=s,this.current_program_=l,this.current_pmt_pid_=c)}parsePMT(e){const t=e[0];if(2!==t)return void o.Z.e(this.TAG,`parsePMT: table_id ${t} is not corresponded to PMT!`);const i=(15&e[1])<<8|e[2],n=e[3]<<8|e[4],a=(62&e[5])>>>1,r=1&e[5],s=e[6];e[7];let d=null;if(1===r&&0===s)d=new B,d.program_number=n,d.version_number=a,this.program_pmt_map_[n]=d;else if(d=this.program_pmt_map_[n],null==d)return;e[8],e[9];const l=(15&e[10])<<8|e[11],c=12+l,u=i-9-l-4;for(let m=c;m<c+u;){const t=e[m],i=(31&e[m+1])<<8|e[m+2],n=(15&e[m+3])<<8|e[m+4];d.pid_stream_type[i]=t;const a=d.common_pids.h264||d.common_pids.h265,r=d.common_pids.adts_aac||d.common_pids.loas_aac||d.common_pids.ac3||d.common_pids.eac3||d.common_pids.opus||d.common_pids.mp3;if(t!==x.kH264||a)if(t!==x.kH265||a)if(t!==x.kADTSAAC||r)if(t!==x.kLOASAAC||r)if(t!==x.kAC3||r)if(t!==x.kEAC3||r)if(t!==x.kMPEG1Audio&&t!==x.kMPEG2Audio||r)if(t===x.kPESPrivateData){if(d.pes_private_data_pids[i]=!0,n>0){for(let t=m+5;t<m+5+n;){const n=e[t+0],a=e[t+1];if(5===n){const n=String.fromCharCode(...Array.from(e.subarray(t+2,t+2+a)));"VANC"===n?d.smpte2038_pids[i]=!0:"Opus"===n&&(d.common_pids.opus=i)}else if(127===n&&i===d.common_pids.opus){let i=null;if(128===e[t+2]&&(i=e[t+3]),null==i){o.Z.e(this.TAG,"Not Supported Opus channel count.");continue}const n={codec:"opus",channel_count:0==(15&i)?2:15&i,channel_config_code:i,sample_rate:48e3},a={codec:"opus",meta:n};this.audio_init_segment_dispatched_?this.detectAudioMetadataChange(a)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(a)):(this.audio_metadata_=n,this.dispatchAudioInitSegment(a))}t+=2+a}const a=e.subarray(m+5,m+5+n);this.dispatchPESPrivateDataDescriptor(i,t,a)}}else t===x.kID3?d.timed_id3_pids[i]=!0:t===x.kSCTE35&&(d.scte_35_pids[i]=!0);else d.common_pids.mp3=i;else d.common_pids.eac3=i;else d.common_pids.ac3=i;else d.common_pids.loas_aac=i;else d.common_pids.adts_aac=i;else d.common_pids.h265=i;else d.common_pids.h264=i;m+=5+n}n===this.current_program_&&(void 0===this.pmt_&&o.Z.v(this.TAG,"Parsed first PMT: "+JSON.stringify(d)),this.pmt_=d,(d.common_pids.h264||d.common_pids.h265)&&(this.has_video_=!0),(d.common_pids.adts_aac||d.common_pids.loas_aac||d.common_pids.ac3||d.common_pids.opus||d.common_pids.mp3)&&(this.has_audio_=!0))}parseSCTE35(e){const t=de(e);if(void 0!==t.pts){const e=Math.floor(t.pts/this.timescale_);t.pts=e}else t.nearest_pts=this.aac_last_sample_pts_;this.onSCTE35Metadata&&this.onSCTE35Metadata(t)}parseH264Payload(e,t,i,n,a){var r,s;const d=new z(e);let l=null;const c=[];let u=0,m=!1;for(;null!=(l=d.readNextNaluPayload());){const e=new F(l);if(e.type===R.kSliceSPS){const t=f.parseSPS(l.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(e,t)&&(o.Z.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:e,pps:void 0,details:t}):this.video_metadata_&&(this.video_metadata_.sps=e,this.video_metadata_.details=t)}else e.type===R.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_&&(this.video_metadata_.pps=e),(null===(r=this.video_metadata_)||void 0===r?void 0:r.sps)&&(null===(s=this.video_metadata_)||void 0===s?void 0:s.pps)&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(e.type===R.kSliceIDR||e.type===R.kSliceNonIDR&&1===a)&&(m=!0);this.video_init_segment_dispatched_&&(c.push(e),u+=e.data.byteLength)}const p=Math.floor(t/this.timescale_),h=Math.floor(i/this.timescale_);if(c.length){const e=this.video_track_,t={units:c,length:u,isKeyframe:m,dts:h,pts:p,cts:p-h,file_position:n};e&&(e.samples.push(t),e.length+=u)}}parseH265Payload(e,t,i,n,a){var r,s,d,l,c,u,m;const p=new me(e);let h=null;const f=[];let g=0,v=!1;for(;null!=(h=p.readNextNaluPayload());){const e=new ue(h);if(e.type===le.kSliceVPS){if(!this.video_init_segment_dispatched_){const t=y.parseVPS(h.data);this.video_metadata_&&(this.video_metadata_.vps=e,this.video_metadata_.details=Object.assign(Object.assign({},null===(r=this.video_metadata_)||void 0===r?void 0:r.details),t))}}else if(e.type===le.kSliceSPS){const t=y.parseSPS(h.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(e,t)&&(o.Z.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:e,pps:void 0,details:t}):this.video_metadata_&&(this.video_metadata_.sps=e,this.video_metadata_.details=Object.assign(Object.assign({},null===(s=this.video_metadata_)||void 0===s?void 0:s.details),t))}else if(e.type===le.kSlicePPS){if(!this.video_init_segment_dispatched_||this.video_metadata_changed_){const t=y.parsePPS(h.data);this.video_metadata_&&(this.video_metadata_.pps=e,this.video_metadata_.details=Object.assign(Object.assign({},null===(d=this.video_metadata_)||void 0===d?void 0:d.details),t)),(null===(l=this.video_metadata_)||void 0===l?void 0:l.vps)&&(null===(c=this.video_metadata_)||void 0===c?void 0:c.sps)&&(null===(u=this.video_metadata_)||void 0===u?void 0:u.pps)&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())}}else e.type!==le.kSliceIDR_W_RADL&&e.type!==le.kSliceIDR_N_LP&&e.type!==le.kSliceCRA_NUT||(v=!0);this.video_init_segment_dispatched_&&(f.push(e),g+=e.data.byteLength)}const S=Math.floor(t/this.timescale_),_=Math.floor(i/this.timescale_);if(f.length){const e=this.video_track_,t={units:f,length:g,isKeyframe:v,dts:_,pts:S,cts:S-_,file_position:n};e&&(null===(m=e.samples)||void 0===m||m.push(t),e.length+=g)}}detectVideoMetadataChange(e,t){var i,n,a,r,s,d,l,c,u,m;if(t.codec_mimetype!==(null===(n=null===(i=this.video_metadata_)||void 0===i?void 0:i.details)||void 0===n?void 0:n.codec_mimetype))return o.Z.v(this.TAG,`Video: Codec mimeType changed from ${null===(a=this.video_metadata_)||void 0===a?void 0:a.details.codec_mimetype} to ${null==t?void 0:t.codec_mimetype}`),!0;if(t.codec_size.width!==(null===(s=null===(r=this.video_metadata_)||void 0===r?void 0:r.details)||void 0===s?void 0:s.codec_size.width)||t.codec_size.height!==(null===(l=null===(d=this.video_metadata_)||void 0===d?void 0:d.details)||void 0===l?void 0:l.codec_size.height)){const e=null===(c=this.video_metadata_)||void 0===c?void 0:c.details.codec_size,i=t.codec_size;return o.Z.v(this.TAG,`Video: Coded Resolution changed from ${e.width}x${e.height} to ${i.width}x${i.height}`),!0}return t.present_size.width!==(null===(u=this.video_metadata_)||void 0===u?void 0:u.details.present_size.width)&&(o.Z.v(this.TAG,`Video: Present resolution width changed from ${null===(m=this.video_metadata_)||void 0===m?void 0:m.details.present_size.width} to ${null==t?void 0:t.present_size.width}`),!0)}isInitSegmentDispatched(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_}dispatchVideoInitSegment(){var e,t,i,n,a,r,s,d,l,c,u,m;const p=null===(e=this.video_metadata_)||void 0===e?void 0:e.details,h={type:"video"};h.id=null===(t=this.video_track_)||void 0===t?void 0:t.id,h.timescale=1e3,h.duration=this.duration_,h.codecWidth=p.codec_size.width,h.codecHeight=p.codec_size.height,h.presentWidth=p.present_size.width,h.presentHeight=p.present_size.height,h.profile=p.profile_string,h.level=p.level_string,h.bitDepth=p.bit_depth,h.chromaFormat=p.chroma_format,h.sarRatio=p.sar_ratio,h.frameRate=p.frame_rate;const f=h.frameRate.fps_den,g=h.frameRate.fps_num;if(h.refSampleDuration=f/g*1e3,h.codec=p.codec_mimetype,null===(i=this.video_metadata_)||void 0===i?void 0:i.vps){const e=null===(n=this.video_metadata_)||void 0===n?void 0:n.vps.data.subarray(4),t=null===(r=null===(a=this.video_metadata_)||void 0===a?void 0:a.sps)||void 0===r?void 0:r.data.subarray(4),i=null===(d=null===(s=this.video_metadata_)||void 0===s?void 0:s.pps)||void 0===d?void 0:d.data.subarray(4),l=new pe(e,t,i,p);h.hvcc=l.getData(),this.video_init_segment_dispatched_||o.Z.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: "+h.codec)}else{const e=null===(c=null===(l=this.video_metadata_)||void 0===l?void 0:l.sps)||void 0===c?void 0:c.data.subarray(4),t=null===(m=null===(u=this.video_metadata_)||void 0===u?void 0:u.pps)||void 0===m?void 0:m.data.subarray(4),i=new O(e,t,p);h.avcc=i.getData(),this.video_init_segment_dispatched_||o.Z.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: "+h.codec)}this.onTrackMetadata&&this.onTrackMetadata("video",h),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;const v=this.media_info_;v.hasVideo=!0,v.width=h.codecWidth,v.height=h.codecHeight,v.fps=h.frameRate.fps,v.profile=h.profile,v.level=h.level,v.refFrames=p.ref_frames,v.chromaFormat=p.chroma_format_string,v.sarNum=h.sarRatio.width,v.sarDen=h.sarRatio.height,v.videoCodec=h.codec,v.hasAudio&&v.audioCodec?v.mimeType=`video/mp2t; codecs="${v.videoCodec},${v.audioCodec}"`:v.mimeType=`video/mp2t; codecs="${v.videoCodec}"`,v.isComplete()&&this.onMediaInfo&&this.onMediaInfo(v)}dispatchVideoMediaSegment(){var e;this.isInitSegmentDispatched()&&(null===(e=this.video_track_)||void 0===e?void 0:e.length)&&this.onDataAvailable&&this.onDataAvailable(null,this.video_track_)}dispatchAudioMediaSegment(){var e;this.isInitSegmentDispatched()&&(null===(e=this.audio_track_)||void 0===e?void 0:e.length)&&this.onDataAvailable&&this.onDataAvailable(this.audio_track_,null)}dispatchAudioVideoMediaSegment(){var e,t;this.isInitSegmentDispatched()&&((null===(e=this.audio_track_)||void 0===e?void 0:e.length)||(null===(t=this.video_track_)||void 0===t?void 0:t.length))&&this.onDataAvailable&&this.onDataAvailable(this.audio_track_,this.video_track_)}parseADTSAACPayload(e,t){var i,n,a;if(this.has_video_&&!this.video_init_segment_dispatched_)return;if(this.aac_last_incomplete_data_){const t=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);t.set(this.aac_last_incomplete_data_,0),t.set(e,this.aac_last_incomplete_data_.byteLength),e=t}let r,s=0;if(void 0!==t&&(s=t/this.timescale_),"aac"===(null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec)){if(void 0===t&&void 0!==this.aac_last_sample_pts_)r=1024/(null===(n=this.audio_metadata_)||void 0===n?void 0:n.sampling_frequency)*1e3,s=this.aac_last_sample_pts_+r;else if(void 0===t)return void o.Z.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){r=1024/this.audio_metadata_.sampling_frequency*1e3;const e=this.aac_last_sample_pts_+r;Math.abs(e-s)>1&&(o.Z.w(this.TAG,`AAC: Detected pts overlapped, expected: ${e}ms, PES pts: ${s}ms`),s=e)}}const d=new H(e);let l=null,c=s,u=0;for(;null!=(l=d.readNextAACFrame());){r=1024/l.sampling_frequency*1e3;const e={codec:"aac",data:l};this.audio_init_segment_dispatched_?this.detectAudioMetadataChange(e)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(e)):(this.audio_metadata_={codec:"aac",audio_object_type:l.audio_object_type,sampling_freq_index:l.sampling_freq_index,sampling_frequency:l.sampling_frequency,channel_config:l.channel_config},this.dispatchAudioInitSegment(e)),u=c;const t=Math.floor(c),i={unit:l.data,length:l.data.byteLength,pts:t,dts:t};this.audio_track_&&(null===(a=this.audio_track_)||void 0===a||a.samples.push(i),this.audio_track_.length+=l.data.byteLength),c+=r}d.hasIncompleteData()&&(this.aac_last_incomplete_data_=d.getIncompleteData()),u&&(this.aac_last_sample_pts_=u)}parseLOASAACPayload(e,t){var i,n,a;if(this.has_video_&&!this.video_init_segment_dispatched_)return;if(this.aac_last_incomplete_data_){const t=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);t.set(this.aac_last_incomplete_data_,0),t.set(e,this.aac_last_incomplete_data_.byteLength),e=t}let r,s=0;if(void 0!==t&&(s=t/this.timescale_),"aac"===(null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec)){if(void 0===t&&void 0!==this.aac_last_sample_pts_)r=1024/this.audio_metadata_.sampling_frequency*1e3,s=this.aac_last_sample_pts_+r;else if(void 0===t)return void o.Z.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){r=1024/this.audio_metadata_.sampling_frequency*1e3;const e=this.aac_last_sample_pts_+r;Math.abs(e-s)>1&&(o.Z.w(this.TAG,`AAC: Detected pts overlapped, expected: ${e}ms, PES pts: ${s}ms`),s=e)}}const d=new G(e);let l=null,c=s,u=0;for(;null!=(l=d.readNextAACFrame(null!==(n=this.loas_previous_frame)&&void 0!==n?n:void 0));){this.loas_previous_frame=l,r=1024/l.sampling_frequency*1e3;const e={codec:"aac",data:l};this.audio_init_segment_dispatched_?this.detectAudioMetadataChange(e)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(e)):(this.audio_metadata_={codec:"aac",audio_object_type:l.audio_object_type,sampling_freq_index:l.sampling_freq_index,sampling_frequency:l.sampling_frequency,channel_config:l.channel_config},this.dispatchAudioInitSegment(e)),u=c;const t=Math.floor(c),i={unit:l.data,length:l.data.byteLength,pts:t,dts:t};this.audio_track_&&(null===(a=this.audio_track_)||void 0===a||a.samples.push(i),this.audio_track_.length+=l.data.byteLength),c+=r}d.hasIncompleteData()&&(this.aac_last_incomplete_data_=d.getIncompleteData()),u&&(this.aac_last_sample_pts_=u)}parseAC3Payload(e,t){var i,n;if(this.has_video_&&!this.video_init_segment_dispatched_)return;let a,r=0;if(void 0!==t&&(r=t/this.timescale_),"ac-3"===(null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec))if(void 0===t&&void 0!==this.aac_last_sample_pts_)a=1536/this.audio_metadata_.sampling_frequency*1e3,r=this.aac_last_sample_pts_+a;else if(void 0===t)return void o.Z.w(this.TAG,"AC3: Unknown pts");const s=new ye(e);let d=null,l=r,c=0;for(;null!=(d=s.readNextAC3Frame());){a=1536/d.sampling_frequency*1e3;const e={codec:"ac-3",data:d};this.audio_init_segment_dispatched_?this.detectAudioMetadataChange(e)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(e)):(this.audio_metadata_={codec:"ac-3",sampling_frequency:d.sampling_frequency,bit_stream_identification:d.bit_stream_identification,bit_stream_mode:d.bit_stream_mode,low_frequency_effects_channel_on:d.low_frequency_effects_channel_on,channel_mode:d.channel_mode},this.dispatchAudioInitSegment(e)),c=l;const t=Math.floor(l),i={unit:d.data,length:d.data.byteLength,pts:t,dts:t};this.audio_track_&&(null===(n=this.audio_track_)||void 0===n||n.samples.push(i),this.audio_track_.length+=d.data.byteLength),l+=a}c&&(this.aac_last_sample_pts_=c)}parseEAC3Payload(e,t){var i,n;if(this.has_video_&&!this.video_init_segment_dispatched_)return;let a,r=0;if(void 0!==t&&(r=t/this.timescale_),"ec-3"===(null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec))if(void 0===t&&void 0!==this.aac_last_sample_pts_)a=256*(this.audio_metadata_.num_blks||0)/(this.audio_metadata_.sampling_frequency||0)*1e3,r=this.aac_last_sample_pts_+a;else if(void 0===t)return void o.Z.w(this.TAG,"EAC3: Unknown pts");const s=new be(e);let d=null,l=r,c=0;for(;null!=(d=s.readNextEAC3Frame());){a=1536/d.sampling_frequency*1e3;const e={codec:"ec-3",data:d};this.audio_init_segment_dispatched_?this.detectAudioMetadataChange(e)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(e)):(this.audio_metadata_={codec:"ec-3",sampling_frequency:d.sampling_frequency,bit_stream_identification:d.bit_stream_identification,low_frequency_effects_channel_on:d.low_frequency_effects_channel_on,num_blks:d.num_blks,channel_mode:d.channel_mode},this.dispatchAudioInitSegment(e)),c=l;const t=Math.floor(l),i={unit:d.data,length:d.data.byteLength,pts:t,dts:t};this.audio_track_&&(null===(n=this.audio_track_)||void 0===n||n.samples.push(i),this.audio_track_.length+=d.data.byteLength),l+=a}c&&(this.aac_last_sample_pts_=c)}parseOpusPayload(e,t){var i,n;if(this.has_video_&&!this.video_init_segment_dispatched_)return;let a,r=0;if(void 0!==t&&(r=t/this.timescale_),"opus"===(null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec))if(void 0===t&&void 0!==this.aac_last_sample_pts_)a=20,r=this.aac_last_sample_pts_+a;else if(void 0===t)return void o.Z.w(this.TAG,"Opus: Unknown pts");let s=r,d=0;for(let o=0;o<e.length;){a=20;const t=0!=(16&e[o+1]),i=0!=(8&e[o+1]);let r=o+2,l=0;for(;255===e[r];)l+=255,r+=1;l+=e[r],r+=1,r+=t?2:0,r+=i?2:0,d=s;const c=Math.floor(s),u=e.slice(r,r+l),m={unit:u,length:u.byteLength,pts:c,dts:c};this.audio_track_&&(null===(n=this.audio_track_)||void 0===n||n.samples.push(m),this.audio_track_.length+=u.byteLength),s+=a,o=r+l}d&&(this.aac_last_sample_pts_=d)}parseMP3Payload(e,t){var i;if(this.has_video_&&!this.video_init_segment_dispatched_)return;const n=[44100,48e3,32e3,0],o=[22050,24e3,16e3,0],a=[11025,12e3,8e3,0],r=e[1]>>>3&3,s=(6&e[1])>>1;e[2];const d=(12&e[2])>>>2,l=3!==(e[3]>>>6&3)?2:1;let c=0,u=34;switch(r){case 0:c=a[d];break;case 2:c=o[d];break;case 3:c=n[d]}switch(s){case 1:u=34;break;case 2:u=33;break;case 3:u=32}const m=new fe;m.object_type=u,m.sample_rate=c,m.channel_count=l,m.data=e;const p={codec:"mp3",data:m};this.audio_init_segment_dispatched_?this.detectAudioMetadataChange(p)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(p)):(this.audio_metadata_={codec:"mp3",object_type:u,sample_rate:c,channel_count:l},this.dispatchAudioInitSegment(p));const h={unit:e,length:e.byteLength,pts:t/this.timescale_,dts:t/this.timescale_};this.audio_track_&&(null===(i=this.audio_track_)||void 0===i||i.samples.push(h),this.audio_track_.length+=e.byteLength)}detectAudioMetadataChange(e){var t,i,n,a;if(e.codec!==(null===(t=this.audio_metadata_)||void 0===t?void 0:t.codec))return o.Z.v(this.TAG,`Audio: Audio Codecs changed from ${null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec} to ${e.codec}`),!0;if("aac"===e.codec&&"aac"===this.audio_metadata_.codec){const t=e.data;if(t.audio_object_type!==this.audio_metadata_.audio_object_type)return o.Z.v(this.TAG,`AAC: AudioObjectType changed from ${this.audio_metadata_.audio_object_type} to ${t.audio_object_type}`),!0;if(t.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return o.Z.v(this.TAG,`AAC: SamplingFrequencyIndex changed from ${this.audio_metadata_.sampling_freq_index} to ${t.sampling_freq_index}`),!0;if(t.channel_config!==this.audio_metadata_.channel_config)return o.Z.v(this.TAG,`AAC: Channel configuration changed from ${null===(n=this.audio_metadata_)||void 0===n?void 0:n.channel_config} to ${t.channel_config}`),!0}else if("ac-3"===e.codec&&"ac-3"===this.audio_metadata_.codec){const t=e.data;if(t.sampling_frequency!==this.audio_metadata_.sampling_frequency)return o.Z.v(this.TAG,`AC3: Sampling Frequency changed from ${null===(a=this.audio_metadata_)||void 0===a?void 0:a.sampling_frequency} to ${t.sampling_frequency}`),!0;if(t.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return o.Z.v(this.TAG,`AC3: Bit Stream Identification changed from ${this.audio_metadata_.bit_stream_identification} to ${t.bit_stream_identification}`),!0;if(t.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return o.Z.v(this.TAG,`AC3: BitStream Mode changed from ${this.audio_metadata_.bit_stream_mode} to ${t.bit_stream_mode}`),!0;if(t.channel_mode!==this.audio_metadata_.channel_mode)return o.Z.v(this.TAG,`AC3: Channel Mode changed from ${this.audio_metadata_.channel_mode} to ${t.channel_mode}`),!0;if(t.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return o.Z.v(this.TAG,`AC3: Low Frequency Effects Channel On changed from ${this.audio_metadata_.low_frequency_effects_channel_on} to ${t.low_frequency_effects_channel_on}`),!0}else if("opus"===e.codec&&"opus"===this.audio_metadata_.codec){const t=e.meta;if(t.sample_rate!==this.audio_metadata_.sample_rate)return o.Z.v(this.TAG,`Opus: SamplingFrequencyIndex changed from ${this.audio_metadata_.sample_rate} to ${t.sample_rate}`),!0;if(t.channel_count!==this.audio_metadata_.channel_count)return o.Z.v(this.TAG,`Opus: Channel count changed from ${this.audio_metadata_.channel_count} to ${t.channel_count}`),!0}else if("mp3"===e.codec&&"mp3"===this.audio_metadata_.codec){const t=e.data;if(t.object_type!==this.audio_metadata_.object_type)return o.Z.v(this.TAG,`MP3: AudioObjectType changed from ${this.audio_metadata_.object_type} to ${t.object_type}`),!0;if(t.sample_rate!==this.audio_metadata_.sample_rate)return o.Z.v(this.TAG,`MP3: SamplingFrequencyIndex changed from ${this.audio_metadata_.sample_rate} to ${t.sample_rate}`),!0;if(t.channel_count!==this.audio_metadata_.channel_count)return o.Z.v(this.TAG,`MP3: Channel count changed from ${this.audio_metadata_.channel_count} to ${t.channel_count}`),!0}return!1}dispatchAudioInitSegment(e){var t,i,n,a,r,s;const d={type:"audio"};if(d.id=null===(t=this.audio_track_)||void 0===t?void 0:t.id,d.timescale=1e3,d.duration=this.duration_,"aac"===(null===(i=this.audio_metadata_)||void 0===i?void 0:i.codec)){const t="aac"===e.codec?e.data:null,i=new W(t);d.audioSampleRate=i.sampling_rate,d.channelCount=i.channel_count,d.codec=i.codec_mimetype,d.originalCodec=i.original_codec_mimetype,d.config=i.config,d.refSampleDuration=1024/d.audioSampleRate*d.timescale}else if("ac-3"===(null===(n=this.audio_metadata_)||void 0===n?void 0:n.codec)){const t="ac-3"===e.codec?e.data:null,i=new Se(t);d.audioSampleRate=i.sampling_rate,d.channelCount=i.channel_count,d.codec=i.codec_mimetype,d.originalCodec=i.original_codec_mimetype,d.config=i.config,d.refSampleDuration=1536/d.audioSampleRate*d.timescale}else if("ec-3"===(null===(a=this.audio_metadata_)||void 0===a?void 0:a.codec)){const t="ec-3"===e.codec?e.data:null,i=new Ce(t);d.audioSampleRate=i.sampling_rate,d.channelCount=i.channel_count,d.codec=i.codec_mimetype,d.originalCodec=i.original_codec_mimetype,d.config=i.config,d.refSampleDuration=256*i.num_blks/d.audioSampleRate*d.timescale}else"opus"===(null===(r=this.audio_metadata_)||void 0===r?void 0:r.codec)?(d.audioSampleRate=this.audio_metadata_.sample_rate,d.channelCount=this.audio_metadata_.channel_count,d.channelConfigCode=this.audio_metadata_.channel_config_code,d.codec="opus",d.originalCodec="opus",d.config=void 0,d.refSampleDuration=20):"mp3"===(null===(s=this.audio_metadata_)||void 0===s?void 0:s.codec)&&(d.audioSampleRate=this.audio_metadata_.sample_rate,d.channelCount=this.audio_metadata_.channel_count,d.codec="mp3",d.originalCodec="mp3",d.config=void 0);this.audio_init_segment_dispatched_||o.Z.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: "+d.codec),this.onTrackMetadata&&this.onTrackMetadata("audio",d),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;const l=this.media_info_;l.hasAudio=!0,l.audioCodec=d.originalCodec,l.audioSampleRate=d.audioSampleRate,l.audioChannelCount=d.channelCount,l.hasVideo&&l.videoCodec?l.mimeType=`video/mp2t; codecs="${l.videoCodec},${l.audioCodec}"`:l.mimeType=`video/mp2t; codecs="${l.audioCodec}"`,l.isComplete()&&this.onMediaInfo&&this.onMediaInfo(l)}dispatchPESPrivateDataDescriptor(e,t,i){const n=new K;n.pid=e,n.stream_type=t,n.descriptor=i,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(n)}parsePESPrivateDataPayload(e,t,i,n,o){const a=new q;if(a.pid=n,a.stream_id=o,a.len=e.byteLength,a.data=e,void 0!==t){const e=Math.floor(t/this.timescale_);a.pts=e}else a.nearest_pts=this.aac_last_sample_pts_;if(void 0!==i){const e=Math.floor(i/this.timescale_);a.dts=e}this.onPESPrivateData&&this.onPESPrivateData(a)}parseTimedID3MetadataPayload(e,t,i,n,o){const a=new q;if(a.pid=n,a.stream_id=o,a.len=e.byteLength,a.data=e,void 0!==t){const e=Math.floor(t/this.timescale_);a.pts=e}if(void 0!==i){const e=Math.floor(i/this.timescale_);a.dts=e}this.onTimedID3Metadata&&this.onTimedID3Metadata(a)}parseSMPTE2038MetadataPayload(e,t,i,n,o){const a=new he;if(a.pid=n,a.stream_id=o,a.len=e.byteLength,a.data=e,void 0!==t){const e=Math.floor(t/this.timescale_);a.pts=e}if(a.nearest_pts=this.aac_last_sample_pts_,void 0!==i){const e=Math.floor(i/this.timescale_);a.dts=e}a.ancillaries=(e=>{let t=new p(e),i=0;const n=[];for(;i+=6,0===t.readBits(6);){const e=t.readBool();i+=1;const o=t.readBits(11);i+=11;const a=t.readBits(12);i+=12;const r=255&t.readBits(10);i+=10;const s=255&t.readBits(10);i+=10;const d=255&t.readBits(10);i+=10;const l=new Uint8Array(d);for(let n=0;n<d;n++){const e=255&t.readBits(10);i+=10,l[n]=e}t.readBits(10),i+=10;let c="User Defined";const u={};65===r?7===s&&(c="SCTE-104"):95===r?220===s?c="ARIB STD-B37 (1SEG)":221===s?c="ARIB STD-B37 (ANALOG)":222===s?c="ARIB STD-B37 (SD)":223===s&&(c="ARIB STD-B37 (HD)"):97===r&&(1===s?c="EIA-708":2===s&&(c="EIA-608")),n.push({yc_indicator:e,line_number:o,horizontal_offset:a,did:r,sdid:s,user_data:l,description:c,information:u}),t.readBits(8-(i-Math.floor(i/8))%8),i+=(8-(i-Math.floor(i/8)))%8}return t.destroy(),t=null,n})(e),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(a)}},we=new Uint8Array([0,0,0,0,0,0,0,0]);class ke{static init(){ke.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[]};for(const e in ke.types)ke.types.hasOwnProperty(e)&&(ke.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)])}static box(e,...t){let i=8,n=null;const o=Array.prototype.slice.call(arguments,1),a=o.length;for(let s=0;s<a;s++)i+=o[s].byteLength;n=new Uint8Array(i),n[0]=i>>>24&255,n[1]=i>>>16&255,n[2]=i>>>8&255,n[3]=255&i,n.set(e,4);let r=8;for(let s=0;s<a;s++)n.set(o[s],r),r+=o[s].byteLength;return n}static generateInitSegment(e){const t=ke.box(ke.types.ftyp,ke.constants.FTYP),i=ke.moov(e),n=new Uint8Array(t.byteLength+i.byteLength);return n.set(t,0),n.set(i,t.byteLength),n}static moov(e){const t=ke.mvhd(e.timescale,e.duration),i=ke.trak(e),n=ke.mvex(e);return ke.box(ke.types.moov,t,i,n)}static mvhd(e,t){return ke.box(ke.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}static trak(e){return ke.box(ke.types.trak,ke.tkhd(e),ke.mdia(e))}static tkhd(e){const t=e.id,i=e.duration,n=e.presentWidth,o=e.presentHeight;return ke.box(ke.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,255&n,0,0,o>>>8&255,255&o,0,0]))}static mdia(e){return ke.box(ke.types.mdia,ke.mdhd(e),ke.hdlr(e),ke.minf(e))}static mdhd(e){const t=e.timescale,i=e.duration;return ke.box(ke.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,i>>>24&255,i>>>16&255,i>>>8&255,255&i,85,196,0,0]))}static hdlr(e){let t=null;return t="audio"===e.type?ke.constants.HDLR_AUDIO:ke.constants.HDLR_VIDEO,ke.box(ke.types.hdlr,t)}static minf(e){let t=null;return t="audio"===e.type?ke.box(ke.types.smhd,ke.constants.SMHD):ke.box(ke.types.vmhd,ke.constants.VMHD),ke.box(ke.types.minf,t,ke.dinf(),ke.stbl(e))}static dinf(){return ke.box(ke.types.dinf,ke.box(ke.types.dref,ke.constants.DREF))}static stbl(e){return ke.box(ke.types.stbl,ke.stsd(e),ke.box(ke.types.stts,ke.constants.STTS),ke.box(ke.types.stsc,ke.constants.STSC),ke.box(ke.types.stsz,ke.constants.STSZ),ke.box(ke.types.stco,ke.constants.STCO))}static stsd(e){return"audio"===e.type?"mp3"===e.codec?ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.mp3(e)):"ac-3"===e.codec?ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.ac3(e)):"ec-3"===e.codec?ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.ec3(e)):"opus"===e.codec?ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.Opus(e)):ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.mp4a(e)):"video"===e.type&&e.codec.startsWith("hvc1")?ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.hvc1(e)):"video"===e.type&&e.codec.startsWith("av01")?ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.av01(e)):ke.box(ke.types.stsd,ke.constants.STSD_PREFIX,ke.avc1(e))}static mp3(e){const t=e.channelCount,i=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return ke.box(ke.types[".mp3"],n)}static mp4a(e){const t=e.channelCount,i=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return ke.box(ke.types.mp4a,n,ke.esds(e))}static ac3(e){var t;const i=e.channelCount,n=e.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return ke.box(ke.types["ac-3"],o,ke.box(ke.types.dac3,new Uint8Array(null!==(t=e.config)&&void 0!==t?t:[])))}static ec3(e){var t;const i=e.channelCount,n=e.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return ke.box(ke.types["ec-3"],o,ke.box(ke.types.dec3,new Uint8Array(null!==(t=e.config)&&void 0!==t?t:[])))}static esds(e){var t;const i=null!==(t=e.config)&&void 0!==t?t:[],n=i.length,o=new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(i).concat([6,1,2]));return ke.box(ke.types.esds,o)}static Opus(e){const t=e.channelCount,i=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return ke.box(ke.types.Opus,n,ke.dOps(e))}static dOps(e){const t=e.channelCount,i=e.channelConfigCode,n=e.audioSampleRate;let o=[];switch(i){case 1:case 2:o=[0];break;case 0:o=[255,1,1,0,1];break;case 128:o=[255,2,0,0,1];break;case 3:o=[1,2,1,0,2,1];break;case 4:o=[1,2,2,0,1,2,3];break;case 5:o=[1,3,2,0,4,1,2,3];break;case 6:o=[1,4,2,0,4,1,2,3,5];break;case 7:o=[1,4,2,0,4,1,2,3,5,6];break;case 8:o=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:o=[1,1,2,0,1];break;case 131:o=[1,1,3,0,1,2];break;case 132:o=[1,1,4,0,1,2,3];break;case 133:o=[1,1,5,0,1,2,3,4];break;case 134:o=[1,1,6,0,1,2,3,4,5];break;case 135:o=[1,1,7,0,1,2,3,4,5,6];break;case 136:o=[1,1,8,0,1,2,3,4,5,6,7]}const a=new Uint8Array([0,t,0,0,n>>>24&255,n>>>17&255,n>>>8&255,n>>>0&255,0,0,...o]);return ke.box(ke.types.dOps,a)}static avc1(e){const t=e.avcc,i=e.codecWidth,n=e.codecHeight,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return ke.box(ke.types.avc1,o,ke.box(ke.types.avcC,t))}static hvc1(e){const t=e.hvcc,i=e.codecWidth,n=e.codecHeight,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,n>>>8&255,255&n,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return ke.box(ke.types.hvc1,o,ke.box(ke.types.hvcC,t))}static av01(e){var t,i;const n=e.av1c,o=null!==(t=e.codecWidth)&&void 0!==t?t:192,a=null!==(i=e.codecHeight)&&void 0!==i?i:108,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>>8&255,255&o,a>>>8&255,255&a,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return ke.box(ke.types.av01,r,ke.box(ke.types.av1C,n))}static mvex(e){return ke.box(ke.types.mvex,ke.trex(e))}static trex(e){const t=e.id,i=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return ke.box(ke.types.trex,i)}static moof(e,t){return ke.box(ke.types.moof,ke.mfhd(e.sequenceNumber),ke.traf(e,t))}static mfhd(e){const t=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]);return ke.box(ke.types.mfhd,t)}static traf(e,t){const i=e.id,n=ke.box(ke.types.tfhd,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),o=ke.box(ke.types.tfdt,new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t])),a=ke.sdtp(e),r=ke.trun(e,a.byteLength+16+16+8+16+8+8);return ke.box(ke.types.traf,n,o,r,a)}static sdtp(e){const t=e.samples||[],i=t.length,n=new Uint8Array(4+i);for(let o=0;o<i;o++){const e=t[o].flags;n[o+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return ke.box(ke.types.sdtp,n)}static trun(e,t){const i=e.samples||[],n=i.length,o=12+16*n,a=new Uint8Array(o);t+=8+o,a.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0);for(let r=0;r<n;r++){const e=i[r].duration,t=i[r].size,n=i[r].flags,o=i[r].cts;a.set([e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,n.isLeading<<2|n.dependsOn,n.isDependedOn<<6|n.hasRedundancy<<4|n.isNonSync,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*r)}return ke.box(ke.types.trun,a)}static mdat(e){return ke.box(ke.types.mdat,e)}}ke.constants={FTYP:new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),STSD_PREFIX:new Uint8Array([0,0,0,0,0,0,0,1]),STTS:we,STSC:we,STCO:we,STSZ:new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),HDLR_VIDEO:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),HDLR_AUDIO:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),DREF:new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),SMHD:new Uint8Array([0,0,0,0,0,0,0,0]),VMHD:new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},ke.init();const Ee=ke,Pe=class{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}};var Ie=i(68);const xe=class{constructor(e){var t;this.TAG="MP4Remuxer",this._fillSilentAfterSeek=!1,this._config=e,this._isLive=!!e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Ie.J1("audio"),this._videoSegmentInfoList=new Ie.J1("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!a.Z.chrome||!(a.Z.version&&a.Z.version.major<50||a.Z.version&&50===a.Z.version.major&&((null===(t=a.Z.version)||void 0===t?void 0:t.build)||0)<2661)),this._fillSilentAfterSeek=!(!a.Z.msedge&&!a.Z.msie),this._mp3UseMpegAudio=!a.Z.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}destroy(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null}bindDataSource(e){var t;return e.onDataAvailable=null===(t=this.remux)||void 0===t?void 0:t.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this}get onInitSegment(){return this._onInitSegment}set onInitSegment(e){this._onInitSegment=e}get onMediaSegment(){return this._onMediaSegment}set onMediaSegment(e){this._onMediaSegment=e}insertDiscontinuity(){this._audioNextDts=this._videoNextDts=void 0}seek(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()}remux(e,t){if(!this._onMediaSegment)throw new l.rT("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),t&&this._remuxVideo(t),e&&this._remuxAudio(e)}_onTrackMetadataReceived(e,t){let i=null,n="mp4",o=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(n="mpeg",o="",i=new Uint8Array):i=Ee.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,i=Ee.generateInitSegment(t)}if(!this._onInitSegment)throw new l.rT("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:i.buffer,codec:o,container:`${e}/${n}`,mediaDuration:t.duration})}_calculateDtsBase(e,t){var i,n;this._dtsBaseInited||((null===(i=null==e?void 0:e.samples)||void 0===i?void 0:i.length)&&(this._audioDtsBase=e.samples[0].dts),(null===(n=null==t?void 0:t.samples)||void 0===n?void 0:n.length)&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)}getTimestampBase(){if(this._dtsBaseInited)return this._dtsBase}flushStashedSamples(){const e=this._videoStashedLastSample,t=this._audioStashedLastSample,i={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(i.samples.push(e),i.length=null==e?void 0:e.length);const n={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=null==t?void 0:t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(i,!0),this._remuxAudio(n,!0)}_remuxAudio(e,t){var i,n,r,s,d,l,c;if(null==this._audioMeta)return;const u=e,m=u.samples;let p,h=-1,f=-1;const g=this._audioMeta.refSampleDuration,v="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,y=this._dtsBaseInited&&void 0===this._audioNextDts;let S=!1;if(!m||0===m.length)return;if(1===m.length&&!t)return;let _=0,b=null,C=0;v?(_=0,C=u.length):(_=8,C=8+u.length);let T=null;if(m.length>1&&(T=m.pop(),C-=T.length),null!=this._audioStashedLastSample){const e=this._audioStashedLastSample;this._audioStashedLastSample=null,m.unshift(e),C+=e.length}null!=T&&(this._audioStashedLastSample=T);const w=m[0].dts-this._dtsBase;if(this._audioNextDts)p=w-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())p=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(S=!0);else{const e=this._audioSegmentInfoList.getLastSampleBefore(w);if(null!=e){let t=w-(e.originalDts+e.duration);t<=3&&(t=0),p=w-(e.dts+e.duration+t)}else p=0}if(S){const e=w-p,t=this._videoSegmentInfoList.getLastSegmentBefore(w);if(null!=t&&t.beginDts<e){const a=Pe.getSilentFrame(null===(i=this._audioMeta)||void 0===i?void 0:i.originalCodec,null===(n=this._audioMeta)||void 0===n?void 0:n.channelCount);if(a){const i=t.beginDts,n=e-t.beginDts;o.Z.v(this.TAG,`InsertPrefixSilentAudio: dts: ${i}, duration: ${n}`),m.unshift({unit:a,dts:i,pts:i}),C+=a.byteLength}}else S=!1}const k=[];for(let R=0;R<m.length;R++){const e=m[R],t=e.unit,i=e.dts-this._dtsBase;let n=i,c=!1,u=null,f=0;if(!(i<-.001)){if("mp3"!==this._audioMeta.codec){let e=i;const d=3;if(this._audioNextDts&&(e=this._audioNextDts),p=i-e,p<=-d*(g||0)){o.Z.w(this.TAG,`Dropping 1 audio frame (originalDts: ${i} ms ,curRefDts: ${e} ms)  due to dtsCorrection: ${p} ms overlap.`);continue}if(p>=d*(g||0)&&this._fillAudioTimestampGap&&!a.Z.safari){c=!0;const a=Math.floor(p/(g||0));o.Z.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: ${i} ms, curRefDts: ${e} ms, dtsCorrection: ${Math.round(p)} ms, generate: ${a} frames`),n=Math.floor(e),f=Math.floor(e+(g||0))-n;let d=Pe.getSilentFrame(null===(r=this._audioMeta)||void 0===r?void 0:r.originalCodec,this._audioMeta.channelCount);null==d&&(o.Z.w(this.TAG,`Unable to generate silent frame for ${null===(s=this._audioMeta)||void 0===s?void 0:s.originalCodec} with ${this._audioMeta.channelCount} channels, repeat last frame`),d=t),u=[];for(let t=0;t<a;t++){e+=g||0;const t=Math.floor(e),n=Math.floor(e+(g||0))-t,o={dts:t,pts:t,cts:0,unit:d,size:d.byteLength,duration:n,originalDts:i,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};u.push(o),C+=o.size}this._audioNextDts=e+(g||0)}else n=Math.floor(e),f=Math.floor(e+(g||0))-n,this._audioNextDts=e+(g||0)}else n=i-p,f=R!==m.length-1?m[R+1].dts-this._dtsBase-p-n:null!=T?T.dts-this._dtsBase-p-n:k.length>=1?null===(d=k[k.length-1])||void 0===d?void 0:d.duration:Math.floor(g||0),this._audioNextDts=n+f;-1===h&&(h=n),k.push({dts:n,pts:n,cts:0,unit:e.unit,size:null===(l=e.unit)||void 0===l?void 0:l.byteLength,duration:f,originalDts:i,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),c&&k.push.apply(k,u)}}if(0===k.length)return u.samples=[],void(u.length=0);v?b=new Uint8Array(C):(b=new Uint8Array(C),b[0]=C>>>24&255,b[1]=C>>>16&255,b[2]=C>>>8&255,b[3]=255&C,b.set(Ee.types.mdat,4));for(let o=0;o<k.length;o++){const e=k[o].unit;b.set(e,_),_+=e.byteLength||0}const E=k[k.length-1];f=E.dts+E.duration;const P=new Ie.Yy;P.beginDts=h,P.endDts=f,P.beginPts=h,P.endPts=f,P.originalBeginDts=k[0].originalDts,P.originalEndDts=E.originalDts+E.duration,P.firstSample=new Ie.Wk(k[0].dts,k[0].pts,k[0].duration,k[0].originalDts,!1),P.lastSample=new Ie.Wk(E.dts,E.pts,E.duration,E.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(P),u.samples=k,u.sequenceNumber++;let I=null;I=v?new Uint8Array:Ee.moof(u,h),u.samples=[],u.length=0;const x={type:"audio",data:this._mergeBoxes(I,b).buffer,sampleCount:k.length,info:P};v&&y&&x&&(x.timestampOffset=h),null===(c=this._onMediaSegment)||void 0===c||c.call(this,"audio",x)}_remuxVideo(e,t){var i,n;if(null==this._videoMeta)return;const o=e,a=o.samples;let r,s=-1,d=-1,l=-1,c=-1;if(!a||0===a.length)return;if(1===a.length&&!t)return;let u=8,m=null,p=8+e.length,h=null;if(a.length>1&&(h=a.pop(),p-=h.length),null!=this._videoStashedLastSample){const e=this._videoStashedLastSample;this._videoStashedLastSample=null,a.unshift(e),p+=(null==e?void 0:e.length)||0}null!=h&&(this._videoStashedLastSample=h);const f=a[0].dts-this._dtsBase;if(this._videoNextDts)r=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())r=0;else{const e=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=e){let t=f-(e.originalDts+e.duration);t<=3&&(t=0),r=f-(e.dts+e.duration+t)}else r=0}const g=new Ie.Yy,v=[];for(let _=0;_<a.length;_++){const e=a[_],t=e.dts-this._dtsBase,n=e.isKeyframe,o=t-r,d=e.cts,c=o+d;-1===s&&(s=o,l=c);let u=0;if(u=_!==a.length-1?a[_+1].dts-this._dtsBase-r-o:null!=h?h.dts-this._dtsBase-r-o:v.length>=1?v[v.length-1].duration:Math.floor((null===(i=this._videoMeta)||void 0===i?void 0:i.refSampleDuration)||0),n){const t=new Ie.Wk(o,c,u,e.dts,!0);t.fileposition=e.fileposition,g.appendSyncPoint(t)}v.push({dts:o,pts:c,cts:d,units:e.units,size:e.length,isKeyframe:n,duration:u,originalDts:t,flags:{isLeading:0,dependsOn:n?2:1,isDependedOn:n?1:0,hasRedundancy:0,isNonSync:n?0:1}})}m=new Uint8Array(p),m[0]=p>>>24&255,m[1]=p>>>16&255,m[2]=p>>>8&255,m[3]=255&p,m.set(Ee.types.mdat,4);for(let _=0;_<v.length;_++){const e=v[_].units;for(;null==e?void 0:e.length;){const t=e.shift(),i=null==t?void 0:t.data;m.set(i,u),u+=i.byteLength}}const y=v[v.length-1];if(d=y.dts+y.duration,c=y.pts+y.duration,this._videoNextDts=d,g.beginDts=s,g.endDts=d,g.beginPts=l,g.endPts=c,g.originalBeginDts=v[0].originalDts,g.originalEndDts=y.originalDts+y.duration,g.firstSample=new Ie.Wk(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,!!v[0].isKeyframe),g.lastSample=new Ie.Wk(y.dts,y.pts,y.duration,y.originalDts,!!y.isKeyframe),this._isLive||this._videoSegmentInfoList.append(g),o.samples=v,o.sequenceNumber++,this._forceFirstIDR){const e=v[0].flags;e.dependsOn=2,e.isNonSync=0}const S=Ee.moof(o,s);o.samples=[],o.length=0,null===(n=this._onMediaSegment)||void 0===n||n.call(this,"video",{type:"video",data:this._mergeBoxes(S,m).buffer,sampleCount:v.length,info:g})}_mergeBoxes(e,t){const i=new Uint8Array(e.byteLength+t.byteLength);return i.set(e,0),i.set(t,e.byteLength),i}};var Re=i(575),Ae=i(473);const De=class{constructor(e,t){var i;this.TAG="TransmuxingController",this._emitter=new n.EventEmitter,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;let o=0;null===(i=this._mediaDataSource.segments)||void 0===i||i.forEach(i=>{i.timestampBase=o,o+=i.duration,i.cors=e.cors,i.withCredentials=e.withCredentials,t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy)}),isNaN(o)||this._mediaDataSource.duration===o||(this._mediaDataSource.duration=o),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}destroy(){var e,t,i;this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(null===(e=this._ioctl)||void 0===e||e.destroy(),this._ioctl=null),this._demuxer&&(null===(t=this._demuxer)||void 0===t||t.destroy(),this._demuxer=null),this._remuxer&&(null===(i=this._remuxer)||void 0===i||i.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}start(){this._loadSegment(0),this._enableStatisticsReporter()}_loadSegment(e,t){var i,n,o;if(this._currentSegmentIndex=e,null===(i=this._mediaDataSource)||void 0===i?void 0:i.segments){const i=null===(n=this._mediaDataSource)||void 0===n?void 0:n.segments[e],a=this._ioctl=new Re.Z(i,this._config,e);a.onError=this._onIOException.bind(this),a.onSeeked=this._onIOSeeked.bind(this),a.onComplete=this._onIOComplete.bind(this),a.onRedirect=this._onIORedirect.bind(this),a.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?null===(o=this._demuxer)||void 0===o||o.bindDataSource(this._ioctl):a.onDataArrival=this._onInitChunkArrival.bind(this),a.open(t)}}stop(){this._internalAbort(),this._disableStatisticsReporter()}_internalAbort(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)}pause(){var e;(null===(e=this._ioctl)||void 0===e?void 0:e.isWorking())&&(this._ioctl.pause(),this._disableStatisticsReporter())}resume(){var e;(null===(e=this._ioctl)||void 0===e?void 0:e.isPaused())&&(this._ioctl.resume(),this._enableStatisticsReporter())}seek(e){var t,i,n,o,a,r,s,d,l,c,u,m,p,h;if(null==this._mediaInfo||!(null===(t=this._mediaInfo)||void 0===t?void 0:t.isSeekable()))return;const f=this._searchSegmentIndexContains(e);if(f===this._currentSegmentIndex){const t=(null===(i=this._mediaInfo)||void 0===i?void 0:i.segments)?null===(n=this._mediaInfo)||void 0===n?void 0:n.segments[f]:{};if(void 0===t)this._pendingSeekTime=e;else{const i=null==t?void 0:t.getNearestKeyframe(e);null===(o=this._remuxer)||void 0===o||o.seek(null==i?void 0:i.milliseconds),null===(a=this._ioctl)||void 0===a||a.seek(null==i?void 0:i.fileposition),this._pendingResolveSeekPoint=null==i?void 0:i.milliseconds}}else{const t=(null===(r=this._mediaInfo)||void 0===r?void 0:r.segments)?null===(s=this._mediaInfo)||void 0===s?void 0:s.segments[f]:{};if(void 0===t)this._pendingSeekTime=e,this._internalAbort(),null===(d=this._remuxer)||void 0===d||d.seek(),null===(l=this._remuxer)||void 0===l||l.insertDiscontinuity(),this._loadSegment(f);else{const i=t.getNearestKeyframe(e);this._internalAbort(),null===(c=this._remuxer)||void 0===c||c.seek(e),null===(u=this._remuxer)||void 0===u||u.insertDiscontinuity(),this._demuxer&&(null===(m=this._demuxer)||void 0===m||m.resetMediaInfo(),this._demuxer.timestampBase=(null===(p=this._mediaDataSource)||void 0===p?void 0:p.segments)?null===(h=this._mediaDataSource)||void 0===h?void 0:h.segments[f].timestampBase:0),this._loadSegment(f,null==i?void 0:i.fileposition),this._pendingResolveSeekPoint=null==i?void 0:i.milliseconds,this._reportSegmentMediaInfo(f)}}this._enableStatisticsReporter()}_searchSegmentIndexContains(e){var t;const i=this._mediaDataSource.segments;let n=((null==i?void 0:i.length)||0)-1;if(0===((null==i?void 0:i.length)||0))return n;for(let o=0;o<((null==i?void 0:i.length)||0);o++)if(i&&e<((null===(t=i[o])||void 0===t?void 0:t.timestampBase)||0)){n=o-1;break}return n}_onInitChunkArrival(e,t){var i,n,a,r,s;let d=0;if(t>0)null===(i=this._demuxer)||void 0===i||i.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments?null===(n=this._mediaDataSource.segments[this._currentSegmentIndex])||void 0===n?void 0:n.timestampBase:0,d=(null===(a=this._demuxer)||void 0===a?void 0:a.parseChunks(e,t))||0;else{let i=null;i=E.probe(e),i.match&&(this._setupFLVDemuxerRemuxer(i),d=(null===(r=this._demuxer)||void 0===r?void 0:r.parseChunks(e,t))||0),i.match||(null==i?void 0:i.needMoreData)||(i=Te.probe(e),i.match&&(this._setupTSDemuxerRemuxer(i),d=(null===(s=this._demuxer)||void 0===s?void 0:s.parseChunks(e,t))||0)),i.match||(null==i?void 0:i.needMoreData)||(i=null,o.Z.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(()=>{this._internalAbort()}),this._emitter.emit(Ae.Z.DEMUX_ERROR,g.Z.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return d}_setupFLVDemuxerRemuxer(e){var t;this._demuxer=new E(e,this._config),this._remuxer||(this._remuxer=new xe(this._config));const i=this._mediaDataSource;void 0===i.duration||isNaN(i.duration)||(this._demuxer.overridedDuration=i.duration),"boolean"==typeof i.hasAudio&&(this._demuxer.overridedHasAudio=i.hasAudio),"boolean"==typeof i.hasVideo&&(this._demuxer.overridedHasVideo=i.hasVideo),i.segments&&this._demuxer&&this._remuxer&&(this._demuxer.timestampBase=null===(t=null==i?void 0:i.segments[this._currentSegmentIndex])||void 0===t?void 0:t.timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this))}_setupTSDemuxerRemuxer(e){const t=this._demuxer=new Te(e,this._config);this._remuxer||(this._remuxer=new xe(this._config)),t.onError=this._onDemuxException.bind(this),t.onMediaInfo=this._onMediaInfo.bind(this),t.onMetaDataArrived=this._onMetaDataArrived.bind(this),t.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),t.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),t.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),t.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),t.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)}_onMediaInfo(e){var t,i;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=(null===(i=null===(t=this._mediaDataSource)||void 0===t?void 0:t.segments)||void 0===i?void 0:i.length)||0,Object.setPrototypeOf(this._mediaInfo,r.Z.prototype));const n=Object.assign({},e);Object.setPrototypeOf(n,r.Z.prototype),this._mediaInfo.segments&&(this._mediaInfo.segments[this._currentSegmentIndex]=n),this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then(()=>{const e=this._pendingSeekTime;this._pendingSeekTime=null,this.seek(e)})}_onMetaDataArrived(e){this._emitter.emit(Ae.Z.METADATA_ARRIVED,e)}_onScriptDataArrived(e){this._emitter.emit(Ae.Z.SCRIPTDATA_ARRIVED,e)}_onTimedID3Metadata(e){var t;const i=null===(t=this._remuxer)||void 0===t?void 0:t.getTimestampBase();void 0!==i&&(void 0!==e.pts&&(e.pts-=i),void 0!==e.dts&&(e.dts-=i),this._emitter.emit(Ae.Z.TIMED_ID3_METADATA_ARRIVED,e))}_onSMPTE2038Metadata(e){var t;const i=null===(t=this._remuxer)||void 0===t?void 0:t.getTimestampBase();void 0!==i&&(void 0!==e.pts&&(e.pts-=i),void 0!==e.dts&&(e.dts-=i),void 0!==e.nearest_pts&&(e.nearest_pts-=i),this._emitter.emit(Ae.Z.SMPTE2038_METADATA_ARRIVED,e))}_onSCTE35Metadata(e){var t;const i=null===(t=this._remuxer)||void 0===t?void 0:t.getTimestampBase();void 0!==i&&(void 0!==e.pts&&(e.pts-=i),void 0!==e.nearest_pts&&(e.nearest_pts-=i),this._emitter.emit(Ae.Z.SCTE35_METADATA_ARRIVED,e))}_onPESPrivateDataDescriptor(e){this._emitter.emit(Ae.Z.PES_PRIVATE_DATA_DESCRIPTOR,e)}_onPESPrivateData(e){var t;const i=null===(t=this._remuxer)||void 0===t?void 0:t.getTimestampBase();void 0!==i&&(void 0!==e.pts&&(e.pts-=i),void 0!==e.nearest_pts&&(e.nearest_pts-=i),void 0!==e.dts&&(e.dts-=i),this._emitter.emit(Ae.Z.PES_PRIVATE_DATA_ARRIVED,e))}_onIOSeeked(){var e;null===(e=this._remuxer)||void 0===e||e.insertDiscontinuity()}_onIOComplete(e){var t,i;const n=e+1;n<((null===(i=null===(t=this._mediaDataSource)||void 0===t?void 0:t.segments)||void 0===i?void 0:i.length)||0)?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(n)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Ae.Z.LOADING_COMPLETE),this._disableStatisticsReporter())}_onIORedirect(e){var t;const i=null===(t=this._ioctl)||void 0===t?void 0:t.extraData;this._mediaDataSource.segments&&(this._mediaDataSource.segments[i].redirectedURL=e)}_onIORecoveredEarlyEof(){this._emitter.emit(Ae.Z.RECOVERED_EARLY_EOF)}_onIOException(e,t){o.Z.e(this.TAG,`IOException: type = ${e}, code = ${t.code}, msg = ${t.msg}`),this._emitter.emit(Ae.Z.IO_ERROR,e,t),this._disableStatisticsReporter()}_onDemuxException(e,t){o.Z.e(this.TAG,`DemuxException: type = ${e}, info = ${t}`),this._emitter.emit(Ae.Z.DEMUX_ERROR,e,t)}_onRemuxerInitSegmentArrival(e,t){this._emitter.emit(Ae.Z.INIT_SEGMENT,e,t)}_onRemuxerMediaSegmentArrival(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(Ae.Z.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){const e=t.info.syncPoints;let i=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,a.Z.safari&&e.length>0&&e[0].originalDts===i&&(i=e[0].pts),this._emitter.emit(Ae.Z.RECOMMEND_SEEKPOINT,i)}}_enableStatisticsReporter(){null==this._statisticsReporter&&this._reportStatisticsInfo&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))}_disableStatisticsReporter(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}_reportSegmentMediaInfo(e){var t,i,n,o;const a=(null===(t=this._mediaInfo)||void 0===t?void 0:t.segments)?null===(i=this._mediaInfo)||void 0===i?void 0:i.segments[e]:{},r=Object.assign({},a);r.duration=null===(n=this._mediaInfo)||void 0===n?void 0:n.duration,r.segmentCount=null===(o=this._mediaInfo)||void 0===o?void 0:o.segmentCount,delete r.segments,delete r.keyframesIndex,this._emitter.emit(Ae.Z.MEDIA_INFO,r)}_reportStatisticsInfo(){var e,t,i,n,o,a;const r={};r.url=null===(e=this._ioctl)||void 0===e?void 0:e.currentURL,r.hasRedirect=null===(t=this._ioctl)||void 0===t?void 0:t.hasRedirect,r.hasRedirect&&(r.redirectedURL=null===(i=this._ioctl)||void 0===i?void 0:i.currentRedirectedURL),r.speed=null===(n=this._ioctl)||void 0===n?void 0:n.currentSpeed,r.loaderType=null===(o=this._ioctl)||void 0===o?void 0:o.loaderType,r.currentSegmentIndex=this._currentSegmentIndex,r.totalSegmentCount=null===(a=this._mediaDataSource.segments)||void 0===a?void 0:a.length,this._emitter.emit(Ae.Z.STATISTICS_INFO,r)}}},473:(e,t,i)=>{i.d(t,{Z:()=>n});const n={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},638:(e,t,i)=>{var n=i(278),o=i(943),a=i(473);let r=null;const s=function(e,t){self.postMessage({msg:"logcat_callback",data:{type:e,logcat:t}})};function d(e,t){const i={msg:a.Z.INIT_SEGMENT,data:{type:e,data:t}};self.postMessage(i,[t.data])}function l(e,t){const i={msg:a.Z.MEDIA_SEGMENT,data:{type:e,data:t}};self.postMessage(i,[t.data])}function c(){const e={msg:a.Z.LOADING_COMPLETE};self.postMessage(e)}function u(){const e={msg:a.Z.RECOVERED_EARLY_EOF};self.postMessage(e)}function m(e){const t={msg:a.Z.MEDIA_INFO,data:e};self.postMessage(t)}function p(e){const t={msg:a.Z.METADATA_ARRIVED,data:e};self.postMessage(t)}function h(e){const t={msg:a.Z.SCRIPTDATA_ARRIVED,data:e};self.postMessage(t)}function f(e){const t={msg:a.Z.TIMED_ID3_METADATA_ARRIVED,data:e};self.postMessage(t)}function g(e){const t={msg:a.Z.SMPTE2038_METADATA_ARRIVED,data:e};self.postMessage(t)}function v(e){const t={msg:a.Z.SCTE35_METADATA_ARRIVED,data:e};self.postMessage(t)}function y(e){const t={msg:a.Z.PES_PRIVATE_DATA_DESCRIPTOR,data:e};self.postMessage(t)}function S(e){const t={msg:a.Z.PES_PRIVATE_DATA_ARRIVED,data:e};self.postMessage(t)}function _(e){const t={msg:a.Z.STATISTICS_INFO,data:e};self.postMessage(t)}function b(e,t){self.postMessage({msg:a.Z.IO_ERROR,data:{type:e,info:t}})}function C(e,t){self.postMessage({msg:a.Z.DEMUX_ERROR,data:{type:e,info:t}})}function T(e){self.postMessage({msg:a.Z.RECOMMEND_SEEKPOINT,data:e})}self.addEventListener("message",(function(e){switch(e.data.cmd){case"init":r=new o.Z(e.data.param[0],e.data.param[1]),r.on(a.Z.IO_ERROR,b),r.on(a.Z.DEMUX_ERROR,C),r.on(a.Z.INIT_SEGMENT,d),r.on(a.Z.MEDIA_SEGMENT,l),r.on(a.Z.LOADING_COMPLETE,c),r.on(a.Z.RECOVERED_EARLY_EOF,u),r.on(a.Z.MEDIA_INFO,m),r.on(a.Z.METADATA_ARRIVED,p),r.on(a.Z.SCRIPTDATA_ARRIVED,h),r.on(a.Z.TIMED_ID3_METADATA_ARRIVED,f),r.on(a.Z.SMPTE2038_METADATA_ARRIVED,g),r.on(a.Z.SCTE35_METADATA_ARRIVED,v),r.on(a.Z.PES_PRIVATE_DATA_DESCRIPTOR,y),r.on(a.Z.PES_PRIVATE_DATA_ARRIVED,S),r.on(a.Z.STATISTICS_INFO,_),r.on(a.Z.RECOMMEND_SEEKPOINT,T);break;case"destroy":r&&(r.destroy(),r=null),self.postMessage({msg:"destroyed"});break;case"start":null==r||r.start();break;case"stop":null==r||r.stop();break;case"seek":null==r||r.seek(e.data.param);break;case"pause":null==r||r.pause();break;case"resume":null==r||r.resume();break;case"logging_config":{const t=e.data.param;n.Z.applyConfig(t),!0===t.enableCallback?n.Z.addLogListener(s):n.Z.removeLogListener(s);break}}}))},898:(e,t,i)=>{i.d(t,{Z:()=>n});const n={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},578:(e,t,i)=>{i.d(t,{default:()=>U});var n=i(575);const o={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0,url:void 0,redirectedURL:void 0,cors:!1};function a(){return Object.assign({},o)}class r{static supportMSEH264Playback(){var e;return null===(e=window.MediaSource)||void 0===e?void 0:e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}static supportMSEH265Playback(){var e;return null===(e=window.MediaSource)||void 0===e?void 0:e.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"')}static supportNetworkStreamIO(){const e=new n.Z({},a()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"===t||"xhr-moz-chunked-loader"===t}static getNetworkLoaderTypeName(){const e=new n.Z({},a()),t=e.loaderType;return e.destroy(),t}static supportNativeMediaPlayback(e){void 0===r.videoElement&&(r.videoElement=window.document.createElement("video"));const t=r.videoElement.canPlayType(e);return"probably"===t||"maybe"===t}static getFeatureList(){const e={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return e.msePlayback=r.supportMSEH264Playback(),e.networkStreamIO=r.supportNetworkStreamIO(),e.networkLoaderName=r.getNetworkLoaderTypeName()||"",e.mseLivePlayback=e.msePlayback&&e.networkStreamIO,e.mseH265Playback=r.supportMSEH265Playback(),e.nativeMP4H264Playback=r.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),e.nativeMP4H265Playback=r.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),e.nativeWebmVP8Playback=r.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),e.nativeWebmVP9Playback=r.supportNativeMediaPlayback('video/webm; codecs="vp9"'),e}}const s=r;var d=i(108),l=i(99),c=i(645),u=i(479);const m={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info"},p=function(){const e=ENTRY_MODULE,t={};function i(n){if(t[n])return t[n].exports;const o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.m=e,i.n=e=>{const t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(const n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("[object Object]"===Object.prototype.toString.call(globalThis))return globalThis;try{return this||new Function("return this")()}catch(e){if("[object Object]"===Object.prototype.toString.call(window))return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const n=i(ENTRY_MODULE);return n.default||n};p.toString();const h="[\\.|\\-|\\+|\\w|/|@]+",f="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+h+").*?\\)";function g(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function v(e,t,n){const o={};o[n]=[];const a=t.toString(),r=a.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||a.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!r)return o;const s=r[1];let d,l=new RegExp("(\\\\n|\\W)"+g(s)+f,"g");for(;d=l.exec(a);)"dll-reference"!==d[3]&&o[n].push(d[3]);for(l=new RegExp("\\("+g(s)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+f,"g");d=l.exec(a);)e[d[2]]||(o[n].push(d[1]),e[d[2]]=i(d[1]).m),o[d[2]]=o[d[2]]||[],o[d[2]].push(d[4]);const c=Object.keys(o);for(let i=0;i<c.length;i++)for(let e=0;e<o[c[i]].length;e++)u=o[c[i]][e],isNaN(1*u)||(o[c[i]][e]=1*o[c[i]][e]);var u;return o}function y(e){return Object.keys(e).reduce((t,i)=>t||e[i].length>0,!1)}function S(e,t,i,n){const o=e[n].map(e=>`"${e}": ${t[n][e].toString()}`).join(","),a=p.toString().split("ENTRY_MODULE");return`${a[0]}{${o}}${a[1]}"${i}"${a[2]}`}function _(e,t){t=t||{};const n={main:i.m},o=t.all?{main:Object.keys(n.main)}:function(e,t){const i={main:[t]},n={main:[]},o={main:{}};for(;y(i);){const t=Object.keys(i);for(let a=0;a<t.length;a++){const r=t[a],s=i[r].pop();if(o[r]=o[r]||{},o[r][s]||!e[r][s])continue;o[r][s]=!0,n[r]=n[r]||[],n[r].push(s);const d=v(e,e[r][s],r),l=Object.keys(d);for(let e=0;e<l.length;e++)i[l[e]]=i[l[e]]||[],i[l[e]]=i[l[e]].concat(d[l[e]])}}return n}(n,e);let a="";Object.keys(o).filter(e=>"main"!==e).forEach(e=>{let t=0;for(;o[e][t];)t++;o[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a+=`var ${e} = (${S(o,n,t,modules)})();\n`}),a+=`(${S(o,n,e,"main")})();`;const r=new window.Blob([a],{type:"text/javascript"});if(t.bare)return r;const s=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(r),d=new window.Worker(s);return d.objectURL=s,d}var b=i(278),C=i(943),T=i(473),w=i(994);const k=class{constructor(e,t){if(this.TAG="Transmuxer",this._workerDestroying=!1,this._controller=null,this._emitter=new l.EventEmitter,t.enableWorker&&"undefined"!=typeof Worker)try{this._worker=this._worker=_(638),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},b.Z.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:b.Z.getConfig()})}catch(i){c.Z.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new C.Z(e,t)}else this._controller=new C.Z(e,t);if(this._controller){const e=this._controller;null==e||e.on(T.Z.IO_ERROR,this._onIOError.bind(this)),null==e||e.on(T.Z.DEMUX_ERROR,this._onDemuxError.bind(this)),null==e||e.on(T.Z.INIT_SEGMENT,this._onInitSegment.bind(this)),null==e||e.on(T.Z.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),null==e||e.on(T.Z.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),null==e||e.on(T.Z.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),null==e||e.on(T.Z.MEDIA_INFO,this._onMediaInfo.bind(this)),null==e||e.on(T.Z.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),null==e||e.on(T.Z.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),null==e||e.on(T.Z.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),null==e||e.on(T.Z.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),null==e||e.on(T.Z.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),null==e||e.on(T.Z.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),null==e||e.on(T.Z.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),null==e||e.on(T.Z.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),null==e||e.on(T.Z.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}destroy(){var e;this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),b.Z.removeListener(this.e.onLoggingConfigChanged),this.e=null):(null===(e=this._controller)||void 0===e||e.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}hasWorker(){return null!=this._worker}open(){var e;this._worker?this._worker.postMessage({cmd:"start"}):null===(e=this._controller)||void 0===e||e.start()}close(){var e;this._worker?this._worker.postMessage({cmd:"stop"}):null===(e=this._controller)||void 0===e||e.stop()}seek(e){var t;this._worker?this._worker.postMessage({cmd:"seek",param:e}):null===(t=this._controller)||void 0===t||t.seek(e)}pause(){var e;this._worker?this._worker.postMessage({cmd:"pause"}):null===(e=this._controller)||void 0===e||e.pause()}resume(){var e;this._worker?this._worker.postMessage({cmd:"resume"}):null===(e=this._controller)||void 0===e||e.resume()}_onInitSegment(e,t){Promise.resolve().then(()=>{this._emitter.emit(T.Z.INIT_SEGMENT,e,t)})}_onMediaSegment(e,t){Promise.resolve().then(()=>{this._emitter.emit(T.Z.MEDIA_SEGMENT,e,t)})}_onLoadingComplete(){Promise.resolve().then(()=>{this._emitter.emit(T.Z.LOADING_COMPLETE)})}_onRecoveredEarlyEof(){Promise.resolve().then(()=>{this._emitter.emit(T.Z.RECOVERED_EARLY_EOF)})}_onMediaInfo(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.MEDIA_INFO,e)})}_onMetaDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.METADATA_ARRIVED,e)})}_onScriptDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.SCRIPTDATA_ARRIVED,e)})}_onTimedID3MetadataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.TIMED_ID3_METADATA_ARRIVED,e)})}_onSMPTE2038MetadataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.SMPTE2038_METADATA_ARRIVED,e)})}_onSCTE35MetadataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.SCTE35_METADATA_ARRIVED,e)})}_onPESPrivateDataDescriptor(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.PES_PRIVATE_DATA_DESCRIPTOR,e)})}_onPESPrivateDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.PES_PRIVATE_DATA_ARRIVED,e)})}_onStatisticsInfo(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.STATISTICS_INFO,e)})}_onIOError(e,t){Promise.resolve().then(()=>{this._emitter.emit(T.Z.IO_ERROR,e,t)})}_onDemuxError(e,t){Promise.resolve().then(()=>{this._emitter.emit(T.Z.DEMUX_ERROR,e,t)})}_onRecommendSeekpoint(e){Promise.resolve().then(()=>{this._emitter.emit(T.Z.RECOMMEND_SEEKPOINT,e)})}_onLoggingConfigChanged(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})}_onWorkerMessage(e){const t=e.data,i=null==t?void 0:t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case T.Z.INIT_SEGMENT:case T.Z.MEDIA_SEGMENT:this._emitter.emit(t.msg,i.type,i.data);break;case T.Z.LOADING_COMPLETE:case T.Z.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case T.Z.MEDIA_INFO:Object.setPrototypeOf(i,w.Z.prototype),this._emitter.emit(t.msg,i);break;case T.Z.METADATA_ARRIVED:case T.Z.SCRIPTDATA_ARRIVED:case T.Z.TIMED_ID3_METADATA_ARRIVED:case T.Z.SMPTE2038_METADATA_ARRIVED:case T.Z.SCTE35_METADATA_ARRIVED:case T.Z.PES_PRIVATE_DATA_DESCRIPTOR:case T.Z.PES_PRIVATE_DATA_ARRIVED:case T.Z.STATISTICS_INFO:this._emitter.emit(t.msg,i);break;case T.Z.IO_ERROR:case T.Z.DEMUX_ERROR:this._emitter.emit(t.msg,i.type,i.info);break;case T.Z.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,i);break;case"logcat_callback":c.Z.emitter.emit("log",i.type,i.logcat)}}},E={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};var P=i(68),I=i(411);const x=class{constructor(e){this.TAG="MSEController",this._config=e,this._emitter=new l.EventEmitter,this._config.isLive&&void 0===this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new P.Vn}destroy(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaSource)throw new I.rT("MediaSource has been attached to an HTMLMediaElement!");const t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL}detachMediaElement(){if(this._mediaSource){const t=this._mediaSource;for(const i in this._sourceBuffers){const n=this._pendingSegments[i];n.splice(0,n.length),this._pendingSegments[i]=null,this._pendingRemoveRanges[i]=null,this._lastInitSegments[i]=null;const o=this._sourceBuffers[i];if(o){if("closed"!==t.readyState){try{t.removeSourceBuffer(o)}catch(e){c.Z.e(this.TAG,e.message)}null==o||o.removeEventListener("error",this.e.onSourceBufferError),null==o||o.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[i]=null,this._sourceBuffers[i]=null}}if("open"===t.readyState)try{t.endOfStream()}catch(e){c.Z.e(this.TAG,e.message)}t.removeEventListener("sourceopen",this.e.onSourceOpen),t.removeEventListener("sourceended",this.e.onSourceEnded),t.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)}appendInitSegment(e,t){var i;if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);const n=e;let o=""+n.container;n.codec&&n.codec.length>0&&(o+=";codecs="+n.codec);let a=!1;if(c.Z.v(this.TAG,"Received Initialization Segment, mimeType: "+o),this._lastInitSegments[n.type]=n,o!==this._mimeTypes[n.type]){if(this._mimeTypes[n.type])c.Z.v(this.TAG,`Notice: ${n.type} mimeType changed, origin: ${this._mimeTypes[n.type]||""}, target: ${o}`);else{a=!0;try{const e=this._sourceBuffers[n.type]=this._mediaSource.addSourceBuffer(o);e.addEventListener("error",this.e.onSourceBufferError),e.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return c.Z.e(this.TAG,e.message),void this._emitter.emit(E.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[n.type]=o}t||this._pendingSegments[n.type].push(n),a||this._sourceBuffers[n.type]&&!(null===(i=this._sourceBuffers[n.type])||void 0===i?void 0:i.updating)&&this._doAppendSegments(),u.Z.safari&&"audio/mpeg"===n.container&&n.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=n.mediaDuration/1e3,this._updateMediaSourceDuration())}appendMediaSegment(e){const t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();const i=this._sourceBuffers[t.type];!i||i.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}seek(e){var t,i;for(const n in this._sourceBuffers){if(!this._sourceBuffers[n])continue;const o=this._sourceBuffers[n];if("open"===(null===(t=this._mediaSource)||void 0===t?void 0:t.readyState))try{null==o||o.abort()}catch(e){c.Z.e(this.TAG,e.message)}this._idrList.clear();const a=this._pendingSegments[n];if(a.splice(0,a.length),"closed"!==(null===(i=this._mediaSource)||void 0===i?void 0:i.readyState)){if(o){for(let e=0;e<o.buffered.length;e++){const t=o.buffered.start(e),i=o.buffered.end(e);this._pendingRemoveRanges[n].push({start:t,end:i})}(null==o?void 0:o.updating)||this._doRemoveRanges()}if(u.Z.safari){const e=this._lastInitSegments[n];e&&(this._pendingSegments[n].push(e),(null==o?void 0:o.updating)||this._doAppendSegments())}}}}endOfStream(){var e,t;const i=this._mediaSource,n=this._sourceBuffers;i&&"open"===i.readyState?(null===(e=n.video)||void 0===e?void 0:e.updating)||(null===(t=n.audio)||void 0===t?void 0:t.updating)?this._hasPendingEos=!0:(this._hasPendingEos=!1,i.endOfStream()):i&&"closed"===i.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)}getNearestKeyframe(e){return this._idrList.getLastSyncPointBeforeDts(e)}_needCleanupSourceBuffer(){var e,t;if(!this._config.autoCleanupSourceBuffer)return!1;const i=null===(e=this._mediaElement)||void 0===e?void 0:e.currentTime;for(const n in this._sourceBuffers){const e=this._sourceBuffers[n];if(e){const n=e.buffered;if(n.length>=1&&i-n.start(0)>=((null===(t=this._config)||void 0===t?void 0:t.autoCleanupMaxBackwardDuration)||0))return!0}}return!1}_doCleanupSourceBuffer(){var e,t,i;const n=null===(e=this._mediaElement)||void 0===e?void 0:e.currentTime;for(const o in this._sourceBuffers){const e=this._sourceBuffers[o];if(e){const a=e.buffered;let r=!1;for(let e=0;e<a.length;e++){const s=a.start(e),d=a.end(e);if(s<=n&&n<d+3){if(n-s>=((null===(t=this._config)||void 0===t?void 0:t.autoCleanupMaxBackwardDuration)||0)){r=!0;const e=n-((null===(i=this._config)||void 0===i?void 0:i.autoCleanupMinBackwardDuration)||0);this._pendingRemoveRanges[o].push({start:s,end:e})}}else d<n&&(r=!0,this._pendingRemoveRanges[o].push({start:s,end:d}))}r&&!e.updating&&this._doRemoveRanges()}}}_updateMediaSourceDuration(){var e,t,i,n;const o=this._sourceBuffers;if(0===(null===(e=this._mediaElement)||void 0===e?void 0:e.readyState)||"open"!==(null===(t=this._mediaSource)||void 0===t?void 0:t.readyState))return;if((null===(i=o.video)||void 0===i?void 0:i.updating)||(null===(n=o.audio)||void 0===n?void 0:n.updating))return;const a=this._mediaSource.duration,r=this._pendingMediaDuration;r>0&&(isNaN(a)||r>a)&&(c.Z.v(this.TAG,`Update MediaSource duration from ${a} to ${r}`),this._mediaSource.duration=r),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}_doRemoveRanges(){var e;for(const t in this._pendingRemoveRanges){if(!this._sourceBuffers[t]||(null===(e=this._sourceBuffers[t])||void 0===e?void 0:e.updating))continue;const i=this._sourceBuffers[t],n=this._pendingRemoveRanges[t];for(;n.length&&!(null==i?void 0:i.updating);){const e=n.shift();null==i||i.remove(e.start,e.end)}}}_doAppendSegments(){var e,t,i;const n=this._pendingSegments;for(const o in n)if(this._sourceBuffers[o]&&!(null===(e=this._sourceBuffers[o])||void 0===e?void 0:e.updating)&&n[o].length>0){const e=n[o].shift();if(null==e?void 0:e.timestampOffset){const i=(null===(t=this._sourceBuffers[o])||void 0===t?void 0:t.timestampOffset)||0,n=e.timestampOffset/1e3;Math.abs(i-n)>.1&&(c.Z.v(this.TAG,`Update MPEG audio timestampOffset from ${i} to ${n}`),this._sourceBuffers[o]&&(this._sourceBuffers[o].timestampOffset=n)),delete e.timestampOffset}if(!e.data||0===e.data.byteLength)continue;try{null===(i=this._sourceBuffers[o])||void 0===i||i.appendBuffer(e.data),this._isBufferFull=!1,"video"===o&&e.hasOwnProperty("info")&&this._idrList.appendArray(e.info.syncPoints)}catch(t){this._pendingSegments[o].unshift(e),22===t.code?(this._isBufferFull||this._emitter.emit(E.BUFFER_FULL),this._isBufferFull=!0):(c.Z.e(this.TAG,t.message),this._emitter.emit(E.ERROR,{code:t.code,msg:t.message}))}}}_onSourceOpen(){var e;if(c.Z.v(this.TAG,"MediaSource onSourceOpen"),null===(e=this._mediaSource)||void 0===e||e.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0){const e=this._pendingSourceBufferInit;for(;e.length;){const t=e.shift();this.appendInitSegment(t,!0)}}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(E.SOURCE_OPEN)}_onSourceEnded(){c.Z.v(this.TAG,"MediaSource onSourceEnded")}_onSourceClose(){c.Z.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))}_hasPendingSegments(){const e=this._pendingSegments;return e.video.length>0||e.audio.length>0}_hasPendingRemoveRanges(){const e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0}_onSourceBufferUpdateEnd(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(E.UPDATE_END)}_onSourceBufferError(e){c.Z.e(this.TAG,"SourceBuffer Error: "+e)}};var R=i(898);const A={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},D={NETWORK_EXCEPTION:d.nm.EXCEPTION,NETWORK_STATUS_CODE_INVALID:d.nm.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:d.nm.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:d.nm.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:R.Z.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:R.Z.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:R.Z.CODEC_UNSUPPORTED};var B=function(e,t,i,n){return new(i||(i=Promise))((function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}d((n=n.apply(e,t||[])).next())}))};const j=class{constructor(e,t){var i,n,o;this.TAG="MSEPlayer",this._type="MSEPlayer",this._emitter=new l.EventEmitter,this._config=a(),"object"==typeof t&&Object.assign(this._config,t);const r=e.type.toLowerCase();if("mse"!==r&&"mpegts"!==r&&"m2ts"!==r&&"flv"!==r)throw new I.OC("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;const s=u.Z.chrome&&(u.Z.version&&(null===(i=u.Z.version)||void 0===i?void 0:i.major)<50||u.Z.version&&50===(null===(n=null===u.Z||void 0===u.Z?void 0:u.Z.version)||void 0===n?void 0:n.major)&&((null===(o=null===u.Z||void 0===u.Z?void 0:u.Z.version)||void 0===o?void 0:o.build)||-1)<2661);this._alwaysSeekKeyframe=!!(s||u.Z.msedge||u.Z.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}destroy(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){e===m.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then(()=>{this._emitter.emit(m.MEDIA_INFO,this.mediaInfo)}):e===m.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then(()=>{this._emitter.emit(m.STATISTICS_INFO,this.statisticsInfo)}),this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){var t,i,n,o,a;if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new x(this._config),null===(t=this._msectl)||void 0===t||t.on(E.UPDATE_END,this._onmseUpdateEnd.bind(this)),null===(i=this._msectl)||void 0===i||i.on(E.BUFFER_FULL,this._onmseBufferFull.bind(this)),null===(n=this._msectl)||void 0===n||n.on(E.SOURCE_OPEN,()=>{this._mseSourceOpened=!0,this._hasPendingLoad&&(this._hasPendingLoad=!1,this.load())}),null===(o=this._msectl)||void 0===o||o.on(E.ERROR,e=>{this._emitter.emit(m.ERROR,A.MEDIA_ERROR,D.MEDIA_MSE_ERROR,e)}),null===(a=this._msectl)||void 0===a||a.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}detachMediaElement(){var e;this._mediaElement&&(null===(e=this._msectl)||void 0===e||e.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)}load(){if(!this._mediaElement)throw new I.rT("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new I.rT("MSEPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(!this._config.deferLoadAfterSourceOpen||this._mseSourceOpened?(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new k(this._mediaDataSource,this._config),this._transmuxer.on(T.Z.INIT_SEGMENT,(e,t)=>{var i;null===(i=this._msectl)||void 0===i||i.appendInitSegment(t)}),this._transmuxer.on(T.Z.MEDIA_SEGMENT,(e,t)=>{var i,n,o;if(null===(i=this._msectl)||void 0===i||i.appendMediaSegment(t),this._config.lazyLoad&&!this._config.isLive){const e=null===(n=this._mediaElement)||void 0===n?void 0:n.currentTime;t.info.endDts>=1e3*(e+((null===(o=this._config)||void 0===o?void 0:o.lazyLoadMaxDuration)||0))&&null==this._progressChecker&&(c.Z.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}}),this._transmuxer.on(T.Z.LOADING_COMPLETE,()=>{var e;null===(e=this._msectl)||void 0===e||e.endOfStream(),this._emitter.emit(m.LOADING_COMPLETE)}),this._transmuxer.on(T.Z.RECOVERED_EARLY_EOF,()=>{this._emitter.emit(m.RECOVERED_EARLY_EOF)}),this._transmuxer.on(T.Z.IO_ERROR,(e,t)=>{this._emitter.emit(m.ERROR,A.NETWORK_ERROR,e,t)}),this._transmuxer.on(T.Z.DEMUX_ERROR,(e,t)=>{this._emitter.emit(m.ERROR,A.MEDIA_ERROR,e,{code:-1,msg:t})}),this._transmuxer.on(T.Z.MEDIA_INFO,e=>{this._mediaInfo=e,this._emitter.emit(m.MEDIA_INFO,Object.assign({},e))}),this._transmuxer.on(T.Z.METADATA_ARRIVED,e=>{this._emitter.emit(m.METADATA_ARRIVED,e)}),this._transmuxer.on(T.Z.SCRIPTDATA_ARRIVED,e=>{this._emitter.emit(m.SCRIPTDATA_ARRIVED,e)}),this._transmuxer.on(T.Z.TIMED_ID3_METADATA_ARRIVED,e=>{this._emitter.emit(m.TIMED_ID3_METADATA_ARRIVED,e)}),this._transmuxer.on(T.Z.SMPTE2038_METADATA_ARRIVED,e=>{this._emitter.emit(m.SMPTE2038_METADATA_ARRIVED,e)}),this._transmuxer.on(T.Z.SCTE35_METADATA_ARRIVED,e=>{this._emitter.emit(m.SCTE35_METADATA_ARRIVED,e)}),this._transmuxer.on(T.Z.PES_PRIVATE_DATA_DESCRIPTOR,e=>{this._emitter.emit(m.PES_PRIVATE_DATA_DESCRIPTOR,e)}),this._transmuxer.on(T.Z.PES_PRIVATE_DATA_ARRIVED,e=>{this._emitter.emit(m.PES_PRIVATE_DATA_ARRIVED,e)}),this._transmuxer.on(T.Z.STATISTICS_INFO,e=>{this._statisticsInfo=this._fillStatisticsInfo(e),this._emitter.emit(m.STATISTICS_INFO,Object.assign({},this._statisticsInfo))}),this._transmuxer.on(T.Z.RECOMMEND_SEEKPOINT,e=>{this._mediaElement&&!this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e/1e3)}),this._transmuxer.open()):this._hasPendingLoad=!0)}unload(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)}play(){var e;return B(this,void 0,void 0,(function*(){return yield null===(e=this._mediaElement)||void 0===e?void 0:e.play()}))}pause(){var e;null===(e=this._mediaElement)||void 0===e||e.pause()}get type(){return this._type}get buffered(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.buffered}get duration(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.duration}get volume(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.volume}set volume(e){this._mediaElement&&(this._mediaElement.volume=e)}get muted(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.muted}set muted(e){this._mediaElement&&(this._mediaElement.muted=e)}get currentTime(){return this._mediaElement?this._mediaElement.currentTime:0}set currentTime(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e}get mediaInfo(){return Object.assign({},this._mediaInfo)}get statisticsInfo(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)}_fillStatisticsInfo(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;let t=!0,i=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){const e=this._mediaElement.getVideoPlaybackQuality();i=e.totalVideoFrames,n=e.droppedVideoFrames}else void 0!==this._mediaElement.webkitDecodedFrameCount?(i=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=n),e}_onmseUpdateEnd(){var e,t,i,n;const o=null===(e=this._mediaElement)||void 0===e?void 0:e.buffered,a=(null===(t=this._mediaElement)||void 0===t?void 0:t.currentTime)||0;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&(null==o?void 0:o.length)>0&&!(null===(i=this._mediaElement)||void 0===i?void 0:i.paused)){const e=o.end(o.length-1);if(e>((null===(n=this._config)||void 0===n?void 0:n.liveBufferLatencyMaxLatency)||0)&&e-a>(this._config.liveBufferLatencyMaxLatency||0)){const t=e-(this._config.liveBufferLatencyMinRemain||0);this.currentTime=t}}if(!this._config.lazyLoad||this._config.isLive)return;let r=0;for(let s=0;s<o.length;s++){const e=o.start(s),t=o.end(s);if(e<=a&&a<t){r=t;break}}r>=a+(this._config.lazyLoadMaxDuration||0)&&null==this._progressChecker&&(c.Z.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}_onmseBufferFull(){c.Z.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()}_suspendTransmuxer(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))}_checkProgressAndResume(){var e,t,i;const n=(null===(e=this._mediaElement)||void 0===e?void 0:e.currentTime)||0,o=null===(t=this._mediaElement)||void 0===t?void 0:t.buffered;let a=!1;for(let r=0;r<o.length;r++){const e=o.start(r),t=o.end(r);if(n>=e&&n<t){n>=t-(this._config.lazyLoadRecoverDuration||0)&&(a=!0);break}}a&&(window.clearInterval(this._progressChecker),this._progressChecker=null,a&&(c.Z.v(this.TAG,"Continue loading from paused position"),null===(i=this._transmuxer)||void 0===i||i.resume()))}_isTimepointBuffered(e){var t;const i=null===(t=this._mediaElement)||void 0===t?void 0:t.buffered;for(let n=0;n<i.length;n++){const t=i.start(n),o=i.end(n);if(e>=t&&e<o)return!0}return!1}_internalSeek(e){var t,i,n,o,a;const r=this._isTimepointBuffered(e);let s=!1,d=0;if(e<1&&(null===(t=this._mediaElement)||void 0===t?void 0:t.buffered).length>0){const t=(null===(i=this._mediaElement)||void 0===i?void 0:i.buffered).start(0);(t<1&&e<t||u.Z.safari)&&(s=!0,d=u.Z.safari?.1:t)}if(s)this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=d);else if(r){if(this._alwaysSeekKeyframe){const t=null===(n=this._msectl)||void 0===n?void 0:n.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=null!=t?t.dts/1e3:e)}else this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=e);null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),null===(o=this._msectl)||void 0===o||o.seek(e),null===(a=this._transmuxer)||void 0===a||a.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=e))}_checkAndApplyUnbufferedSeekpoint(){var e,t,i,n;if(this._seekpointRecord)if(((null===(e=this._seekpointRecord)||void 0===e?void 0:e.recordTime)||0)<=this._now()-100){const e=null===(t=this._mediaElement)||void 0===t?void 0:t.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),null===(i=this._msectl)||void 0===i||i.seek(e),null===(n=this._transmuxer)||void 0===n||n.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=e)))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}_checkAndResumeStuckPlayback(e){const t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){const e=t.buffered;e.length>0&&t.currentTime<e.start(0)&&(c.Z.w(this.TAG,`Playback seems stuck at ${t.currentTime}, seek to ${e.start(0)}`),this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=e.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress)))}else this._mediaElement&&this._mediaElement.removeEventListener("progress",this.e.onvProgress)}_onvLoadedMetadata(e){null!=this._pendingSeekTime&&(this._mediaElement&&(this._mediaElement.currentTime=this._pendingSeekTime),this._pendingSeekTime=null)}_onvSeeking(e){var t,i,n;const o=null===(t=this._mediaElement)||void 0===t?void 0:t.currentTime,a=null===(i=this._mediaElement)||void 0===i?void 0:i.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(o<1&&a.length>0){const e=a.start(0);if(e<1&&o<e||u.Z.safari)return this._requestSetTime=!0,void(this._mediaElement&&(this._mediaElement.currentTime=u.Z.safari?.1:e))}if(this._isTimepointBuffered(o)){if(this._alwaysSeekKeyframe){const e=null===(n=this._msectl)||void 0===n?void 0:n.getNearestKeyframe(Math.floor(1e3*o));null!=e&&(this._requestSetTime=!0,this._mediaElement&&(this._mediaElement.currentTime=e.dts/1e3))}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:o,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}}_onvCanPlay(e){var t;this._receivedCanPlay=!0,null===(t=this._mediaElement)||void 0===t||t.removeEventListener("canplay",this.e.onvCanPlay)}_onvStalled(e){this._checkAndResumeStuckPlayback(!0)}_onvProgress(e){this._checkAndResumeStuckPlayback()}};var L=function(e,t,i,n){return new(i||(i=Promise))((function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}d((n=n.apply(e,t||[])).next())}))};const M=class{constructor(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new l.EventEmitter,this._config=a(),"object"==typeof t&&Object.assign(this._config,t);const i=e.type.toLowerCase();if("mse"===i||"mpegts"===i||"m2ts"===i||"flv"===i)throw new I.OC("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new I.OC(`NativePlayer(${e.type}) doesn't support multipart playback!`);this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}destroy(){var e;this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,null===(e=this._emitter)||void 0===e||e.removeAllListeners(),this._emitter=null}on(e,t){e===m.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(()=>{this._emitter.emit(m.MEDIA_INFO,this.mediaInfo)}):e===m.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(()=>{this._emitter.emit(m.STATISTICS_INFO,this.statisticsInfo)}),this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}detachMediaElement(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}load(){var e;if(!this._mediaElement)throw new I.rT("HTMLMediaElement must be attached before load()!");this._mediaElement.src=(null===(e=this._mediaDataSource)||void 0===e?void 0:e.url)||"",this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)}unload(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}play(){var e;return L(this,void 0,void 0,(function*(){return yield null===(e=this._mediaElement)||void 0===e?void 0:e.play()}))}pause(){var e;null===(e=this._mediaElement)||void 0===e||e.pause()}get type(){return this._type}get buffered(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.buffered}get duration(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.duration}get volume(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.volume}set volume(e){this._mediaElement&&(this._mediaElement.volume=e)}get muted(){var e;return null===(e=this._mediaElement)||void 0===e?void 0:e.muted}set muted(e){this._mediaElement&&(this._mediaElement.muted=e)}get currentTime(){return this._mediaElement?this._mediaElement.currentTime:0}set currentTime(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e}get mediaInfo(){const e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e}get statisticsInfo(){const e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;let t=!0,i=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){const e=this._mediaElement.getVideoPlaybackQuality();i=e.totalVideoFrames,n=e.droppedVideoFrames}else void 0!==this._mediaElement.webkitDecodedFrameCount?(i=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=n),e}_onvLoadedMetadata(e){null!=this._pendingSeekTime&&(this._mediaElement&&(this._mediaElement.currentTime=this._pendingSeekTime),this._pendingSeekTime=null),this._emitter.emit(m.MEDIA_INFO,this.mediaInfo)}_reportStatisticsInfo(){this._emitter.emit(m.STATISTICS_INFO,this.statisticsInfo)}},N={h264:1,h265:2,h266:4,vp8:8,vp9:16,av1:32},F=["h264","h265"],z=e=>{const t=e.split("?"),i=new URLSearchParams(t[1]);return i.delete("vc"),i.set("vc",F.reduce((e,t)=>e+(N[t]||0),0).toString()),t[0]+"?"+i.toString()},O={createPlayer:function(e,t){(null==e?void 0:e.url)&&(e.url=z(e.url));const i=e;if(null==i||"object"!=typeof i)throw new I.OC("MediaDataSource must be an javascript object!");if(!Object.prototype.hasOwnProperty.call(i,"type"))throw new I.OC("MediaDataSource must has type field to indicate video file type!");switch(i.type){case"mse":case"mpegts":case"m2ts":case"flv":return new j(i,t);default:return new M(i,t)}},isSupported:function(){return s.supportMSEH264Playback()},getFeatureList:function(){return s.getFeatureList()},BaseLoader:d.fp,LoaderStatus:d.GM,LoaderErrors:d.nm,version:"",Events:m,ErrorTypes:A,ErrorDetails:D,MSEPlayer:j,NativePlayer:M,LoggingControl:b.Z};Object.defineProperty(O,"version",{enumerable:!0,get:function(){return"2.0.0"}});const U=O},607:(e,t,i)=>{e.exports=i(578).default},575:(e,t,i)=>{i.d(t,{Z:()=>y});var n=i(645);const o=class{constructor(){var e;this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,(null===(e=self.performance)||void 0===e?void 0:e.now)?this._now=self.performance.now.bind(self.performance):this._now=Date.now}reset(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}addBytes(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}get currentKBps(){this.addBytes(0);let e=(this._now()-this._lastCheckpoint)/1e3;return 0===e&&(e=1),this._intervalBytes/e/1024}get lastSecondKBps(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}get averageKBps(){const e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}};var a=i(108),r=i(479),s=i(411);class d extends a.fp{static isSupported(){var e;try{const t=r.Z.msedge&&((null===(e=null===r.Z||void 0===r.Z?void 0:r.Z.version)||void 0===e?void 0:e.minor)||0)>=15048&&!r.Z.webkit,i=!r.Z.msedge||t;return self.fetch&&self.ReadableStream&&i}catch(e){return!1}}constructor(e,t){super("fetch-stream-loader"),this.TAG="FetchStreamLoader",this._seekHandler=e,this._config=t,this._needStash=!0,this._requestAbort=!1,this._abortController=null,this._contentLength=null,this._receivedLength=0}destroy(){this.isWorking()&&this.abort(),super.destroy()}open(e,t){this._dataSource=e,this._range=t;let i=e.url;this._config.reuseRedirectedURL&&void 0!==e.redirectedURL&&(i=e.redirectedURL);const n=this._seekHandler.getConfig(i,t),o=new self.Headers;if("object"==typeof n.headers){const e=n.headers;for(const t in e)e.hasOwnProperty(t)&&o.append(t,e[t])}const r={method:"GET",headers:o,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(const a in this._config.headers)o.append(a,this._config.headers[a]);e.cors||(r.mode="same-origin"),e.withCredentials&&(r.credentials="include"),(null==e?void 0:e.referrerPolicy)&&(r.referrerPolicy=e.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,this._abortController&&(r.signal=this._abortController.signal)),this._status=a.GM.kConnecting,self.fetch(n.url,r).then(e=>{var t,i;if(this._requestAbort)return this._status=a.GM.kIdle,void(null===(t=e.body)||void 0===t||t.cancel());if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==n.url&&this._onURLRedirect){const t=this._seekHandler.removeURLParameters(e.url);this._onURLRedirect(t)}const t=e.headers.get("Content-Length");return null!=t&&(this._contentLength=parseInt(t),0!==this._contentLength&&this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)),this._pump.call(this,null===(i=e.body)||void 0===i?void 0:i.getReader())}if(this._status=a.GM.kError,!this._onError)throw new s.OZ("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);this._onError(a.nm.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})}).catch(e=>{var t;if(!(null===(t=this._abortController)||void 0===t?void 0:t.signal.aborted)){if(this._status=a.GM.kError,!this._onError)throw e;this._onError(a.nm.EXCEPTION,{code:-1,msg:e.message})}})}abort(){var e;if(this._requestAbort=!0,(this._status!==a.GM.kBuffering||!r.Z.chrome)&&this._abortController)try{null===(e=this._abortController)||void 0===e||e.abort()}catch(e){}}_pump(e){return e.read().then(t=>{var i,n,o,r;if(t.done)if(null!==this._contentLength&&this._receivedLength<this._contentLength){this._status=a.GM.kError;const e=a.nm.EARLY_EOF,t={code:-1,msg:"Fetch stream meet Early-EOF"};if(!this._onError)throw new s.OZ(t.msg);this._onError(e,t)}else this._status=a.GM.kComplete,this._onComplete&&this._onComplete((null===(i=this._range)||void 0===i?void 0:i.from)||0,((null===(n=this._range)||void 0===n?void 0:n.from)||0)+this._receivedLength-1);else{if(null===(o=this._abortController)||void 0===o?void 0:o.signal.aborted)return void(this._status=a.GM.kComplete);if(this._requestAbort)return this._status=a.GM.kComplete,e.cancel();this._status=a.GM.kBuffering;const i=t.value.buffer,n=((null===(r=this._range)||void 0===r?void 0:r.from)||0)+this._receivedLength;this._receivedLength+=i.byteLength,this._onDataArrival&&this._onDataArrival(i,n,this._receivedLength),this._pump(e)}}).catch(e=>{var t,i;if(null===(i=null===(t=this._abortController)||void 0===t?void 0:t.signal)||void 0===i?void 0:i.aborted)return void(this._status=a.GM.kComplete);if(11===e.code&&r.Z.msedge)return;this._status=a.GM.kError;let n=0,o=null;if(19!==e.code&&"network error"!==e.message||!(null===this._contentLength||null!==this._contentLength&&this._receivedLength<this._contentLength)?(n=a.nm.EXCEPTION,o={code:e.code,msg:e.message}):(n=a.nm.EARLY_EOF,o={code:e.code,msg:"Fetch stream meet Early-EOF"}),!this._onError)throw new s.OZ(o.msg);this._onError(n,o)})}}const l=d;class c extends a.fp{static isSupported(){try{const e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return n.Z.w("MozChunkedLoader",e.message),!1}}constructor(e,t){super("xhr-moz-chunked-loader"),this.TAG="MozChunkedLoader",this._seekHandler=e,this._config=t,this._needStash=!0,this._xhr=null,this._requestAbort=!1,this._contentLength=null,this._receivedLength=0}destroy(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),super.destroy()}open(e,t){this._dataSource=e,this._range=t;let i=e.url;this._config.reuseRedirectedURL&&void 0!==e.redirectedURL&&(i=e.redirectedURL);const n=this._seekHandler.getConfig(i,t);this._requestURL=n.url;const o=this._xhr=new XMLHttpRequest;if(o.open("GET",n.url,!0),o.responseType="moz-chunked-arraybuffer",o.onreadystatechange=this._onReadyStateChange.bind(this),o.onprogress=this._onProgress.bind(this),o.onloadend=this._onLoadEnd.bind(this),o.onerror=this._onXhrError.bind(this),e.withCredentials&&(o.withCredentials=!0),"object"==typeof n.headers){const e=n.headers;for(const t in e)e.hasOwnProperty(t)&&o.setRequestHeader(t,e[t])}if("object"==typeof this._config.headers){const e=this._config.headers;for(const t in e)e.hasOwnProperty(t)&&o.setRequestHeader(t,e[t])}this._status=a.GM.kConnecting,o.send()}abort(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=a.GM.kComplete}_onReadyStateChange(e){const t=e.target;if(2===t.readyState){if(void 0!==t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){const e=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(e)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=a.GM.kError,!this._onError)throw new s.OZ("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(a.nm.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=a.GM.kBuffering}}_onProgress(e){var t;if(this._status===a.GM.kError)return;null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));const i=e.target.response,n=((null===(t=this._range)||void 0===t?void 0:t.from)||0)+this._receivedLength;this._receivedLength+=i.byteLength,this._onDataArrival&&this._onDataArrival(i,n,this._receivedLength)}_onLoadEnd(e){this._requestAbort?this._requestAbort=!1:this._status!==a.GM.kError&&(this._status=a.GM.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}_onXhrError(e){this._status=a.GM.kError;let t=0,i=null;if(this._contentLength&&e.loaded<this._contentLength?(t=a.nm.EARLY_EOF,i={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=a.nm.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new s.OZ(i.msg);this._onError(t,i)}}const u=c;class m extends a.fp{static isSupported(){try{const e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return n.Z.w("RangeLoader",e.message),!1}}constructor(e,t){super("xhr-range-loader"),this.TAG="RangeLoader",this._seekHandler=e,this._config=t,this._needStash=!1,this._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],this._currentChunkSizeKB=384,this._currentSpeedNormalized=0,this._zeroSpeedChunkCount=0,this._xhr=null,this._speedSampler=new o,this._requestAbort=!1,this._waitForTotalLength=!1,this._totalLengthReceived=!1,this._currentRequestURL=null,this._currentRedirectedURL=null,this._currentRequestRange=null,this._totalLength=null,this._contentLength=null,this._receivedLength=0,this._lastTimeLoaded=0}destroy(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),super.destroy()}get currentSpeed(){return this._speedSampler.lastSecondKBps}open(e,t){this._dataSource=e,this._range=t,this._status=a.GM.kConnecting;let i=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(i=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||i?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))}_openSubRange(){var e,t;const i=1024*this._currentChunkSizeKB,n=((null===(e=this._range)||void 0===e?void 0:e.from)||0)+this._receivedLength;let o=n+i;null!=this._contentLength&&o-this._range.from>=this._contentLength&&(o=((null===(t=this._range)||void 0===t?void 0:t.from)||0)+this._contentLength-1),this._currentRequestRange={from:n,to:o},this._internalOpen(this._dataSource,this._currentRequestRange)}_internalOpen(e,t){this._lastTimeLoaded=0;let i=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?i=this._currentRedirectedURL:null!=e.redirectedURL&&(i=e.redirectedURL));const n=this._seekHandler.getConfig(i,t);this._currentRequestURL=n.url;const o=this._xhr=new XMLHttpRequest;if(o.open("GET",n.url,!0),o.responseType="arraybuffer",o.onreadystatechange=this._onReadyStateChange.bind(this),o.onprogress=this._onProgress.bind(this),o.onload=this._onLoad.bind(this),o.onerror=this._onXhrError.bind(this),e.withCredentials&&(o.withCredentials=!0),"object"==typeof n.headers){const e=n.headers;for(const t in e)e.hasOwnProperty(t)&&o.setRequestHeader(t,e[t])}if("object"==typeof this._config.headers){const e=this._config.headers;for(const t in e)e.hasOwnProperty(t)&&o.setRequestHeader(t,e[t])}o.send()}abort(){this._requestAbort=!0,this._internalAbort(),this._status=a.GM.kComplete}_internalAbort(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)}_onReadyStateChange(e){const t=e.target;if(2===t.readyState){if(null!=t.responseURL){const e=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&e!==this._currentRedirectedURL&&(this._currentRedirectedURL=e,this._onURLRedirect&&this._onURLRedirect(e))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=a.GM.kBuffering}else{if(this._status=a.GM.kError,!this._onError)throw new s.OZ("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(a.nm.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}}_onProgress(e){if(this._status===a.GM.kError)return;if(null===this._contentLength){let t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;const i=e.total;this._internalAbort(),null!=i&&0!==i&&(this._totalLength=i)}if(-1===this._range.to?this._contentLength=(this._totalLength||0)-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}const t=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(t)}_normalizeSpeed(e){const t=this._chunkSizeKBList,i=t.length-1;let n=0,o=0,a=i;if(e<t[0])return t[0];for(;o<=a;){if(n=o+Math.floor((a-o)/2),n===i||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?o=n+1:a=n-1}}_onLoad(e){if(this._status===a.GM.kError)return;if(this._waitForTotalLength)return void(this._waitForTotalLength=!1);this._lastTimeLoaded=0;let t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){const e=this._normalizeSpeed(t);this._currentSpeedNormalized!==e&&(this._currentSpeedNormalized=e,this._currentChunkSizeKB=e)}const i=e.target.response,n=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;let o=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():o=!0,this._onDataArrival&&this._onDataArrival(i,n,this._receivedLength),o&&(this._status=a.GM.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}_onXhrError(e){this._status=a.GM.kError;let t=0,i=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=a.nm.EARLY_EOF,i={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=a.nm.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new s.OZ(i.msg);this._onError(t,i)}}const p=m;class h extends a.fp{static isSupported(){try{return void 0!==self.WebSocket}catch(e){return!1}}constructor(e,t){super("websocket-loader"),this.TAG="WebSocketLoader",this._needStash=!0,this._ws=null,this._requestAbort=!1,this._receivedLength=0}destroy(){this._ws&&this.abort(),super.destroy()}open(e){try{const t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=a.GM.kConnecting}catch(e){this._status=a.GM.kError;const t={code:e.code,msg:e.message};if(!this._onError)throw new s.OZ(t.msg);this._onError(a.nm.EXCEPTION,t)}}abort(){const e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=a.GM.kComplete}_onWebSocketOpen(e){this._status=a.GM.kBuffering}_onWebSocketClose(e){this._requestAbort?this._requestAbort=!1:(this._status=a.GM.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1))}_onWebSocketMessage(e){if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){const t=new FileReader;t.onload=()=>{this._dispatchArrayBuffer(null==t?void 0:t.result)},t.readAsArrayBuffer(e.data)}else{this._status=a.GM.kError;const t={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new s.OZ(t.msg);this._onError(a.nm.EXCEPTION,t)}}_dispatchArrayBuffer(e){const t=e,i=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,i,this._receivedLength)}_onWebSocketError(e){this._status=a.GM.kError;const t={code:e.code,msg:e.message};if(!this._onError)throw new s.OZ(t.msg);this._onError(a.nm.EXCEPTION,t)}}const f=h,g=class{constructor(e){this._zeroStart=e||!1}getConfig(e,t){const i={};if(0!==t.from||-1!==t.to){let e;e=-1!==t.to?`bytes=${t.from.toString()}-${t.to.toString()}`:`bytes=${t.from.toString()}-`,i.Range=e}else this._zeroStart&&(i.Range="bytes=0-");return{url:e,headers:i}}removeURLParameters(e){return e}},v=class{constructor(e,t){this._startName=e,this._endName=t}getConfig(e,t){let i=e;if(0!==t.from||-1!==t.to){let e=!0;i.includes("?")||(i+="?",e=!1),e&&(i+="&"),i+=`${this._startName}=${t.from.toString()}`,-1!==t.to&&(i+=`&${this._endName}=${t.to.toString()}`)}return{url:i,headers:{}}}removeURLParameters(e){const t=e.split("?")[0];let i;const n=e.indexOf("?");-1!==n&&(i=e.substring(n+1));let o="";if(void 0!==i&&i.length>0){const e=i.split("&");for(let t=0;t<e.length;t++){const i=e[t].split("="),n=t>0;i[0]!==this._startName&&i[0]!==this._endName&&(n&&(o+="&"),o+=e[t])}}return 0===o.length?t:t+"?"+o}},y=class{constructor(e,t,i){this.TAG="IOController",this._config=t,this._extraData=i,this._stashInitialSize=65536,void 0!==t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,t.enableStashBuffer||(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url||""),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new o,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}destroy(){var e,t,i;(null===(e=this._loader)||void 0===e?void 0:e.isWorking())&&(null===(t=this._loader)||void 0===t||t.abort()),null===(i=this._loader)||void 0===i||i.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null}isWorking(){var e;return(null===(e=this._loader)||void 0===e?void 0:e.isWorking())&&!this._paused}isPaused(){return this._paused}get status(){var e;return null===(e=this._loader)||void 0===e?void 0:e.status}get extraData(){return this._extraData}set extraData(e){this._extraData=e}get onDataArrival(){return this._onDataArrival}set onDataArrival(e){this._onDataArrival=e}get onSeeked(){return this._onSeeked}set onSeeked(e){this._onSeeked=e}get onError(){return this._onError}set onError(e){this._onError=e}get onComplete(){return this._onComplete}set onComplete(e){this._onComplete=e}get onRedirect(){return this._onRedirect}set onRedirect(e){this._onRedirect=e}get onRecoveredEarlyEof(){return this._onRecoveredEarlyEof}set onRecoveredEarlyEof(e){this._onRecoveredEarlyEof=e}get currentURL(){var e;return null===(e=this._dataSource)||void 0===e?void 0:e.url}get hasRedirect(){var e;return null!=this._redirectedURL||void 0!==(null===(e=this._dataSource)||void 0===e?void 0:e.redirectedURL)}get currentRedirectedURL(){var e;return this._redirectedURL||(null===(e=this._dataSource)||void 0===e?void 0:e.redirectedURL)}get currentSpeed(){var e,t;return this._loaderClass===p?null===(e=this._loader)||void 0===e?void 0:e.currentSpeed:null===(t=this._speedSampler)||void 0===t?void 0:t.lastSecondKBps}get loaderType(){var e;return null===(e=this._loader)||void 0===e?void 0:e.type}_selectSeekHandler(){const e=this._config;if("range"===e.seekType)this._seekHandler=new g(!!this._config.rangeLoadZeroStart);else if("param"===e.seekType){const t=e.seekParamStart||"bstart",i=e.seekParamEnd||"bend";this._seekHandler=new v(t,i)}else{if("custom"!==e.seekType)throw new s.OC("Invalid seekType in config: "+((null==e?void 0:e.seekType)||""));if("function"!=typeof e.customSeekHandler)throw new s.OC("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}}_selectLoader(){var e;if(null!=this._config.customLoader)this._loaderClass=(null===(e=this._config)||void 0===e?void 0:e.customLoader)||null;else if(this._isWebSocketURL)this._loaderClass=f;else if(l.isSupported())this._loaderClass=l;else if(u.isSupported())this._loaderClass=u;else{if(!p.isSupported())throw new s.OZ("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=p}}_createLoader(){var e;this._loaderClass&&(this._loader=new this._loaderClass(this._seekHandler,this._config),(null===(e=this._loader)||void 0===e?void 0:e.needStashBuffer)||(this._enableStash=!1),this._loader&&(this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)))}open(e){var t,i;this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),null===(t=this._speedSampler)||void 0===t||t.reset(),e||(this._fullRequestFlag=!0),null===(i=this._loader)||void 0===i||i.open(this._dataSource,Object.assign({},this._currentRange))}abort(){var e;null===(e=this._loader)||void 0===e||e.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)}pause(){var e,t;this.isWorking()&&(null===(e=this._loader)||void 0===e||e.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange&&(this._currentRange.to=this._stashByteStart-1)):this._resumeFrom=((null===(t=this._currentRange)||void 0===t?void 0:t.to)||0)+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)}resume(){if(this._paused){this._paused=!1;const e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}}seek(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)}_internalSeek(e,t){var i,n,o,a;(null===(i=this._loader)||void 0===i?void 0:i.isWorking())&&(null===(n=this._loader)||void 0===n||n.abort()),this._flushStashBuffer(t),null===(o=this._loader)||void 0===o||o.destroy(),this._loader=null;const r={from:e,to:-1};this._currentRange={from:r.from,to:-1},null===(a=this._speedSampler)||void 0===a||a.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,r),this._onSeeked&&this._onSeeked()}updateUrl(e){if(!e||"string"!=typeof e||0===e.length)throw new s.OC("Url must be a non-empty string!");this._dataSource.url=e}_expandBuffer(e){let t=this._stashSize;for(;t+1048576<e;)t*=2;if(t+=1048576,t===this._bufferSize)return;const i=new ArrayBuffer(t);if(this._stashUsed>0){const e=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(i,0,t).set(e,0)}this._stashBuffer=i,this._bufferSize=t}_normalizeSpeed(e){const t=this._speedNormalizeList,i=t.length-1;let n=0,o=0,a=i;if(e<t[0])return t[0];for(;o<=a;){if(n=o+Math.floor((a-o)/2),n===i||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?o=n+1:a=n-1}}_adjustStashSize(e){let t=0;t=this._config.isLive?e/8:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e,t>8192&&(t=8192);const i=1024*t+1048576;this._bufferSize<i&&this._expandBuffer(i),this._stashSize=1024*t}_dispatchChunks(e,t){return this._currentRange&&(this._currentRange.to=t+e.byteLength-1),this._onDataArrival?this._onDataArrival(e,t):0}_onURLRedirect(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)}_onContentLengthKnown(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)}_onLoaderChunkArrival(e,t,i){var n,o;if(!this._onDataArrival)throw new s.rT("IOController: No existing consumer (onDataArrival) callback!");if(this._paused)return;this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),null===(n=this._speedSampler)||void 0===n||n.addBytes(e.byteLength);const a=null===(o=this._speedSampler)||void 0===o?void 0:o.lastSecondKBps;if(0!==a){const e=this._normalizeSpeed(a);this._speedNormalized!==e&&(this._speedNormalized=e,this._adjustStashSize(e))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize)new Uint8Array(this._stashBuffer,0,this._stashSize).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;else{let i=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){const t=this._stashBuffer.slice(0,this._stashUsed),n=this._dispatchChunks(t,this._stashByteStart);if(n<t.byteLength){if(n>0){const e=new Uint8Array(t,n);i.set(e,0),this._stashUsed=e.byteLength,this._stashByteStart+=n}}else this._stashUsed=0,this._stashByteStart+=n;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),i=new Uint8Array(this._stashBuffer,0,this._bufferSize)),i.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{const n=this._dispatchChunks(e,t);if(n<e.byteLength){const o=e.byteLength-n;o>this._bufferSize&&(this._expandBuffer(o),i=new Uint8Array(this._stashBuffer,0,this._bufferSize)),i.set(new Uint8Array(e,n),0),this._stashUsed+=o,this._stashByteStart=t+n}}}else if(0===this._stashUsed){const i=this._dispatchChunks(e,t);if(i<e.byteLength){const n=e.byteLength-i;n>this._bufferSize&&this._expandBuffer(n),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(e,i),0),this._stashUsed+=n,this._stashByteStart=t+i}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);const t=new Uint8Array(this._stashBuffer,0,this._bufferSize);t.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;const i=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(i<this._stashUsed&&i>0){const e=new Uint8Array(this._stashBuffer,i);t.set(e,0)}this._stashUsed-=i,this._stashByteStart+=i}}_flushStashBuffer(e){if(this._stashUsed>0){const t=this._stashBuffer.slice(0,this._stashUsed),i=this._dispatchChunks(t,this._stashByteStart),o=t.byteLength-i;if(i<t.byteLength){if(!e){if(i>0){const e=new Uint8Array(this._stashBuffer,0,this._bufferSize),n=new Uint8Array(t,i);e.set(n,0),this._stashUsed=n.byteLength,this._stashByteStart+=i}return 0}n.Z.w(this.TAG,o+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,o}return 0}_onLoaderComplete(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)}_onLoaderError(e,t){var i;switch(n.Z.e(this.TAG,`Loader error, code = ${t.code}, msg = ${t.msg}`),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=a.nm.UNRECOVERABLE_EARLY_EOF),e){case a.nm.EARLY_EOF:if(!this._config.isLive&&this._totalLength){const e=((null===(i=this._currentRange)||void 0===i?void 0:i.to)||0)+1;return void(e<this._totalLength&&(n.Z.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(e,!1)))}e=a.nm.UNRECOVERABLE_EARLY_EOF;case a.nm.UNRECOVERABLE_EARLY_EOF:case a.nm.CONNECTING_TIMEOUT:case a.nm.HTTP_STATUS_CODE_INVALID:case a.nm.EXCEPTION:}if(!this._onError)throw new s.OZ("IOException: "+t.msg);this._onError(e,t)}}},108:(e,t,i)=>{i.d(t,{GM:()=>o,fp:()=>r,nm:()=>a});var n=i(411);const o={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},a={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"};class r{constructor(e){this._type=e||"undefined",this._status=o.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}destroy(){this._status=o.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}isWorking(){return this._status===o.kConnecting||this._status===o.kBuffering}get type(){return this._type}get status(){return this._status}get needStashBuffer(){return this._needStash}get onContentLengthKnown(){return this._onContentLengthKnown}set onContentLengthKnown(e){this._onContentLengthKnown=e}get onURLRedirect(){return this._onURLRedirect}set onURLRedirect(e){this._onURLRedirect=e}get onDataArrival(){return this._onDataArrival}set onDataArrival(e){this._onDataArrival=e}get onError(){return this._onError}set onError(e){this._onError=e}get onComplete(){return this._onComplete}set onComplete(e){this._onComplete=e}open(e,t){throw new n.do("Unimplemented abstract function!")}abort(){throw new n.do("Unimplemented abstract function!")}}},479:(e,t,i)=>{i.d(t,{Z:()=>o});const n={};!function(){const e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.includes("trident")&&/(rv)(?::| )([\w.]+)/.exec(e)||!e.includes("compatible")&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],i=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],o={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:i[0]||""},a={};if(o.browser){a[o.browser]=!0;const e=o.majorVersion.split(".");a.version={major:parseInt(o.majorVersion,10),string:o.version},e.length>1&&(a.version.minor=parseInt(e[1],10)),e.length>2&&(a.version.build=parseInt(e[2],10))}if(o.platform&&(a[o.platform]=!0),(a.chrome||a.opr||a.safari)&&(a.webkit=!0),a.rv||a.iemobile){a.rv&&delete a.rv;const e="msie";o.browser=e,a[e]=!0}if(a.edge){delete a.edge;const e="msedge";o.browser=e,a[e]=!0}if(a.opr){const e="opera";o.browser=e,a[e]=!0}if(a.safari&&a.android){const e="android";o.browser=e,a[e]=!0}a.name=o.browser,a.platform=o.platform;for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&delete n[r];Object.assign(n,a)}();const o=n},411:(e,t,i)=>{i.d(t,{OC:()=>a,OZ:()=>n,do:()=>r,rT:()=>o});class n{constructor(e){this.name="RuntimeException",this._message=e}get message(){return this._message}toString(){return this.name+": "+this.message}}class o extends n{constructor(e){super(e),this.name="IllegalStateException"}}class a extends n{constructor(e){super(e),this.name="InvalidArgumentException"}}class r extends n{constructor(e){super(e),this.name="NotImplementedException"}}},645:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(99);class o{static e(e,t){var i;e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);const n=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&(null===(i=o.emitter)||void 0===i||i.emit("log","error",n)),o.ENABLE_ERROR&&(console.error?console.error(n):console.warn?console.warn(n):console.log(n))}static i(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);const i=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","info",i),o.ENABLE_INFO&&(console.info?console.info(i):console.log(i))}static w(e,t){e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);const i=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&o.emitter.emit("log","warn",i),o.ENABLE_WARN&&(console.warn?console.warn(i):console.log(i))}static d(e,t){var i;e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);const n=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&(null===(i=o.emitter)||void 0===i||i.emit("log","debug",n)),o.ENABLE_DEBUG&&(console.debug?console.debug(n):console.log(n))}static v(e,t){var i;e&&!o.FORCE_GLOBAL_TAG||(e=o.GLOBAL_TAG);const n=`[${e}] > ${t}`;o.ENABLE_CALLBACK&&(null===(i=o.emitter)||void 0===i||i.emit("log","verbose",n)),o.ENABLE_VERBOSE&&console.log(n)}}o.FORCE_GLOBAL_TAG=!1,o.GLOBAL_TAG="mpegts.js",o.ENABLE_CALLBACK=!1,o.emitter=new n.EventEmitter,o.ENABLE_ERROR=!0,o.ENABLE_INFO=!0,o.ENABLE_WARN=!0,o.ENABLE_DEBUG=!0,o.ENABLE_VERBOSE=!0;const a=o},278:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(99),o=i(645);class a{static get forceGlobalTag(){return o.Z.FORCE_GLOBAL_TAG}static set forceGlobalTag(e){o.Z.FORCE_GLOBAL_TAG=e,a._notifyChange()}static get globalTag(){return o.Z.GLOBAL_TAG}static set globalTag(e){o.Z.GLOBAL_TAG=e,a._notifyChange()}static get enableAll(){return o.Z.ENABLE_VERBOSE&&o.Z.ENABLE_DEBUG&&o.Z.ENABLE_INFO&&o.Z.ENABLE_WARN&&o.Z.ENABLE_ERROR}static set enableAll(e){o.Z.ENABLE_VERBOSE=e,o.Z.ENABLE_DEBUG=e,o.Z.ENABLE_INFO=e,o.Z.ENABLE_WARN=e,o.Z.ENABLE_ERROR=e,a._notifyChange()}static get enableDebug(){return o.Z.ENABLE_DEBUG}static set enableDebug(e){o.Z.ENABLE_DEBUG=e,a._notifyChange()}static get enableVerbose(){return o.Z.ENABLE_VERBOSE}static set enableVerbose(e){o.Z.ENABLE_VERBOSE=e,a._notifyChange()}static get enableInfo(){return o.Z.ENABLE_INFO}static set enableInfo(e){o.Z.ENABLE_INFO=e,a._notifyChange()}static get enableWarn(){return o.Z.ENABLE_WARN}static set enableWarn(e){o.Z.ENABLE_WARN=e,a._notifyChange()}static get enableError(){return o.Z.ENABLE_ERROR}static set enableError(e){o.Z.ENABLE_ERROR=e,a._notifyChange()}static getConfig(){return{globalTag:o.Z.GLOBAL_TAG,forceGlobalTag:o.Z.FORCE_GLOBAL_TAG,enableVerbose:o.Z.ENABLE_VERBOSE,enableDebug:o.Z.ENABLE_DEBUG,enableInfo:o.Z.ENABLE_INFO,enableWarn:o.Z.ENABLE_WARN,enableError:o.Z.ENABLE_ERROR,enableCallback:o.Z.ENABLE_CALLBACK}}static applyConfig(e){o.Z.GLOBAL_TAG=e.globalTag,o.Z.FORCE_GLOBAL_TAG=e.forceGlobalTag,o.Z.ENABLE_VERBOSE=e.enableVerbose,o.Z.ENABLE_DEBUG=e.enableDebug,o.Z.ENABLE_INFO=e.enableInfo,o.Z.ENABLE_WARN=e.enableWarn,o.Z.ENABLE_ERROR=e.enableError,o.Z.ENABLE_CALLBACK=!!e.enableCallback}static _notifyChange(){const e=a.emitter;if(e.listenerCount("change")>0){const t=a.getConfig();e.emit("change",t)}}static registerListener(e){a.emitter.addListener("change",e)}static removeListener(e){a.emitter.removeListener("change",e)}static addLogListener(e){o.Z.emitter.addListener("log",e),o.Z.emitter.listenerCount("log")>0&&(o.Z.ENABLE_CALLBACK=!0,a._notifyChange())}static removeLogListener(e){o.Z.emitter.removeListener("log",e),0===o.Z.emitter.listenerCount("log")&&(o.Z.ENABLE_CALLBACK=!1,a._notifyChange())}}a.emitter=new n.EventEmitter;const r=a}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}return i.m=e,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i(607)})());var z=function(){function e(t,i){p(this,e),console.log("isSupportFlv",window.flvjs.isSupported()),window.flvjs.isSupported()&&this.initFLV(t,i)}return f(e,[{key:"toString",value:function(){return"Flv ".concat(this.coreX,"-").concat(this.coreY)}},{key:"initFLV",value:function(e,t){var i=document.getElementById(e),n=i.getAttribute("controls");n||i.setAttribute("controls",!0);var o=window.flvjs.createPlayer({type:"flv",url:t,isLive:!0},{enableStashBuffer:!0,stashInitialSize:128,enableWorker:!0});o.attachMediaElement(i),o.load(),o.play(),this.flvUrl=t,this.flv=o,this.video=i}},{key:"play",value:function(){console.log("执行flv播放",this.video),this.video.play()}},{key:"stop",value:function(){this.video.pause(),this.flv.unload()}},{key:"destroy",value:function(){void 0!==this.flv&&null!==this.flv&&(this.flv.pause(),this.flv.unload(),this.flv.detachMediaElement(),this.flv.destroy(),this.flv=null)}}]),e}(),O="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{};function U(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Z=U((function(e,t){(function(){var i,n="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",r="Expected a function",s="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",l=500,c="__lodash_placeholder__",u=1,m=2,p=4,h=1,f=2,g=1,v=2,y=4,S=8,_=16,b=32,C=64,T=128,w=256,k=512,E=30,P="...",I=800,x=16,R=1,A=2,D=3,B=1/0,j=9007199254740991,L=17976931348623157e292,M=NaN,N=4294967295,F=N-1,z=N>>>1,U=[["ary",T],["bind",g],["bindKey",v],["curry",S],["curryRight",_],["flip",k],["partial",b],["partialRight",C],["rearg",w]],Z="[object Arguments]",V="[object Array]",H="[object AsyncFunction]",G="[object Boolean]",W="[object Date]",q="[object DOMException]",K="[object Error]",J="[object Function]",$="[object GeneratorFunction]",X="[object Map]",Y="[object Number]",Q="[object Null]",ee="[object Object]",te="[object Promise]",ie="[object Proxy]",ne="[object RegExp]",oe="[object Set]",ae="[object String]",re="[object Symbol]",se="[object Undefined]",de="[object WeakMap]",le="[object WeakSet]",ce="[object ArrayBuffer]",ue="[object DataView]",me="[object Float32Array]",pe="[object Float64Array]",he="[object Int8Array]",fe="[object Int16Array]",ge="[object Int32Array]",ve="[object Uint8Array]",ye="[object Uint8ClampedArray]",Se="[object Uint16Array]",_e="[object Uint32Array]",be=/\b__p \+= '';/g,Ce=/\b(__p \+=) '' \+/g,Te=/(__e\(.*?\)|\b__t\)) \+\n'';/g,we=/&(?:amp|lt|gt|quot|#39);/g,ke=/[&<>"']/g,Ee=RegExp(we.source),Pe=RegExp(ke.source),Ie=/<%-([\s\S]+?)%>/g,xe=/<%([\s\S]+?)%>/g,Re=/<%=([\s\S]+?)%>/g,Ae=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,De=/^\w*$/,Be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,je=/[\\^$.*+?()[\]{}|]/g,Le=RegExp(je.source),Me=/^\s+/,Ne=/\s/,Fe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ze=/\{\n\/\* \[wrapped with (.+)\] \*/,Oe=/,? & /,Ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ze=/[()=,{}\[\]\/\s]/,Ve=/\\(\\)?/g,He=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ge=/\w*$/,We=/^[-+]0x[0-9a-f]+$/i,qe=/^0b[01]+$/i,Ke=/^\[object .+?Constructor\]$/,Je=/^0o[0-7]+$/i,$e=/^(?:0|[1-9]\d*)$/,Xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ye=/($^)/,Qe=/['\n\r\u2028\u2029\\]/g,et="\\ud800-\\udfff",tt="\\u0300-\\u036f",it="\\ufe20-\\ufe2f",nt="\\u20d0-\\u20ff",ot=tt+it+nt,at="\\u2700-\\u27bf",rt="a-z\\xdf-\\xf6\\xf8-\\xff",st="\\xac\\xb1\\xd7\\xf7",dt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",lt="\\u2000-\\u206f",ct=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ut="A-Z\\xc0-\\xd6\\xd8-\\xde",mt="\\ufe0e\\ufe0f",pt=st+dt+lt+ct,ht="['’]",ft="["+et+"]",gt="["+pt+"]",vt="["+ot+"]",yt="\\d+",St="["+at+"]",_t="["+rt+"]",bt="[^"+et+pt+yt+at+rt+ut+"]",Ct="\\ud83c[\\udffb-\\udfff]",Tt="(?:"+vt+"|"+Ct+")",wt="[^"+et+"]",kt="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",Pt="["+ut+"]",It="\\u200d",xt="(?:"+_t+"|"+bt+")",Rt="(?:"+Pt+"|"+bt+")",At="(?:"+ht+"(?:d|ll|m|re|s|t|ve))?",Dt="(?:"+ht+"(?:D|LL|M|RE|S|T|VE))?",Bt=Tt+"?",jt="["+mt+"]?",Lt="(?:"+It+"(?:"+[wt,kt,Et].join("|")+")"+jt+Bt+")*",Mt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Nt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ft=jt+Bt+Lt,zt="(?:"+[St,kt,Et].join("|")+")"+Ft,Ot="(?:"+[wt+vt+"?",vt,kt,Et,ft].join("|")+")",Ut=RegExp(ht,"g"),Zt=RegExp(vt,"g"),Vt=RegExp(Ct+"(?="+Ct+")|"+Ot+Ft,"g"),Ht=RegExp([Pt+"?"+_t+"+"+At+"(?="+[gt,Pt,"$"].join("|")+")",Rt+"+"+Dt+"(?="+[gt,Pt+xt,"$"].join("|")+")",Pt+"?"+xt+"+"+At,Pt+"+"+Dt,Nt,Mt,yt,zt].join("|"),"g"),Gt=RegExp("["+It+et+ot+mt+"]"),Wt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Kt=-1,Jt={};Jt[me]=Jt[pe]=Jt[he]=Jt[fe]=Jt[ge]=Jt[ve]=Jt[ye]=Jt[Se]=Jt[_e]=!0,Jt[Z]=Jt[V]=Jt[ce]=Jt[G]=Jt[ue]=Jt[W]=Jt[K]=Jt[J]=Jt[X]=Jt[Y]=Jt[ee]=Jt[ne]=Jt[oe]=Jt[ae]=Jt[de]=!1;var $t={};$t[Z]=$t[V]=$t[ce]=$t[ue]=$t[G]=$t[W]=$t[me]=$t[pe]=$t[he]=$t[fe]=$t[ge]=$t[X]=$t[Y]=$t[ee]=$t[ne]=$t[oe]=$t[ae]=$t[re]=$t[ve]=$t[ye]=$t[Se]=$t[_e]=!0,$t[K]=$t[J]=$t[de]=!1;var Xt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Yt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ei={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ti=parseFloat,ii=parseInt,ni="object"==typeof O&&O&&O.Object===Object&&O,oi="object"==typeof self&&self&&self.Object===Object&&self,ai=ni||oi||Function("return this")(),ri=t&&!t.nodeType&&t,si=ri&&e&&!e.nodeType&&e,di=si&&si.exports===ri,li=di&&ni.process,ci=function(){try{var e=si&&si.require&&si.require("util").types;return e||li&&li.binding&&li.binding("util")}catch(t){}}(),ui=ci&&ci.isArrayBuffer,mi=ci&&ci.isDate,pi=ci&&ci.isMap,hi=ci&&ci.isRegExp,fi=ci&&ci.isSet,gi=ci&&ci.isTypedArray;function vi(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function yi(e,t,i,n){var o=-1,a=null==e?0:e.length;while(++o<a){var r=e[o];t(n,r,i(r),e)}return n}function Si(e,t){var i=-1,n=null==e?0:e.length;while(++i<n)if(!1===t(e[i],i,e))break;return e}function _i(e,t){var i=null==e?0:e.length;while(i--)if(!1===t(e[i],i,e))break;return e}function bi(e,t){var i=-1,n=null==e?0:e.length;while(++i<n)if(!t(e[i],i,e))return!1;return!0}function Ci(e,t){var i=-1,n=null==e?0:e.length,o=0,a=[];while(++i<n){var r=e[i];t(r,i,e)&&(a[o++]=r)}return a}function Ti(e,t){var i=null==e?0:e.length;return!!i&&Li(e,t,0)>-1}function wi(e,t,i){var n=-1,o=null==e?0:e.length;while(++n<o)if(i(t,e[n]))return!0;return!1}function ki(e,t){var i=-1,n=null==e?0:e.length,o=Array(n);while(++i<n)o[i]=t(e[i],i,e);return o}function Ei(e,t){var i=-1,n=t.length,o=e.length;while(++i<n)e[o+i]=t[i];return e}function Pi(e,t,i,n){var o=-1,a=null==e?0:e.length;n&&a&&(i=e[++o]);while(++o<a)i=t(i,e[o],o,e);return i}function Ii(e,t,i,n){var o=null==e?0:e.length;n&&o&&(i=e[--o]);while(o--)i=t(i,e[o],o,e);return i}function xi(e,t){var i=-1,n=null==e?0:e.length;while(++i<n)if(t(e[i],i,e))return!0;return!1}var Ri=zi("length");function Ai(e){return e.split("")}function Di(e){return e.match(Ue)||[]}function Bi(e,t,i){var n;return i(e,(function(e,i,o){if(t(e,i,o))return n=i,!1})),n}function ji(e,t,i,n){var o=e.length,a=i+(n?1:-1);while(n?a--:++a<o)if(t(e[a],a,e))return a;return-1}function Li(e,t,i){return t===t?mn(e,t,i):ji(e,Ni,i)}function Mi(e,t,i,n){var o=i-1,a=e.length;while(++o<a)if(n(e[o],t))return o;return-1}function Ni(e){return e!==e}function Fi(e,t){var i=null==e?0:e.length;return i?Vi(e,t)/i:M}function zi(e){return function(t){return null==t?i:t[e]}}function Oi(e){return function(t){return null==e?i:e[t]}}function Ui(e,t,i,n,o){return o(e,(function(e,o,a){i=n?(n=!1,e):t(i,e,o,a)})),i}function Zi(e,t){var i=e.length;e.sort(t);while(i--)e[i]=e[i].value;return e}function Vi(e,t){var n,o=-1,a=e.length;while(++o<a){var r=t(e[o]);r!==i&&(n=n===i?r:n+r)}return n}function Hi(e,t){var i=-1,n=Array(e);while(++i<e)n[i]=t(i);return n}function Gi(e,t){return ki(t,(function(t){return[t,e[t]]}))}function Wi(e){return e?e.slice(0,gn(e)+1).replace(Me,""):e}function qi(e){return function(t){return e(t)}}function Ki(e,t){return ki(t,(function(t){return e[t]}))}function Ji(e,t){return e.has(t)}function $i(e,t){var i=-1,n=e.length;while(++i<n&&Li(t,e[i],0)>-1);return i}function Xi(e,t){var i=e.length;while(i--&&Li(t,e[i],0)>-1);return i}function Yi(e,t){var i=e.length,n=0;while(i--)e[i]===t&&++n;return n}var Qi=Oi(Xt),en=Oi(Yt);function tn(e){return"\\"+ei[e]}function nn(e,t){return null==e?i:e[t]}function on(e){return Gt.test(e)}function an(e){return Wt.test(e)}function rn(e){var t,i=[];while(!(t=e.next()).done)i.push(t.value);return i}function sn(e){var t=-1,i=Array(e.size);return e.forEach((function(e,n){i[++t]=[n,e]})),i}function dn(e,t){return function(i){return e(t(i))}}function ln(e,t){var i=-1,n=e.length,o=0,a=[];while(++i<n){var r=e[i];r!==t&&r!==c||(e[i]=c,a[o++]=i)}return a}function cn(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}function un(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=[e,e]})),i}function mn(e,t,i){var n=i-1,o=e.length;while(++n<o)if(e[n]===t)return n;return-1}function pn(e,t,i){var n=i+1;while(n--)if(e[n]===t)return n;return n}function hn(e){return on(e)?yn(e):Ri(e)}function fn(e){return on(e)?Sn(e):Ai(e)}function gn(e){var t=e.length;while(t--&&Ne.test(e.charAt(t)));return t}var vn=Oi(Qt);function yn(e){var t=Vt.lastIndex=0;while(Vt.test(e))++t;return t}function Sn(e){return e.match(Vt)||[]}function _n(e){return e.match(Ht)||[]}var bn=function e(t){t=null==t?ai:Cn.defaults(ai.Object(),t,Cn.pick(ai,qt));var O=t.Array,Ne=t.Date,Ue=t.Error,et=t.Function,tt=t.Math,it=t.Object,nt=t.RegExp,ot=t.String,at=t.TypeError,rt=O.prototype,st=et.prototype,dt=it.prototype,lt=t["__core-js_shared__"],ct=st.toString,ut=dt.hasOwnProperty,mt=0,pt=function(){var e=/[^.]+$/.exec(lt&&lt.keys&&lt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ht=dt.toString,ft=ct.call(it),gt=ai._,vt=nt("^"+ct.call(ut).replace(je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yt=di?t.Buffer:i,St=t.Symbol,_t=t.Uint8Array,bt=yt?yt.allocUnsafe:i,Ct=dn(it.getPrototypeOf,it),Tt=it.create,wt=dt.propertyIsEnumerable,kt=rt.splice,Et=St?St.isConcatSpreadable:i,Pt=St?St.iterator:i,It=St?St.toStringTag:i,xt=function(){try{var e=qr(it,"defineProperty");return e({},"",{}),e}catch(t){}}(),Rt=t.clearTimeout!==ai.clearTimeout&&t.clearTimeout,At=Ne&&Ne.now!==ai.Date.now&&Ne.now,Dt=t.setTimeout!==ai.setTimeout&&t.setTimeout,Bt=tt.ceil,jt=tt.floor,Lt=it.getOwnPropertySymbols,Mt=yt?yt.isBuffer:i,Nt=t.isFinite,Ft=rt.join,zt=dn(it.keys,it),Ot=tt.max,Vt=tt.min,Ht=Ne.now,Gt=t.parseInt,Wt=tt.random,Xt=rt.reverse,Yt=qr(t,"DataView"),Qt=qr(t,"Map"),ei=qr(t,"Promise"),ni=qr(t,"Set"),oi=qr(t,"WeakMap"),ri=qr(it,"create"),si=oi&&new oi,li={},ci=Ds(Yt),Ri=Ds(Qt),Ai=Ds(ei),Oi=Ds(ni),mn=Ds(oi),yn=St?St.prototype:i,Sn=yn?yn.valueOf:i,bn=yn?yn.toString:i;function Tn(e){if(kc(e)&&!dc(e)&&!(e instanceof Pn)){if(e instanceof En)return e;if(ut.call(e,"__wrapped__"))return js(e)}return new En(e)}var wn=function(){function e(){}return function(t){if(!wc(t))return{};if(Tt)return Tt(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function kn(){}function En(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Pn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=N,this.__views__=[]}function In(){var e=new Pn(this.__wrapped__);return e.__actions__=or(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=or(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=or(this.__views__),e}function xn(){if(this.__filtered__){var e=new Pn(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Rn(){var e=this.__wrapped__.value(),t=this.__dir__,i=dc(e),n=t<0,o=i?e.length:0,a=Yr(0,o,this.__views__),r=a.start,s=a.end,d=s-r,l=n?s:r-1,c=this.__iteratees__,u=c.length,m=0,p=Vt(d,this.__takeCount__);if(!i||!n&&o==d&&p==d)return za(e,this.__actions__);var h=[];e:while(d--&&m<p){l+=t;var f=-1,g=e[l];while(++f<u){var v=c[f],y=v.iteratee,S=v.type,_=y(g);if(S==A)g=_;else if(!_){if(S==R)continue e;break e}}h[m++]=g}return h}function An(e){var t=-1,i=null==e?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function Dn(){this.__data__=ri?ri(null):{},this.size=0}function Bn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function jn(e){var t=this.__data__;if(ri){var n=t[e];return n===d?i:n}return ut.call(t,e)?t[e]:i}function Ln(e){var t=this.__data__;return ri?t[e]!==i:ut.call(t,e)}function Mn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ri&&t===i?d:t,this}function Nn(e){var t=-1,i=null==e?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function Fn(){this.__data__=[],this.size=0}function zn(e){var t=this.__data__,i=uo(t,e);if(i<0)return!1;var n=t.length-1;return i==n?t.pop():kt.call(t,i,1),--this.size,!0}function On(e){var t=this.__data__,n=uo(t,e);return n<0?i:t[n][1]}function Un(e){return uo(this.__data__,e)>-1}function Zn(e,t){var i=this.__data__,n=uo(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this}function Vn(e){var t=-1,i=null==e?0:e.length;this.clear();while(++t<i){var n=e[t];this.set(n[0],n[1])}}function Hn(){this.size=0,this.__data__={hash:new An,map:new(Qt||Nn),string:new An}}function Gn(e){var t=Gr(this,e)["delete"](e);return this.size-=t?1:0,t}function Wn(e){return Gr(this,e).get(e)}function qn(e){return Gr(this,e).has(e)}function Kn(e,t){var i=Gr(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this}function Jn(e){var t=-1,i=null==e?0:e.length;this.__data__=new Vn;while(++t<i)this.add(e[t])}function $n(e){return this.__data__.set(e,d),this}function Xn(e){return this.__data__.has(e)}function Yn(e){var t=this.__data__=new Nn(e);this.size=t.size}function Qn(){this.__data__=new Nn,this.size=0}function eo(e){var t=this.__data__,i=t["delete"](e);return this.size=t.size,i}function to(e){return this.__data__.get(e)}function io(e){return this.__data__.has(e)}function no(e,t){var i=this.__data__;if(i instanceof Nn){var n=i.__data__;if(!Qt||n.length<o-1)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new Vn(n)}return i.set(e,t),this.size=i.size,this}function oo(e,t){var i=dc(e),n=!i&&sc(e),o=!i&&!n&&pc(e),a=!i&&!n&&!o&&Oc(e),r=i||n||o||a,s=r?Hi(e.length,ot):[],d=s.length;for(var l in e)!t&&!ut.call(e,l)||r&&("length"==l||o&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||rs(l,d))||s.push(l);return s}function ao(e){var t=e.length;return t?e[ya(0,t-1)]:i}function ro(e,t){return xs(or(e),vo(t,0,e.length))}function so(e){return xs(or(e))}function lo(e,t,n){(n!==i&&!oc(e[t],n)||n===i&&!(t in e))&&fo(e,t,n)}function co(e,t,n){var o=e[t];ut.call(e,t)&&oc(o,n)&&(n!==i||t in e)||fo(e,t,n)}function uo(e,t){var i=e.length;while(i--)if(oc(e[i][0],t))return i;return-1}function mo(e,t,i,n){return To(e,(function(e,o,a){t(n,e,i(e),a)})),n}function po(e,t){return e&&ar(t,Cu(t),e)}function ho(e,t){return e&&ar(t,Tu(t),e)}function fo(e,t,i){"__proto__"==t&&xt?xt(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function go(e,t){var n=-1,o=t.length,a=O(o),r=null==e;while(++n<o)a[n]=r?i:gu(e,t[n]);return a}function vo(e,t,n){return e===e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function yo(e,t,n,o,a,r){var s,d=t&u,l=t&m,c=t&p;if(n&&(s=a?n(e,o,a,r):n(e)),s!==i)return s;if(!wc(e))return e;var h=dc(e);if(h){if(s=ts(e),!d)return or(e,s)}else{var f=Xr(e),g=f==J||f==$;if(pc(e))return Ka(e,d);if(f==ee||f==Z||g&&!a){if(s=l||g?{}:is(e),!d)return l?sr(e,ho(s,e)):rr(e,po(s,e))}else{if(!$t[f])return a?e:{};s=ns(e,f,d)}}r||(r=new Yn);var v=r.get(e);if(v)return v;r.set(e,s),Nc(e)?e.forEach((function(i){s.add(yo(i,t,n,i,e,r))})):Ec(e)&&e.forEach((function(i,o){s.set(o,yo(i,t,n,o,e,r))}));var y=c?l?Or:zr:l?Tu:Cu,S=h?i:y(e);return Si(S||e,(function(i,o){S&&(o=i,i=e[o]),co(s,o,yo(i,t,n,o,e,r))})),s}function So(e){var t=Cu(e);return function(i){return _o(i,e,t)}}function _o(e,t,n){var o=n.length;if(null==e)return!o;e=it(e);while(o--){var a=n[o],r=t[a],s=e[a];if(s===i&&!(a in e)||!r(s))return!1}return!0}function bo(e,t,n){if("function"!=typeof e)throw new at(r);return ks((function(){e.apply(i,n)}),t)}function Co(e,t,i,n){var a=-1,r=Ti,s=!0,d=e.length,l=[],c=t.length;if(!d)return l;i&&(t=ki(t,qi(i))),n?(r=wi,s=!1):t.length>=o&&(r=Ji,s=!1,t=new Jn(t));e:while(++a<d){var u=e[a],m=null==i?u:i(u);if(u=n||0!==u?u:0,s&&m===m){var p=c;while(p--)if(t[p]===m)continue e;l.push(u)}else r(t,m,n)||l.push(u)}return l}Tn.templateSettings={escape:Ie,evaluate:xe,interpolate:Re,variable:"",imports:{_:Tn}},Tn.prototype=kn.prototype,Tn.prototype.constructor=Tn,En.prototype=wn(kn.prototype),En.prototype.constructor=En,Pn.prototype=wn(kn.prototype),Pn.prototype.constructor=Pn,An.prototype.clear=Dn,An.prototype["delete"]=Bn,An.prototype.get=jn,An.prototype.has=Ln,An.prototype.set=Mn,Nn.prototype.clear=Fn,Nn.prototype["delete"]=zn,Nn.prototype.get=On,Nn.prototype.has=Un,Nn.prototype.set=Zn,Vn.prototype.clear=Hn,Vn.prototype["delete"]=Gn,Vn.prototype.get=Wn,Vn.prototype.has=qn,Vn.prototype.set=Kn,Jn.prototype.add=Jn.prototype.push=$n,Jn.prototype.has=Xn,Yn.prototype.clear=Qn,Yn.prototype["delete"]=eo,Yn.prototype.get=to,Yn.prototype.has=io,Yn.prototype.set=no;var To=cr(Do),wo=cr(Bo,!0);function ko(e,t){var i=!0;return To(e,(function(e,n,o){return i=!!t(e,n,o),i})),i}function Eo(e,t,n){var o=-1,a=e.length;while(++o<a){var r=e[o],s=t(r);if(null!=s&&(d===i?s===s&&!zc(s):n(s,d)))var d=s,l=r}return l}function Po(e,t,n,o){var a=e.length;n=Kc(n),n<0&&(n=-n>a?0:a+n),o=o===i||o>a?a:Kc(o),o<0&&(o+=a),o=n>o?0:Jc(o);while(n<o)e[n++]=t;return e}function Io(e,t){var i=[];return To(e,(function(e,n,o){t(e,n,o)&&i.push(e)})),i}function xo(e,t,i,n,o){var a=-1,r=e.length;i||(i=as),o||(o=[]);while(++a<r){var s=e[a];t>0&&i(s)?t>1?xo(s,t-1,i,n,o):Ei(o,s):n||(o[o.length]=s)}return o}var Ro=ur(),Ao=ur(!0);function Do(e,t){return e&&Ro(e,t,Cu)}function Bo(e,t){return e&&Ao(e,t,Cu)}function jo(e,t){return Ci(t,(function(t){return bc(e[t])}))}function Lo(e,t){t=Ha(t,e);var n=0,o=t.length;while(null!=e&&n<o)e=e[As(t[n++])];return n&&n==o?e:i}function Mo(e,t,i){var n=t(e);return dc(e)?n:Ei(n,i(e))}function No(e){return null==e?e===i?se:Q:It&&It in it(e)?Kr(e):Ss(e)}function Fo(e,t){return e>t}function zo(e,t){return null!=e&&ut.call(e,t)}function Oo(e,t){return null!=e&&t in it(e)}function Uo(e,t,i){return e>=Vt(t,i)&&e<Ot(t,i)}function Zo(e,t,n){var o=n?wi:Ti,a=e[0].length,r=e.length,s=r,d=O(r),l=1/0,c=[];while(s--){var u=e[s];s&&t&&(u=ki(u,qi(t))),l=Vt(u.length,l),d[s]=!n&&(t||a>=120&&u.length>=120)?new Jn(s&&u):i}u=e[0];var m=-1,p=d[0];e:while(++m<a&&c.length<l){var h=u[m],f=t?t(h):h;if(h=n||0!==h?h:0,!(p?Ji(p,f):o(c,f,n))){s=r;while(--s){var g=d[s];if(!(g?Ji(g,f):o(e[s],f,n)))continue e}p&&p.push(f),c.push(h)}}return c}function Vo(e,t,i,n){return Do(e,(function(e,o,a){t(n,i(e),o,a)})),n}function Ho(e,t,n){t=Ha(t,e),e=bs(e,t);var o=null==e?e:e[As(ad(t))];return null==o?i:vi(o,e,n)}function Go(e){return kc(e)&&No(e)==Z}function Wo(e){return kc(e)&&No(e)==ce}function qo(e){return kc(e)&&No(e)==W}function Ko(e,t,i,n,o){return e===t||(null==e||null==t||!kc(e)&&!kc(t)?e!==e&&t!==t:Jo(e,t,i,n,Ko,o))}function Jo(e,t,i,n,o,a){var r=dc(e),s=dc(t),d=r?V:Xr(e),l=s?V:Xr(t);d=d==Z?ee:d,l=l==Z?ee:l;var c=d==ee,u=l==ee,m=d==l;if(m&&pc(e)){if(!pc(t))return!1;r=!0,c=!1}if(m&&!c)return a||(a=new Yn),r||Oc(e)?Lr(e,t,i,n,o,a):Mr(e,t,d,i,n,o,a);if(!(i&h)){var p=c&&ut.call(e,"__wrapped__"),f=u&&ut.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,v=f?t.value():t;return a||(a=new Yn),o(g,v,i,n,a)}}return!!m&&(a||(a=new Yn),Nr(e,t,i,n,o,a))}function $o(e){return kc(e)&&Xr(e)==X}function Xo(e,t,n,o){var a=n.length,r=a,s=!o;if(null==e)return!r;e=it(e);while(a--){var d=n[a];if(s&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}while(++a<r){d=n[a];var l=d[0],c=e[l],u=d[1];if(s&&d[2]){if(c===i&&!(l in e))return!1}else{var m=new Yn;if(o)var p=o(c,u,l,e,t,m);if(!(p===i?Ko(u,c,h|f,o,m):p))return!1}}return!0}function Yo(e){if(!wc(e)||us(e))return!1;var t=bc(e)?vt:Ke;return t.test(Ds(e))}function Qo(e){return kc(e)&&No(e)==ne}function ea(e){return kc(e)&&Xr(e)==oe}function ta(e){return kc(e)&&Tc(e.length)&&!!Jt[No(e)]}function ia(e){return"function"==typeof e?e:null==e?Rm:"object"==typeof e?dc(e)?da(e[0],e[1]):sa(e):Vm(e)}function na(e){if(!ps(e))return zt(e);var t=[];for(var i in it(e))ut.call(e,i)&&"constructor"!=i&&t.push(i);return t}function oa(e){if(!wc(e))return ys(e);var t=ps(e),i=[];for(var n in e)("constructor"!=n||!t&&ut.call(e,n))&&i.push(n);return i}function aa(e,t){return e<t}function ra(e,t){var i=-1,n=cc(e)?O(e.length):[];return To(e,(function(e,o,a){n[++i]=t(e,o,a)})),n}function sa(e){var t=Wr(e);return 1==t.length&&t[0][2]?fs(t[0][0],t[0][1]):function(i){return i===e||Xo(i,e,t)}}function da(e,t){return ds(e)&&hs(t)?fs(As(e),t):function(n){var o=gu(n,e);return o===i&&o===t?yu(n,e):Ko(t,o,h|f)}}function la(e,t,n,o,a){e!==t&&Ro(t,(function(r,s){if(a||(a=new Yn),wc(r))ca(e,t,s,n,la,o,a);else{var d=o?o(Ts(e,s),r,s+"",e,t,a):i;d===i&&(d=r),lo(e,s,d)}}),Tu)}function ca(e,t,n,o,a,r,s){var d=Ts(e,n),l=Ts(t,n),c=s.get(l);if(c)lo(e,n,c);else{var u=r?r(d,l,n+"",e,t,s):i,m=u===i;if(m){var p=dc(l),h=!p&&pc(l),f=!p&&!h&&Oc(l);u=l,p||h||f?dc(d)?u=d:uc(d)?u=or(d):h?(m=!1,u=Ka(l,!0)):f?(m=!1,u=Qa(l,!0)):u=[]:jc(l)||sc(l)?(u=d,sc(d)?u=Xc(d):wc(d)&&!bc(d)||(u=is(l))):m=!1}m&&(s.set(l,u),a(u,l,o,r,s),s["delete"](l)),lo(e,n,u)}}function ua(e,t){var n=e.length;if(n)return t+=t<0?n:0,rs(t,n)?e[t]:i}function ma(e,t,i){t=t.length?ki(t,(function(e){return dc(e)?function(t){return Lo(t,1===e.length?e[0]:e)}:e})):[Rm];var n=-1;t=ki(t,qi(Hr()));var o=ra(e,(function(e,i,o){var a=ki(t,(function(t){return t(e)}));return{criteria:a,index:++n,value:e}}));return Zi(o,(function(e,t){return tr(e,t,i)}))}function pa(e,t){return ha(e,t,(function(t,i){return yu(e,i)}))}function ha(e,t,i){var n=-1,o=t.length,a={};while(++n<o){var r=t[n],s=Lo(e,r);i(s,r)&&wa(a,Ha(r,e),s)}return a}function fa(e){return function(t){return Lo(t,e)}}function ga(e,t,i,n){var o=n?Mi:Li,a=-1,r=t.length,s=e;e===t&&(t=or(t)),i&&(s=ki(e,qi(i)));while(++a<r){var d=0,l=t[a],c=i?i(l):l;while((d=o(s,c,d,n))>-1)s!==e&&kt.call(s,d,1),kt.call(e,d,1)}return e}function va(e,t){var i=e?t.length:0,n=i-1;while(i--){var o=t[i];if(i==n||o!==a){var a=o;rs(o)?kt.call(e,o,1):Ma(e,o)}}return e}function ya(e,t){return e+jt(Wt()*(t-e+1))}function Sa(e,t,i,n){var o=-1,a=Ot(Bt((t-e)/(i||1)),0),r=O(a);while(a--)r[n?a:++o]=e,e+=i;return r}function _a(e,t){var i="";if(!e||t<1||t>j)return i;do{t%2&&(i+=e),t=jt(t/2),t&&(e+=e)}while(t);return i}function ba(e,t){return Es(_s(e,t,Rm),e+"")}function Ca(e){return ao(Uu(e))}function Ta(e,t){var i=Uu(e);return xs(i,vo(t,0,i.length))}function wa(e,t,n,o){if(!wc(e))return e;t=Ha(t,e);var a=-1,r=t.length,s=r-1,d=e;while(null!=d&&++a<r){var l=As(t[a]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(a!=s){var u=d[l];c=o?o(u,l,d):i,c===i&&(c=wc(u)?u:rs(t[a+1])?[]:{})}co(d,l,c),d=d[l]}return e}var ka=si?function(e,t){return si.set(e,t),e}:Rm,Ea=xt?function(e,t){return xt(e,"toString",{configurable:!0,enumerable:!1,value:Em(t),writable:!0})}:Rm;function Pa(e){return xs(Uu(e))}function Ia(e,t,i){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),i=i>o?o:i,i<0&&(i+=o),o=t>i?0:i-t>>>0,t>>>=0;var a=O(o);while(++n<o)a[n]=e[n+t];return a}function xa(e,t){var i;return To(e,(function(e,n,o){return i=t(e,n,o),!i})),!!i}function Ra(e,t,i){var n=0,o=null==e?n:e.length;if("number"==typeof t&&t===t&&o<=z){while(n<o){var a=n+o>>>1,r=e[a];null!==r&&!zc(r)&&(i?r<=t:r<t)?n=a+1:o=a}return o}return Aa(e,t,Rm,i)}function Aa(e,t,n,o){var a=0,r=null==e?0:e.length;if(0===r)return 0;t=n(t);var s=t!==t,d=null===t,l=zc(t),c=t===i;while(a<r){var u=jt((a+r)/2),m=n(e[u]),p=m!==i,h=null===m,f=m===m,g=zc(m);if(s)var v=o||f;else v=c?f&&(o||p):d?f&&p&&(o||!h):l?f&&p&&!h&&(o||!g):!h&&!g&&(o?m<=t:m<t);v?a=u+1:r=u}return Vt(r,F)}function Da(e,t){var i=-1,n=e.length,o=0,a=[];while(++i<n){var r=e[i],s=t?t(r):r;if(!i||!oc(s,d)){var d=s;a[o++]=0===r?0:r}}return a}function Ba(e){return"number"==typeof e?e:zc(e)?M:+e}function ja(e){if("string"==typeof e)return e;if(dc(e))return ki(e,ja)+"";if(zc(e))return bn?bn.call(e):"";var t=e+"";return"0"==t&&1/e==-B?"-0":t}function La(e,t,i){var n=-1,a=Ti,r=e.length,s=!0,d=[],l=d;if(i)s=!1,a=wi;else if(r>=o){var c=t?null:xr(e);if(c)return cn(c);s=!1,a=Ji,l=new Jn}else l=t?[]:d;e:while(++n<r){var u=e[n],m=t?t(u):u;if(u=i||0!==u?u:0,s&&m===m){var p=l.length;while(p--)if(l[p]===m)continue e;t&&l.push(m),d.push(u)}else a(l,m,i)||(l!==d&&l.push(m),d.push(u))}return d}function Ma(e,t){return t=Ha(t,e),e=bs(e,t),null==e||delete e[As(ad(t))]}function Na(e,t,i,n){return wa(e,t,i(Lo(e,t)),n)}function Fa(e,t,i,n){var o=e.length,a=n?o:-1;while((n?a--:++a<o)&&t(e[a],a,e));return i?Ia(e,n?0:a,n?a+1:o):Ia(e,n?a+1:0,n?o:a)}function za(e,t){var i=e;return i instanceof Pn&&(i=i.value()),Pi(t,(function(e,t){return t.func.apply(t.thisArg,Ei([e],t.args))}),i)}function Oa(e,t,i){var n=e.length;if(n<2)return n?La(e[0]):[];var o=-1,a=O(n);while(++o<n){var r=e[o],s=-1;while(++s<n)s!=o&&(a[o]=Co(a[o]||r,e[s],t,i))}return La(xo(a,1),t,i)}function Ua(e,t,n){var o=-1,a=e.length,r=t.length,s={};while(++o<a){var d=o<r?t[o]:i;n(s,e[o],d)}return s}function Za(e){return uc(e)?e:[]}function Va(e){return"function"==typeof e?e:Rm}function Ha(e,t){return dc(e)?e:ds(e,t)?[e]:Rs(Qc(e))}var Ga=ba;function Wa(e,t,n){var o=e.length;return n=n===i?o:n,!t&&n>=o?e:Ia(e,t,n)}var qa=Rt||function(e){return ai.clearTimeout(e)};function Ka(e,t){if(t)return e.slice();var i=e.length,n=bt?bt(i):new e.constructor(i);return e.copy(n),n}function Ja(e){var t=new e.constructor(e.byteLength);return new _t(t).set(new _t(e)),t}function $a(e,t){var i=t?Ja(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function Xa(e){var t=new e.constructor(e.source,Ge.exec(e));return t.lastIndex=e.lastIndex,t}function Ya(e){return Sn?it(Sn.call(e)):{}}function Qa(e,t){var i=t?Ja(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function er(e,t){if(e!==t){var n=e!==i,o=null===e,a=e===e,r=zc(e),s=t!==i,d=null===t,l=t===t,c=zc(t);if(!d&&!c&&!r&&e>t||r&&s&&l&&!d&&!c||o&&s&&l||!n&&l||!a)return 1;if(!o&&!r&&!c&&e<t||c&&n&&a&&!o&&!r||d&&n&&a||!s&&a||!l)return-1}return 0}function tr(e,t,i){var n=-1,o=e.criteria,a=t.criteria,r=o.length,s=i.length;while(++n<r){var d=er(o[n],a[n]);if(d){if(n>=s)return d;var l=i[n];return d*("desc"==l?-1:1)}}return e.index-t.index}function ir(e,t,i,n){var o=-1,a=e.length,r=i.length,s=-1,d=t.length,l=Ot(a-r,0),c=O(d+l),u=!n;while(++s<d)c[s]=t[s];while(++o<r)(u||o<a)&&(c[i[o]]=e[o]);while(l--)c[s++]=e[o++];return c}function nr(e,t,i,n){var o=-1,a=e.length,r=-1,s=i.length,d=-1,l=t.length,c=Ot(a-s,0),u=O(c+l),m=!n;while(++o<c)u[o]=e[o];var p=o;while(++d<l)u[p+d]=t[d];while(++r<s)(m||o<a)&&(u[p+i[r]]=e[o++]);return u}function or(e,t){var i=-1,n=e.length;t||(t=O(n));while(++i<n)t[i]=e[i];return t}function ar(e,t,n,o){var a=!n;n||(n={});var r=-1,s=t.length;while(++r<s){var d=t[r],l=o?o(n[d],e[d],d,n,e):i;l===i&&(l=e[d]),a?fo(n,d,l):co(n,d,l)}return n}function rr(e,t){return ar(e,Jr(e),t)}function sr(e,t){return ar(e,$r(e),t)}function dr(e,t){return function(i,n){var o=dc(i)?yi:mo,a=t?t():{};return o(i,e,Hr(n,2),a)}}function lr(e){return ba((function(t,n){var o=-1,a=n.length,r=a>1?n[a-1]:i,s=a>2?n[2]:i;r=e.length>3&&"function"==typeof r?(a--,r):i,s&&ss(n[0],n[1],s)&&(r=a<3?i:r,a=1),t=it(t);while(++o<a){var d=n[o];d&&e(t,d,o,r)}return t}))}function cr(e,t){return function(i,n){if(null==i)return i;if(!cc(i))return e(i,n);var o=i.length,a=t?o:-1,r=it(i);while(t?a--:++a<o)if(!1===n(r[a],a,r))break;return i}}function ur(e){return function(t,i,n){var o=-1,a=it(t),r=n(t),s=r.length;while(s--){var d=r[e?s:++o];if(!1===i(a[d],d,a))break}return t}}function mr(e,t,i){var n=t&g,o=fr(e);function a(){var t=this&&this!==ai&&this instanceof a?o:e;return t.apply(n?i:this,arguments)}return a}function pr(e){return function(t){t=Qc(t);var n=on(t)?fn(t):i,o=n?n[0]:t.charAt(0),a=n?Wa(n,1).join(""):t.slice(1);return o[e]()+a}}function hr(e){return function(t){return Pi(bm(Ku(t).replace(Ut,"")),e,"")}}function fr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=wn(e.prototype),n=e.apply(i,t);return wc(n)?n:i}}function gr(e,t,n){var o=fr(e);function a(){var r=arguments.length,s=O(r),d=r,l=Vr(a);while(d--)s[d]=arguments[d];var c=r<3&&s[0]!==l&&s[r-1]!==l?[]:ln(s,l);if(r-=c.length,r<n)return Pr(e,t,Sr,a.placeholder,i,s,c,i,i,n-r);var u=this&&this!==ai&&this instanceof a?o:e;return vi(u,this,s)}return a}function vr(e){return function(t,n,o){var a=it(t);if(!cc(t)){var r=Hr(n,3);t=Cu(t),n=function(e){return r(a[e],e,a)}}var s=e(t,n,o);return s>-1?a[r?t[s]:s]:i}}function yr(e){return Fr((function(t){var n=t.length,o=n,a=En.prototype.thru;e&&t.reverse();while(o--){var s=t[o];if("function"!=typeof s)throw new at(r);if(a&&!d&&"wrapper"==Zr(s))var d=new En([],!0)}o=d?o:n;while(++o<n){s=t[o];var l=Zr(s),c="wrapper"==l?Ur(s):i;d=c&&cs(c[0])&&c[1]==(T|S|b|w)&&!c[4].length&&1==c[9]?d[Zr(c[0])].apply(d,c[3]):1==s.length&&cs(s)?d[l]():d.thru(s)}return function(){var e=arguments,i=e[0];if(d&&1==e.length&&dc(i))return d.plant(i).value();var o=0,a=n?t[o].apply(this,e):i;while(++o<n)a=t[o].call(this,a);return a}}))}function Sr(e,t,n,o,a,r,s,d,l,c){var u=t&T,m=t&g,p=t&v,h=t&(S|_),f=t&k,y=p?i:fr(e);function b(){var i=arguments.length,g=O(i),v=i;while(v--)g[v]=arguments[v];if(h)var S=Vr(b),_=Yi(g,S);if(o&&(g=ir(g,o,a,h)),r&&(g=nr(g,r,s,h)),i-=_,h&&i<c){var C=ln(g,S);return Pr(e,t,Sr,b.placeholder,n,g,C,d,l,c-i)}var T=m?n:this,w=p?T[e]:e;return i=g.length,d?g=Cs(g,d):f&&i>1&&g.reverse(),u&&l<i&&(g.length=l),this&&this!==ai&&this instanceof b&&(w=y||fr(w)),w.apply(T,g)}return b}function _r(e,t){return function(i,n){return Vo(i,e,t(n),{})}}function br(e,t){return function(n,o){var a;if(n===i&&o===i)return t;if(n!==i&&(a=n),o!==i){if(a===i)return o;"string"==typeof n||"string"==typeof o?(n=ja(n),o=ja(o)):(n=Ba(n),o=Ba(o)),a=e(n,o)}return a}}function Cr(e){return Fr((function(t){return t=ki(t,qi(Hr())),ba((function(i){var n=this;return e(t,(function(e){return vi(e,n,i)}))}))}))}function Tr(e,t){t=t===i?" ":ja(t);var n=t.length;if(n<2)return n?_a(t,e):t;var o=_a(t,Bt(e/hn(t)));return on(t)?Wa(fn(o),0,e).join(""):o.slice(0,e)}function wr(e,t,i,n){var o=t&g,a=fr(e);function r(){var t=-1,s=arguments.length,d=-1,l=n.length,c=O(l+s),u=this&&this!==ai&&this instanceof r?a:e;while(++d<l)c[d]=n[d];while(s--)c[d++]=arguments[++t];return vi(u,o?i:this,c)}return r}function kr(e){return function(t,n,o){return o&&"number"!=typeof o&&ss(t,n,o)&&(n=o=i),t=qc(t),n===i?(n=t,t=0):n=qc(n),o=o===i?t<n?1:-1:qc(o),Sa(t,n,o,e)}}function Er(e){return function(t,i){return"string"==typeof t&&"string"==typeof i||(t=$c(t),i=$c(i)),e(t,i)}}function Pr(e,t,n,o,a,r,s,d,l,c){var u=t&S,m=u?s:i,p=u?i:s,h=u?r:i,f=u?i:r;t|=u?b:C,t&=~(u?C:b),t&y||(t&=~(g|v));var _=[e,t,a,h,m,f,p,d,l,c],T=n.apply(i,_);return cs(e)&&ws(T,_),T.placeholder=o,Ps(T,e,t)}function Ir(e){var t=tt[e];return function(e,i){if(e=$c(e),i=null==i?0:Vt(Kc(i),292),i&&Nt(e)){var n=(Qc(e)+"e").split("e"),o=t(n[0]+"e"+(+n[1]+i));return n=(Qc(o)+"e").split("e"),+(n[0]+"e"+(+n[1]-i))}return t(e)}}var xr=ni&&1/cn(new ni([,-0]))[1]==B?function(e){return new ni(e)}:Fm;function Rr(e){return function(t){var i=Xr(t);return i==X?sn(t):i==oe?un(t):Gi(t,e(t))}}function Ar(e,t,n,o,a,s,d,l){var c=t&v;if(!c&&"function"!=typeof e)throw new at(r);var u=o?o.length:0;if(u||(t&=~(b|C),o=a=i),d=d===i?d:Ot(Kc(d),0),l=l===i?l:Kc(l),u-=a?a.length:0,t&C){var m=o,p=a;o=a=i}var h=c?i:Ur(e),f=[e,t,n,o,a,m,p,s,d,l];if(h&&vs(f,h),e=f[0],t=f[1],n=f[2],o=f[3],a=f[4],l=f[9]=f[9]===i?c?0:e.length:Ot(f[9]-u,0),!l&&t&(S|_)&&(t&=~(S|_)),t&&t!=g)y=t==S||t==_?gr(e,t,l):t!=b&&t!=(g|b)||a.length?Sr.apply(i,f):wr(e,t,n,o);else var y=mr(e,t,n);var T=h?ka:ws;return Ps(T(y,f),e,t)}function Dr(e,t,n,o){return e===i||oc(e,dt[n])&&!ut.call(o,n)?t:e}function Br(e,t,n,o,a,r){return wc(e)&&wc(t)&&(r.set(t,e),la(e,t,i,Br,r),r["delete"](t)),e}function jr(e){return jc(e)?i:e}function Lr(e,t,n,o,a,r){var s=n&h,d=e.length,l=t.length;if(d!=l&&!(s&&l>d))return!1;var c=r.get(e),u=r.get(t);if(c&&u)return c==t&&u==e;var m=-1,p=!0,g=n&f?new Jn:i;r.set(e,t),r.set(t,e);while(++m<d){var v=e[m],y=t[m];if(o)var S=s?o(y,v,m,t,e,r):o(v,y,m,e,t,r);if(S!==i){if(S)continue;p=!1;break}if(g){if(!xi(t,(function(e,t){if(!Ji(g,t)&&(v===e||a(v,e,n,o,r)))return g.push(t)}))){p=!1;break}}else if(v!==y&&!a(v,y,n,o,r)){p=!1;break}}return r["delete"](e),r["delete"](t),p}function Mr(e,t,i,n,o,a,r){switch(i){case ue:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ce:return!(e.byteLength!=t.byteLength||!a(new _t(e),new _t(t)));case G:case W:case Y:return oc(+e,+t);case K:return e.name==t.name&&e.message==t.message;case ne:case ae:return e==t+"";case X:var s=sn;case oe:var d=n&h;if(s||(s=cn),e.size!=t.size&&!d)return!1;var l=r.get(e);if(l)return l==t;n|=f,r.set(e,t);var c=Lr(s(e),s(t),n,o,a,r);return r["delete"](e),c;case re:if(Sn)return Sn.call(e)==Sn.call(t)}return!1}function Nr(e,t,n,o,a,r){var s=n&h,d=zr(e),l=d.length,c=zr(t),u=c.length;if(l!=u&&!s)return!1;var m=l;while(m--){var p=d[m];if(!(s?p in t:ut.call(t,p)))return!1}var f=r.get(e),g=r.get(t);if(f&&g)return f==t&&g==e;var v=!0;r.set(e,t),r.set(t,e);var y=s;while(++m<l){p=d[m];var S=e[p],_=t[p];if(o)var b=s?o(_,S,p,t,e,r):o(S,_,p,e,t,r);if(!(b===i?S===_||a(S,_,n,o,r):b)){v=!1;break}y||(y="constructor"==p)}if(v&&!y){var C=e.constructor,T=t.constructor;C==T||!("constructor"in e)||!("constructor"in t)||"function"==typeof C&&C instanceof C&&"function"==typeof T&&T instanceof T||(v=!1)}return r["delete"](e),r["delete"](t),v}function Fr(e){return Es(_s(e,i,Ks),e+"")}function zr(e){return Mo(e,Cu,Jr)}function Or(e){return Mo(e,Tu,$r)}var Ur=si?function(e){return si.get(e)}:Fm;function Zr(e){var t=e.name+"",i=li[t],n=ut.call(li,t)?i.length:0;while(n--){var o=i[n],a=o.func;if(null==a||a==e)return o.name}return t}function Vr(e){var t=ut.call(Tn,"placeholder")?Tn:e;return t.placeholder}function Hr(){var e=Tn.iteratee||Am;return e=e===Am?ia:e,arguments.length?e(arguments[0],arguments[1]):e}function Gr(e,t){var i=e.__data__;return ls(t)?i["string"==typeof t?"string":"hash"]:i.map}function Wr(e){var t=Cu(e),i=t.length;while(i--){var n=t[i],o=e[n];t[i]=[n,o,hs(o)]}return t}function qr(e,t){var n=nn(e,t);return Yo(n)?n:i}function Kr(e){var t=ut.call(e,It),n=e[It];try{e[It]=i;var o=!0}catch(r){}var a=ht.call(e);return o&&(t?e[It]=n:delete e[It]),a}var Jr=Lt?function(e){return null==e?[]:(e=it(e),Ci(Lt(e),(function(t){return wt.call(e,t)})))}:qm,$r=Lt?function(e){var t=[];while(e)Ei(t,Jr(e)),e=Ct(e);return t}:qm,Xr=No;function Yr(e,t,i){var n=-1,o=i.length;while(++n<o){var a=i[n],r=a.size;switch(a.type){case"drop":e+=r;break;case"dropRight":t-=r;break;case"take":t=Vt(t,e+r);break;case"takeRight":e=Ot(e,t-r);break}}return{start:e,end:t}}function Qr(e){var t=e.match(ze);return t?t[1].split(Oe):[]}function es(e,t,i){t=Ha(t,e);var n=-1,o=t.length,a=!1;while(++n<o){var r=As(t[n]);if(!(a=null!=e&&i(e,r)))break;e=e[r]}return a||++n!=o?a:(o=null==e?0:e.length,!!o&&Tc(o)&&rs(r,o)&&(dc(e)||sc(e)))}function ts(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&ut.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function is(e){return"function"!=typeof e.constructor||ps(e)?{}:wn(Ct(e))}function ns(e,t,i){var n=e.constructor;switch(t){case ce:return Ja(e);case G:case W:return new n(+e);case ue:return $a(e,i);case me:case pe:case he:case fe:case ge:case ve:case ye:case Se:case _e:return Qa(e,i);case X:return new n;case Y:case ae:return new n(e);case ne:return Xa(e);case oe:return new n;case re:return Ya(e)}}function os(e,t){var i=t.length;if(!i)return e;var n=i-1;return t[n]=(i>1?"& ":"")+t[n],t=t.join(i>2?", ":" "),e.replace(Fe,"{\n/* [wrapped with "+t+"] */\n")}function as(e){return dc(e)||sc(e)||!!(Et&&e&&e[Et])}function rs(e,t){var i=typeof e;return t=null==t?j:t,!!t&&("number"==i||"symbol"!=i&&$e.test(e))&&e>-1&&e%1==0&&e<t}function ss(e,t,i){if(!wc(i))return!1;var n=typeof t;return!!("number"==n?cc(i)&&rs(t,i.length):"string"==n&&t in i)&&oc(i[t],e)}function ds(e,t){if(dc(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!zc(e))||(De.test(e)||!Ae.test(e)||null!=t&&e in it(t))}function ls(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function cs(e){var t=Zr(e),i=Tn[t];if("function"!=typeof i||!(t in Pn.prototype))return!1;if(e===i)return!0;var n=Ur(i);return!!n&&e===n[0]}function us(e){return!!pt&&pt in e}(Yt&&Xr(new Yt(new ArrayBuffer(1)))!=ue||Qt&&Xr(new Qt)!=X||ei&&Xr(ei.resolve())!=te||ni&&Xr(new ni)!=oe||oi&&Xr(new oi)!=de)&&(Xr=function(e){var t=No(e),n=t==ee?e.constructor:i,o=n?Ds(n):"";if(o)switch(o){case ci:return ue;case Ri:return X;case Ai:return te;case Oi:return oe;case mn:return de}return t});var ms=lt?bc:Km;function ps(e){var t=e&&e.constructor,i="function"==typeof t&&t.prototype||dt;return e===i}function hs(e){return e===e&&!wc(e)}function fs(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==i||e in it(n)))}}function gs(e){var t=Ol(e,(function(e){return i.size===l&&i.clear(),e})),i=t.cache;return t}function vs(e,t){var i=e[1],n=t[1],o=i|n,a=o<(g|v|T),r=n==T&&i==S||n==T&&i==w&&e[7].length<=t[8]||n==(T|w)&&t[7].length<=t[8]&&i==S;if(!a&&!r)return e;n&g&&(e[2]=t[2],o|=i&g?0:y);var s=t[3];if(s){var d=e[3];e[3]=d?ir(d,s,t[4]):s,e[4]=d?ln(e[3],c):t[4]}return s=t[5],s&&(d=e[5],e[5]=d?nr(d,s,t[6]):s,e[6]=d?ln(e[5],c):t[6]),s=t[7],s&&(e[7]=s),n&T&&(e[8]=null==e[8]?t[8]:Vt(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e}function ys(e){var t=[];if(null!=e)for(var i in it(e))t.push(i);return t}function Ss(e){return ht.call(e)}function _s(e,t,n){return t=Ot(t===i?e.length-1:t,0),function(){var i=arguments,o=-1,a=Ot(i.length-t,0),r=O(a);while(++o<a)r[o]=i[t+o];o=-1;var s=O(t+1);while(++o<t)s[o]=i[o];return s[t]=n(r),vi(e,this,s)}}function bs(e,t){return t.length<2?e:Lo(e,Ia(t,0,-1))}function Cs(e,t){var n=e.length,o=Vt(t.length,n),a=or(e);while(o--){var r=t[o];e[o]=rs(r,n)?a[r]:i}return e}function Ts(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var ws=Is(ka),ks=Dt||function(e,t){return ai.setTimeout(e,t)},Es=Is(Ea);function Ps(e,t,i){var n=t+"";return Es(e,os(n,Bs(Qr(n),i)))}function Is(e){var t=0,n=0;return function(){var o=Ht(),a=x-(o-n);if(n=o,a>0){if(++t>=I)return arguments[0]}else t=0;return e.apply(i,arguments)}}function xs(e,t){var n=-1,o=e.length,a=o-1;t=t===i?o:t;while(++n<t){var r=ya(n,a),s=e[r];e[r]=e[n],e[n]=s}return e.length=t,e}var Rs=gs((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Be,(function(e,i,n,o){t.push(n?o.replace(Ve,"$1"):i||e)})),t}));function As(e){if("string"==typeof e||zc(e))return e;var t=e+"";return"0"==t&&1/e==-B?"-0":t}function Ds(e){if(null!=e){try{return ct.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Bs(e,t){return Si(U,(function(i){var n="_."+i[0];t&i[1]&&!Ti(e,n)&&e.push(n)})),e.sort()}function js(e){if(e instanceof Pn)return e.clone();var t=new En(e.__wrapped__,e.__chain__);return t.__actions__=or(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Ls(e,t,n){t=(n?ss(e,t,n):t===i)?1:Ot(Kc(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];var a=0,r=0,s=O(Bt(o/t));while(a<o)s[r++]=Ia(e,a,a+=t);return s}function Ms(e){var t=-1,i=null==e?0:e.length,n=0,o=[];while(++t<i){var a=e[t];a&&(o[n++]=a)}return o}function Ns(){var e=arguments.length;if(!e)return[];var t=O(e-1),i=arguments[0],n=e;while(n--)t[n-1]=arguments[n];return Ei(dc(i)?or(i):[i],xo(t,1))}var Fs=ba((function(e,t){return uc(e)?Co(e,xo(t,1,uc,!0)):[]})),zs=ba((function(e,t){var n=ad(t);return uc(n)&&(n=i),uc(e)?Co(e,xo(t,1,uc,!0),Hr(n,2)):[]})),Os=ba((function(e,t){var n=ad(t);return uc(n)&&(n=i),uc(e)?Co(e,xo(t,1,uc,!0),i,n):[]}));function Us(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===i?1:Kc(t),Ia(e,t<0?0:t,o)):[]}function Zs(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===i?1:Kc(t),t=o-t,Ia(e,0,t<0?0:t)):[]}function Vs(e,t){return e&&e.length?Fa(e,Hr(t,3),!0,!0):[]}function Hs(e,t){return e&&e.length?Fa(e,Hr(t,3),!0):[]}function Gs(e,t,i,n){var o=null==e?0:e.length;return o?(i&&"number"!=typeof i&&ss(e,t,i)&&(i=0,n=o),Po(e,t,i,n)):[]}function Ws(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var o=null==i?0:Kc(i);return o<0&&(o=Ot(n+o,0)),ji(e,Hr(t,3),o)}function qs(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var a=o-1;return n!==i&&(a=Kc(n),a=n<0?Ot(o+a,0):Vt(a,o-1)),ji(e,Hr(t,3),a,!0)}function Ks(e){var t=null==e?0:e.length;return t?xo(e,1):[]}function Js(e){var t=null==e?0:e.length;return t?xo(e,B):[]}function $s(e,t){var n=null==e?0:e.length;return n?(t=t===i?1:Kc(t),xo(e,t)):[]}function Xs(e){var t=-1,i=null==e?0:e.length,n={};while(++t<i){var o=e[t];n[o[0]]=o[1]}return n}function Ys(e){return e&&e.length?e[0]:i}function Qs(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var o=null==i?0:Kc(i);return o<0&&(o=Ot(n+o,0)),Li(e,t,o)}function ed(e){var t=null==e?0:e.length;return t?Ia(e,0,-1):[]}var td=ba((function(e){var t=ki(e,Za);return t.length&&t[0]===e[0]?Zo(t):[]})),id=ba((function(e){var t=ad(e),n=ki(e,Za);return t===ad(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Zo(n,Hr(t,2)):[]})),nd=ba((function(e){var t=ad(e),n=ki(e,Za);return t="function"==typeof t?t:i,t&&n.pop(),n.length&&n[0]===e[0]?Zo(n,i,t):[]}));function od(e,t){return null==e?"":Ft.call(e,t)}function ad(e){var t=null==e?0:e.length;return t?e[t-1]:i}function rd(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var a=o;return n!==i&&(a=Kc(n),a=a<0?Ot(o+a,0):Vt(a,o-1)),t===t?pn(e,t,a):ji(e,Ni,a,!0)}function sd(e,t){return e&&e.length?ua(e,Kc(t)):i}var dd=ba(ld);function ld(e,t){return e&&e.length&&t&&t.length?ga(e,t):e}function cd(e,t,i){return e&&e.length&&t&&t.length?ga(e,t,Hr(i,2)):e}function ud(e,t,n){return e&&e.length&&t&&t.length?ga(e,t,i,n):e}var md=Fr((function(e,t){var i=null==e?0:e.length,n=go(e,t);return va(e,ki(t,(function(e){return rs(e,i)?+e:e})).sort(er)),n}));function pd(e,t){var i=[];if(!e||!e.length)return i;var n=-1,o=[],a=e.length;t=Hr(t,3);while(++n<a){var r=e[n];t(r,n,e)&&(i.push(r),o.push(n))}return va(e,o),i}function hd(e){return null==e?e:Xt.call(e)}function fd(e,t,n){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&ss(e,t,n)?(t=0,n=o):(t=null==t?0:Kc(t),n=n===i?o:Kc(n)),Ia(e,t,n)):[]}function gd(e,t){return Ra(e,t)}function vd(e,t,i){return Aa(e,t,Hr(i,2))}function yd(e,t){var i=null==e?0:e.length;if(i){var n=Ra(e,t);if(n<i&&oc(e[n],t))return n}return-1}function Sd(e,t){return Ra(e,t,!0)}function _d(e,t,i){return Aa(e,t,Hr(i,2),!0)}function bd(e,t){var i=null==e?0:e.length;if(i){var n=Ra(e,t,!0)-1;if(oc(e[n],t))return n}return-1}function Cd(e){return e&&e.length?Da(e):[]}function Td(e,t){return e&&e.length?Da(e,Hr(t,2)):[]}function wd(e){var t=null==e?0:e.length;return t?Ia(e,1,t):[]}function kd(e,t,n){return e&&e.length?(t=n||t===i?1:Kc(t),Ia(e,0,t<0?0:t)):[]}function Ed(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===i?1:Kc(t),t=o-t,Ia(e,t<0?0:t,o)):[]}function Pd(e,t){return e&&e.length?Fa(e,Hr(t,3),!1,!0):[]}function Id(e,t){return e&&e.length?Fa(e,Hr(t,3)):[]}var xd=ba((function(e){return La(xo(e,1,uc,!0))})),Rd=ba((function(e){var t=ad(e);return uc(t)&&(t=i),La(xo(e,1,uc,!0),Hr(t,2))})),Ad=ba((function(e){var t=ad(e);return t="function"==typeof t?t:i,La(xo(e,1,uc,!0),i,t)}));function Dd(e){return e&&e.length?La(e):[]}function Bd(e,t){return e&&e.length?La(e,Hr(t,2)):[]}function jd(e,t){return t="function"==typeof t?t:i,e&&e.length?La(e,i,t):[]}function Ld(e){if(!e||!e.length)return[];var t=0;return e=Ci(e,(function(e){if(uc(e))return t=Ot(e.length,t),!0})),Hi(t,(function(t){return ki(e,zi(t))}))}function Md(e,t){if(!e||!e.length)return[];var n=Ld(e);return null==t?n:ki(n,(function(e){return vi(t,i,e)}))}var Nd=ba((function(e,t){return uc(e)?Co(e,t):[]})),Fd=ba((function(e){return Oa(Ci(e,uc))})),zd=ba((function(e){var t=ad(e);return uc(t)&&(t=i),Oa(Ci(e,uc),Hr(t,2))})),Od=ba((function(e){var t=ad(e);return t="function"==typeof t?t:i,Oa(Ci(e,uc),i,t)})),Ud=ba(Ld);function Zd(e,t){return Ua(e||[],t||[],co)}function Vd(e,t){return Ua(e||[],t||[],wa)}var Hd=ba((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,Md(e,n)}));function Gd(e){var t=Tn(e);return t.__chain__=!0,t}function Wd(e,t){return t(e),e}function qd(e,t){return t(e)}var Kd=Fr((function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,a=function(t){return go(t,e)};return!(t>1||this.__actions__.length)&&o instanceof Pn&&rs(n)?(o=o.slice(n,+n+(t?1:0)),o.__actions__.push({func:qd,args:[a],thisArg:i}),new En(o,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(a)}));function Jd(){return Gd(this)}function $d(){return new En(this.value(),this.__chain__)}function Xd(){this.__values__===i&&(this.__values__=Wc(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function Yd(){return this}function Qd(e){var t,n=this;while(n instanceof kn){var o=js(n);o.__index__=0,o.__values__=i,t?a.__wrapped__=o:t=o;var a=o;n=n.__wrapped__}return a.__wrapped__=e,t}function el(){var e=this.__wrapped__;if(e instanceof Pn){var t=e;return this.__actions__.length&&(t=new Pn(this)),t=t.reverse(),t.__actions__.push({func:qd,args:[hd],thisArg:i}),new En(t,this.__chain__)}return this.thru(hd)}function tl(){return za(this.__wrapped__,this.__actions__)}var il=dr((function(e,t,i){ut.call(e,i)?++e[i]:fo(e,i,1)}));function nl(e,t,n){var o=dc(e)?bi:ko;return n&&ss(e,t,n)&&(t=i),o(e,Hr(t,3))}function ol(e,t){var i=dc(e)?Ci:Io;return i(e,Hr(t,3))}var al=vr(Ws),rl=vr(qs);function sl(e,t){return xo(gl(e,t),1)}function dl(e,t){return xo(gl(e,t),B)}function ll(e,t,n){return n=n===i?1:Kc(n),xo(gl(e,t),n)}function cl(e,t){var i=dc(e)?Si:To;return i(e,Hr(t,3))}function ul(e,t){var i=dc(e)?_i:wo;return i(e,Hr(t,3))}var ml=dr((function(e,t,i){ut.call(e,i)?e[i].push(t):fo(e,i,[t])}));function pl(e,t,i,n){e=cc(e)?e:Uu(e),i=i&&!n?Kc(i):0;var o=e.length;return i<0&&(i=Ot(o+i,0)),Fc(e)?i<=o&&e.indexOf(t,i)>-1:!!o&&Li(e,t,i)>-1}var hl=ba((function(e,t,i){var n=-1,o="function"==typeof t,a=cc(e)?O(e.length):[];return To(e,(function(e){a[++n]=o?vi(t,e,i):Ho(e,t,i)})),a})),fl=dr((function(e,t,i){fo(e,i,t)}));function gl(e,t){var i=dc(e)?ki:ra;return i(e,Hr(t,3))}function vl(e,t,n,o){return null==e?[]:(dc(t)||(t=null==t?[]:[t]),n=o?i:n,dc(n)||(n=null==n?[]:[n]),ma(e,t,n))}var yl=dr((function(e,t,i){e[i?0:1].push(t)}),(function(){return[[],[]]}));function Sl(e,t,i){var n=dc(e)?Pi:Ui,o=arguments.length<3;return n(e,Hr(t,4),i,o,To)}function _l(e,t,i){var n=dc(e)?Ii:Ui,o=arguments.length<3;return n(e,Hr(t,4),i,o,wo)}function bl(e,t){var i=dc(e)?Ci:Io;return i(e,Ul(Hr(t,3)))}function Cl(e){var t=dc(e)?ao:Ca;return t(e)}function Tl(e,t,n){t=(n?ss(e,t,n):t===i)?1:Kc(t);var o=dc(e)?ro:Ta;return o(e,t)}function wl(e){var t=dc(e)?so:Pa;return t(e)}function kl(e){if(null==e)return 0;if(cc(e))return Fc(e)?hn(e):e.length;var t=Xr(e);return t==X||t==oe?e.size:na(e).length}function El(e,t,n){var o=dc(e)?xi:xa;return n&&ss(e,t,n)&&(t=i),o(e,Hr(t,3))}var Pl=ba((function(e,t){if(null==e)return[];var i=t.length;return i>1&&ss(e,t[0],t[1])?t=[]:i>2&&ss(t[0],t[1],t[2])&&(t=[t[0]]),ma(e,xo(t,1),[])})),Il=At||function(){return ai.Date.now()};function xl(e,t){if("function"!=typeof t)throw new at(r);return e=Kc(e),function(){if(--e<1)return t.apply(this,arguments)}}function Rl(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Ar(e,T,i,i,i,i,t)}function Al(e,t){var n;if("function"!=typeof t)throw new at(r);return e=Kc(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Dl=ba((function(e,t,i){var n=g;if(i.length){var o=ln(i,Vr(Dl));n|=b}return Ar(e,n,t,i,o)})),Bl=ba((function(e,t,i){var n=g|v;if(i.length){var o=ln(i,Vr(Bl));n|=b}return Ar(t,n,e,i,o)}));function jl(e,t,n){t=n?i:t;var o=Ar(e,S,i,i,i,i,i,t);return o.placeholder=jl.placeholder,o}function Ll(e,t,n){t=n?i:t;var o=Ar(e,_,i,i,i,i,i,t);return o.placeholder=Ll.placeholder,o}function Ml(e,t,n){var o,a,s,d,l,c,u=0,m=!1,p=!1,h=!0;if("function"!=typeof e)throw new at(r);function f(t){var n=o,r=a;return o=a=i,u=t,d=e.apply(r,n),d}function g(e){return u=e,l=ks(S,t),m?f(e):d}function v(e){var i=e-c,n=e-u,o=t-i;return p?Vt(o,s-n):o}function y(e){var n=e-c,o=e-u;return c===i||n>=t||n<0||p&&o>=s}function S(){var e=Il();if(y(e))return _(e);l=ks(S,v(e))}function _(e){return l=i,h&&o?f(e):(o=a=i,d)}function b(){l!==i&&qa(l),u=0,o=c=a=l=i}function C(){return l===i?d:_(Il())}function T(){var e=Il(),n=y(e);if(o=arguments,a=this,c=e,n){if(l===i)return g(c);if(p)return qa(l),l=ks(S,t),f(c)}return l===i&&(l=ks(S,t)),d}return t=$c(t)||0,wc(n)&&(m=!!n.leading,p="maxWait"in n,s=p?Ot($c(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),T.cancel=b,T.flush=C,T}var Nl=ba((function(e,t){return bo(e,1,t)})),Fl=ba((function(e,t,i){return bo(e,$c(t)||0,i)}));function zl(e){return Ar(e,k)}function Ol(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new at(r);var i=function(){var n=arguments,o=t?t.apply(this,n):n[0],a=i.cache;if(a.has(o))return a.get(o);var r=e.apply(this,n);return i.cache=a.set(o,r)||a,r};return i.cache=new(Ol.Cache||Vn),i}function Ul(e){if("function"!=typeof e)throw new at(r);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Zl(e){return Al(2,e)}Ol.Cache=Vn;var Vl=Ga((function(e,t){t=1==t.length&&dc(t[0])?ki(t[0],qi(Hr())):ki(xo(t,1),qi(Hr()));var i=t.length;return ba((function(n){var o=-1,a=Vt(n.length,i);while(++o<a)n[o]=t[o].call(this,n[o]);return vi(e,this,n)}))})),Hl=ba((function(e,t){var n=ln(t,Vr(Hl));return Ar(e,b,i,t,n)})),Gl=ba((function(e,t){var n=ln(t,Vr(Gl));return Ar(e,C,i,t,n)})),Wl=Fr((function(e,t){return Ar(e,w,i,i,i,t)}));function ql(e,t){if("function"!=typeof e)throw new at(r);return t=t===i?t:Kc(t),ba(e,t)}function Kl(e,t){if("function"!=typeof e)throw new at(r);return t=null==t?0:Ot(Kc(t),0),ba((function(i){var n=i[t],o=Wa(i,0,t);return n&&Ei(o,n),vi(e,this,o)}))}function Jl(e,t,i){var n=!0,o=!0;if("function"!=typeof e)throw new at(r);return wc(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),Ml(e,t,{leading:n,maxWait:t,trailing:o})}function $l(e){return Rl(e,1)}function Xl(e,t){return Hl(Va(t),e)}function Yl(){if(!arguments.length)return[];var e=arguments[0];return dc(e)?e:[e]}function Ql(e){return yo(e,p)}function ec(e,t){return t="function"==typeof t?t:i,yo(e,p,t)}function tc(e){return yo(e,u|p)}function ic(e,t){return t="function"==typeof t?t:i,yo(e,u|p,t)}function nc(e,t){return null==t||_o(e,t,Cu(t))}function oc(e,t){return e===t||e!==e&&t!==t}var ac=Er(Fo),rc=Er((function(e,t){return e>=t})),sc=Go(function(){return arguments}())?Go:function(e){return kc(e)&&ut.call(e,"callee")&&!wt.call(e,"callee")},dc=O.isArray,lc=ui?qi(ui):Wo;function cc(e){return null!=e&&Tc(e.length)&&!bc(e)}function uc(e){return kc(e)&&cc(e)}function mc(e){return!0===e||!1===e||kc(e)&&No(e)==G}var pc=Mt||Km,hc=mi?qi(mi):qo;function fc(e){return kc(e)&&1===e.nodeType&&!jc(e)}function gc(e){if(null==e)return!0;if(cc(e)&&(dc(e)||"string"==typeof e||"function"==typeof e.splice||pc(e)||Oc(e)||sc(e)))return!e.length;var t=Xr(e);if(t==X||t==oe)return!e.size;if(ps(e))return!na(e).length;for(var i in e)if(ut.call(e,i))return!1;return!0}function vc(e,t){return Ko(e,t)}function yc(e,t,n){n="function"==typeof n?n:i;var o=n?n(e,t):i;return o===i?Ko(e,t,i,n):!!o}function Sc(e){if(!kc(e))return!1;var t=No(e);return t==K||t==q||"string"==typeof e.message&&"string"==typeof e.name&&!jc(e)}function _c(e){return"number"==typeof e&&Nt(e)}function bc(e){if(!wc(e))return!1;var t=No(e);return t==J||t==$||t==H||t==ie}function Cc(e){return"number"==typeof e&&e==Kc(e)}function Tc(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=j}function wc(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function kc(e){return null!=e&&"object"==typeof e}var Ec=pi?qi(pi):$o;function Pc(e,t){return e===t||Xo(e,t,Wr(t))}function Ic(e,t,n){return n="function"==typeof n?n:i,Xo(e,t,Wr(t),n)}function xc(e){return Bc(e)&&e!=+e}function Rc(e){if(ms(e))throw new Ue(a);return Yo(e)}function Ac(e){return null===e}function Dc(e){return null==e}function Bc(e){return"number"==typeof e||kc(e)&&No(e)==Y}function jc(e){if(!kc(e)||No(e)!=ee)return!1;var t=Ct(e);if(null===t)return!0;var i=ut.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&ct.call(i)==ft}var Lc=hi?qi(hi):Qo;function Mc(e){return Cc(e)&&e>=-j&&e<=j}var Nc=fi?qi(fi):ea;function Fc(e){return"string"==typeof e||!dc(e)&&kc(e)&&No(e)==ae}function zc(e){return"symbol"==typeof e||kc(e)&&No(e)==re}var Oc=gi?qi(gi):ta;function Uc(e){return e===i}function Zc(e){return kc(e)&&Xr(e)==de}function Vc(e){return kc(e)&&No(e)==le}var Hc=Er(aa),Gc=Er((function(e,t){return e<=t}));function Wc(e){if(!e)return[];if(cc(e))return Fc(e)?fn(e):or(e);if(Pt&&e[Pt])return rn(e[Pt]());var t=Xr(e),i=t==X?sn:t==oe?cn:Uu;return i(e)}function qc(e){if(!e)return 0===e?e:0;if(e=$c(e),e===B||e===-B){var t=e<0?-1:1;return t*L}return e===e?e:0}function Kc(e){var t=qc(e),i=t%1;return t===t?i?t-i:t:0}function Jc(e){return e?vo(Kc(e),0,N):0}function $c(e){if("number"==typeof e)return e;if(zc(e))return M;if(wc(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=wc(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Wi(e);var i=qe.test(e);return i||Je.test(e)?ii(e.slice(2),i?2:8):We.test(e)?M:+e}function Xc(e){return ar(e,Tu(e))}function Yc(e){return e?vo(Kc(e),-j,j):0===e?e:0}function Qc(e){return null==e?"":ja(e)}var eu=lr((function(e,t){if(ps(t)||cc(t))ar(t,Cu(t),e);else for(var i in t)ut.call(t,i)&&co(e,i,t[i])})),tu=lr((function(e,t){ar(t,Tu(t),e)})),iu=lr((function(e,t,i,n){ar(t,Tu(t),e,n)})),nu=lr((function(e,t,i,n){ar(t,Cu(t),e,n)})),ou=Fr(go);function au(e,t){var i=wn(e);return null==t?i:po(i,t)}var ru=ba((function(e,t){e=it(e);var n=-1,o=t.length,a=o>2?t[2]:i;a&&ss(t[0],t[1],a)&&(o=1);while(++n<o){var r=t[n],s=Tu(r),d=-1,l=s.length;while(++d<l){var c=s[d],u=e[c];(u===i||oc(u,dt[c])&&!ut.call(e,c))&&(e[c]=r[c])}}return e})),su=ba((function(e){return e.push(i,Br),vi(Pu,i,e)}));function du(e,t){return Bi(e,Hr(t,3),Do)}function lu(e,t){return Bi(e,Hr(t,3),Bo)}function cu(e,t){return null==e?e:Ro(e,Hr(t,3),Tu)}function uu(e,t){return null==e?e:Ao(e,Hr(t,3),Tu)}function mu(e,t){return e&&Do(e,Hr(t,3))}function pu(e,t){return e&&Bo(e,Hr(t,3))}function hu(e){return null==e?[]:jo(e,Cu(e))}function fu(e){return null==e?[]:jo(e,Tu(e))}function gu(e,t,n){var o=null==e?i:Lo(e,t);return o===i?n:o}function vu(e,t){return null!=e&&es(e,t,zo)}function yu(e,t){return null!=e&&es(e,t,Oo)}var Su=_r((function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=ht.call(t)),e[t]=i}),Em(Rm)),_u=_r((function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=ht.call(t)),ut.call(e,t)?e[t].push(i):e[t]=[i]}),Hr),bu=ba(Ho);function Cu(e){return cc(e)?oo(e):na(e)}function Tu(e){return cc(e)?oo(e,!0):oa(e)}function wu(e,t){var i={};return t=Hr(t,3),Do(e,(function(e,n,o){fo(i,t(e,n,o),e)})),i}function ku(e,t){var i={};return t=Hr(t,3),Do(e,(function(e,n,o){fo(i,n,t(e,n,o))})),i}var Eu=lr((function(e,t,i){la(e,t,i)})),Pu=lr((function(e,t,i,n){la(e,t,i,n)})),Iu=Fr((function(e,t){var i={};if(null==e)return i;var n=!1;t=ki(t,(function(t){return t=Ha(t,e),n||(n=t.length>1),t})),ar(e,Or(e),i),n&&(i=yo(i,u|m|p,jr));var o=t.length;while(o--)Ma(i,t[o]);return i}));function xu(e,t){return Au(e,Ul(Hr(t)))}var Ru=Fr((function(e,t){return null==e?{}:pa(e,t)}));function Au(e,t){if(null==e)return{};var i=ki(Or(e),(function(e){return[e]}));return t=Hr(t),ha(e,i,(function(e,i){return t(e,i[0])}))}function Du(e,t,n){t=Ha(t,e);var o=-1,a=t.length;a||(a=1,e=i);while(++o<a){var r=null==e?i:e[As(t[o])];r===i&&(o=a,r=n),e=bc(r)?r.call(e):r}return e}function Bu(e,t,i){return null==e?e:wa(e,t,i)}function ju(e,t,n,o){return o="function"==typeof o?o:i,null==e?e:wa(e,t,n,o)}var Lu=Rr(Cu),Mu=Rr(Tu);function Nu(e,t,i){var n=dc(e),o=n||pc(e)||Oc(e);if(t=Hr(t,4),null==i){var a=e&&e.constructor;i=o?n?new a:[]:wc(e)&&bc(a)?wn(Ct(e)):{}}return(o?Si:Do)(e,(function(e,n,o){return t(i,e,n,o)})),i}function Fu(e,t){return null==e||Ma(e,t)}function zu(e,t,i){return null==e?e:Na(e,t,Va(i))}function Ou(e,t,n,o){return o="function"==typeof o?o:i,null==e?e:Na(e,t,Va(n),o)}function Uu(e){return null==e?[]:Ki(e,Cu(e))}function Zu(e){return null==e?[]:Ki(e,Tu(e))}function Vu(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=$c(n),n=n===n?n:0),t!==i&&(t=$c(t),t=t===t?t:0),vo($c(e),t,n)}function Hu(e,t,n){return t=qc(t),n===i?(n=t,t=0):n=qc(n),e=$c(e),Uo(e,t,n)}function Gu(e,t,n){if(n&&"boolean"!=typeof n&&ss(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=qc(e),t===i?(t=e,e=0):t=qc(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var a=Wt();return Vt(e+a*(t-e+ti("1e-"+((a+"").length-1))),t)}return ya(e,t)}var Wu=hr((function(e,t,i){return t=t.toLowerCase(),e+(i?qu(t):t)}));function qu(e){return _m(Qc(e).toLowerCase())}function Ku(e){return e=Qc(e),e&&e.replace(Xe,Qi).replace(Zt,"")}function Ju(e,t,n){e=Qc(e),t=ja(t);var o=e.length;n=n===i?o:vo(Kc(n),0,o);var a=n;return n-=t.length,n>=0&&e.slice(n,a)==t}function $u(e){return e=Qc(e),e&&Pe.test(e)?e.replace(ke,en):e}function Xu(e){return e=Qc(e),e&&Le.test(e)?e.replace(je,"\\$&"):e}var Yu=hr((function(e,t,i){return e+(i?"-":"")+t.toLowerCase()})),Qu=hr((function(e,t,i){return e+(i?" ":"")+t.toLowerCase()})),em=pr("toLowerCase");function tm(e,t,i){e=Qc(e),t=Kc(t);var n=t?hn(e):0;if(!t||n>=t)return e;var o=(t-n)/2;return Tr(jt(o),i)+e+Tr(Bt(o),i)}function im(e,t,i){e=Qc(e),t=Kc(t);var n=t?hn(e):0;return t&&n<t?e+Tr(t-n,i):e}function nm(e,t,i){e=Qc(e),t=Kc(t);var n=t?hn(e):0;return t&&n<t?Tr(t-n,i)+e:e}function om(e,t,i){return i||null==t?t=0:t&&(t=+t),Gt(Qc(e).replace(Me,""),t||0)}function am(e,t,n){return t=(n?ss(e,t,n):t===i)?1:Kc(t),_a(Qc(e),t)}function rm(){var e=arguments,t=Qc(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var sm=hr((function(e,t,i){return e+(i?"_":"")+t.toLowerCase()}));function dm(e,t,n){return n&&"number"!=typeof n&&ss(e,t,n)&&(t=n=i),n=n===i?N:n>>>0,n?(e=Qc(e),e&&("string"==typeof t||null!=t&&!Lc(t))&&(t=ja(t),!t&&on(e))?Wa(fn(e),0,n):e.split(t,n)):[]}var lm=hr((function(e,t,i){return e+(i?" ":"")+_m(t)}));function cm(e,t,i){return e=Qc(e),i=null==i?0:vo(Kc(i),0,e.length),t=ja(t),e.slice(i,i+t.length)==t}function um(e,t,n){var o=Tn.templateSettings;n&&ss(e,t,n)&&(t=i),e=Qc(e),t=iu({},t,o,Dr);var a,r,d=iu({},t.imports,o.imports,Dr),l=Cu(d),c=Ki(d,l),u=0,m=t.interpolate||Ye,p="__p += '",h=nt((t.escape||Ye).source+"|"+m.source+"|"+(m===Re?He:Ye).source+"|"+(t.evaluate||Ye).source+"|$","g"),f="//# sourceURL="+(ut.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Kt+"]")+"\n";e.replace(h,(function(t,i,n,o,s,d){return n||(n=o),p+=e.slice(u,d).replace(Qe,tn),i&&(a=!0,p+="' +\n__e("+i+") +\n'"),s&&(r=!0,p+="';\n"+s+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=d+t.length,t})),p+="';\n";var g=ut.call(t,"variable")&&t.variable;if(g){if(Ze.test(g))throw new Ue(s)}else p="with (obj) {\n"+p+"\n}\n";p=(r?p.replace(be,""):p).replace(Ce,"$1").replace(Te,"$1;"),p="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=Cm((function(){return et(l,f+"return "+p).apply(i,c)}));if(v.source=p,Sc(v))throw v;return v}function mm(e){return Qc(e).toLowerCase()}function pm(e){return Qc(e).toUpperCase()}function hm(e,t,n){if(e=Qc(e),e&&(n||t===i))return Wi(e);if(!e||!(t=ja(t)))return e;var o=fn(e),a=fn(t),r=$i(o,a),s=Xi(o,a)+1;return Wa(o,r,s).join("")}function fm(e,t,n){if(e=Qc(e),e&&(n||t===i))return e.slice(0,gn(e)+1);if(!e||!(t=ja(t)))return e;var o=fn(e),a=Xi(o,fn(t))+1;return Wa(o,0,a).join("")}function gm(e,t,n){if(e=Qc(e),e&&(n||t===i))return e.replace(Me,"");if(!e||!(t=ja(t)))return e;var o=fn(e),a=$i(o,fn(t));return Wa(o,a).join("")}function vm(e,t){var n=E,o=P;if(wc(t)){var a="separator"in t?t.separator:a;n="length"in t?Kc(t.length):n,o="omission"in t?ja(t.omission):o}e=Qc(e);var r=e.length;if(on(e)){var s=fn(e);r=s.length}if(n>=r)return e;var d=n-hn(o);if(d<1)return o;var l=s?Wa(s,0,d).join(""):e.slice(0,d);if(a===i)return l+o;if(s&&(d+=l.length-d),Lc(a)){if(e.slice(d).search(a)){var c,u=l;a.global||(a=nt(a.source,Qc(Ge.exec(a))+"g")),a.lastIndex=0;while(c=a.exec(u))var m=c.index;l=l.slice(0,m===i?d:m)}}else if(e.indexOf(ja(a),d)!=d){var p=l.lastIndexOf(a);p>-1&&(l=l.slice(0,p))}return l+o}function ym(e){return e=Qc(e),e&&Ee.test(e)?e.replace(we,vn):e}var Sm=hr((function(e,t,i){return e+(i?" ":"")+t.toUpperCase()})),_m=pr("toUpperCase");function bm(e,t,n){return e=Qc(e),t=n?i:t,t===i?an(e)?_n(e):Di(e):e.match(t)||[]}var Cm=ba((function(e,t){try{return vi(e,i,t)}catch(n){return Sc(n)?n:new Ue(n)}})),Tm=Fr((function(e,t){return Si(t,(function(t){t=As(t),fo(e,t,Dl(e[t],e))})),e}));function wm(e){var t=null==e?0:e.length,i=Hr();return e=t?ki(e,(function(e){if("function"!=typeof e[1])throw new at(r);return[i(e[0]),e[1]]})):[],ba((function(i){var n=-1;while(++n<t){var o=e[n];if(vi(o[0],this,i))return vi(o[1],this,i)}}))}function km(e){return So(yo(e,u))}function Em(e){return function(){return e}}function Pm(e,t){return null==e||e!==e?t:e}var Im=yr(),xm=yr(!0);function Rm(e){return e}function Am(e){return ia("function"==typeof e?e:yo(e,u))}function Dm(e){return sa(yo(e,u))}function Bm(e,t){return da(e,yo(t,u))}var jm=ba((function(e,t){return function(i){return Ho(i,e,t)}})),Lm=ba((function(e,t){return function(i){return Ho(e,i,t)}}));function Mm(e,t,i){var n=Cu(t),o=jo(t,n);null!=i||wc(t)&&(o.length||!n.length)||(i=t,t=e,e=this,o=jo(t,Cu(t)));var a=!(wc(i)&&"chain"in i)||!!i.chain,r=bc(e);return Si(o,(function(i){var n=t[i];e[i]=n,r&&(e.prototype[i]=function(){var t=this.__chain__;if(a||t){var i=e(this.__wrapped__),o=i.__actions__=or(this.__actions__);return o.push({func:n,args:arguments,thisArg:e}),i.__chain__=t,i}return n.apply(e,Ei([this.value()],arguments))})})),e}function Nm(){return ai._===this&&(ai._=gt),this}function Fm(){}function zm(e){return e=Kc(e),ba((function(t){return ua(t,e)}))}var Om=Cr(ki),Um=Cr(bi),Zm=Cr(xi);function Vm(e){return ds(e)?zi(As(e)):fa(e)}function Hm(e){return function(t){return null==e?i:Lo(e,t)}}var Gm=kr(),Wm=kr(!0);function qm(){return[]}function Km(){return!1}function Jm(){return{}}function $m(){return""}function Xm(){return!0}function Ym(e,t){if(e=Kc(e),e<1||e>j)return[];var i=N,n=Vt(e,N);t=Hr(t),e-=N;var o=Hi(n,t);while(++i<e)t(i);return o}function Qm(e){return dc(e)?ki(e,As):zc(e)?[e]:or(Rs(Qc(e)))}function ep(e){var t=++mt;return Qc(e)+t}var tp=br((function(e,t){return e+t}),0),ip=Ir("ceil"),np=br((function(e,t){return e/t}),1),op=Ir("floor");function ap(e){return e&&e.length?Eo(e,Rm,Fo):i}function rp(e,t){return e&&e.length?Eo(e,Hr(t,2),Fo):i}function sp(e){return Fi(e,Rm)}function dp(e,t){return Fi(e,Hr(t,2))}function lp(e){return e&&e.length?Eo(e,Rm,aa):i}function cp(e,t){return e&&e.length?Eo(e,Hr(t,2),aa):i}var up=br((function(e,t){return e*t}),1),mp=Ir("round"),pp=br((function(e,t){return e-t}),0);function hp(e){return e&&e.length?Vi(e,Rm):0}function fp(e,t){return e&&e.length?Vi(e,Hr(t,2)):0}return Tn.after=xl,Tn.ary=Rl,Tn.assign=eu,Tn.assignIn=tu,Tn.assignInWith=iu,Tn.assignWith=nu,Tn.at=ou,Tn.before=Al,Tn.bind=Dl,Tn.bindAll=Tm,Tn.bindKey=Bl,Tn.castArray=Yl,Tn.chain=Gd,Tn.chunk=Ls,Tn.compact=Ms,Tn.concat=Ns,Tn.cond=wm,Tn.conforms=km,Tn.constant=Em,Tn.countBy=il,Tn.create=au,Tn.curry=jl,Tn.curryRight=Ll,Tn.debounce=Ml,Tn.defaults=ru,Tn.defaultsDeep=su,Tn.defer=Nl,Tn.delay=Fl,Tn.difference=Fs,Tn.differenceBy=zs,Tn.differenceWith=Os,Tn.drop=Us,Tn.dropRight=Zs,Tn.dropRightWhile=Vs,Tn.dropWhile=Hs,Tn.fill=Gs,Tn.filter=ol,Tn.flatMap=sl,Tn.flatMapDeep=dl,Tn.flatMapDepth=ll,Tn.flatten=Ks,Tn.flattenDeep=Js,Tn.flattenDepth=$s,Tn.flip=zl,Tn.flow=Im,Tn.flowRight=xm,Tn.fromPairs=Xs,Tn.functions=hu,Tn.functionsIn=fu,Tn.groupBy=ml,Tn.initial=ed,Tn.intersection=td,Tn.intersectionBy=id,Tn.intersectionWith=nd,Tn.invert=Su,Tn.invertBy=_u,Tn.invokeMap=hl,Tn.iteratee=Am,Tn.keyBy=fl,Tn.keys=Cu,Tn.keysIn=Tu,Tn.map=gl,Tn.mapKeys=wu,Tn.mapValues=ku,Tn.matches=Dm,Tn.matchesProperty=Bm,Tn.memoize=Ol,Tn.merge=Eu,Tn.mergeWith=Pu,Tn.method=jm,Tn.methodOf=Lm,Tn.mixin=Mm,Tn.negate=Ul,Tn.nthArg=zm,Tn.omit=Iu,Tn.omitBy=xu,Tn.once=Zl,Tn.orderBy=vl,Tn.over=Om,Tn.overArgs=Vl,Tn.overEvery=Um,Tn.overSome=Zm,Tn.partial=Hl,Tn.partialRight=Gl,Tn.partition=yl,Tn.pick=Ru,Tn.pickBy=Au,Tn.property=Vm,Tn.propertyOf=Hm,Tn.pull=dd,Tn.pullAll=ld,Tn.pullAllBy=cd,Tn.pullAllWith=ud,Tn.pullAt=md,Tn.range=Gm,Tn.rangeRight=Wm,Tn.rearg=Wl,Tn.reject=bl,Tn.remove=pd,Tn.rest=ql,Tn.reverse=hd,Tn.sampleSize=Tl,Tn.set=Bu,Tn.setWith=ju,Tn.shuffle=wl,Tn.slice=fd,Tn.sortBy=Pl,Tn.sortedUniq=Cd,Tn.sortedUniqBy=Td,Tn.split=dm,Tn.spread=Kl,Tn.tail=wd,Tn.take=kd,Tn.takeRight=Ed,Tn.takeRightWhile=Pd,Tn.takeWhile=Id,Tn.tap=Wd,Tn.throttle=Jl,Tn.thru=qd,Tn.toArray=Wc,Tn.toPairs=Lu,Tn.toPairsIn=Mu,Tn.toPath=Qm,Tn.toPlainObject=Xc,Tn.transform=Nu,Tn.unary=$l,Tn.union=xd,Tn.unionBy=Rd,Tn.unionWith=Ad,Tn.uniq=Dd,Tn.uniqBy=Bd,Tn.uniqWith=jd,Tn.unset=Fu,Tn.unzip=Ld,Tn.unzipWith=Md,Tn.update=zu,Tn.updateWith=Ou,Tn.values=Uu,Tn.valuesIn=Zu,Tn.without=Nd,Tn.words=bm,Tn.wrap=Xl,Tn.xor=Fd,Tn.xorBy=zd,Tn.xorWith=Od,Tn.zip=Ud,Tn.zipObject=Zd,Tn.zipObjectDeep=Vd,Tn.zipWith=Hd,Tn.entries=Lu,Tn.entriesIn=Mu,Tn.extend=tu,Tn.extendWith=iu,Mm(Tn,Tn),Tn.add=tp,Tn.attempt=Cm,Tn.camelCase=Wu,Tn.capitalize=qu,Tn.ceil=ip,Tn.clamp=Vu,Tn.clone=Ql,Tn.cloneDeep=tc,Tn.cloneDeepWith=ic,Tn.cloneWith=ec,Tn.conformsTo=nc,Tn.deburr=Ku,Tn.defaultTo=Pm,Tn.divide=np,Tn.endsWith=Ju,Tn.eq=oc,Tn.escape=$u,Tn.escapeRegExp=Xu,Tn.every=nl,Tn.find=al,Tn.findIndex=Ws,Tn.findKey=du,Tn.findLast=rl,Tn.findLastIndex=qs,Tn.findLastKey=lu,Tn.floor=op,Tn.forEach=cl,Tn.forEachRight=ul,Tn.forIn=cu,Tn.forInRight=uu,Tn.forOwn=mu,Tn.forOwnRight=pu,Tn.get=gu,Tn.gt=ac,Tn.gte=rc,Tn.has=vu,Tn.hasIn=yu,Tn.head=Ys,Tn.identity=Rm,Tn.includes=pl,Tn.indexOf=Qs,Tn.inRange=Hu,Tn.invoke=bu,Tn.isArguments=sc,Tn.isArray=dc,Tn.isArrayBuffer=lc,Tn.isArrayLike=cc,Tn.isArrayLikeObject=uc,Tn.isBoolean=mc,Tn.isBuffer=pc,Tn.isDate=hc,Tn.isElement=fc,Tn.isEmpty=gc,Tn.isEqual=vc,Tn.isEqualWith=yc,Tn.isError=Sc,Tn.isFinite=_c,Tn.isFunction=bc,Tn.isInteger=Cc,Tn.isLength=Tc,Tn.isMap=Ec,Tn.isMatch=Pc,Tn.isMatchWith=Ic,Tn.isNaN=xc,Tn.isNative=Rc,Tn.isNil=Dc,Tn.isNull=Ac,Tn.isNumber=Bc,Tn.isObject=wc,Tn.isObjectLike=kc,Tn.isPlainObject=jc,Tn.isRegExp=Lc,Tn.isSafeInteger=Mc,Tn.isSet=Nc,Tn.isString=Fc,Tn.isSymbol=zc,Tn.isTypedArray=Oc,Tn.isUndefined=Uc,Tn.isWeakMap=Zc,Tn.isWeakSet=Vc,Tn.join=od,Tn.kebabCase=Yu,Tn.last=ad,Tn.lastIndexOf=rd,Tn.lowerCase=Qu,Tn.lowerFirst=em,Tn.lt=Hc,Tn.lte=Gc,Tn.max=ap,Tn.maxBy=rp,Tn.mean=sp,Tn.meanBy=dp,Tn.min=lp,Tn.minBy=cp,Tn.stubArray=qm,Tn.stubFalse=Km,Tn.stubObject=Jm,Tn.stubString=$m,Tn.stubTrue=Xm,Tn.multiply=up,Tn.nth=sd,Tn.noConflict=Nm,Tn.noop=Fm,Tn.now=Il,Tn.pad=tm,Tn.padEnd=im,Tn.padStart=nm,Tn.parseInt=om,Tn.random=Gu,Tn.reduce=Sl,Tn.reduceRight=_l,Tn.repeat=am,Tn.replace=rm,Tn.result=Du,Tn.round=mp,Tn.runInContext=e,Tn.sample=Cl,Tn.size=kl,Tn.snakeCase=sm,Tn.some=El,Tn.sortedIndex=gd,Tn.sortedIndexBy=vd,Tn.sortedIndexOf=yd,Tn.sortedLastIndex=Sd,Tn.sortedLastIndexBy=_d,Tn.sortedLastIndexOf=bd,Tn.startCase=lm,Tn.startsWith=cm,Tn.subtract=pp,Tn.sum=hp,Tn.sumBy=fp,Tn.template=um,Tn.times=Ym,Tn.toFinite=qc,Tn.toInteger=Kc,Tn.toLength=Jc,Tn.toLower=mm,Tn.toNumber=$c,Tn.toSafeInteger=Yc,Tn.toString=Qc,Tn.toUpper=pm,Tn.trim=hm,Tn.trimEnd=fm,Tn.trimStart=gm,Tn.truncate=vm,Tn.unescape=ym,Tn.uniqueId=ep,Tn.upperCase=Sm,Tn.upperFirst=_m,Tn.each=cl,Tn.eachRight=ul,Tn.first=Ys,Mm(Tn,function(){var e={};return Do(Tn,(function(t,i){ut.call(Tn.prototype,i)||(e[i]=t)})),e}(),{chain:!1}),Tn.VERSION=n,Si(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Tn[e].placeholder=Tn})),Si(["drop","take"],(function(e,t){Pn.prototype[e]=function(n){n=n===i?1:Ot(Kc(n),0);var o=this.__filtered__&&!t?new Pn(this):this.clone();return o.__filtered__?o.__takeCount__=Vt(n,o.__takeCount__):o.__views__.push({size:Vt(n,N),type:e+(o.__dir__<0?"Right":"")}),o},Pn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Si(["filter","map","takeWhile"],(function(e,t){var i=t+1,n=i==R||i==D;Pn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Hr(e,3),type:i}),t.__filtered__=t.__filtered__||n,t}})),Si(["head","last"],(function(e,t){var i="take"+(t?"Right":"");Pn.prototype[e]=function(){return this[i](1).value()[0]}})),Si(["initial","tail"],(function(e,t){var i="drop"+(t?"":"Right");Pn.prototype[e]=function(){return this.__filtered__?new Pn(this):this[i](1)}})),Pn.prototype.compact=function(){return this.filter(Rm)},Pn.prototype.find=function(e){return this.filter(e).head()},Pn.prototype.findLast=function(e){return this.reverse().find(e)},Pn.prototype.invokeMap=ba((function(e,t){return"function"==typeof e?new Pn(this):this.map((function(i){return Ho(i,e,t)}))})),Pn.prototype.reject=function(e){return this.filter(Ul(Hr(e)))},Pn.prototype.slice=function(e,t){e=Kc(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Pn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(t=Kc(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Pn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pn.prototype.toArray=function(){return this.take(N)},Do(Pn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),a=Tn[o?"take"+("last"==t?"Right":""):t],r=o||/^find/.test(t);a&&(Tn.prototype[t]=function(){var t=this.__wrapped__,s=o?[1]:arguments,d=t instanceof Pn,l=s[0],c=d||dc(t),u=function(e){var t=a.apply(Tn,Ei([e],s));return o&&m?t[0]:t};c&&n&&"function"==typeof l&&1!=l.length&&(d=c=!1);var m=this.__chain__,p=!!this.__actions__.length,h=r&&!m,f=d&&!p;if(!r&&c){t=f?t:new Pn(this);var g=e.apply(t,s);return g.__actions__.push({func:qd,args:[u],thisArg:i}),new En(g,m)}return h&&f?e.apply(this,s):(g=this.thru(u),h?o?g.value()[0]:g.value():g)})})),Si(["pop","push","shift","sort","splice","unshift"],(function(e){var t=rt[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);Tn.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var o=this.value();return t.apply(dc(o)?o:[],e)}return this[i]((function(i){return t.apply(dc(i)?i:[],e)}))}})),Do(Pn.prototype,(function(e,t){var i=Tn[t];if(i){var n=i.name+"";ut.call(li,n)||(li[n]=[]),li[n].push({name:t,func:i})}})),li[Sr(i,v).name]=[{name:"wrapper",func:i}],Pn.prototype.clone=In,Pn.prototype.reverse=xn,Pn.prototype.value=Rn,Tn.prototype.at=Kd,Tn.prototype.chain=Jd,Tn.prototype.commit=$d,Tn.prototype.next=Xd,Tn.prototype.plant=Qd,Tn.prototype.reverse=el,Tn.prototype.toJSON=Tn.prototype.valueOf=Tn.prototype.value=tl,Tn.prototype.first=Tn.prototype.head,Pt&&(Tn.prototype[Pt]=Yd),Tn},Cn=bn();si?((si.exports=Cn)._=Cn,ri._=Cn):ai._=Cn}).call(O)})),V=function(){function e(t,i){p(this,e),this.id=i,this.jSPlugin=t,this.state={play:!1,loading:!1,text:""},this.loadingSetText=this.loadingSetText}return f(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"setPlayStatus",value:function(e){this.state=Object.assign(this.state,e)}},{key:"loadingStart",value:function(e){var t=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(t),t.innerHTML="@keyframes antRotate {to {transform: rotate(400deg);transform-origin:50% 50%;}} .loading {display: inline-block;z-index: 1000;-webkit-animation: antRotate 1s infinite linear;animation: antRotate 1s infinite linear;}";var i=e,n=document.getElementById(i),o=n.offsetWidth,a=n.offsetHeight,r=0,s=n.offsetLeft;document.getElementById("".concat(e,"-loading-id-0"))&&document.getElementById("".concat(e,"-loading-id-0")).parentNode.removeChild(document.getElementById("".concat(e,"-loading-id-0"))),console.log("loading-id-0---------------");var d=document.createElement("div");d.setAttribute("id","".concat(e,"-loading-id-0"));var l="position:absolute;outline:none;pointer-events:none;";console.log("this.jSPlugin",this.jSPlugin),l+="width: 100%;background-size: cover; background-repeat:no-repeat;",l+="height: 100%;",l+="top:"+r+";",l+="left:"+s+"px;",d.setAttribute("style",l),d.style.height=a,d.setAttribute("class","loading-container"),n.style.position="relative",n.appendChild(d);var c=1,u=document.createElement("div"),m=document.createElement("div");u.setAttribute("class","loading-item"),u.setAttribute("id","".concat(e,"-loading-item-0"));l="display:inline-flex;pointer-events:none;flex-direction:column;justify-content:center;align-items: center;width:100%;height:"+a+"px;outline:none;vertical-align: top;position:absolute;";function p(e,t,i,n){var o=parseInt(n/i,10)*(e/i),a=n%i*(t/i);return{top:o,left:a}}l+="left:"+p(a,o,c,0).left+"px;",l+="top:"+p(a,o,c,0).top+"px;",u.setAttribute("style",l);var h=1,f=document.createElement("div");m.innerHTML="",m.style.color="#fff",f.setAttribute("class","loading"),f.setAttribute("id","loading-icon");var g='<svg t="1567069979438" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399" width="24" height="24"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#ffffff" p-id="2400"></path></svg>';!this.jSPlugin.isMobile&&this.jSPlugin.isCall&&(h=this.jSPlugin.width/1024,g='<svg t="1567069979438" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399" width="'.concat(40*h,'" height="').concat(40*h,'"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#ffffff" p-id="2400"></path></svg>')),f.innerHTML=g,u.appendChild(f),u.appendChild(m),d.appendChild(u)}},{key:"loadingStop",value:function(e){var t=document.getElementById("".concat(e,"-loading-item-0"));t&&t.removeChild(document.getElementById("loading-icon"))}},{key:"loadingSetText",value:function(e){var t=this;if(this.loadingClearText(),document.getElementById("".concat(this.id,"-loading-item-0"))){var i=document.getElementById("".concat(this.id,"-loading-item-0")),n=document.getElementById("".concat(this.id,"-loading-item-0")).childNodes[1];if(n||(i.style.height="100%",n=document.createElement("div"),n.innerHTML=e.text,i.appendChild(n)),n.id="".concat(this.id,"-loading-item-txt"),n.innerHTML=e.text,n.style.fontSize="14px",!this.jSPlugin.isMobile&&this.jSPlugin.isCall){var o=this.jSPlugin.width/1024;n.style.fontSize="".concat(28*o,"px"),n.style.marginTop="16px"}if(this.jSPlugin.isCall&&1==e.type){var a=document.getElementById("".concat(this.id,"-loading-item-txt")),r=document.createElement("div");r.style="margin-bottom: 8px;width:24px;height:24px;",r.innerHTML='<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n            <title></title>\n            <g id="gantan" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                <g id="Group">\n                    <polygon id="Path" points="0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001"></polygon>\n                    <path d="M12,2.25000001 C17.2781739,2.25000001 21.5934661,6.44926243 21.746085,11.7237735 L21.746085,11.7237735 L21.75,12 C21.75,17.2781739 17.5507376,21.5934661 12.2762266,21.746085 L12.2762266,21.746085 L12,21.75 C6.72182614,21.75 2.40653397,17.5507376 2.25391507,12.2762266 L2.25391507,12.2762266 L2.25000001,12 C2.25000001,6.72182617 6.44926245,2.40653397 11.7237735,2.25391507 L11.7237735,2.25391507 Z M12,3.75000001 L11.7563186,3.75352261 C7.3032926,3.88243816 3.74992165,7.53391173 3.74992165,11.9891583 L3.74992165,11.9891583 L3.75352261,12.2436814 C3.88243816,16.6967075 7.5339117,20.2500784 11.9891583,20.2500784 L11.9891583,20.2500784 L12.2436814,20.2464774 C16.6967075,20.1175619 20.2500784,16.4660884 20.2500784,12.0108417 L20.2500784,12.0108417 L20.2464774,11.7563186 C20.1175619,7.30329258 16.4660883,3.75000001 12,3.75000001 L12,3.75000001 Z M11.999,15.2500001 L12.1156933,15.25672 C12.6133664,15.3144204 12.999993,15.7366564 12.999993,16.2500001 C12.999993,16.8022157 12.5522116,17.2500001 11.999993,17.2500001 C11.4477844,17.2500001 10.999993,16.8022116 11.0000197,16.2554347 C10.9962666,15.7375014 11.3873731,15.3105316 11.8897485,15.2559043 L11.999,15.2500001 Z M12,6.75000003 C12.3796958,6.75000003 12.693491,7.03215391 12.7431534,7.39822947 L12.75,7.50000003 L12.75,12.5 C12.75,12.9142136 12.4142136,13.25 12,13.25 C11.6203043,13.25 11.3065091,12.9678461 11.2568467,12.6017706 L11.25,12.5 L11.25,7.50000003 C11.25,7.08578647 11.5857865,6.75000003 12,6.75000003 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                </g>\n            </g>\n        </svg>',i.insertBefore(r,a)}n.style.color=e.color||"#FFFFFF",this.state.text=e.text,e.delayClear&&setTimeout((function(){t.loadingClearText()}),parseInt(e.delayClear))}}},{key:"loadingSetTextWithBtn",value:function(e){var t=this;this.loadingClear(),console.log(this.jSPlugin);var i=!!this.jSPlugin.Theme.call&&this.jSPlugin.Theme.call.themeData||null;!i||0!==i.customConfig.bellPoster&&"onCall"!==this.jSPlugin.Theme.call.bellStatus||document.getElementById("".concat(this.id,"-loading-id-0"))&&(document.getElementById("".concat(this.id,"-loading-id-0")).style.background="rgba(0,0,0,0.6)");var n=document.getElementById("".concat(this.id,"-loading-item-0"));if(n){n.style.height="100%",n.style["pointer-events"]="auto";var o=document.createElement("div");if(o.id="".concat(this.id,"-loading-item-txt"),o.innerHTML=e.text,o.style.color=e.color||"#FFFFFF",e.isMobile){var a=this.jSPlugin.width/375,r=14*a;o.style.fontSize=r+"px"}else{var s=this.jSPlugin.width/1024,d=28*s;o.style.fontSize=d+"px"}if(n.appendChild(o),e.type&&2==e.type){var l=8,c=24;if(e.isMobile){var u=this.jSPlugin.width/375;c=24*u}else{var m=this.jSPlugin.width/1024;l=m<1?16*m:16,c=40*m}var p=document.getElementById("".concat(this.id,"-loading-item-txt")),h=document.createElement("div");h.style="margin-bottom: ".concat(l,"px;width:").concat(c,"px;height:").concat(c,"px;"),h.innerHTML='<svg width="'.concat(c,'px" height="').concat(c,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n            <title></title>\n            <g id="gantan" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                <g id="Group">\n                    <polygon id="Path" points="0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001"></polygon>\n                    <path d="M12,2.25000001 C17.2781739,2.25000001 21.5934661,6.44926243 21.746085,11.7237735 L21.746085,11.7237735 L21.75,12 C21.75,17.2781739 17.5507376,21.5934661 12.2762266,21.746085 L12.2762266,21.746085 L12,21.75 C6.72182614,21.75 2.40653397,17.5507376 2.25391507,12.2762266 L2.25391507,12.2762266 L2.25000001,12 C2.25000001,6.72182617 6.44926245,2.40653397 11.7237735,2.25391507 L11.7237735,2.25391507 Z M12,3.75000001 L11.7563186,3.75352261 C7.3032926,3.88243816 3.74992165,7.53391173 3.74992165,11.9891583 L3.74992165,11.9891583 L3.75352261,12.2436814 C3.88243816,16.6967075 7.5339117,20.2500784 11.9891583,20.2500784 L11.9891583,20.2500784 L12.2436814,20.2464774 C16.6967075,20.1175619 20.2500784,16.4660884 20.2500784,12.0108417 L20.2500784,12.0108417 L20.2464774,11.7563186 C20.1175619,7.30329258 16.4660883,3.75000001 12,3.75000001 L12,3.75000001 Z M11.999,15.2500001 L12.1156933,15.25672 C12.6133664,15.3144204 12.999993,15.7366564 12.999993,16.2500001 C12.999993,16.8022157 12.5522116,17.2500001 11.999993,17.2500001 C11.4477844,17.2500001 10.999993,16.8022116 11.0000197,16.2554347 C10.9962666,15.7375014 11.3873731,15.3105316 11.8897485,15.2559043 L11.999,15.2500001 Z M12,6.75000003 C12.3796958,6.75000003 12.693491,7.03215391 12.7431534,7.39822947 L12.75,7.50000003 L12.75,12.5 C12.75,12.9142136 12.4142136,13.25 12,13.25 C11.6203043,13.25 11.3065091,12.9678461 11.2568467,12.6017706 L11.25,12.5 L11.25,7.50000003 C11.25,7.08578647 11.5857865,6.75000003 12,6.75000003 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                </g>\n            </g>\n        </svg>'),n.insertBefore(h,p)}else{var f=document.createElement("div");if(f.innerHTML='<div id="'.concat(this.id,'-loading-item-btn">').concat(e.btnName,"</div>"),e.isMobile)1==e.type?f.style="color:white;width:100px;height:30px;border-radius: 10px;background: rgba(255,255,255,0.25);text-align:center;line-height:30px;margin-top:9px;font-size:14px;-webkit-tap-highlight-color: transparent;":f.style="border: 1px solid rgba(204,204,204,1);color:white;width:80px;height:24px;border-radius: 12px;background: rgba(255,255,255,0.1);text-align:center;line-height:24px;margin-top:20px;font-size:12px;-webkit-tap-highlight-color: transparent;";else{var g=this.jSPlugin.width/1024;f.style="color:#648FFC;margin-top:16px;cursor: pointer;font-size:".concat(24*g,"px;")}if(n.appendChild(f),e.isMobile&&1==e.type){var v=document.getElementById("".concat(this.id,"-loading-item-txt"));h=document.createElement("div");h.style="margin-bottom: 8px;width:24px;height:24px;",h.innerHTML='<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title></title>\n              <g id="gantan" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="Group">\n                      <polygon id="Path" points="0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001"></polygon>\n                      <path d="M12,2.25000001 C17.2781739,2.25000001 21.5934661,6.44926243 21.746085,11.7237735 L21.746085,11.7237735 L21.75,12 C21.75,17.2781739 17.5507376,21.5934661 12.2762266,21.746085 L12.2762266,21.746085 L12,21.75 C6.72182614,21.75 2.40653397,17.5507376 2.25391507,12.2762266 L2.25391507,12.2762266 L2.25000001,12 C2.25000001,6.72182617 6.44926245,2.40653397 11.7237735,2.25391507 L11.7237735,2.25391507 Z M12,3.75000001 L11.7563186,3.75352261 C7.3032926,3.88243816 3.74992165,7.53391173 3.74992165,11.9891583 L3.74992165,11.9891583 L3.75352261,12.2436814 C3.88243816,16.6967075 7.5339117,20.2500784 11.9891583,20.2500784 L11.9891583,20.2500784 L12.2436814,20.2464774 C16.6967075,20.1175619 20.2500784,16.4660884 20.2500784,12.0108417 L20.2500784,12.0108417 L20.2464774,11.7563186 C20.1175619,7.30329258 16.4660883,3.75000001 12,3.75000001 L12,3.75000001 Z M11.999,15.2500001 L12.1156933,15.25672 C12.6133664,15.3144204 12.999993,15.7366564 12.999993,16.2500001 C12.999993,16.8022157 12.5522116,17.2500001 11.999993,17.2500001 C11.4477844,17.2500001 10.999993,16.8022116 11.0000197,16.2554347 C10.9962666,15.7375014 11.3873731,15.3105316 11.8897485,15.2559043 L11.999,15.2500001 Z M12,6.75000003 C12.3796958,6.75000003 12.693491,7.03215391 12.7431534,7.39822947 L12.75,7.50000003 L12.75,12.5 C12.75,12.9142136 12.4142136,13.25 12,13.25 C11.6203043,13.25 11.3065091,12.9678461 11.2568467,12.6017706 L11.25,12.5 L11.25,7.50000003 C11.25,7.08578647 11.5857865,6.75000003 12,6.75000003 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                  </g>\n              </g>\n          </svg>',n.insertBefore(h,v)}document.getElementById("".concat(this.id,"-loading-item-btn")).onclick=function(){console.log("-----------重新加载"),t.jSPlugin.play(),t.loadingClear(),t.loadingStart(t.id),t.loadingSetText({text:"视频加载中"})}}this.state.text=e.text,e.delayClear&&setTimeout((function(){t.loadingClearText()}),parseInt(e.delayClear))}}},{key:"loadingClearText",value:function(){if(document.getElementById("".concat(this.id,"-loading-item-0"))){var e=document.getElementById("".concat(this.id,"-loading-item-0")).childNodes;e.length>1?e[1].parentNode.removeChild(e[1]):e[0]&&e[0].parentNode.removeChild(e[0])}}},{key:"loadingClear",value:function(){if(document.getElementById("".concat(this.id,"-loading-item-0"))){for(var e=document.getElementById("".concat(this.id,"-loading-item-0")).childNodes,t=e.length-1;t>=0;t--)e[t].parentNode.removeChild(e[t]);document.getElementById("".concat(this.id,"-loading-id-0"))&&(document.getElementById("".concat(this.id,"-loading-id-0")).style.background="none"),document.getElementById("loading-icon")&&document.getElementById("loading-icon").parentNode.removeChild(document.getElementById("loading-icon"))}}},{key:"loadingEnd",value:function(){var e=document.getElementById("".concat(this.id,"-loading-item-0"));if(e){e.parentNode.removeChild(e);var t=document.getElementById("".concat(this.id,"-loading-id-0"));t&&0===t.children.length&&t.parentNode.removeChild(t)}document.getElementById("".concat(this.id,"-loading-item-0")).style.background="none"}}]),e}(),H=function(){function e(t,i){p(this,e),this.id=i,this.jSPlugin=t,this.timer=null,this.state={play:!1,loading:!1}}return f(e,[{key:"default",value:function(e){var t=this,i="msgId";document.getElementById("".concat(this.id,"-").concat(i))&&document.getElementById("".concat(this.id,"-wrap")).removeChild(document.getElementById("".concat(this.id,"-").concat(i)));var n=document.createElement("div");n.id="".concat(this.id,"-").concat(i),n.style="position: absolute;top: 50%;left:calc(50% - ".concat(14*e.length/2,"px);padding: 4px 16px;background: #00000080;color: #FFFFFF;font-size: 14px"),n.innerHTML=e,document.getElementById("".concat(this.id,"-wrap")).appendChild(n),this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){document.getElementById("".concat(t.id,"-wrap")).removeChild(document.getElementById("".concat(t.id,"-").concat(i)))}),2e3)}}]),e}(),G=[{moduleCode:"",detailCode:"405984",description:"",solution:"",updateTime:1559564188e3},{moduleCode:"",detailCode:"10035",description:"获取子账户AccessToken异常,子账户不存在或子账户不属于该开发者",solution:"",updateTime:1559551958e3},{moduleCode:"",detailCode:"1052674",description:"获取本地录像失败",solution:"",updateTime:1558579653e3},{moduleCode:"",detailCode:"395547",description:"",solution:"",updateTime:1557367296e3},{moduleCode:"",detailCode:"12",description:"",solution:"",updateTime:1557229476e3},{moduleCode:"",detailCode:"10052",description:"余额不足",solution:"",updateTime:1557121463e3},{moduleCode:"",detailCode:"20108",description:"当前用户和所添加用户不是好友关系",solution:"",updateTime:1556541725e3},{moduleCode:"",detailCode:"10009",description:"",solution:"",updateTime:1556422452e3},{moduleCode:"",detailCode:"320001",description:"通道不存在",solution:"请检查录像机的关联状态是否正常，没有摄像头的通道无法播放",updateTime:1556419044e3},{moduleCode:"",detailCode:"120001",description:"通道不存在",solution:"请检查录像机的关联状态是否正常，没有摄像头的通道无法播放",updateTime:155641903e4},{moduleCode:"",detailCode:"320049",description:"",solution:"",updateTime:1556272984e3},{moduleCode:"",detailCode:"380227",description:"",solution:"",updateTime:1556264379e3},{moduleCode:"",detailCode:"10033",description:"policy参数信息异常",solution:"",updateTime:1555922124e3},{moduleCode:"",detailCode:"10065",description:"weakAppKey 不属于accessToken对应的用户",solution:"",updateTime:1555497522e3},{moduleCode:"",detailCode:"100001",description:"",solution:"",updateTime:1555141776e3},{moduleCode:"",detailCode:"395558",description:"",solution:"",updateTime:1554987121e3},{moduleCode:"",detailCode:"70001",description:"智能家居买断用户设备受到限制,建议合理选择pagestart和pageSize",solution:"",updateTime:1554691023e3},{moduleCode:"",detailCode:"170001",description:"",solution:"",updateTime:1554691023e3},{moduleCode:"",detailCode:"1012",description:"重置失败",solution:"",updateTime:1554645841e3},{moduleCode:"",detailCode:"1043",description:"重置失败",solution:"",updateTime:1554645834e3},{moduleCode:"",detailCode:"60060",description:"直播功能未开通",solution:"通道未开通直播功能，请先开通直播",updateTime:1554346018e3},{moduleCode:"",detailCode:"380203",description:"",solution:"",updateTime:1554093666e3},{moduleCode:"",detailCode:"399048",description:"免费版并发数达到上限，请升级企业版使用多并发能力",solution:"升级成为企业版套餐即可取消并发数限制",updateTime:1553839878e3},{moduleCode:"",detailCode:"60007",description:"预置点个数超过最大值",solution:"",updateTime:1553671316e3},{moduleCode:"",detailCode:"1005",description:"",solution:"",updateTime:1553513701e3},{moduleCode:"",detailCode:"20605",description:"其他用户正在认证中",solution:"",updateTime:1552976317e3},{moduleCode:"",detailCode:"90004",description:"当前型号设备暂时不支持AI任务：CS-C3W-3B1WFR-YGL",solution:"",updateTime:1552898525e3},{moduleCode:"",detailCode:"60046",description:"添加的设备的IP和本设备的IP冲突",solution:"",updateTime:1552872372e3},{moduleCode:"",detailCode:"3",description:"修改视频清晰度失败!",solution:"",updateTime:1552440229e3},{moduleCode:"",detailCode:"1013",description:"",solution:"",updateTime:1552035069e3},{moduleCode:"",detailCode:"370007",description:"",solution:"",updateTime:1551852327e3},{moduleCode:"",detailCode:"-1",description:"",solution:"",updateTime:1551752889e3},{moduleCode:"",detailCode:"30005",description:"弱账户不存在",solution:"",updateTime:1551422358e3},{moduleCode:"",detailCode:"90006",description:"用户操作AI任务受限",solution:"",updateTime:155107332e4},{moduleCode:"",detailCode:"60203",description:"未开通相关服务",solution:"",updateTime:155062307e4},{moduleCode:"",detailCode:"10002",description:"accessToken过期或异常",solution:"",updateTime:1550300346e3},{moduleCode:"",detailCode:"380339",description:"",solution:"",updateTime:1549889458e3},{moduleCode:"",detailCode:"90002",description:"AI任务设备配置数达到上限：3",solution:"",updateTime:1549071664e3},{moduleCode:"",detailCode:"380008",description:"",solution:"",updateTime:1549005979e3},{moduleCode:"",detailCode:"320227",description:"",solution:"",updateTime:1548739731e3},{moduleCode:"",detailCode:"60059",description:"ezopen地址均不可用",solution:"",updateTime:154839535e4},{moduleCode:"",detailCode:"10005",description:"appKey异常",solution:"",updateTime:1548317858e3},{moduleCode:"",detailCode:"60045",description:"添加的设备的IP和其他通道的IP冲突",solution:"",updateTime:1548155085e3},{moduleCode:"",detailCode:"60047",description:"码流类型不支持",solution:"",updateTime:1547962108e3},{moduleCode:"",detailCode:"60041",description:"添加的设备被其他设备关联或响应超时",solution:"",updateTime:154796098e4},{moduleCode:"",detailCode:"110029",description:"个人用户接口调用频率超限",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1547606859e3},{moduleCode:"",detailCode:"380355",description:"设备直连推流异常结束",solution:"",updateTime:1547106294e3},{moduleCode:"",detailCode:"320081",description:"",solution:"",updateTime:1547106279e3},{moduleCode:"",detailCode:"60035",description:"购买云存储服务失败",solution:"",updateTime:1547026959e3},{moduleCode:"",detailCode:"90005",description:"设备已存在：C75714141",solution:"",updateTime:1546940622e3},{moduleCode:"",detailCode:"1053445",description:"该时间段没有录像片段",solution:"",updateTime:1546935727e3},{moduleCode:"",detailCode:"90007",description:"设备未加入到AI任务",solution:"",updateTime:1546932948e3},{moduleCode:"",detailCode:"326000",description:"",solution:"",updateTime:1546823143e3},{moduleCode:"",detailCode:"1021",description:"重置失败",solution:"",updateTime:1546781152e3},{moduleCode:"",detailCode:"2001",description:"删除设备失败!",solution:"",updateTime:1546422886e3},{moduleCode:"",detailCode:"380425",description:"",solution:"",updateTime:1546407694e3},{moduleCode:"",detailCode:"120097",description:"",solution:"",updateTime:1546085995e3},{moduleCode:"",detailCode:"10059",description:"requestId已存在",solution:"",updateTime:1545824509e3},{moduleCode:"",detailCode:"1154723",description:"",solution:"",updateTime:1545795209e3},{moduleCode:"",detailCode:"60043",description:"添加的设备超出最大数量",solution:"",updateTime:1545493607e3},{moduleCode:"",detailCode:"1152677",description:"",solution:"",updateTime:1545313404e3},{moduleCode:"",detailCode:"20097",description:"设备添加异常,设备验证码为ABCDEF或设备被N1，R1关联",solution:"",updateTime:1545310795e3},{moduleCode:"",detailCode:"10060",description:"设备不支持该云存储类型",solution:"",updateTime:1545309064e3},{moduleCode:"",detailCode:"20102",description:"无相应邀请信息，无法接受邀请",solution:"",updateTime:1545204966e3},{moduleCode:"",detailCode:"10053",description:"云存储开通中",solution:"",updateTime:1545100293e3},{moduleCode:"",detailCode:"20401",description:"用户云空间信息不存在",solution:"",updateTime:154501788e4},{moduleCode:"",detailCode:"20600",description:"临时密码数已达上限",solution:"",updateTime:1544873457e3},{moduleCode:"",detailCode:"901",description:"",solution:"",updateTime:1544693519e3},{moduleCode:"",detailCode:"60210",description:"图片数据错误",solution:"",updateTime:1544604457e3},{moduleCode:"",detailCode:"10013",description:"您的应用没有权限调用",solution:"",updateTime:1544416237e3},{moduleCode:"",detailCode:"70007",description:"授权码不存在",solution:"",updateTime:1544179533e3},{moduleCode:"",detailCode:"10015",description:"授权地址不存在",solution:"",updateTime:154416324e4},{moduleCode:"",detailCode:"320423",description:"",solution:"",updateTime:1544100685e3},{moduleCode:"",detailCode:"370009",description:"",solution:"",updateTime:1544077151e3},{moduleCode:"",detailCode:"10031",description:"子账户或萤石用户没有权限",solution:"",updateTime:1543990462e3},{moduleCode:"",detailCode:"10055",description:"设备不支持试用云存储服务",solution:"",updateTime:1543986292e3},{moduleCode:"",detailCode:"60042",description:"添加的设备密码错误",solution:"",updateTime:1543710913e3},{moduleCode:"",detailCode:"60082",description:"设备正在响应本次声源定位",solution:"",updateTime:1543647426e3},{moduleCode:"",detailCode:"10056",description:"设备不支持云存储服务转出",solution:"",updateTime:1543558342e3},{moduleCode:"",detailCode:"20104",description:"好友不存在",solution:"",updateTime:1543492403e3},{moduleCode:"",detailCode:"20111",description:"好友不是等待验证状态，无法接受邀请",solution:"",updateTime:1543492365e3},{moduleCode:"",detailCode:"20107",description:"不能添加自己为好友",solution:"",updateTime:1543480986e3},{moduleCode:"",detailCode:"1",description:"设备返回其他错误",solution:"",updateTime:1543459921e3},{moduleCode:"",detailCode:"60084",description:"当前正在关闭隐私遮蔽",solution:"",updateTime:1543456515e3},{moduleCode:"",detailCode:"380255",description:"",solution:"",updateTime:1543411652e3},{moduleCode:"",detailCode:"20015",description:"设备不支持",solution:"",updateTime:1543390936e3},{moduleCode:"",detailCode:"30003",description:"手机验证码错误",solution:"",updateTime:1543389137e3},{moduleCode:"",detailCode:"20615",description:"锁用户已存在",solution:"",updateTime:1543388325e3},{moduleCode:"",detailCode:"60061",description:"账户流量已超出或未购买，限制开通",solution:"",updateTime:1543372581e3},{moduleCode:"",detailCode:"60020",description:"设备不支持该信令",solution:"",updateTime:1543321636e3},{moduleCode:"",detailCode:"320146",description:"",solution:"",updateTime:1543318472e3},{moduleCode:"",detailCode:"60018",description:"设备升级失败",solution:"",updateTime:1543304928e3},{moduleCode:"",detailCode:"60044",description:"添加的设备网络不可达超时",solution:"",updateTime:1543304102e3},{moduleCode:"",detailCode:"20619",description:"主用户无法删除",solution:"",updateTime:1543290219e3},{moduleCode:"",detailCode:"20608",description:"锁用户不存在",solution:"",updateTime:154328195e4},{moduleCode:"",detailCode:"20609",description:"设备响应超时,门锁通信故障或者电量不足,请重试.",solution:"",updateTime:1543281601e3},{moduleCode:"",detailCode:"1049954",description:"升级设备失败",solution:"",updateTime:1543279264e3},{moduleCode:"",detailCode:"60009",description:"正在调用预置点",solution:"",updateTime:1543238114e3},{moduleCode:"",detailCode:"1052677",description:"获取本地录像失败",solution:"",updateTime:1543207604e3},{moduleCode:"",detailCode:"327000",description:"",solution:"",updateTime:1543196609e3},{moduleCode:"",detailCode:"20021",description:"设备在线，未被用户添加",solution:"",updateTime:1543193436e3},{moduleCode:"",detailCode:"20202",description:"操作留言信息失败",solution:"",updateTime:1543191562e3},{moduleCode:"",detailCode:"1052678",description:"获取本地录像失败",solution:"",updateTime:1543132218e3},{moduleCode:"",detailCode:"1054723",description:"格式化设备失败",solution:"",updateTime:1543129833e3},{moduleCode:"",detailCode:"20109",description:"对应分享不存在",solution:"",updateTime:1543129111e3},{moduleCode:"",detailCode:"60026",description:"设备处于隐私遮蔽状态",solution:"",updateTime:1543110403e3},{moduleCode:"",detailCode:"60083",description:"当前正在开启隐私遮蔽",solution:"",updateTime:1543071148e3},{moduleCode:"",detailCode:"60001",description:"用户无云台控制权限",solution:"",updateTime:1543059167e3},{moduleCode:"",detailCode:"2003",description:"设备不在线",solution:"",updateTime:1543051046e3},{moduleCode:"",detailCode:"-24",description:"设置设备enable错误",solution:"",updateTime:1543042701e3},{moduleCode:"",detailCode:"10018",description:"",solution:"",updateTime:1543041564e3},{moduleCode:"",detailCode:"20103",description:"好友已存在",solution:"",updateTime:154303843e4},{moduleCode:"",detailCode:"70010",description:"授权异常请重试",solution:"",updateTime:154303559e4},{moduleCode:"",detailCode:"60056",description:"删除设备失败",solution:"",updateTime:1543031275e3},{moduleCode:"",detailCode:"60040",description:"添加的设备不在同一局域网",solution:"",updateTime:154303121e4},{moduleCode:"",detailCode:"60019",description:"加密已开启",solution:"",updateTime:1543029931e3},{moduleCode:"",detailCode:"1054722",description:"格式化设备失败",solution:"",updateTime:1543028537e3},{moduleCode:"",detailCode:"20016",description:"当前设备正在格式化",solution:"",updateTime:1543028537e3},{moduleCode:"",detailCode:"10024",description:"透明通道权限校验不通过",solution:"",updateTime:154302554e4},{moduleCode:"",detailCode:"6002",description:"删除设备失败!",solution:"",updateTime:1543025026e3},{moduleCode:"",detailCode:"1011",description:"验证码错误！",solution:"",updateTime:1543016865e3},{moduleCode:"",detailCode:"60032",description:"卡密已使用",solution:"",updateTime:1543006668e3},{moduleCode:"",detailCode:"10034",description:"子账号已存在",solution:"",updateTime:1542989194e3},{moduleCode:"",detailCode:"20301",description:"根据uuid查询联动信息不存在",solution:"",updateTime:1542988651e3},{moduleCode:"",detailCode:"1041",description:"获取验证码过于频繁",solution:"",updateTime:1542980953e3},{moduleCode:"",detailCode:"10012",description:"该appkey下已绑定重复的phone！",solution:"",updateTime:15429808e5},{moduleCode:"",detailCode:"1008",description:"phone不合法！",solution:"",updateTime:1542979812e3},{moduleCode:"",detailCode:"60023",description:"订阅操作失败",solution:"",updateTime:1542979006e3},{moduleCode:"",detailCode:"5",description:"设备返回其他错误",solution:"",updateTime:1542977828e3},{moduleCode:"",detailCode:"60006",description:"云台当前操作失败",solution:"",updateTime:1542977598e3},{moduleCode:"",detailCode:"131",description:"修改视频清晰度失败!",solution:"",updateTime:1542977246e3},{moduleCode:"",detailCode:"10019",description:"密码错误",solution:"",updateTime:1542976628e3},{moduleCode:"",detailCode:"10004",description:"用户不存在",solution:"",updateTime:1542976268e3},{moduleCode:"",detailCode:"20201",description:"操作报警信息失败",solution:"",updateTime:1542975906e3},{moduleCode:"",detailCode:"20024",description:"设备不在线，已经被别的用户添加",solution:"",updateTime:1542975858e3},{moduleCode:"",detailCode:"60004",description:"设备云台旋转达到左限位",solution:"",updateTime:1542975207e3},{moduleCode:"",detailCode:"1052679",description:"修改视频清晰度失败!",solution:"",updateTime:1542974886e3},{moduleCode:"",detailCode:"20031",description:"请在萤石客户端关闭终端绑定",solution:"",updateTime:1542974756e3},{moduleCode:"",detailCode:"1053825",description:"获取本地录像失败",solution:"",updateTime:1542974692e3},{moduleCode:"",detailCode:"60011",description:"预置点不存在",solution:"",updateTime:1542974414e3},{moduleCode:"",detailCode:"1052936",description:"修改视频清晰度失败!",solution:"",updateTime:154297439e4},{moduleCode:"",detailCode:"1016",description:"",solution:"",updateTime:1542974273e3},{moduleCode:"",detailCode:"10032",description:"子账号不存在",solution:"",updateTime:1542973906e3},{moduleCode:"",detailCode:"20013",description:"设备已被别人添加",solution:"",updateTime:1542973817e3},{moduleCode:"",detailCode:"50000",description:"服务器错误!",solution:"",updateTime:1542973801e3},{moduleCode:"",detailCode:"60010",description:"该预置点已经是当前位置",solution:"",updateTime:15429738e5},{moduleCode:"",detailCode:"60003",description:"设备云台旋转达到下限位",solution:"",updateTime:154297377e4},{moduleCode:"",detailCode:"4",description:"设备返回其他错误",solution:"",updateTime:1542973755e3},{moduleCode:"",detailCode:"60016",description:"加密未开启，无需关闭",solution:"",updateTime:1542973753e3},{moduleCode:"",detailCode:"60002",description:"设备云台旋转达到上限位",solution:"",updateTime:1542973742e3},{moduleCode:"",detailCode:"20023",description:"设备不在线，未被用户添加",solution:"",updateTime:1542973685e3},{moduleCode:"",detailCode:"10008",description:"",solution:"",updateTime:1542973676e3},{moduleCode:"",detailCode:"20010",description:"设备验证码错误",solution:"",updateTime:1542973658e3},{moduleCode:"",detailCode:"60005",description:"设备云台旋转达到右限位",solution:"",updateTime:1542973657e3},{moduleCode:"",detailCode:"20017",description:"设备已经被自己添加",solution:"",updateTime:1542973648e3},{moduleCode:"",detailCode:"20020",description:"设备在线，已经被自己添加",solution:"",updateTime:1542973533e3},{moduleCode:"",detailCode:"20029",description:"设备不在线，已经被自己添加",solution:"",updateTime:154297353e4},{moduleCode:"",detailCode:"10014",description:"APPKEY下对应的第三方userId和phone未绑定！",solution:"",updateTime:1542973499e3},{moduleCode:"",detailCode:"20002",description:"设备不存在",solution:"",updateTime:1542973499e3},{moduleCode:"",detailCode:"10030",description:"appkey和appsecret不匹配",solution:"",updateTime:154297349e4},{moduleCode:"",detailCode:"20022",description:"设备在线，已经被别的用户添加",solution:"",updateTime:1542973486e3},{moduleCode:"",detailCode:"20008",description:"设备响应超时",solution:"",updateTime:1542973484e3},{moduleCode:"",detailCode:"20032",description:"该用户下通道不存在",solution:"",updateTime:1542973481e3},{moduleCode:"",detailCode:"20006",description:"网络异常",solution:"",updateTime:1542973475e3},{moduleCode:"",detailCode:"20014",description:"deviceSerial不合法!",solution:"",updateTime:1542973454e3},{moduleCode:"",detailCode:"20007",description:"设备不在线",solution:"",updateTime:1542973454e3},{moduleCode:"",detailCode:"20018",description:"该用户不拥有该设备",solution:"",updateTime:1542973453e3},{moduleCode:"",detailCode:"10010",description:"",solution:"",updateTime:1542973453e3},{moduleCode:"",detailCode:"10011",description:"未绑定！",solution:"",updateTime:1542973453e3},{moduleCode:"",detailCode:"20001",description:"通道不存在!",solution:"",updateTime:1542973452e3},{moduleCode:"",detailCode:"10017",description:"appKey不存在",solution:"",updateTime:1542973451e3},{moduleCode:"",detailCode:"400259",description:"",solution:"",updateTime:1542875643e3},{moduleCode:"",detailCode:"400004",description:"",solution:"",updateTime:1542873364e3},{moduleCode:"",detailCode:"3840",description:"",solution:"",updateTime:154186e7},{moduleCode:"",detailCode:"-1017",description:"",solution:"",updateTime:1541733663e3},{moduleCode:"",detailCode:"320025",description:"",solution:"",updateTime:1541078281e3},{moduleCode:"",detailCode:"320024",description:"",solution:"",updateTime:1540801374e3},{moduleCode:"",detailCode:"321002",description:"",solution:"",updateTime:1540631734e3},{moduleCode:"",detailCode:"321000",description:"",solution:"",updateTime:1540609178e3},{moduleCode:"",detailCode:"321022",description:"",solution:"",updateTime:1540548345e3},{moduleCode:"",detailCode:"321016",description:"",solution:"",updateTime:1540287187e3},{moduleCode:"",detailCode:"320023",description:"",solution:"",updateTime:1539825993e3},{moduleCode:"",detailCode:"-1016",description:"",solution:"",updateTime:1539584931e3},{moduleCode:"",detailCode:"8",description:"",solution:"",updateTime:1539391812e3},{moduleCode:"",detailCode:"1075127593",description:"",solution:"",updateTime:1538959251e3},{moduleCode:"",detailCode:"380421",description:"",solution:"",updateTime:1537288465e3},{moduleCode:"",detailCode:"322000",description:"麦克风权限未开启",solution:"",updateTime:1536820136e3},{moduleCode:"",detailCode:"1152678",description:"",solution:"",updateTime:1536738348e3},{moduleCode:"",detailCode:"320047",description:"",solution:"",updateTime:1536664472e3},{moduleCode:"",detailCode:"327006",description:"",solution:"",updateTime:153613612e4},{moduleCode:"",detailCode:"1074807593",description:"",solution:"",updateTime:1536135035e3},{moduleCode:"",detailCode:"320291",description:"",solution:"",updateTime:1536110836e3},{moduleCode:"",detailCode:"320045",description:"",solution:"",updateTime:1535963775e3},{moduleCode:"",detailCode:"370004",description:"",solution:"",updateTime:1535883699e3},{moduleCode:"",detailCode:"1149954",description:"",solution:"",updateTime:1535700674e3},{moduleCode:"",detailCode:"320053",description:"",solution:"",updateTime:1535681079e3},{moduleCode:"",detailCode:"400000",description:"",solution:"",updateTime:1535532332e3},{moduleCode:"",detailCode:"110028",description:"个人版抓图接口日调用次数超出限制",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1535348756e3},{moduleCode:"",detailCode:"110027",description:"个人版帐号数量超出安全限制，无法调用",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1535348734e3},{moduleCode:"",detailCode:"110026",description:"设备数量超出个人版限制，当前设备无法操作",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1535348588e3},{moduleCode:"",detailCode:"100000",description:"",solution:"",updateTime:1534980008e3},{moduleCode:"",detailCode:"324004",description:"",solution:"",updateTime:1534927762e3},{moduleCode:"",detailCode:"360104",description:"",solution:"",updateTime:1534761006e3},{moduleCode:"",detailCode:"320204",description:"",solution:"",updateTime:1534584221e3},{moduleCode:"",detailCode:"380001",description:"",solution:"",updateTime:1534404715e3},{moduleCode:"",detailCode:"380204",description:"",solution:"",updateTime:1534401682e3},{moduleCode:"",detailCode:"328006",description:"",solution:"",updateTime:1534144407e3},{moduleCode:"",detailCode:"321703",description:"",solution:"",updateTime:1534127274e3},{moduleCode:"",detailCode:"321510",description:"",solution:"",updateTime:1533428892e3},{moduleCode:"",detailCode:"321006",description:"",solution:"",updateTime:1533036916e3},{moduleCode:"",detailCode:"50009",description:"",solution:"",updateTime:1532078548e3},{moduleCode:"",detailCode:"50007",description:"",solution:"",updateTime:153199172e4},{moduleCode:"",detailCode:"50018",description:"",solution:"",updateTime:1531912829e3},{moduleCode:"",detailCode:"380451",description:"",solution:"",updateTime:15316157e5},{moduleCode:"",detailCode:"380336",description:"",solution:"",updateTime:1531231721e3},{moduleCode:"",detailCode:"360020",description:"",solution:"",updateTime:1531117554e3},{moduleCode:"",detailCode:"380418",description:"",solution:"",updateTime:153110707e4},{moduleCode:"",detailCode:"1153445",description:"设备在该时间段内没有录像",solution:"",updateTime:1530944007e3},{moduleCode:"",detailCode:"110007",description:"调用接口总次数达到上限",solution:"请升级企业版，获取更高能力",updateTime:1530935584e3},{moduleCode:"",detailCode:"360019",description:"",solution:"",updateTime:1530869771e3},{moduleCode:"",detailCode:"360100",description:"",solution:"",updateTime:1530786188e3},{moduleCode:"",detailCode:"380042",description:"",solution:"",updateTime:1530775199e3},{moduleCode:"",detailCode:"320355",description:"",solution:"",updateTime:1530716074e3},{moduleCode:"",detailCode:"100003",description:"",solution:"",updateTime:1530232541e3},{moduleCode:"",detailCode:"371026",description:"",solution:"",updateTime:15301926e5},{moduleCode:"",detailCode:"102",description:"",solution:"",updateTime:1529895641e3},{moduleCode:"",detailCode:"380201",description:"",solution:"",updateTime:1529740929e3},{moduleCode:"",detailCode:"320054",description:"",solution:"",updateTime:1529544875e3},{moduleCode:"",detailCode:"500101",description:"",solution:"",updateTime:1529485953e3},{moduleCode:"",detailCode:"321001",description:"",solution:"",updateTime:1529411048e3},{moduleCode:"",detailCode:"321508",description:"",solution:"",updateTime:1529393279e3},{moduleCode:"",detailCode:"405991",description:"",solution:"",updateTime:1529380238e3},{moduleCode:"",detailCode:"380461",description:"",solution:"",updateTime:1529130941e3},{moduleCode:"",detailCode:"-1019",description:"",solution:"",updateTime:1529057245e3},{moduleCode:"",detailCode:"322009",description:"",solution:"",updateTime:1528965717e3},{moduleCode:"",detailCode:"324005",description:"",solution:"",updateTime:1528950153e3},{moduleCode:"",detailCode:"325000",description:"",solution:"",updateTime:1528947143e3},{moduleCode:"",detailCode:"326032",description:"",solution:"",updateTime:1528872971e3},{moduleCode:"",detailCode:"325032",description:"",solution:"",updateTime:1528863189e3},{moduleCode:"",detailCode:"328000",description:"",solution:"",updateTime:1528794505e3},{moduleCode:"",detailCode:"53",description:"",solution:"",updateTime:1528693249e3},{moduleCode:"",detailCode:"-1020",description:"",solution:"",updateTime:152849944e4},{moduleCode:"",detailCode:"329032",description:"",solution:"",updateTime:1528446301e3},{moduleCode:"",detailCode:"-1202",description:"",solution:"",updateTime:152843982e4},{moduleCode:"",detailCode:"2",description:"",solution:"",updateTime:1528434175e3},{moduleCode:"",detailCode:"1152936",description:"",solution:"",updateTime:1528345986e3},{moduleCode:"",detailCode:"328011",description:"",solution:"",updateTime:15283386e5},{moduleCode:"",detailCode:"28",description:"",solution:"",updateTime:152833753e4},{moduleCode:"",detailCode:"320356",description:"",solution:"",updateTime:1528188693e3},{moduleCode:"",detailCode:"320357",description:"",solution:"",updateTime:1528188517e3},{moduleCode:"",detailCode:"405800",description:"",solution:"",updateTime:1528168732e3},{moduleCode:"",detailCode:"405996",description:"",solution:"",updateTime:1528168686e3},{moduleCode:"",detailCode:"380357",description:"",solution:"",updateTime:1528011565e3},{moduleCode:"",detailCode:"328022",description:"",solution:"",updateTime:1527929065e3},{moduleCode:"",detailCode:"380003",description:"",solution:"",updateTime:1527927819e3},{moduleCode:"",detailCode:"50004",description:"",solution:"",updateTime:1527770643e3},{moduleCode:"",detailCode:"50011",description:"",solution:"",updateTime:1527770635e3},{moduleCode:"",detailCode:"370017",description:"",solution:"",updateTime:1527739514e3},{moduleCode:"",detailCode:"327032",description:"",solution:"",updateTime:1527726704e3},{moduleCode:"",detailCode:"324001",description:"",solution:"",updateTime:1527681892e3},{moduleCode:"",detailCode:"405997",description:"",solution:"",updateTime:1527653408e3},{moduleCode:"",detailCode:"405995",description:"",solution:"",updateTime:1527647283e3},{moduleCode:"",detailCode:"1153825",description:"",solution:"",updateTime:1527601747e3},{moduleCode:"",detailCode:"328002",description:"",solution:"",updateTime:1527495292e3},{moduleCode:"",detailCode:"1152679",description:"",solution:"",updateTime:1527486665e3},{moduleCode:"",detailCode:"380356",description:"",solution:"",updateTime:1527125669e3},{moduleCode:"",detailCode:"328032",description:"",solution:"",updateTime:1527069382e3},{moduleCode:"",detailCode:"22",description:"",solution:"",updateTime:1527049826e3},{moduleCode:"",detailCode:"9",description:"",solution:"",updateTime:1527006778e3},{moduleCode:"",detailCode:"89",description:"",solution:"",updateTime:1526622784e3},{moduleCode:"",detailCode:"328016",description:"",solution:"",updateTime:1526452365e3},{moduleCode:"",detailCode:"368005",description:"",solution:"",updateTime:1525921264e3},{moduleCode:"",detailCode:"0",description:"",solution:"",updateTime:1525920242e3},{moduleCode:"",detailCode:"380006",description:"",solution:"",updateTime:1525918868e3},{moduleCode:"",detailCode:"310",description:"",solution:"",updateTime:1525834436e3},{moduleCode:"",detailCode:"360011",description:"",solution:"",updateTime:1525681552e3},{moduleCode:"",detailCode:"170005",description:"",solution:"",updateTime:15254339e5},{moduleCode:"",detailCode:"50023",description:"",solution:"",updateTime:1525403338e3},{moduleCode:"",detailCode:"100131",description:"",solution:"",updateTime:1525229691e3},{moduleCode:"",detailCode:"-1018",description:"",solution:"",updateTime:1525142341e3},{moduleCode:"",detailCode:"362026",description:"",solution:"",updateTime:1524882677e3},{moduleCode:"",detailCode:"368007",description:"",solution:"",updateTime:1524832269e3},{moduleCode:"",detailCode:"54",description:"",solution:"",updateTime:1524793646e3},{moduleCode:"",detailCode:"1154722",description:"",solution:"",updateTime:1524620807e3},{moduleCode:"",detailCode:"320229",description:"",solution:"",updateTime:1524551682e3},{moduleCode:"",detailCode:"360012",description:"",solution:"",updateTime:1524472094e3},{moduleCode:"",detailCode:"380229",description:"",solution:"",updateTime:1524110755e3},{moduleCode:"",detailCode:"360016",description:"",solution:"",updateTime:1523933518e3},{moduleCode:"",detailCode:"-1003",description:"",solution:"",updateTime:1523584804e3},{moduleCode:"",detailCode:"410026",description:"",solution:"",updateTime:152351743e4},{moduleCode:"",detailCode:"360102",description:"TTS初始化失败",solution:"",updateTime:1523503528e3},{moduleCode:"",detailCode:"360013",description:"设备开启了隐私保护",solution:"",updateTime:1523503507e3},{moduleCode:"",detailCode:"360010",description:"设备正在对讲中",solution:"",updateTime:1523503491e3},{moduleCode:"",detailCode:"360007",description:"TTS关闭了与客户端的连接",solution:"",updateTime:1523503475e3},{moduleCode:"",detailCode:"360006",description:"客户端接收发生错误",solution:"",updateTime:1523503457e3},{moduleCode:"",detailCode:"360005",description:"客户端发送的消息错误",solution:"",updateTime:1523503437e3},{moduleCode:"",detailCode:"360004",description:"TTS内部发生错误",solution:"",updateTime:1523503421e3},{moduleCode:"",detailCode:"360003",description:"TTS的设备端发生错误",solution:"",updateTime:1523503397e3},{moduleCode:"",detailCode:"360002",description:"对讲发起超时",solution:"",updateTime:1523503376e3},{moduleCode:"",detailCode:"360001",description:"客户端请求超时",solution:"",updateTime:1523503357e3},{moduleCode:"",detailCode:"320077",description:"",solution:"",updateTime:1523444274e3},{moduleCode:"",detailCode:"370047",description:"",solution:"",updateTime:152344048e4},{moduleCode:"",detailCode:"100002",description:"",solution:"",updateTime:1523413964e3},{moduleCode:"",detailCode:"-1004",description:"",solution:"",updateTime:1523336653e3},{moduleCode:"",detailCode:"380000",description:"",solution:"",updateTime:1523180856e3},{moduleCode:"",detailCode:"380213",description:"",solution:"",updateTime:1523180623e3},{moduleCode:"",detailCode:"380101",description:"",solution:"",updateTime:1522834231e3},{moduleCode:"",detailCode:"50047",description:"",solution:"",updateTime:1522833243e3},{moduleCode:"",detailCode:"-999",description:"",solution:"",updateTime:1522831034e3},{moduleCode:"",detailCode:"320418",description:"",solution:"",updateTime:1522829072e3},{moduleCode:"",detailCode:"-1009",description:"",solution:"",updateTime:1522746247e3},{moduleCode:"",detailCode:"320209",description:"",solution:"",updateTime:1522744395e3},{moduleCode:"",detailCode:"368006",description:"",solution:"",updateTime:15227443e5},{moduleCode:"",detailCode:"369003",description:"",solution:"",updateTime:1522736355e3},{moduleCode:"",detailCode:"405989",description:"",solution:"",updateTime:1522726571e3},{moduleCode:"",detailCode:"-1012",description:"",solution:"",updateTime:1522726203e3},{moduleCode:"",detailCode:"322016",description:"",solution:"",updateTime:1522722918e3},{moduleCode:"",detailCode:"500103",description:"",solution:"",updateTime:1522655556e3},{moduleCode:"",detailCode:"405999",description:"",solution:"",updateTime:1522654716e3},{moduleCode:"",detailCode:"321032",description:"",solution:"",updateTime:1522647732e3},{moduleCode:"",detailCode:"381101",description:"",solution:"",updateTime:1522392414e3},{moduleCode:"",detailCode:"399999",description:"",solution:"",updateTime:1522379834e3},{moduleCode:"",detailCode:"380103",description:"",solution:"",updateTime:1522312724e3},{moduleCode:"",detailCode:"360014",description:"",solution:"",updateTime:1522304341e3},{moduleCode:"",detailCode:"-1005",description:"",solution:"",updateTime:1522288195e3},{moduleCode:"",detailCode:"100005",description:"",solution:"",updateTime:1522218849e3},{moduleCode:"",detailCode:"100004",description:"",solution:"",updateTime:1522209053e3},{moduleCode:"",detailCode:"106002",description:"",solution:"",updateTime:15222062e5},{moduleCode:"",detailCode:"410030",description:"",solution:"",updateTime:1522162252e3},{moduleCode:"",detailCode:"-1002",description:"",solution:"",updateTime:152215069e4},{moduleCode:"",detailCode:"-1200",description:"",solution:"",updateTime:1522139025e3},{moduleCode:"",detailCode:"-1001",description:"",solution:"",updateTime:1522046436e3},{moduleCode:"",detailCode:"-1011",description:"",solution:"",updateTime:1522045931e3},{moduleCode:"",detailCode:"381102",description:"",solution:"",updateTime:1522044953e3},{moduleCode:"",detailCode:"381103",description:"",solution:"",updateTime:1522044953e3},{moduleCode:"",detailCode:"391205",description:"vtdu解析服务器ip失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391206",description:"vtdu描述符select失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391207",description:"vtdu文件描述符不在可读中",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391208",description:"vtdu网络发生错误getsockopt",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391209",description:"vtdu描述符select超时",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395000",description:"cas回复信令，发现内存已经释放（和设备之间异常断开）",msg:"播放失败请重试",solution:"检查设备网络；刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395400",description:"私有化协议vtm检测私有化协议中码流类型小于0或者设备序列号为空等非法参数场景返回(app不重试取流)",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395402",description:"回放找不到录像文件",msg:"回放找不到录像文件，本地存储请检查存储卡是否接触良好",solution:"检查是否有存储卡并且接触良好",updateTime:1522034841e3},{moduleCode:"",detailCode:"395403",description:"操作码或信令密钥与设备不匹配",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395404",description:"设备不在线",solution:"检查设备网络；重启设备接入萤石云",msg:"设备不在线，请检查设备网络或重启设备接入萤石云",updateTime:1522034841e3},{moduleCode:"",detailCode:"395405",description:"流媒体向设备发送或接受信令超时/cas响应超时",msg:"播放失败，请检查设备网络或重启设备",solution:"检查设备网络；重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"395406",description:"token失效",msg:"播放失败请重试或重启设备",solution:"刷新重试或者重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"395407",description:"客户端的URL格式错误",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395409",description:"预览开启隐私保护",msg:"播放失败请关闭隐私遮蔽",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395410",description:"设备达到最大连接数",solution:"请升级设备固件版本",updateTime:1522034841e3},{moduleCode:"",detailCode:"395411",description:"token无权限",msg:"播放失败",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395412",description:"session不存在",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395413",description:"验证token的他异常（不具体） ",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395415",description:"设备通道错",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395416",description:"设备资源受限",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395451",description:"设备不支持的码流类型",msg:"播放失败请重试或切换设备码流",solution:"刷新重试或者切换到高清模式",updateTime:1522034841e3},{moduleCode:"",detailCode:"395452",description:"设备链接流媒体服务器失败",msg:"播放失败，请检查设备网络或重启设备或重新加载",solution:"检查设备网络，重启设备，刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395454",description:"流媒体中关于设备取流会话不存在",msg:"播放失败请重试",solution:"流媒体中关于设备取流会话不存在",updateTime:152222018e4},{moduleCode:"",detailCode:"395455",description:"设备通道未关联",msg:"播放失败，请检查设备通道是否关联",solution:"检查设备通道是否关联",updateTime:152222018e4},{moduleCode:"",detailCode:"395456",description:"设备通道关联设备不在线",msg:"播放失败，请检查设备通道是否上线",solution:"检查设备通道是否上线",updateTime:152222018e4},{moduleCode:"",detailCode:"395457",description:"客户端不支持端到端加密",msg:"播放失败",solution:"客户端不支持端到端加密",updateTime:152222018e4},{moduleCode:"",detailCode:"395458",description:"设备不支持当前并发ECDH密",msg:"客户端不支持端到端加密",solution:"设备不支持当前并发ECDH密",updateTime:152222018e4},{moduleCode:"",detailCode:"395459",description:"VTDU 处理ECDH 加密失败",msg:"播放失败",solution:"VTDU 处理ECDH 加密失败",updateTime:152222018e4},{moduleCode:"",detailCode:"395460",description:"流媒体中关于设备取流会话不存在",msg:"播放失败请重试",solution:"流媒体中关于设备取流会话不存在",updateTime:152222018e4},{moduleCode:"",detailCode:"395492",description:"设备不支持的命令",msg:"操作失败，设备不支持",solution:"",updateTime:152222018e4},{moduleCode:"",detailCode:"395500",description:"服务器处理失败",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395501",description:"流媒体vtdu达到最大负载，请扩容",msg:"播放失败请重试",solution:"服务器负载达到上限，请稍后重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395503",description:"vtm返回分配vtdu失败",msg:"播放失败请重试",solution:"vtdu服务异常，请请稍后重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395504",description:"流媒体vtdu达到最大负载",msg:"播放失败请重试",solution:"服务器负载达到上限，请稍后重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395505",description:"vtm ecdh解密失败",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395506",description:"vtm 返回IPC不支持取流（需要IPC添加NVR后支持）",msg:"播放失败，请绑定NVR使用",solution:"IPC绑定NVR使用",updateTime:1522034841e3},{moduleCode:"",detailCode:"395544",description:"设备返回无视频源",msg:"播放失败，请检查设备接触情况",solution:"设备是否接触良好； 如果一直无法解决，请联系技术支持",updateTime:1522034841e3},{moduleCode:"",detailCode:"395545",description:"视频分享时间已经结束",msg:"视频分享时间已结束",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395546",description:"vtdu返回达到取流并发路数限制",msg:"并发上限，请升级为企业版",solution:"请升级为企业版，放开并发限制",updateTime:1522034841e3},{moduleCode:"",detailCode:"395547",description:"vtdu返回开放平台用户并发限制",msg:"并发上限，请升级为企业版",solution:"请确定开放平台用户预览是否超过用户并发数量限制",updateTime:1522034841e3},{moduleCode:"",detailCode:"395556",description:"ticket校验失败",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395557",description:"回放服务器等待流头超时",msg:"播放失败请重试",solution:"刷新重试，检测设备网络，重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"395558",description:"查找录像开始时间错误",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395560",description:"群组分享取流二次验证失败",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395561",description:"分享群组用户被锁住",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395562",description:"群组分享用户权限变更",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395563",description:"认证服务连接失败",msg:"播放失败请重试",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395564",description:"认证超时",msg:"播放失败请重试",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395566",description:"不在分享时间内预览",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395567",description:"分享通道被锁定",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395568",description:"未找到认证类型",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395569",description:"认证返回的参数异常",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395600",description:"分享设备不在分享时间内",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395601",description:"群组分享用户没权限",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395602",description:"群组分享权限变更",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395610",description:"接收流头失败",msg:"播放失败请重试并检查设备网络情况以及设备配置",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395620",description:"心跳超时",msg:"播放失败请重试并检查设备网络情况以及设备配置",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395530",description:"机房故障不可用",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395701",description:"cas信令返回格式错误",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395702",description:"SPGW请求Cas、Status透传超时",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395703",description:"SPGW请求http不通",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396001",description:"客户端参数出错",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396099",description:"客户端默认错误",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396101",description:"不支持的命令",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396102",description:"设备流头发送失败",msg:"播放失败请重试",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396103",description:"cas/设备返回错误1",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396104",description:"cas/设备返回错误-1",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396105",description:"设备返回错误码3",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396106",description:"设备返回错误码4",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396107",description:"设备返回错误码5",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396108",description:"cas信令回应重复",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396109",description:"视频广场取消分享",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396110",description:"设备信令默认错误",msg:"播放失败请重试",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396501",description:"设备数据链路和实际链路不匹配",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396502",description:"设备数据链路重复建立连接",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396503",description:"设备数据链路端口不匹配",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396504",description:"缓存设备数据链路失败(内存块不足)",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396505",description:"设备发送确认头消息重复",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396506",description:"设备数据先于确定头部到达",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396508",description:"设备数据头部长度非法",msg:"播放失败请重试或重启设备",solution:"刷新重试，或者重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"396509",description:"索引找不到设备数据管理块",msg:"播放失败请重试",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396510",description:"设备数据链路vtdu内存块协议状态不匹配",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396511",description:"设备数据头部没有streamkey错误",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396512",description:"设备数据头部非法(较笼统)",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396513",description:"设备数据长度过小",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396514",description:"设备老协议推流头部没有streamkey错误",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396515",description:"设备老协议推流数据非法",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396516",description:"设备老协议索引找不到内存管理块",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396517",description:"设备老协议推流数据非法",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396518",description:"设备数据包过大",msg:"播放失败请重试或重启设备",solution:"刷新重试，或者重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"396519",description:"设备推流链路网络不稳定",msg:"播放失败，请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396520",description:"设备推流链路网络不稳定(默认)",msg:"播放失败请重试或重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396700",description:"异常数据包",msg:"播放失败，设备重启",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396701",description:"回放结束数据包",msg:"回放结束",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397001",description:"与相应服务连接失败",msg:"播放失败请重试，请检查设备网络情况以及连接情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397002",description:"与相应服务连接失败",msg:"播放失败请重试，请检查设备网络情况以及连接情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397003",description:"与相应服务连接失败",msg:"播放失败请重试，请检查设备网络情况以及连接情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397004",description:"与相应服务连接失败",msg:"播放失败请重试，请检查设备网络情况以及连接情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397005",description:"VTDU连接失败，或VTDU侧断开连接",msg:"播放失败请重试，请检查设备网络情况以及连接情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397006",description:"vtm断开连接（无需 关注）",msg:"播放失败请重试，请检查设备网络情况以及连接情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"397007",description:"客户端发送缓冲区满（上行带宽太小）",msg:"播放失败，上行带宽过小请检查设备网络情况",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"399000",description:"无效包，包过大",msg:" 检查设备重启设备",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"399001",description:"地址不合法",msg:"播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"399002",description:"缺少端口",msg:" 播放失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"170003",description:"refreshToken不存在",solution:"建议用户重新调用logout接口，然后调用openLoginPage接口重新启动登录页面登录",updateTime:1522034841e3},{moduleCode:"",detailCode:"170004",description:"refreshToken已过期",solution:"建议用户重新调用logout接口，然后调用openLoginPage接口重新启动登录页面登录",updateTime:1522034841e3},{moduleCode:"",detailCode:"380011",description:"设备隐私保护中",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380045",description:"设备直连取流连接数量过大",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380047",description:"设备不支持该命令",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380077",description:"设备正在对讲中",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380102",description:"数据接收异常",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380205",description:"设备检测入参异常",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380209",description:"网络连接超时",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380212",description:"设备端网络连接超时",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"101007",description:"手机号未注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120503",description:"正在响铃",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390016",description:"vtdu成功响应未携带流头",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101008",description:"手机号码不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120504",description:"室内机正在通话",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390017",description:"无数据流，尚未使用",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101009",description:"用户名与手机不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120505",description:"设备操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390018",description:"信令消息体PB解析失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101010",description:"获取验证码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120506",description:"非法命令",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390019",description:"信令消息体PB封装失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101011",description:"验证码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120507",description:"智能锁密码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390020",description:"申请系统内存资源失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101012",description:"验证码失效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120508",description:"开关锁失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390021",description:"vtdu地址尚未获取到",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101013",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120509",description:"开关锁超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390022",description:"客户端尚未支持",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101014",description:"密码不正确或者appKey不正确",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120510",description:"智能锁设备繁忙",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390023",description:"获取系统socket资源失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101015",description:"用户被锁住",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120511",description:"远程开锁功能未打开",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390024",description:"上层填充的StreamSsnId不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101021",description:"验证参数异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120600",description:"临时密码数已达上限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390025",description:"链接服务器失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101026",description:"邮箱已经被注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120601",description:"添加临时密码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390026",description:"客户端请求未收到服务端应答",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101031",description:"邮箱未注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120602",description:"删除临时密码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390027",description:"链路断开",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101032",description:"邮箱不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120603",description:"该临时密码不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390028",description:"没有取流链接",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101041",description:"获取验证码过于频繁",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120604",description:"指纹锁射频通信失败,请稍后再试",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390029",description:"流成功停止",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101043",description:"手机验证码输入错误超过规定次数",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120605",description:"其他用户正在认证中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390030",description:"客户端防串流校验失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102000",description:"设备不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120606",description:"验证已启动,请在120s内进行本地验证和调用添加设备接口",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390031",description:"应用层tcp粘包处理缓冲区满",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102001",description:"摄像机不存在",solution:"摄像机未注册到萤石云平台，请仔细检查摄像机的网络配置，确保连接到网络",updateTime:152203484e4},{moduleCode:"",detailCode:"120607",description:"删除用户失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390032",description:"无效状态迁移",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102003",description:"设备不在线",solution:"参考服务中心排查方法",updateTime:152203484e4},{moduleCode:"",detailCode:"120608",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390033",description:"无效客户端状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102004",description:"设备异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120609",description:"设备响应超时,门锁通信故障或者电量不足,请重试.",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390034",description:"向vtm取流流媒体信息请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102007",description:"设备序列号不正确",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120610",description:"获取临时密码列表失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390035",description:"向代理取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102009",description:"设备请求响应超时异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130001",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390036",description:"向代理保活取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"105000",description:"设备已被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130002",description:"手机号码已经注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390037",description:"向vtdu取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"105001",description:"设备已被别人添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130003",description:"手机验证码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390038",description:"向vtdu保活取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"105002",description:"设备验证码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130004",description:"终端绑定操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391001",description:"vtm地址或端口非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107001",description:"邀请不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"149999",description:"数据异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391002",description:"vtm生成文件描述符失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107002",description:"邀请验证失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"150000",description:"服务器异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391003",description:"vtm设置文件描述符非阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107003",description:"邀请用户不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160000",description:"设备不支持云台控制",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391004",description:"vtm设置文件描述符阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107004",description:"云存储连接失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160001",description:"用户无云台控制权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391005",description:"vtm解析服务器ip失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"7005",description:"VTDU主动断开连接",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107005",description:"VTDU主动断开连接",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160002",description:"设备云台旋转达到上限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391006",description:"vtm描述符select失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107006",description:"不能邀请自己",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160003",description:"设备云台旋转达到下限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391007",description:"vtm文件描述符不在可读中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107007",description:"重复邀请",solution:"分享和删除分享必须全部由接口形式操作，如果与萤石客户端混用会造成这个问题，解决办法：在萤石客户端清空所有相关分享数据并重新添加设备，再通过接口操作即可",updateTime:152203484e4},{moduleCode:"",detailCode:"160004",description:"设备云台旋转达到左限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391008",description:"vtm网络发生错误getsockopt",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110001",description:"参数错误",solution:"参数为空或者格式不对",updateTime:152203484e4},{moduleCode:"",detailCode:"160005",description:"设备云台旋转达到右限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391009",description:"vtm描述符select超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110002",description:"accessToken异常或过期",solution:"accessToken有效期为七天，建议在accessToken即将过期或者出现10002错误码的时候重新获取accessToken",updateTime:152203484e4},{moduleCode:"",detailCode:"160006",description:"云台当前操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391101",description:"proxy地址或端口非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110004",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160007",description:"预置点个数超过最大值",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391102",description:"proxy生成文件描述符失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110005",description:"appKey异常",solution:"确认appKey状态，不通过或者冻结状态会返回该错误码",updateTime:152203484e4},{moduleCode:"",detailCode:"160009",description:"正在调用预置点",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391103",description:"proxy设置文件描述符非阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110006",description:"ip受限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160010",description:"该预置点已经是当前位置",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391104",description:"proxy设置文件描述符阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160011",description:"预置点不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391105",description:"proxy解析服务器ip失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110008",description:"签名错误",solution:"①获取签名方式详见apidemo及[旧]API文档 ②注意编码格式为UTF-8",updateTime:152203484e4},{moduleCode:"",detailCode:"160013",description:"设备版本已是最新",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391106",description:"proxy描述符select失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110009",description:"签名参数错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160014",description:"设备正在升级",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391107",description:"proxy文件描述符不在可读中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110010",description:"签名超时",solution:"请调用同步服务器时间接口进行校时",updateTime:152203484e4},{moduleCode:"",detailCode:"160015",description:"设备正在重启",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391108",description:"proxy网络发生错误getsockopt",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110011",description:"未开通萤石云服务",solution:"参照绑定流程",updateTime:152203484e4},{moduleCode:"",detailCode:"160016",description:"加密未开启，无须关闭",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391109",description:"proxy描述符select超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110012",description:"第三方账户与萤石账号已经绑定",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160017",description:"设备抓图失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391201",description:"vtdu地址或端口非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110013",description:"应用没有权限调用此接口",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160018",description:"设备升级失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391202",description:"vtdu生成文件描述符失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110014",description:"APPKEY下对应的第三方userId和phone未绑定",solution:"获取AccessToken时所用appKey与SDK所用appKey不一致",updateTime:152203484e4},{moduleCode:"",detailCode:"160019",description:"加密已开启",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391203",description:"vtdu设置文件描述符非阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110017",description:"appKey不存在",solution:"请填写在官网申请的应用秘钥",updateTime:152203484e4},{moduleCode:"",detailCode:"160020",description:"不支持该命令",solution:"请确认设备是否支持该命令",updateTime:152203484e4},{moduleCode:"",detailCode:"391204",description:"vtdu设置文件描述符阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110018",description:"AccessToken与Appkey不匹配",solution:"请检查获取accessToken对应的appKey和SDK中设置的appKey是否一致",updateTime:152203484e4},{moduleCode:"",detailCode:"160023",description:"订阅操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110019",description:"密码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160024",description:"取消订阅操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110020",description:"请求方法为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160025",description:"客流统计配置失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110021",description:"ticket校验失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160026",description:"设备处于隐私遮蔽状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110022",description:"透传目的地非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160027",description:"设备正在镜像操作",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110024",description:"无透传权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160028",description:"设备正在键控动作",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110025",description:"appKey被禁止使用通明通道",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160029",description:"设备处于语音对讲状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160030",description:"卡密输入错误次数过多，24小时后再输入",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160031",description:"卡密信息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160032",description:"卡密状态不对或已过期",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160033",description:"卡密非卖品，只能开通对应的绑定设备",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110030",description:"appKey和appSecret不匹配",solution:"请检查appKey和appSecret是否对应",updateTime:152203484e4},{moduleCode:"",detailCode:"160035",description:"购买云存储服务失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110031",description:"子账户或萤石用户没有权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160040",description:"添加的设备不在同一局域网",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110032",description:"子账户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160041",description:"添加的设备被其他设备关联或响应超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110033",description:"子账户未设置授权策略",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160042",description:"添加的设备密码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110034",description:"子账户已存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160043",description:"添加的设备超出最大数量",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110035",description:"获取子账户AccessToken异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160044",description:"添加的设备网络不可达超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110036",description:"子账户被禁用",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160045",description:"添加的设备的IP和其他通道的IP冲突",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110051",description:"无权限进行抓图",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160046",description:"添加的设备的IP和本设备的IP冲突",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160047",description:"码流类型不支持",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120002",description:"设备不存在",solution:"①设备没有注册到萤石云平台，请检查下设备网络参数，确保能正常连接网络②设备序列号不存在",updateTime:152203484e4},{moduleCode:"",detailCode:"160048",description:"带宽超出系统接入带宽",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120003",description:"参数异常，SDK版本过低",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160049",description:"IP或者端口不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120004",description:"参数异常，SDK版本过低",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160050",description:"添加的设备版本不支持需要升级才能接入",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120005",description:"安全认证失败，需进行SDK安全认证",solution:"已去掉安全验证",updateTime:152203484e4},{moduleCode:"",detailCode:"160051",description:"添加的设备不支持接入",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120006",description:"网络异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160052",description:"添加的设备通道号出错",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120007",description:"设备不在线",solution:"参考服务中心排查方法",updateTime:152203484e4},{moduleCode:"",detailCode:"160053",description:"添加的设备分辨率不支持",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120008",description:"设备响应超时",solution:"设备响应超时，请检测设备网络或重试",updateTime:152203484e4},{moduleCode:"",detailCode:"160054",description:"添加的设备账号被锁定",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120009",description:"子账号不能添加设备",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160055",description:"添加的设备取码流出错",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120010",description:"设备验证码错误",solution:"验证码在设备标签上，六位大写字母，注意大小写",updateTime:152203484e4},{moduleCode:"",detailCode:"160056",description:"删除设备失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120012",description:"设备添加失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160057",description:"删除的设备未关联",solution:"检查IPC与NVR是否有关联关系",updateTime:152203484e4},{moduleCode:"",detailCode:"120013",description:"设备已被别人添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160060",description:"地址未绑定",solution:"请前往官网设置直播",updateTime:152203484e4},{moduleCode:"",detailCode:"120014",description:"设备序列号不正确",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160061",description:"账户流量已超出或未购买，限制开通",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120015",description:"设备不支持该功能",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160062",description:"该通道直播已开通",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120016",description:"当前设备正在格式化",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160063",description:"直播未使用或直播已关闭",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120017",description:"设备已被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160070",description:"设备不能转移给自己",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120018",description:"该用户不拥有该设备",solution:"确认设备是否属于用户",updateTime:152203484e4},{moduleCode:"",detailCode:"160071",description:"设备不能转移，设备与其他设备存在关联关系",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400001",description:"参数为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120019",description:"设备不支持云存储服务",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160072",description:"设备不能转移，通道被分享给其他用户或者分享到视频广场",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400002",description:"参数错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120020",description:"设备在线，被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160073",description:"云存储转移失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400025",description:"设备不支持对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120021",description:"设备在线，但是未被用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160080",description:"当前正在声源定位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400029",description:"没有初始化或资源被释放",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120022",description:"设备在线，但是已经被别的用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160081",description:"当前正在轨迹巡航",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400030",description:"json解析异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120023",description:"设备不在线，未被用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160082",description:"设备正在响应本次声源定位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400031",description:"网络异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120024",description:"设备不在线，但是已经被别的用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160083",description:"当前正在开启隐私遮蔽",solution:"设备正在操作隐私遮蔽，无法进行当前操作",updateTime:152203484e4},{moduleCode:"",detailCode:"400032",description:"设备信息异常为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120025",description:"重复申请分享",solution:"确认设备是否由添加过该设备且申请过分享的账户下是否还存在分享记录",updateTime:152203484e4},{moduleCode:"",detailCode:"160084",description:"当前正在关闭隐私遮蔽",solution:"设备正在操作隐私遮蔽，无法进行当前操作",updateTime:152203484e4},{moduleCode:"",detailCode:"400034",description:"取流超时",solution:"一般是由于网络状况不好导致，可以尝试下让用户重新播放",updateTime:152203484e4},{moduleCode:"",detailCode:"120026",description:"视频广场不存在该视频",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"380290",description:"　连接CAS服务器失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400035",description:"设备已加密，需要输入验证码",solution:"收到此错误码，需要让用户输入验证码后，调用EZPlayer.setPlayKey传入验证码，并重新调用播放函数",updateTime:152203484e4},{moduleCode:"",detailCode:"120027",description:"视频转码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361001",description:"对讲服务端排队超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400036",description:"播放验证码错误",solution:"收到此错误码，需要让用户输入验证码后，调用EZPlayer.setPlayKey传入验证码，并重新调用播放函数",updateTime:152203484e4},{moduleCode:"",detailCode:"120028",description:"设备固件升级包不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361002",description:"对讲服务端处理超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400037",description:"surfacehold错误",solution:"请检查是否是播放之前销毁了surface，收到此错误也可以重新建立surface后播放",updateTime:152203484e4},{moduleCode:"",detailCode:"120029",description:"设备不在线，但是已经被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361003",description:"设备链接对讲服务器超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400100",description:"未知错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120030",description:"该用户不拥有该视频广场视频",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361004",description:"服务器内部错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400200",description:"player sdk出错，这种错误一般开发者也是无法解决，不具体分类传出，传一个统一的inner错误码出去",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120031",description:"开启终端绑定，硬件特征码验证失败",solution:"请在萤石客户端关闭终端绑定，参考此步骤",updateTime:152203484e4},{moduleCode:"",detailCode:"361005",description:"解析消息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400300",description:"内存溢出",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120032",description:"该用户下通道不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361006",description:"请求重定向--需要向其他服务申请对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400901",description:"设备不在线，可以提示用户",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120033",description:"无法收藏自己分享的视频",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361007",description:"请求url非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400902",description:"accesstoken异常或失效，需要重新获取accesstoken，并传入到sdk",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120034",description:"该用户下无设备",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361008",description:"token失效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400903",description:"当前账号开启了终端绑定，只允许指定设备登录操作，提示用户登录i.ys7.com解除终端绑定",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120090",description:"用户反馈失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361009",description:"设备验证码或者通信秘钥不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400904",description:"设备正在对讲中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120095",description:"APP包下载失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361010",description:"设备已经在对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400905",description:"设备开启了隐私保护，不允许预览、对讲等",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120096",description:"APP包信息删除失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361011",description:"设备10s响应超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120101",description:"视频不支持分享给本人",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361012",description:"设备不在线",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320002",description:"参数无效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120102",description:"无相应邀请信息",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361013",description:"设备开启隐私保护拒绝对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320003",description:"暂不支持此操作",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120103",description:"好友已存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361014",description:"token无权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320004",description:"内存溢出",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120104",description:"好友不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361015",description:"设备返回session不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320005",description:"创建CAS session失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120105",description:"好友状态错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361016",description:"验证token其他异常错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320006",description:"创建cloud session失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120106",description:"对应群组不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361017",description:"服务端监听设备建立端口超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320007",description:"token失效",solution:"重新设置token后再重试",updateTime:152203484e4},{moduleCode:"",detailCode:"120107",description:"不能添加自己为好友",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361018",description:"设备链路异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320008",description:"token池里面没有token,请传入token",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120108",description:"当前用户和所添加用户不是好友关系",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361019",description:"对讲服务端不支持的信令消息",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320009",description:"传入新的INIT_PARAM并reset(保留，目前未用)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120109",description:"对应分享不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361020",description:"对讲服务端解析对讲请求未携带会话描述能力集",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320010",description:"请重试",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120110",description:"好友群组不属于当前用户",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361021",description:"对讲服务端优先能力集结果为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320011",description:"500毫秒后请重试",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120111",description:"好友不是等待验证状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361022",description:"cas链路异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320012",description:"token池已满",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120112",description:"添加应用下的用户为好友失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361023",description:"对讲服务端分配对讲会话资源失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320013",description:"P2P client超过限制",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120201",description:"操作报警信息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361024",description:"对讲服务端解析信令消息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320014",description:"sdk未初始化",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120202",description:"操作留言信息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390001",description:"通用错误返回",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320015",description:"超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120301",description:"根据UUID查询报警消息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390002",description:"入参为空指针",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320016",description:"正在打洞中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120302",description:"根据UUID查询图片不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390003",description:"入参值无效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320017",description:"没有视频文件头(播放器层面产生和处理此错误)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120303",description:"根据FID查询图片不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390004",description:"信令消息解析非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320018",description:"解码错误/超时(播放器层面产生和处理此错误)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120305",description:"设备ip解析错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390005",description:"内存资源不足",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320019",description:"取消(保留，用户不用处理)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120401",description:"用户云空间信息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390006",description:"协议格式不对或者消息体长度超过STREAM_MAX_MSGBODY_LEN",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320020",description:"播放过程中预连接被用户清除预操作信息",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120402",description:"云空间操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390007",description:"设备序列号长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320021",description:"流加密码不对",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120403",description:"用户目录不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390008",description:"取流url长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320022",description:"未传入播放窗口",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120404",description:"要操作的目标目录不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390009",description:"解析vtm返回vtdu地址不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"100200",description:"操作成功",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120405",description:"要删除的文件信息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390010",description:"解析vtm返回级联vtdu地址不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101001",description:"用户名不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120406",description:"已开通云存储",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390011",description:"解析vtm返回会话标识长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101002",description:"用户名已被占用",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120407",description:"开通记录失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390012",description:"vtdu返回流头长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101003",description:"密码不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120500",description:"获取数据错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390013",description:"vtdu会话长度非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101004",description:"密码为同一字符",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120501",description:"开锁失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390014",description:"回调函数未注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101006",description:"手机号码已经被注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120502",description:"室内机未收到呼叫",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390015",description:"vtdu成功响应未携带会话标识",solution:"",updateTime:152203484e4}],W="200",q="操作成功!",K={data:G,code:W,msg:q},J=function(){function e(t,i){p(this,e),this.coreX=t,this.coreY=i,console.log("ErrorCode",K)}return f(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"matchErrorInfo",value:function(e){return K.data.find((function(t){return t.detailCode.substr(-4)==e}))}}]),e}(),X={color:"red",backgroundColor:"red",activeColor:"red",btnList:[{btnKey:"ade5d065a113432e8091a1c5bc819c57-934f270c08b14e928bf0c2ae8e1a937d-header-0",iconId:"deviceID",part:"left",defaultActive:1,isrender:1,themeId:"934f270c08b14e928bf0c2ae8e1a937d"},{btnKey:"ade5d065a113432e8091a1c5bc819c57-934f270c08b14e928bf0c2ae8e1a937d-header-1",iconId:"deviceName",part:"left",defaultActive:1,isrender:1,themeId:"934f270c08b14e928bf0c2ae8e1a937d"}]},Y={color:"blue",backgroundColor:"blue",activeColor:"blue",btnList:[{btnKey:"ade5d065a113432e8091a1c5bc819c57-934f270c08b14e928bf0c2ae8e1a937d-footer-0",iconId:"play",part:"left",defaultActive:0,isrender:0,themeId:"934f270c08b14e928bf0c2ae8e1a937d"}]},Q={header:X,footer:Y},ee=function e(t){this.jsPlugin=t;var i={isMouseDown:!1,isOver:!1,mousePosition:null,oldTime:null,nowTime:null,moved:null,hoverTime:"2018-12-07 12:00:00",hoverLeft:0,timeTipShow:!1,randomNum:123,timeWidthTbls:[60,1800,3600,86400],timeUnits:["范围: 1分钟; 单位: 秒","范围: 30分钟; 单位: 分钟","范围: 1小时; 单位: 分钟","范围: 1天; 单位: 小时","范围: 3天; 单位: 小时"],drawPen:null,timeSection:[],canvasWidth:null,canvasHeight:null,timeTips:null},n=this;Object.keys(i).forEach((function(e){n[e]=i[e]})),this.options={width:this.canvasWidth,height:48,time:(new Date).getTime(),timeSection:[],timeWidth:0},e.prototype.subTime=function(e){return e<10?"0"+e:e},e.prototype.tranTime=function(e){var t=e;if(e){var i=new Date(e);t=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate()+" "+this.subTime(i.getHours())+":"+this.subTime(i.getMinutes())+":"+this.subTime(i.getSeconds())}return t},e.prototype.init=function(e){e.width&&document.getElementById(e.id).setAttribute("width",parseInt(e.width,10)+"px");var t=this,i=this.options;t.randomNum=(Math.random()+"").split(".").join(""),t.timeWidthTblIndex=i.timeWidth;var n=document.querySelector("#".concat(this.jsPlugin.id,"-canvas"));t.drawPen=n.getContext("2d"),t.nowTime=i.time||Date.now(),t.timeSection=i.timeSection||[],t.canvasWidth=n.offsetWidth,t.canvasHeight=n.offsetHeight,t.updata(),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mousemove",(function(e){t.options.readOnly||t.mousemove(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mouseover",(function(e){t.options.readOnly||t.mouseover(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mouseleave",(function(e){t.options.readOnly||t.mouseleave(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mousedown",(function(e){t.options.readOnly||t.mousedown(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mouseup",(function(i){if(!t.options.readOnly){var n=e.onChange;t.mouseUpFn(i,n)}}))},e.prototype.setWidth=function(e){var t=this,i=this;e.width&&(document.getElementById(this.jsPlugin.id).style.width=e.width,document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.width=e.width,document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).style.width=e.width,i.canvasWidth=e.width,setTimeout((function(){t.updata({time:new Date})}),500))},e.prototype.mousemove=function(e){if(this.isMouseDown&&this.isOver){var t=this.mousePosition-e.pageX;if(0===t)return;var i=0;switch(this.timeWidth){case 60:i=.1;break;case 1800:i=3;break;case 3600:i=3;break;case 86400:i=120;break}var n=new Date(this.oldTime).getTime()+t*i*1e3;this.updata({time:n}),this.moved=!0}else{var o=parseInt(document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).offsetLeft,10);this.mousePosition=e.pageX-o,this.updata()}},e.prototype.mousedown=function(e){this.isMouseDown=!0,this.mousePosition=e.pageX,this.oldTime=this.nowTime},e.prototype.mouseover=function(e){this.isOver=!0},e.prototype.mouseleave=function(e){this.isOver=!1,this.isMouseDown=!1,this.updata()},e.prototype.changeSize=function(e){console.log("changeSize",e),this.options.timeWidth=e,this.updata({timeWidth:e})},e.prototype.mouseUpFn=function(e,t){if(this.isMouseDown&&(this.isMouseDown=!1,this.moved)){this.moved=!1;var i=this.subTime(new Date(this.nowTime).getHours())+":"+this.subTime(new Date(this.nowTime).getMinutes())+":"+this.subTime(new Date(this.nowTime).getSeconds()),n=new Date(this.oldTime).getFullYear()+"/"+(new Date(this.oldTime).getMonth()+1)+"/"+new Date(this.oldTime).getDate();this.nowTime=new Date("".concat(n," ").concat(i)),this.updata({time:this.nowTime}),this.oldTime=this.nowTime,console.log("nowTime",new Date(this.nowTime),"".concat(n," ").concat(i)),t(this.nowTime)}},e.prototype.readOnly=function(e){console.log("更改为只读"),this.options.readOnly=!0,document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.cursor="not-allowed"},e.prototype.unReadOnly=function(e){console.log("更改为只读"),this.options.readOnly=!1,document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.cursor="pointer"},e.prototype.run=function(e){this.isMouseDown||this.updata(e)},e.prototype.getTime=function(e){console.log("this",this),console.log("当前时间",new Date(this.nowTime))},e.prototype.updata=function(e){var t=this;e=e||{},t.nowTime=e.time||t.nowTime,t.timeSection=e.timeSection||t.timeSection,t.timeWidthTblIndex=e.timeWidth||t.timeWidthTblIndex,t.timeWidth=t.timeWidthTbls[e.timeWidth||t.timeWidthTblIndex],t.timeUnit=t.timeUnits[e.timeWidth||t.timeWidthTblIndex],0===e.timeWidth&&(t.timeWidthTblIndex=0,t.timeWidth=t.timeWidthTbls[0],t.timeUnit=t.timeUnits[0]),t.drawPen.fillStyle="#000000",t.drawPen.fillRect(0,0,t.canvasWidth,t.canvasHeight),t.drawScale(),t.drawRecord(),t.drawOtherMsg(),document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).style.width=t.options.width+"px",document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.width=t.options.width+"px",document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).style.height=t.options.height+"px",document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.height=t.options.height+"px"},e.prototype.drawSolidLine=function(e,t,i,n,o,a){this.drawPen.save(),this.drawPen.strokeStyle=a,this.drawPen.lineWidth=o,this.drawPen.beginPath(),this.drawPen.moveTo(e,t),this.drawPen.lineTo(i,n),this.drawPen.stroke(),this.drawPen.restore()},e.prototype.drawString=function(e,t,i,n,o){this.drawPen.font="12px serif",this.drawPen.fillStyle="#ffffff",this.drawPen.textAlign=n||"left",this.drawPen.fillText(e,t,i+10)},e.prototype.drawScale=function(){var e=this,t="rgba(255,255,255)",i=new Date(e.nowTime),n=i.getFullYear(),o=i.getSeconds(),a=i.getMinutes(),r=i.getHours(),s=i.getDate(),d=0;switch(e.timeWidth){case 60:var l=parseInt(e.canvasWidth/10);i.setSeconds(i.getSeconds()-parseInt(l/2,10)),s=i.getDate(),r=i.getHours(),a=i.getMinutes(),o=i.getSeconds();for(var c=0;c<l;c++){if(d=o+c,i.setSeconds(d),d%10===0){e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5+8,1,t);var u=this.subTime(i.getHours())+":"+this.subTime(i.getMinutes())+":"+this.subTime(i.getSeconds());e.drawString(u,c*e.canvasWidth/l,e.canvasHeight/5*2.5,"center","rgba(255,255,255,0.3)")}else e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5*.5+8,1,t);i.setDate(s),i.setHours(r),i.setMinutes(a)}break;case 1800:l=parseInt(e.canvasWidth/20);i.setMinutes(i.getMinutes()-parseInt(l/2,10)),r=i.getHours(),a=i.getMinutes();for(c=0;c<=l;c++){if(d=a+c,i.setMinutes(d),d%5===0){e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5*1.5+8,1,t);u=this.subTime(i.getHours())+":"+this.subTime(i.getMinutes());e.drawString(u,c*e.canvasWidth/l,e.canvasHeight/5*2.5,"center","rgba(255,255,255,0.3)")}else e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5*.5+8,1,t);i.setHours(r)}break;case 3600:l=parseInt(e.canvasWidth/20);i.setMinutes(i.getMinutes()-parseInt(l/2,10)),r=i.getHours(),a=i.getMinutes();for(c=0;c<=l;c++){if(d=a+c,i.setMinutes(d),d%10===0){e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5*1.5+8,1,t);u=this.subTime(i.getHours())+":"+this.subTime(i.getMinutes());e.drawString(u,c*e.canvasWidth/l,e.canvasHeight/5*2.5,"center","rgba(255,255,255,0.3)")}else e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5*.5+8,1,t);i.setHours(r)}break;case 86400:l=parseInt(e.canvasWidth/30);i.setHours(i.getHours()-parseInt(l/2,10)),o=i.getSeconds(),a=i.getMinutes(),r=i.getHours(),s=i.getDate(),n=i.getFullYear();for(c=0;c<=l;c++){d=r+c,i.setHours(d),u=this.subTime(i.getHours())+":00",e.drawSolidLine(c*e.canvasWidth/l,8,c*e.canvasWidth/l,e.canvasHeight/5*.5+8,1,t),d%2===0&&e.drawString(u,c*e.canvasWidth/l,e.canvasHeight/5*2,"center","rgba(255,255,255,0.3)"),i.setFullYear(n),i.setDate(s),i.setHours(r)}break}},e.prototype.getRecord=function(e,t,i){this.timeSection=e,this.drawRecord()},e.prototype.drawRecord=function(){for(var e=this.timeSection||[],t=this,i=t.drawPen,n=0;n<e.length;n++){var o=r(e[n].startTime),a=r(e[n].endTime);i.fillStyle="#1890ff80",i.fillRect(o,0,a-o,48)}function r(e){var i=10;switch(t.timeWidth){case 60:i=10;break;case 1800:i=20/60;break;case 3600:i=20/60;break;case 86400:i=20/60/60;break}var n=t.canvasWidth/2,o=n+(e-t.nowTime)/1e3*i;return o>t.canvasWidth&&(o=t.canvasWidth),o<=0&&(o=0),o}},e.prototype.drawOtherMsg=function(){this.drawSolidLine(this.canvasWidth/2,0,this.canvasWidth/2,this.canvasHeight,2,"#1890FF"),this.drawPen.shadowBlur=0,this.isOver&&!this.isMouseDown?(this.mouseTime=this.mousePosition/this.canvasWidth*this.timeWidth*1e3+this.nowTime-this.timeWidth/2*1e3,this.mouseString=this.tranTime(this.mouseTime),this.hoverTime=this.mouseString,this.hoverLeft=this.mousePosition-60,this.timeTipShow=!0):this.timeTipShow=!1}},te=function(){function e(t){if(p(this,e),this.jSPlugin=t,!document.getElementById("".concat(this.jSPlugin.id,"-audioControls")))return!1;this.currentTimeWidth=0,this.date=new Date,this.datepickerVisible=!1,this.seekTimer=null,this.disabled=!1,this.seekFrequency=2e3,this.jSPlugin.params&&this.jSPlugin.params.seekFrequency&&(this.seekFrequency=this.jSPlugin.params.seekFrequency),this.recInit()}return f(e,[{key:"recInit",value:function(){var e=this;if(!document.getElementById("".concat(this.jSPlugin.id,"-audioControls")))return!1;this.currentTimeWidth=0;var t=parseInt(getComputedStyle(document.getElementById(this.jSPlugin.id)).width,10)-100,i=document.createElement("div");i.style="display:inline-block;height:48px;",i.id=this.jSPlugin.id+"-canvas-container";var n=document.createElement("canvas");n.id=this.jSPlugin.id+"-canvas",n.className="time-line-body",n.height="48",n.width=t,n.style="display:inline-block;",n.innerHTML="该浏览器不支持canvas",i.appendChild(n),P(i,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")));var o=document.createElement("div");o.className="timeline-controls",o.style="display:flex;width:100px;height:48px;text-align:center;line-height: 48px;vertical-align: top;background: #000000;";var a='\n<div class="timeline-controls-scale" style="display: inline-flex;flex-direction: column;justify-content: center;vertical-align: top;padding: 0 20px;">\n  <span style="vertical-Align: middle;line-height: 14px;height: 18px; width: 18px;cursor:pointer;" id="'.concat(this.jSPlugin.id,'-timeline-scale-add">\n    <svg fill="#2C2C2C" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20"\n      viewBox="0 0 20 20">\n      <title>add</title>\n      <g>\n        <polygon points="0.1,0.5 15,0.5 15,15.4 0.1,15.4 \t" />\n      </g>\n      <g>\n        <path\n          fill="#FFFFFF";\n          d="M7.6,12.4c-0.3,0-0.5-0.2-0.5-0.5v-8c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v8C8.1,12.2,7.9,12.4,7.6,12.4z" />\n      </g>\n      <g>\n        <path\n          fill="#FFFFFF";\n          d="M11.6,8.4h-8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h8c0.3,0,0.5,0.2,0.5,0.5S11.8,8.4,11.6,8.4z" />\n      </g>\n    </svg>\n  </span>\n  <span style="vertical-Align: middle;line-height: 14px;height: 18px; width: 18px;cursor:pointer;" id="').concat(this.jSPlugin.id,'-timeline-scale-sub">\n    <svg fill="#2C2C2C" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20"\n      viewBox="0 0 20 20">\n      <title>reduce</title>\n      <g>\n        <polygon class="st0" points="1,0.8 15.2,0.8 15.2,15 1,15 \t" />\n      </g>\n      <g>\n        <path class="st1"\n          fill="#FFFFFF";\n          d="M12.1,8.4h-8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h8c0.3,0,0.5,0.2,0.5,0.5S12.4,8.4,12.1,8.4z" />\n      </g>\n    </svg>\n  </span>\n</div>\n<label for="').concat(this.jSPlugin.id,'-datepicker">\n  <div class="timeline-controls-date">\n    <span>\n      <svg fill="#2C2C2C" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20"\n        viewBox="0 0 20 20">\n        <title>ifttt</title>\n        <g id="Rectangle">\n          <rect x="0.6" y="0.9" class="st0" width="20" height="20" />\n        </g>\n        <g id="Stroke-1">\n          <path fill="#FFFFFF"; class="st1"\n            d="M14,7.2c-0.3,0-0.5-0.2-0.5-0.5V3.4c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v3.3C14.5,7,14.2,7.2,14,7.2z" />\n        </g>\n        <g id="Stroke-3">\n          <path fill="#FFFFFF"; class="st1"\n            d="M7.3,7.2C7,7.2,6.8,7,6.8,6.7V3.4c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v3.3C7.8,7,7.6,7.2,7.3,7.2z" />\n        </g>\n        <g id="Stroke-5">\n          <path fill="#FFFFFF"; class="st1"\n            d="M18.1,9.7h-15c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h15c0.3,0,0.5,0.2,0.5,0.5S18.4,9.7,18.1,9.7z" />\n        </g>\n        <g id="Stroke-7">\n          <path fill="#FFFFFF"; class="st1" d="M16.5,19.7H4.8c-1.2,0-2.2-1-2.2-2.2V6.7c0-1.2,1-2.2,2.2-2.2h11.7c1.2,0,2.2,1,2.2,2.2v10.8\nC18.6,18.8,17.7,19.7,16.5,19.7z M4.8,5.6c-0.6,0-1.2,0.5-1.2,1.2v10.8c0,0.6,0.5,1.2,1.2,1.2h11.7c0.6,0,1.2-0.5,1.2-1.2V6.7\nc0-0.6-0.5-1.2-1.2-1.2H4.8z" />\n        </g>\n        <g id="Stroke-9">\n          <path fill="#FFFFFF"; class="st1" d="M10.6,13.3c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5s0.3-0.2,0.5-0.2h0h0c0.4,0,0.7,0.3,0.7,0.7\nS11,13.3,10.6,13.3z" />\n        </g>\n        <g id="Stroke-11">\n          <path fill="#FFFFFF"; class="st1" d="M14.8,13.3c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.2,0.5-0.2c0.4,0,0.7,0.3,0.7,0.7\nS15.2,13.3,14.8,13.3z M14.8,12.3c-0.2,0-0.3,0.1-0.3,0.3c0,0.2,0.3,0.4,0.5,0.2c0.1-0.1,0.1-0.1,0.1-0.2\nC15.1,12.4,15,12.3,14.8,12.3z" />\n        </g>\n        <g id="Stroke-13">\n          <path fill="#FFFFFF"; class="st1" d="M6.5,16.6c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.2,0.5-0.2h0h0c0.4,0,0.7,0.3,0.7,0.7\nC7.2,16.3,6.9,16.6,6.5,16.6z" />\n        </g>\n        <g id="Stroke-15">\n          <path fill="#FFFFFF"; class="st1" d="M10.6,16.6c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.2,0.5-0.2h0h0c0.4,0,0.7,0.3,0.7,0.7\nC11.4,16.3,11,16.6,10.6,16.6z" />\n        </g>\n      </svg>\n    </span>\n  </div>\n</label>\n<input autocomplete="off" data-toggle="').concat(this.jSPlugin.id,'-datepicker" id="').concat(this.jSPlugin.id,'-datepicker" name="').concat(this.jSPlugin.id,'-datepicker" style="opacity:0;width:24px;margin-left:-24px;cursor:pointer;" />\n');o.innerHTML=a,P(o,i),this.timeLine=new ee(this.jSPlugin),this.timeLine.init({id:this.jSPlugin.id+"-canvas",width:t,onChange:function(t){console.log("time",t,new Date(t).Format("yyyyMMddhhmmss"));var i=new Date(t).Format("yyyyMMddhhmmss");if(console.log("----------------this.jSPlugin.url",e.jSPlugin.url),e.jSPlugin.Theme&&e.jSPlugin.Theme.decoderState.state.recordvideo&&(e.jSPlugin.Theme.setDecoderState({recordvideo:!1}),("cloud.rec"===j(e.jSPlugin.url).type||e.jSPlugin.capacity&&"1"==e.jSPlugin.capacity.support_seek_playback)&&e.jSPlugin.stopSave()),"cloud.rec"===j(e.jSPlugin.url).type||e.jSPlugin.capacity&&"1"==e.jSPlugin.capacity.support_seek_playback){var n=function(){e.jSPlugin.seek(i.substr(8,6),"235959"),e.unSyncTimeLine(),setTimeout((function(){e.syncTimeLine()}),6e3)};e.seekTimer?clearTimeout(e.seekTimer):n(),e.seekTimer=setTimeout((function(){n(),clearTimeout(e.seekTimer),e.seekTimer=null}),e.seekFrequency)}else{var o=function(){setTimeout((function(){e.disabled=!1}),e.seekFrequency)},a=e.jSPlugin.Theme.decoderState.state.play,r=function(t){e.disabled=!0,a?e.jSPlugin.pause(i).then((function(){console.log("暂停成功"),e.jSPlugin.resume(i).then((function(i){console.log("恢复成功：",i),e.jSPlugin.Theme&&e.jSPlugin.Theme.setDecoderState({play:!0}),e.jSPlugin.Theme&&e.jSPlugin.Theme.decoderState.state.sound&&e.jSPlugin.openSound(),t&&t()}))["catch"]((function(e){console.log("恢复失败",e)}))}))["catch"]((function(){console.log("暂停失败"),e.jSPlugin.resume(i).then((function(i){console.log("恢复成功"),e.jSPlugin.Theme&&e.jSPlugin.Theme.setDecoderState({play:!0}),t&&t()}))["catch"]((function(e){console.log("恢复失败",e)}))})):e.jSPlugin.resume().then((function(){e.jSPlugin.pause(i).then((function(){console.log("暂停成功"),e.jSPlugin.resume(i).then((function(i){console.log("恢复成功：",i),e.jSPlugin.Theme&&e.jSPlugin.Theme.setDecoderState({play:!0}),e.jSPlugin.Theme&&e.jSPlugin.Theme.decoderState.state.sound&&e.jSPlugin.openSound(),t&&t()}))["catch"]((function(e){console.log("恢复失败",e)}))}))["catch"]((function(){console.log("暂停失败"),e.jSPlugin.resume(i).then((function(i){console.log("恢复成功"),e.jSPlugin.Theme&&e.jSPlugin.Theme.setDecoderState({play:!0}),t&&t()}))["catch"]((function(e){console.log("恢复失败",e)}))}))})),e.jSPlugin.Theme&&e.jSPlugin.Theme.decoderState&&e.jSPlugin.Theme.decoderState.state&&e.jSPlugin.Theme.decoderState.state.zoom&&(e.jSPlugin.Theme.setDecoderState({zoom:!1}),e.jSPlugin.Zoom.stopZoom())};e.disabled?(console.log("操作频繁，等待2秒后执行"),e.seekTimer&&clearTimeout(e.seekTimer),e.seekTimer=setTimeout((function(){r(o)}),e.seekFrequency)):r(o)}}}),this.syncTimeLine(),w("".concat(this.jSPlugin.staticPath,"/rec/datepicker.min.css")),T("".concat(this.jSPlugin.staticPath,"/rec/jquery.min.js"),(function(){T("".concat(e.jSPlugin.staticPath,"/rec/datepicker.js"),(function(){T("".concat(e.jSPlugin.staticPath,"/rec/datepicker.zh-CN.js"),(function(){!document.getElementsByClassName("datepicker-container")[0]&&$("#".concat(e.jSPlugin.id,"-datepicker")).datepicker&&$("#".concat(e.jSPlugin.id,"-datepicker")).datepicker({autoShow:!1,autoHide:!0,autoPick:!0,language:"zh-CN",date:new Date(E("begin",e.jSPlugin.params.url).replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"))||new Date,format:"yyyy-mm-dd",endDate:new Date(E("end",e.jSPlugin.params.url).replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"))||new Date,inline:!0,container:document.getElementById("".concat(e.jSPlugin.id,"-wrap"))}),document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"),e.datepickerVisible=!1,$("#".concat(e.jSPlugin.id,"-datepicker")).on("pick.datepicker",(function(t){console.log("重新选择日期",t.date,new Date(t.date).Format("yyyyMMdd"),new Date(document.getElementById("".concat(e.jSPlugin.id,"-datepicker")).value).Format("yyyyMMdd")),t.date>new Date||new Date(t.date).Format("yyyyMMdd")===new Date(document.getElementById("".concat(e.jSPlugin.id,"-datepicker")).value).Format("yyyyMMdd")?t.preventDefault():(document.getElementById("".concat(e.jSPlugin.id,"-datepicker")).value=new Date(t.date).Format("yyyy-MM-dd"),console.log("----------------renderRec3"),e.renderRec(t.date),e.jSPlugin.Theme.decoderState&&e.jSPlugin.Theme.decoderState.state?e.jSPlugin.Theme.decoderState.state.cloudRec?e.jSPlugin.changePlayUrl({begin:new Date(t.date).Format("yyyyMMdd"),type:"cloud.rec"}):e.jSPlugin.Theme.decoderState.state.rec?e.jSPlugin.changePlayUrl({begin:new Date(t.date).Format("yyyyMMdd"),type:"rec"}):e.jSPlugin.changePlayUrl({begin:new Date(t.date).Format("yyyyMMdd")}):e.jSPlugin.changePlayUrl({begin:new Date(t.date).Format("yyyyMMdd")})),document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"),e.datepickerVisible=!1,e.jSPlugin.Theme&&e.jSPlugin.Theme.decoderState&&e.jSPlugin.Theme.decoderState.state&&e.jSPlugin.Theme.decoderState.state.zoom&&(e.jSPlugin.Theme.setDecoderState({zoom:!1}),e.jSPlugin.Zoom.stopZoom())})),$("#".concat(e.jSPlugin.id,"-datepicker")).off("click").on("click",(function(t){console.log("点击日期"),e.datepickerVisible?document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"):document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="inline"),e.datepickerVisible=!e.datepickerVisible}))}))}))})),document.getElementById("".concat(this.jSPlugin.id,"-timeline-scale-add")).onclick=function(){var t=e.currentTimeWidth;t<3&&e.timeLine.changeSize(++e.currentTimeWidth)},document.getElementById("".concat(this.jSPlugin.id,"-timeline-scale-sub")).onclick=function(){var t=e.currentTimeWidth;t>0&&e.timeLine.changeSize(--e.currentTimeWidth)};var r=E("begin",this.jSPlugin.url)||(new Date).Format("yyyyMMdd");console.log("----------------renderRec2"),this.renderRec("".concat(r.slice(0,4),"-").concat(r.slice(4,6),"-").concat(r.slice(6,8))),this.observer=new MutationObserver((function(t,i){e.recAutoSize()}));var s={attributes:!0,attributeOldValue:!0,attributeFilter:["style"]},d=document.getElementById("".concat(this.jSPlugin.id));this.observer.observe(d,s)}},{key:"setDatepickerDate",value:function(e){if(document.getElementsByClassName("datepicker-container")[0]){var t=document.getElementsByClassName("datepicker-container")[0],i=t.parentNode;i.removeChild(t),document.getElementById("".concat(this.jSPlugin.id,"-datepicker")).value=e.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3"),$("#".concat(this.jSPlugin.id,"-datepicker")).datepicker({autoShow:!1,autoHide:!0,autoPick:!0,language:"zh-CN",defaultDate:e,format:"yyyy-mm-dd",endDate:new Date,inline:!0,container:document.getElementById("".concat(this.jSPlugin.id,"-wrap"))})}}},{key:"datepickerHide",value:function(){document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"),this.datepickerVisible=!1}},{key:"datepickerShow",value:function(){document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="inline"),this.datepickerVisible=!0}},{key:"recAutoSize",value:function(){var e=this;if(document.getElementById("".concat(this.jSPlugin.id,"-canvas"))){var t=parseInt(getComputedStyle(document.getElementById(this.jSPlugin.id)).width,10)-100;t!==parseInt(document.getElementById("".concat(this.jSPlugin.id,"-canvas")).width)&&(document.getElementById("".concat(this.jSPlugin.id,"-canvas")).width=t,this.timeLine.init({id:"".concat(this.jSPlugin.id,"-canvas"),width:t,onChange:function(t){console.log("time",t,new Date(t).Format("yyyyMMddhhmmss")),console.log("jSPlugin",e.jSPlugin);var i=new Date(t).Format("yyyyMMddhhmmss");e.jSPlugin.changePlayUrl({begin:i})}}),console.log("----------------renderRec1"),this.renderRec(this.date),this.syncTimeLine())}}},{key:"syncTimeLine",value:function(){var e=this;this.jSPlugin.recTimer&&clearInterval(this.jSPlugin.recTimer),this.jSPlugin.recTimer=setInterval((function(){var t=e.jSPlugin.getOSDTime();t.then((function(t){var i=t.data;-1===i?console.log("获取播放时间错误"):i>0&&e.timeLine.run({time:new Date(i>1e12?i:1e3*i)})}))["catch"]((function(e){}))}),1e3)}},{key:"unSyncTimeLine",value:function(){this.jSPlugin.recTimer&&clearInterval(this.jSPlugin.recTimer)}},{key:"renderRec",value:function(e){var t=this;this.date=e;var i=this,n=new Date(new Date(e).Format("yyyy-MM-dd 00:00:00").replace(/-/g,"/")).getTime(),o=new Date(new Date(e).Format("yyyy-MM-dd 23:59:59").replace(/-/g,"/")).getTime();this.timeLine.getRecord([],n,o),console.log("-----------233---------this.jSPlugin.url",this.jSPlugin.url);var a={accessToken:this.jSPlugin.accessToken,recType:"cloud.rec"===j(this.jSPlugin.url).type?1:2,deviceSerial:j(this.jSPlugin.url).deviceSerial,channelNo:j(this.jSPlugin.url).channelNo,startTime:n,endTime:o,version:"2.0"},r=function(e){if(e.data&&e.data.files&&e.data.files.length>0){var r=e.data.files,s=(new Date).getTime(),d=e.data.isAll;if(d)t.timeLine.getRecord(r,n,o);else{var l=function e(){function t(t){t.data&&t.data.files&&t.data.files.length>0?0==t.data.isAll?(t.data.files&&(r=r.concat(t.data.files)),s=t.data.nextFileTime>0?t.data.nextFileTime:(new Date).getTime(),e()):(console.log("云存储执行渲染片段"),i.timeLine.getRecord(r,n,o)):i.timeLine.getRecord(r,n,o)}a.startTime=s,M(this.jSPlugin.env.domain+"/api/lapp/video/by/time","POST",a,"",t)};l()}t.timeLine.run({time:new Date(n)})}else e.data&&e.data.length>0&&(console.log("获取本地录像片段成功",e),i.timeLine.getRecord(e.data,n,o),i.timeLine.run({time:new Date(n)}))},s=this.jSPlugin.env.domain+"/api/lapp/video/by/time";M(s,"POST",a,"",r)}}]),e}(),ie=function(e){console.log("执行TimeLine - params",e),this.state={id:e.id,start:"00:00:00",end:"24:00:00",current:0,timelag:30,timeArr:[],availTimeLine:[],scrollTop:0,index:0,date:"",noTimeLineTxt:"",disabled:!1};var t=this;this.setState=function(e){Object.keys(e).forEach((function(i){t.state[i]=e[i],"scrollTop"===i&&document.getElementById("time-line-item").parentNode.scrollTo(0,e[i]),"current"===i&&(document.getElementById("time-line-current").innerHTML=e[i])}))},this.setDisabled=function(e){this.setState({disabled:e}),document.getElementById("time-line-item").parentNode.style.overflowY=e?"hidden":"scroll"},this.timeToSecond=function(e){var t=e.split(":"),i=Number(t[0]),n=Number(t[1]),o=Number(t[2]);return 60*i*60+60*n+(o||0)},this.minuteToTime=function(e){var t=Math.floor(e/60),i=e%60;return(t>9?t:"0"+t)+":"+(i>9?i:"0"+i)},this.timeToMinute=function(e){var t=e.split(":"),i=Number(t[0]),n=Number(t[1]);return 60*i+n},this.getPalyParam=e.getPalyParam,document.getElementById("time-line-item").parentNode.ontouchstart=function(){if(t.state.disabled)return!1;e.ontouchstart()},document.getElementById("time-line-item").parentNode.ontouchmove=function(){if(t.state.disabled)return!1;e.ontouchmove()},document.getElementById("time-line-item").parentNode.ontouchend=function(){if(t.state.disabled)return!1;var i,n=new Promise((function(e,t){var n=-1;i=setInterval((function(){var t=document.getElementById("time-line-item").parentNode.scrollTop;t!==n?(console.log("scolling",t,n),n=t):(console.log("scoll stop",t,n),clearInterval(i),e(t))}),100)}));n.then((function(e){console.log("scollPromise: then",e,t),t.rectTopTotime(e),console.log("页面滚动实际高度",e,t.state),t.getPalyParam({current:t.state.current})})),e.ontouchend()},this.matchTimeDot()};ie.prototype.changeScale=function(e){this.setState({timelag:e}),this.matchTimeDot()},ie.prototype.setDateLine=function(e,t){e.length>0?("undefined"===typeof t&&(t=e.length-1),this.setState({availTimeLine:e,start:e[t].st,end:e[t].et,current:e[t].st}),console.log("this.state",this.state),this.matchRecTimeDot(),this.primaryOffsetH()):(this.setState({availTimeLine:[]}),console.log("this.state",this.state),this.matchRecTimeDot())},ie.prototype.matchTimeDot=function(){var e=this.state,t=e.start,i=e.end,n=e.timelag;e.availTimeLine,console.log("start",t,"end",i);var o=[],a=this.timeToMinute(i);a=Math.floor(a/n)*n;for(var r=a;r>=0;){var s=0,d=0,l=[];r==a&&(s=70),0==r&&(d=230);var c=this.minuteToTime(r);o.push({id:r,current:c,label:"a"+r,marginTop:s,marginBottom:d,recArr:l}),r-=n}this.setState({timeArr:o}),this.renderDateLine()},ie.prototype.matchRecTimeDot=function(){var e=this.state,t=e.start,i=e.end,n=e.timelag,o=e.availTimeLine,a=e.timeArr;console.log("start",t,"end",i);var r=[],s=o.length;if(0===s)for(var d=0;d<a.length;d++)a[d].recArr=[];else{for(var l=0;l<a.length;l++)a[l].recArr=[];for(var c=0;c<s;c++){var u=o[c],m=this.timeToSecond(u.st),p=this.timeToSecond(u.et),h=void 0,f=void 0,g=0,v=0;h=Math.floor(m/(60*n))*n,g=(m-60*h)/n,f=Math.floor(p/(60*n))*n,v=(p-60*f)/n,r[c]={st:h,et:f,stAvailPercent:g,etAvailPercent:v};for(d=0;d<a.length;d++)if(a[d].id==h&&a[d].id==f){var y=v-g,S=60-v;a[d].recArr.push({height:y,top:S})}else a[d].id==h?a[d].recArr.push({height:60-g,top:0}):a[d].id==f?a[d].recArr.push({height:v,top:60-v}):a[d].id>h&&a[d].id<f&&a[d].recArr.push({height:60,top:0})}}console.log("availArr: ",r),this.setState({timeArr:a}),console.log("timeArr:",this.state),this.renderDateLine()},ie.prototype.renderDateLine=function(){var e=this.state,t=e.id,i=e.timeArr;console.log("id,timeArr",t,i);var n=document.getElementById("time-line-item");n.innerHTML="",i.forEach((function(e,t){var i=document.createElement("div");i.setAttribute("class","time-item"),i.style="margin-top: ".concat(e.marginTop,"px; margin-bottom: ").concat(e.marginBottom,"px; border-right-color: ").concat(e.borderColor,";");var o=document.createElement("div");o.setAttribute("class","scale");var a='<div class="scale"></div><div class="scale"></div><div class="scale"></div><div class="scale"></div><div class="scale"></div><div class="scale" style="width:10px"></div>';e.recArr.forEach((function(e,t){a+='<div class="item-unavail" style="height: '.concat(e.height,"px;background-color:#A8B9ED; top: ").concat(e.top,'px"></div>')})),a+="<div id=".concat(e.label,' style="position: relative; top: 51px; left: 40%"> ').concat(e.current,"</div>"),i.innerHTML=a,n.appendChild(i)}))},ie.prototype.primaryOffsetH=function(){var e=this.state,t=e.start,i=e.timelag,n=e.timeArr,o=n[0].current,a=this.timeToSecond(o),r=this.timeToSecond(t),s=a-r,d=Math.ceil(s/i)+60;this.setState({scrollTop:d}),console.log("起始偏移量",d)},ie.prototype.currentOffsetH=function(){var e=this.state,t=e.current,i=e.timelag,n=e.timeArr,o=n[0].current,a=this.timeToSecond(o),r=this.timeToSecond(t),s=a-r,d=Math.ceil(s/i)+60;this.setState({scrollTop:d})},ie.prototype.rectTopTotime=function(e){var t,i,n=this.state.timelag,o=Math.floor(e/60),a=e-60*o;if(console.log("index：",o,"offsetH:",a),0==a)t=this.state.timeArr[o-1].current,i=0;else{var r=this.state.timeArr[o].current,s=this.timeToMinute(r),d=60-a,l=d*n,c=Math.floor(l/60)+s,u=60*Math.floor(l/60);i=Math.ceil(l-u),t=this.minuteToTime(c)}this.setState({current:t+":"+(i>9?i:"0"+i),scrollTop:e})},ie.prototype.stepScrollTimeLine=function(e){this.setState({current:e}),this.currentOffsetH()},ie.prototype.secondCountDown=function(e){var t=this.state.current,i=t.split(":"),n=Number(i[0]),o=Number(i[1]),a=Number(i[2]),r=60*n*60+60*o+a+1,s=Math.floor(r/3600),d=Math.floor((r-3600*s)/60),l=r-3600*s-60*d;this.setState({current:(s>9?s:"0"+s)+":"+(d>9?d:"0"+d)+":"+(l>9?l:"0"+l)})};var ne=ie;function oe(e){var t=new Date(e),i=t.getHours(),n=t.getMinutes(),o=t.getSeconds();return(i>9?i:"0"+i)+":"+(n>9?n:"0"+n)+":"+(o>9?o:"0"+o)}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var ae=function(){function e(t,i,n){var o=this;p(this,e),this.changeRecSpeed=i,this.resetMobileZoomStatus=n,this.isMobile=!0,this.jSPlugin=t,this.timer=null,this.date=(new Date).Format("yyyy-MM-dd"),this.begin=((new Date).Format("yyyy-MM-dd")+" 00:00:00").replace(/-/g,"/"),this.end=((new Date).Format("yyyy-MM-dd")+" 23:59:59").replace(/-/g,"/"),this.initBegin=null,this.initEnd=null,this.type=j(this.jSPlugin.url).type,this.operating=!1,this.seekTimer=null,this.disabled=!1,this.seekFrequency=2e3,this.jSPlugin.params&&this.jSPlugin.params.seekFrequency&&(this.seekFrequency=this.jSPlugin.params.seekFrequency);var a=document.createElement("style");if(a.innerHTML='\n    body{\n      padding: 0;\n      margin: 0;\n    }\n    .time-line-container {\n      text-align: left;\n      height: 300px;\n      /* outline: 1px solid red; */\n      /* background: gray; */\n      position: relative;\n      /* padding-top: 60px; */\n      margin-top: 20px;\n    }\n\n    .time-line-container .time-line-item-container {\n      display: inline-block;\n      /* height: 400px; */\n      width: 30%;\n      /* background: indianred; */\n      overflow-y: scroll;\n      overflow-x: hidden;\n      /* padding-top: 60px; */\n      height: 300px;\n      box-sizing: border-box;\n      white-space: nowrap;\n      position: relative;\n    }\n\n    .time-line-container .time-line-item-container::-webkit-scrollbar {\n      width: 0px;\n      /*滚动条宽度*/\n      height: 0px;\n      /*滚动条高度*/\n    }\n\n    .time-line-item .time-item {\n      position: relative;\n      box-sizing: border-box;\n      height: 60px;\n      font-size: 12px;\n      color: rgb(150, 150, 150);\n      border-right: 6px solid;\n      border-right-color: #ddd;\n    }\n\n    .time-line-item .time-item .scale {\n      width: 6px;\n      height: 9px;\n      border-bottom: 1px solid #ccc;\n      float: right;\n      clear: both;\n    }\n\n    .time-line-item .time-item .item-unavail {\n      width: 6px;\n      position: absolute;\n      left: 100%;\n      background-color: #ddd;\n    }\n\n    .time-line-container .current-time {\n      position: absolute;\n      left: 0;\n      top: 40px;\n      height: 29px;\n      /* line-height: 58px; */\n      border-bottom: 1px solid #648FFC;\n      width: 60%;\n      margin-left: 26%;\n    }\n\n    .time-line-container .current-time .current-time-bg {\n      position: relative;\n      top: 15px;\n      width: 100px;\n      height: 29px;\n      line-height: 29px;\n      left: -70px;\n      font-size: 12px;\n      color: #2C2C2C;\n    }\n\n    .time-line-container .current-time .current-time-bg::before {\n      content: \'\';\n      display: inline-block;\n      width: 6px;\n      height: 6px;\n      border-radius: 100%;\n      background: #648FFC;\n      top: 11px;\n      position: absolute;\n      right: 30px;\n    }\n\n    .date-switch-container {\n      height: 40px;\n      position: relative;\n      text-align: center;\n      margin: 20px 10px;\n    }\n\n    .date-switch-container .current-date {\n      line-height: 40px;\n      height: 22px;\n      font-size: 16px;\n      color: #2C2C2C;\n      text-align: center;\n      font-weight: bold;\n    }\n\n    .date-container {\n      width: 40px;\n      height: 40px;\n      position: absolute;\n      right: 0;\n      top: 0;\n    }\n\n    .rec-type-container {\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .rec-type-container .rec-type-text {\n      padding: 0 15px;\n      font-size: 12px;\n      color: #2C2C2C;\n    }\n\n    .rec-type-container .rec-type-switch {\n      padding: 0 20px;\n    }\n\n    .date-container input {\n      position: absolute;\n      opacity: 0;\n      display: inline-block;\n      width: 40px;\n      height: 40px;\n      z-index: 10;\n      left: 0;\n    }\n\n    .date-container label {\n      position: absolute;\n      left: 0;\n      top: 0;\n      /* display: none; */\n      z-index: 0;\n    }\n\n    .date-icon {\n      display: inline-block;\n      width: 40px;\n      height: 40px;\n      background: url(\'https://resource.eziot.com/group2/M00/00/6A/CtwQF2F6VieAQrU9AAABP-_Nsqo949.png\') no-repeat 100% 100%;\n    }\n    .select-container {\n      padding: 10px;\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .advice {\n      height: 24px;\n      width: 70px;\n      display: flex;\n      justify-content: space-between;\n      line-height: 24px;\n      background: #F8F8F8;\n      border-radius: 8px;\n    }\n\n    .advice span {\n      width: 40px;\n      display: inline-block;\n    }\n\n    input[type="checkbox"]:not(:checked)+.advice span:first-child {\n      box-shadow: 0px 2px 5px 0px rgb(23 45 101 / 20%);\n      border-radius: 8px;\n      text-align: center;\n\n    }\n\n    input[type="checkbox"]:checked+.advice span:last-child {\n      box-shadow: 0px 2px 5px 0px rgb(23 45 101 / 20%);\n      border-radius: 8px;\n      text-align: center;\n    }\n\n    input[type="checkbox"]:not(:checked)+.advice span:first-child svg {\n      fill: #648FFC !important;\n    }\n\n    input[type="checkbox"]:checked+.advice span:last-child svg {\n      fill: #648FFC !important;\n    }',document.getElementsByTagName("head")[0].appendChild(a),E("begin",this.jSPlugin.url)){var r=E("begin",this.jSPlugin.url);this.date=r.slice(0,4)+"/"+r.slice(4,6)+"/"+r.slice(6,8),this.begin=this.date+" ".concat(r.slice(8,10)||"00",":").concat(r.slice(10,12)||"00",":").concat(r.slice(12,14)||"00"),this.end=this.date+" 23:59:59",this.initBegin=this.begin}if(E("end",this.jSPlugin.url)){var s=E("end",this.jSPlugin.url);this.end=this.date+" ".concat(s.slice(8,10)||"23",":").concat(s.slice(10,12)||"59",":").concat(s.slice(12,14)||"59"),this.initEnd=this.end}var d=document.createElement("div");d.id="date-switch-container-wrap",d.className="date-switch-container-wrap",d.style="",d.innerHTML='\n      <div class="date-switch-container">\n      <div class="current-date" id="current-date">今日录像</div>\n      <div class="date-container">\n        <label for="date">\n          <div class="date-icon"></div>\n        </label>\n        <input type="date" name="date" id="date" />\n      </div>\n    </div>\n        ',P(d,document.getElementById("".concat(this.jSPlugin.id,"-wrap")));var l=document.createElement("div");l.id="rec-type-container-wrap",l.className="rec-type-container-wrap",l.style="",l.innerHTML='\n    <div class="rec-type-container">\n    <div class="rec-type-text">共<span id="recCount">0</span>个录像</div>\n    <div class="rec-type-switch">\n      <label>\n        <input type="checkbox" name="type" id="cloudType" value="1" hidden />\n        <label for="cloudType" class="advice">\n          <span>\n          <svg fill="#CCCCCC" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="2 0 20 20">\n            <path class="st0" d="M12.6,5c-2.3,0.1-4.3,1.4-5.3,3.3L7.2,8.6c-2.4,0.5-4.1,2.5-4.1,4.9c0,2.8,2.4,5,5.2,5h9.9\n            c2.4,0,4.3-1.9,4.3-4.2l0-0.2c-0.1-2-1.6-3.5-3.5-3.9l-0.1,0l0-0.2c-0.4-2.8-3-5-6.1-5L12.6,5z"/>\n          </svg>\n        </span>\n        <span>\n          <svg fill="#CCCCCC" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="2 0 20 20">\n            <path id="形状结合" class="st0" d="M14.3,4c0.6,0,1.2,0.2,1.7,0.7l0,0L18.3,7C18.7,7.4,19,8,19,8.6l0,0v9c0,1.3-1.1,2.3-2.4,2.3\n\tl0,0H8.4C7.1,20,6,19,6,17.7l0,0V6.3C6,5,7.1,4,8.4,4l0,0H14.3z M9.7,7.2C9.3,7.2,8.9,7.6,8.9,8l0,0v2.5l0,0.1\n\tc0,0.4,0.4,0.6,0.7,0.6c0.4,0,0.8-0.3,0.8-0.8l0,0V8l0-0.1C10.4,7.5,10,7.2,9.7,7.2z M12.2,7.2c-0.4,0-0.8,0.3-0.8,0.8l0,0v2.5\n\tl0,0.1c0,0.4,0.4,0.6,0.7,0.6c0.4,0,0.8-0.3,0.8-0.8l0,0V8l0-0.1C12.9,7.5,12.5,7.2,12.2,7.2z M14.7,7.2c-0.4,0-0.8,0.3-0.8,0.8l0,0\n\tv2.5l0,0.1c0,0.4,0.4,0.6,0.7,0.6c0.4,0,0.8-0.3,0.8-0.8l0,0V8l0-0.1C15.4,7.5,15,7.2,14.7,7.2z"/>\n          </svg>\n        </span>\n        </label>\n      </label>\n    </div>\n  </div>\n        ',P(l,d);var c=document.createElement("div");c.id="mobile-rec-wrap",c.className="mobileRec-wrap",c.style="",c.innerHTML='\n    <div class="time-line-container">\n    <div class="current-time">\n      <div class="current-time-bg" id="time-line-current">2020-01-01 00:00:00</div>\n    </div>\n    <div class="time-line-item-container">\n      <div class="time-line-item" id="time-line-item">\n      </div>\n    </div>\n    </div>\n      ',P(c,l);var u=function(e){console.log("子组件传值到父组件",e,e.current);var t=e.current,i=new Date(o.date).Format("yyyyMMdd").substr(0,8)+(e.current?t.replace(/:/g,""):e.current.replace(/:/g,""));if(o.initBegin&&new Date("".concat(o.date," ").concat(e.current)).getTime()<new Date(o.initBegin).getTime()&&(console.log("超过限制最低值"),i=new Date(o.initBegin).Format("yyyyMMddhhmmss")),o.initEnd&&new Date("".concat(o.date," ").concat(e.current)).getTime()>new Date(o.initEnd).getTime()&&(console.log("超过限制最高值"),i=new Date(o.initBegin).Format("yyyyMMddhhmmss")),"cloud.rec"===o.type){var n=function(){o.jSPlugin.seek(i.substr(8,6),"235959"),setTimeout((function(){o.syncTimeLine()}),6e3)};o.seekTimer?clearTimeout(o.seekTimer):n(),console.log("this.jsPlug",o.jSPlugin.params),o.seekTimer=setTimeout((function(){n(),clearTimeout(o.seekTimer),o.seekTimer=null}),o.seekFrequency)}else{var a=function(){setTimeout((function(){o.disabled=!1}),o.seekFrequency)},r=function(e){o.disabled=!0,o.jSPlugin.pause(i).then((function(){console.log("暂停成功"),o.jSPlugin.resume(i).then((function(t){console.log("恢复成功"),o.jSPlugin.Theme&&o.jSPlugin.Theme.setDecoderState({play:!0}),o.jSPlugin.Theme&&o.jSPlugin.Theme.decoderState.state.sound&&o.jSPlugin.openSound(),o.syncTimeLine(),e&&e()}))}))["catch"]((function(){console.log("暂停失败"),o.jSPlugin.resume(i).then((function(t){console.log("恢复成功"),o.jSPlugin.Theme&&o.jSPlugin.Theme.setDecoderState({play:!0}),o.syncTimeLine(),e&&e()}))}))};o.disabled?(console.log("操作频繁，等待2秒后执行"),o.seekTimer&&clearTimeout(o.seekTimer),o.seekTimer=setTimeout((function(){r(a)}),o.seekFrequency)):r(a)}},m=function(){o.operating=!0,o.unSyncTimeLine()},h=function(){},f=function(){o.operating=!1,console.log("ontouchend")};this.TimeLineOBJ=new ne({id:"time-line-item",getPalyParam:u,ontouchstart:m,ontouchmove:h,ontouchend:f}),this.fetchDeviceRec(),document.getElementById("date").addEventListener("change",(function(e){if(console.log("日期变化",e.target.value),o.initBegin||o.initEnd)return console.log("您开启了时间限制，无法切换日期"),!1;o.date=new Date(e.target.value).Format("yyyy/MM/dd"),o.begin=o.date+" 00:00:00",o.end=o.date+" 23:59:59",o.fetchDeviceRec(),o.jSPlugin.changePlayUrl({type:o.type,begin:"".concat(new Date(o.date).Format("yyyyMMdd"),"000000")}),o.changeRecSpeed(1),o.resetMobileZoomStatus()})),document.getElementById("cloudType").checked="rec"===this.type,document.getElementById("cloudType").addEventListener("change",(function(e){var t=e.target.checked?2:1;o.type=e.target.checked?"rec":"cloud.rec",console.log("recType",t),o.fetchDeviceRec(),o.jSPlugin.changePlayUrl({type:o.type,begin:"".concat(new Date(o.date).Format("yyyyMMdd"),"000000")}).then((function(){console.log("切换类型成功"),o.syncTimeLine(),o.changeRecSpeed(1),o.resetMobileZoomStatus()}),(function(e){console.log("err",e)}))["catch"]((function(e){console.log(e)}))})),this.syncTimeLine()}return f(e,[{key:"fetchDeviceRec",value:function(){var e=this,t=function(t){var i=t.length;document.getElementById("recCount").innerHTML=i;for(var n=[],o=i-1;o>=0;o--){var a=t[o],r=oe(a.endTime),s=oe(a.startTime);n.push({st:s,et:r})}e.TimeLineOBJ.setDateLine(n)},i=new FormData;i.append("deviceSerial",j(this.jSPlugin.url).deviceSerial),i.append("channelNo",j(this.jSPlugin.url).channelNo),i.append("accessToken",this.jSPlugin.accessToken),i.append("recType","cloud.rec"===this.type?1:2),i.append("startTime",new Date(this.begin).getTime()),i.append("endTime",new Date(this.end).getTime()),fetch(this.jSPlugin.env.domain+"/api/lapp/video/by/time",{method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){if(200==e.code&&e.data){var i=[];i=e.data,t(i)}else t([])}))}},{key:"syncTimeLine",value:function(){var e=this,t=function(e){var t=new Date(e),i=t.getHours(),n=t.getMinutes(),o=t.getSeconds();return(i>9?i:"0"+i)+":"+(n>9?n:"0"+n)+":"+(o>9?o:"0"+o)};this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){if(e.operating)return console.log("操作中"),!1;e.jSPlugin.getOSDTime().then((function(i){i.data>0?e.TimeLineOBJ.stepScrollTimeLine(t(1e3*i.data)):(console.log("未找到当前获取播放时间，等待中..."),console.log("res:-----------------",i))}))["catch"]((function(e){console.log("err:-----",e),console.log("未找到当前获取播放时间，等待中...")}))}),1e3)}},{key:"unSyncTimeLine",value:function(){this.timer&&clearInterval(this.timer)}}]),e}(),re=[{code:200,msg:"",desc:"请求成功",text:"操作成功",type:"ptzStart"},{code:10001,msg:"操作失败",desc:"参数为空或格式不正确",text:"参数错误",type:"ptzStart"},{code:10002,msg:"账号异常，操作失败",desc:"重新获取accessToken",text:"accessToken异常或过期",type:"ptzStart"},{code:10005,msg:"账号异常，操作失败",desc:"appKey被冻结",text:"appKey异常",type:"ptzStart"},{code:20002,msg:"设备不存在，请检查设备连接情况",desc:"",text:"设备不存在",type:"ptzStart"},{code:20006,msg:"操作失败，请检查设备网络情况",desc:"检查设备网络状况，稍后再试",text:"网络异常",type:"ptzStart"},{code:20007,msg:"操作失败，请检查设备在线情况",desc:"检查设备是否在线",text:"设备不在线",type:"ptzStart"},{code:20008,msg:"操作过于频繁，稍后再试",desc:"操作过于频繁，稍后再试",text:"设备响应超时",type:"ptzStart"},{code:20014,msg:"操作失败",desc:"",text:"deviceSerial不合法",type:"ptzStart"},{code:20032,msg:"通道不存在请检查设备连接情况",desc:"该用户下通道不存在",text:"该用户下通道不存在",type:"ptzStart"},{code:49999,msg:"操作失败，请重试",desc:"接口调用异常",text:"数据异常",type:"ptzStart"},{code:6e4,msg:"操作失败，设备不支持该操作",desc:"",text:"设备不支持云台控制",type:"ptzStart"},{code:60001,msg:"操作失败，用户无权限",desc:"",text:"用户无云台控制权限",type:"ptzStart"},{code:60002,msg:"设备已旋转到上限位",desc:"",text:"设备云台旋转达到上限位",type:"ptzStart"},{code:60003,msg:"设备已旋转到下限位",desc:"",text:"设备云台旋转达到下限位",type:"ptzStart"},{code:60004,msg:"设备已旋转到左限位",desc:"",text:"设备云台旋转达到左限位",type:"ptzStart"},{code:60005,msg:"设备已旋转到右限位",desc:"",text:"设备云台旋转达到右限位",type:"ptzStart"},{code:60006,msg:"操作失败，请重试",desc:"稍候再试",text:"云台当前操作失败",type:"ptzStart"},{code:60009,msg:"设备正在操作中",desc:"",text:"正在调用预置点",type:"ptzStart"},{code:60020,msg:"操作失败",desc:"确认设备是否支持该操作",text:"不支持该命令",type:"ptzStart"}],se=[{code:200,msg:"",desc:"请求成功",text:"操作成功",type:"ptzStop"},{code:10001,msg:"操作失败",desc:"参数为空或格式不正确",text:"参数错误",type:"ptzStop"},{code:10002,msg:"账号异常，操作失败",desc:"重新获取accessToken",text:"accessToken异常或过期",type:"ptzStop"},{code:10005,msg:"账号异常，操作失败",desc:"appKey被冻结",text:"appKey异常",type:"ptzStop"},{code:20002,msg:"设备不存在，请检查设备连接情况",desc:"",text:"设备不存在",type:"ptzStop"},{code:20006,msg:"操作失败，请检查设备网络情况",desc:"检查设备网络状况，稍后再试",text:"网络异常",type:"ptzStop"},{code:20007,msg:"操作失败，请检查设备在线情况",desc:"检查设备是否在线",text:"设备不在线",type:"ptzStop"},{code:20008,msg:"操作过于频繁，稍后再试",desc:"操作过于频繁，稍后再试",text:"设备响应超时",type:"ptzStop"},{code:20014,msg:"操作失败",desc:"",text:"deviceSerial不合法",type:"ptzStop"},{code:20032,msg:"通道不存在请检查设备连接情况",desc:"该用户下通道不存在",text:"该用户下通道不存在",type:"ptzStop"},{code:49999,msg:"操作失败，请重试",desc:"接口调用异常",text:"数据异常",type:"ptzStop"},{code:6e4,msg:"操作失败，设备不支持该操作",desc:"",text:"设备不支持云台控制",type:"ptzStop"},{code:60001,msg:"操作失败，用户无权限",desc:"",text:"用户无云台控制权限",type:"ptzStop"},{code:60006,msg:"操作失败，请重试",desc:"稍候再试",text:"云台当前操作失败",type:"ptzStop"},{code:60009,msg:"设备正在操作中",desc:"",text:"正在调用预置点",type:"ptzStop"},{code:60020,msg:"操作失败",desc:"确认设备是否支持该操作",text:"不支持该命令",type:"ptzStop"}],de=[{code:200,msg:"",desc:"请求成功",text:"操作成功",type:"talk"},{code:10001,msg:"播放失败",desc:"参数为空或格式不正确",text:"参数错误",type:"talk"},{code:10002,msg:"账号异常，操作失败",desc:"",text:"accessToken异常或过期",type:"talk"},{code:10031,msg:"账号异常，操作失败",desc:"",text:"子账户或萤石用户没有权限",type:"talk"},{code:20002,msg:"设备不存在请检查设备连接情况",desc:"设备序列号输入有误或者设备未被添加或者通道异常",text:"设备不存在",type:"talk"},{code:60059,msg:"播放失败",desc:"",text:"ezopen地址均不可用",type:"talk"}],le=[{code:200,msg:"",desc:"",text:"操作成功",type:"time"},{code:10001,msg:"播放失败",desc:"参数为空或格式不正确",text:"参数错误",type:"time"},{code:10002,msg:"账号异常，播放失败",desc:"",text:"accessToken异常或过期",type:"time"},{code:10004,msg:"账号异常，播放失败",desc:"",text:"用户不存在",type:"time"},{code:10005,msg:"账号异常，播放失败",desc:"",text:"appKey异常",type:"time"},{code:10011,msg:"播放失败",desc:"设备对应用户未注册至应用下",text:"未开通萤石服务",type:"time"},{code:10013,msg:"账号异常，播放失败",desc:"",text:"非开发者账号无权限调用",type:"time"},{code:10030,msg:"播放失败",desc:"",text:"appkey和appsecret不匹配",type:"time"},{code:20002,msg:"设备不存在请检查设备连接情况",desc:"设备序列号输入有误或者设备未被添加或者通道异常",text:"设备不存在",type:"time"},{code:20014,msg:"播放失败",desc:"",text:"deviceSerial不合法",type:"time"},{code:20032,msg:"设备不存在请检查设备连接情况",desc:"",text:"该用户下通道不存在",type:"time"},{code:60024,msg:"播放失败请重试",desc:"",text:"取消订阅操作失败",type:"time"},{code:49999,msg:"播放失败请重试",desc:"",text:"操作异常",type:"time"}],ce={ptzStart:re,ptzStop:se,talk:de,time:le},ue=function(){function e(t,i){p(this,e),this.coreX=t,this.coreY=i,console.log("uikitCode",ce)}return f(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"matchInfo",value:function(e,t){if(ce[t]){var i={};return ce[t].map((function(t){t.code==e&&(i=t)})),i}return{code:500,msg:"未知错误",desc:"未知的错误码，或错误码类型有误",text:"",type:t}}}]),e}(),me=function(){function e(t){var i=this;if(p(this,e),this.jSPlugin=t,this.codeHandler=new ue,this.pluginStatus=new V(this,this.jSPlugin.id),this.showPtz=!1,console.log("云台初始化"),document.getElementById(this.jSPlugin.id+"-ez-ptz-item"))return!1;var n=document.createElement("div");n.id=this.jSPlugin.id+"-ez-ptz-item",n.className="ez-ptz-wrap",n.style="display:none";var o=document.createElement("style");o.innerHTML="\n    .ez-ptz-container {\n      position: relative;\n      width: 80px;\n      height: 80px;\n      background: rgba(255, 255, 255, 0.80);\n      box-shadow: 0px 0px 33px 4px rgb(0 0 0 / 15%);\n      border: 1px solid rgba(255, 255, 255, 0.80);\n      border-radius: 100%;\n      cursor: pointer;\n      overflow: hidden;\n      user-select: none;\n    }\n    .ez-ptz-container .ez-ptz-icon.top {\n      width: 0;\n      height: 0;\n      border-left: 3px solid transparent;\n      border-right: 3px solid transparent;\n      border-bottom: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 3px);\n      top: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.top.active {\n      border-bottom-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.bottom {\n      width: 0;\n      height: 0;\n      border-left: 3px solid transparent;\n      border-right: 3px solid transparent;\n      border-top: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 3px);\n      bottom: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.bottom.active {\n      border-top-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.right {\n      width: 0;\n      height: 0;\n      border-top: 3px solid transparent;\n      border-bottom: 3px solid transparent;\n      border-left: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 3px);\n      right: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.right.active {\n      border-left-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.left {\n      width: 0;\n      height: 0;\n      border-top: 3px solid transparent;\n      border-bottom: 3px solid transparent;\n      border-right: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 3px);\n      left: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.left.active {\n      border-right-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-main.center {\n      width: 23px;\n      height: 23px;\n      background: #1890FF;\n      border-radius: 100%;\n      top: calc(50% - 12.3px);\n      left: calc(50% - 12.3px);\n      position: absolute;\n    }\n\n    .ez-ptz-wrap {\n      position: absolute;\n      right: 20px;\n      top: calc(50% - 50px);\n      width: 100px;\n      height: 100px;\n      z-index: 999;\n    }\n\n    .ez-ptz-close {\n      position: absolute;\n      color: #FFFFFF;\n      top: 0;\n      right: 0px;\n    }",document.getElementsByTagName("head")[0].appendChild(o),n.innerHTML='\n      <div class="ez-ptz-container" id="'.concat(this.jSPlugin.id,'-ez-ptz-container" style="position: relative;width: 80px;height: 80px;background: rgba(255, 255, 255, 0.80);box-shadow: 0px 0px 33px 4px rgba(0, 0, 0, 0.15);border: 1px solid rgba(255, 255, 255, 0.80);border-radius: 100%;cursor: pointer;overflow: hidden;user-select: none;">\n        <div class="ez-ptz-main center"></div>\n        <div class="ez-ptz-icon top active"></div>\n        <div class="ez-ptz-icon left active"></div>\n        <div class="ez-ptz-icon bottom active"></div>\n        <div class="ez-ptz-icon right active"></div>\n      '),document.getElementById("".concat(t.id,"-wrap")).appendChild(n),document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).onmousedown=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).onmouseup=function(e){e.preventDefault(),console.log("触摸结束"),i._handlePtzTouch(e,"stop")},document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).ontouchstart=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).ontouchend=function(e){e.preventDefault(),console.log("触摸结束",e),i._handlePtzTouch(e,"stop")}}return f(e,[{key:"show",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-item")).style="display: inline-block",this.showPtz=!0}},{key:"hide",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-item")).style="display: none",this.showPtz=!1}},{key:"_handlePtzTouch",value:function(e,t){var i=this,n=document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).getBoundingClientRect(),o=n.left+41,a=n.top+41,r=e.x||e.changedTouches[0].clientX,s=e.y||e.changedTouches[0].clientY,d=r-o,l=s-a,c=0,u=this.jSPlugin.env.domain+"/api/lapp/device/ptz/start";if(c=Math.abs(d)>Math.abs(l)?d>0?3:2:l>0?1:0,/^rotate\(90/.test(document.getElementById("".concat(this.jSPlugin.id,"-wrap")).style.transform))switch(c){case 0:c=2;break;case 1:c=3;break;case 2:c=1;break;case 3:c=0;break}document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).style="background-image:linear-gradient(".concat(0===c?180:1===c?0:2===c?90:270,"deg, #1d8dd8 0%, rgba(100,143,252,0.00) 30%)"),"stop"===t&&(u=this.jSPlugin.env.domain+"/api/lapp/device/ptz/stop",document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).style="");var m=new FormData;m.append("deviceSerial",j(this.jSPlugin.url).deviceSerial),m.append("channelNo",j(this.jSPlugin.url).channelNo),m.append("speed",1),m.append("direction",c),m.append("accessToken",this.jSPlugin.accessToken),fetch(u,{method:"POST",body:m}).then((function(e){return e.json()})).then((function(e){200==e.code||(console.log(e.code,i.codeHandler.matchInfo(e.code,"start"===t?"ptzStart":"ptzStop")),i.pluginStatus.loadingSetText({text:i.codeHandler.matchInfo(e.code,"start"===t?"ptzStart":"ptzStop").msg,color:"red",delayClear:2e3}),60005!=e.code&&60002!=e.code&&60003!=e.code&&60004!=e.code||(document.getElementById("".concat(i.jSPlugin.id,"-ez-ptz-container")).style="background-image:linear-gradient(".concat(0===c?180:1===c?0:2===c?90:270,"deg, #f45656 0%, rgba(100,143,252,0.00) 30%)")))}))["catch"]((function(e){console.log("云台调用异常",e)}))}}]),e}();(function(e){"object"===c(t)&&"undefined"!==typeof i?i.exports=e():(o=[],n=e,a="function"===typeof n?n.apply(t,o):n,void 0===a||(i.exports=a))})((function(){return function(){function e(t,i,n){function o(s,d){if(!i[s]){if(!t[s]){var l="function"==typeof r&&r;if(!d&&l)return r(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};t[s][0].call(u.exports,(function(e){var i=t[s][1][e];return o(i||e)}),u,u.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof r&&r,s=0;s<n.length;s++)o(n[s]);return o}return e}()({1:[function(e,t,i){var n=e("./adapter_factory.js"),o=(0,n.adapterFactory)({window:window});window.adapter=o,t.exports=o},{"./adapter_factory.js":2}],2:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.adapterFactory=g;var n=e("./utils"),o=f(n),a=e("./chrome/chrome_shim"),r=f(a),s=e("./edge/edge_shim"),d=f(s),l=e("./firefox/firefox_shim"),c=f(l),u=e("./safari/safari_shim"),m=f(u),p=e("./common_shim"),h=f(p);function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=o.log,a=o.detectBrowser(t),s={browserDetails:a,commonShim:h,extractVersion:o.extractVersion,disableLog:o.disableLog,disableWarnings:o.disableWarnings};switch(a.browser){case"chrome":if(!r||!r.shimPeerConnection||!i.shimChrome)return n("Chrome shim is not included in this adapter release."),s;n("adapter.js shimming chrome."),s.browserShim=r,r.shimGetUserMedia(t),r.shimMediaStream(t),r.shimPeerConnection(t),r.shimOnTrack(t),r.shimAddTrackRemoveTrack(t),r.shimGetSendersWithDtmf(t),r.shimGetStats(t),r.shimSenderReceiverGetStats(t),r.fixNegotiationNeeded(t),h.shimRTCIceCandidate(t),h.shimConnectionState(t),h.shimMaxMessageSize(t),h.shimSendThrowTypeError(t),h.removeAllowExtmapMixed(t);break;case"firefox":if(!c||!c.shimPeerConnection||!i.shimFirefox)return n("Firefox shim is not included in this adapter release."),s;n("adapter.js shimming firefox."),s.browserShim=c,c.shimGetUserMedia(t),c.shimPeerConnection(t),c.shimOnTrack(t),c.shimRemoveStream(t),c.shimSenderGetStats(t),c.shimReceiverGetStats(t),c.shimRTCDataChannel(t),c.shimAddTransceiver(t),c.shimCreateOffer(t),c.shimCreateAnswer(t),h.shimRTCIceCandidate(t),h.shimConnectionState(t),h.shimMaxMessageSize(t),h.shimSendThrowTypeError(t);break;case"edge":if(!d||!d.shimPeerConnection||!i.shimEdge)return n("MS edge shim is not included in this adapter release."),s;n("adapter.js shimming edge."),s.browserShim=d,d.shimGetUserMedia(t),d.shimGetDisplayMedia(t),d.shimPeerConnection(t),d.shimReplaceTrack(t),h.shimMaxMessageSize(t),h.shimSendThrowTypeError(t);break;case"safari":if(!m||!i.shimSafari)return n("Safari shim is not included in this adapter release."),s;n("adapter.js shimming safari."),s.browserShim=m,m.shimRTCIceServerUrls(t),m.shimCreateOfferLegacy(t),m.shimCallbacksAPI(t),m.shimLocalStreamsAPI(t),m.shimRemoteStreamsAPI(t),m.shimTrackEventTransceiver(t),m.shimGetUserMedia(t),h.shimRTCIceCandidate(t),h.shimMaxMessageSize(t),h.shimSendThrowTypeError(t),h.removeAllowExtmapMixed(t);break;default:n("Unsupported browser!");break}return s}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)},o=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),i.shimMediaStream=u,i.shimOnTrack=m,i.shimGetSendersWithDtmf=p,i.shimGetStats=h,i.shimSenderReceiverGetStats=f,i.shimAddTrackRemoveTrackWithNative=g,i.shimAddTrackRemoveTrack=v,i.shimPeerConnection=y,i.fixNegotiationNeeded=S;var r=e("../utils.js"),s=d(r);function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function m(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var o=void 0;o=e.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var a=new Event("track");a.track=n.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[t.stream],i.dispatchEvent(a)})),t.stream.getTracks().forEach((function(n){var o=void 0;o=e.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var a=new Event("track");a.track=n,a.receiver=o,a.transceiver={receiver:o},a.streams=[t.stream],i.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else s.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function p(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var o=i.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){o.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var i=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){i._senders.push(t(i,e))}))};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((function(e){var i=t._senders.find((function(t){return t.track===e}));i&&t._senders.splice(t._senders.indexOf(i),1)}))}}else if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function h(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,i=Array.prototype.slice.call(arguments),n=i[0],o=i[1],a=i[2];if(arguments.length>0&&"function"===typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof n))return t.apply(this,[]);var r=function(e){var t={},i=e.result();return i.forEach((function(e){var i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){i[t]=e.stat(t)})),t[i.id]=i})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var d=function(e){o(s(r(e)))};return t.apply(this,[d,n])}return new Promise((function(i,n){t.apply(e,[function(e){i(s(r(e)))},n])})).then(o,a)}}}function f(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var o=e.RTCPeerConnection.prototype.getReceivers;o&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],i=void 0,n=void 0,o=void 0;return this.getSenders().forEach((function(e){e.track===t&&(i?o=!0:i=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(n?o=!0:n=e),e.track===t})),o||i&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}}}function g(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(n)&&this._shimmedLocalStreams[i.id].push(n):this._shimmedLocalStreams[i.id]=[i,n],n};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){var i=t.getSenders().find((function(t){return t.track===e}));if(i)throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();i.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(i){var n=t._shimmedLocalStreams[i].indexOf(e);-1!==n&&t._shimmedLocalStreams[i].splice(n,1),1===t._shimmedLocalStreams[i].length&&delete t._shimmedLocalStreams[i]})),o.apply(this,arguments)}}function v(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return g(e);var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var i=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){var t=i.getSenders().find((function(t){return t.track===e}));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var o=new e.MediaStream(t.getTracks());this._streams[t.id]=o,this._reverseStreams[o.id]=t,t=o}n.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,i){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var a=this.getSenders().find((function(e){return e.track===t}));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var r=this._streams[i.id];if(r)r.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[i.id]=s,this._reverseStreams[s.id]=i,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],n=l({},t,(function(){var e=this,t=arguments,n=arguments.length&&"function"===typeof arguments[0];return n?i.apply(this,[function(i){var n=d(e,i);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):i.apply(this,arguments).then((function(t){return d(e,t)}))}));e.RTCPeerConnection.prototype[t]=n[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=c(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var r=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=r.get.apply(this);return""===e.type?e:d(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var i=e._pc===this;if(!i)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach((function(i){var o=t._streams[i].getTracks().find((function(t){return e.track===t}));o&&(n=t._streams[i])})),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function d(e,t){var i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],o=e._streams[n.id];i=i.replace(new RegExp(o.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}function c(e,t){var i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],o=e._streams[n.id];i=i.replace(new RegExp(n.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:i})}}function y(e){var t=s.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],n=l({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}function S(e){s.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var t=e.target;if("stable"===t.signalingState)return e}))}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,i){function n(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(i){return t(i).then((function(t){var n=i.video&&i.video.width,o=i.video&&i.video.height,a=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},n&&(i.video.mandatory.maxWidth=n),o&&(i.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=n},{}],5:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)};i.shimGetUserMedia=d;var o=e("../utils.js"),a=r(o);function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}var s=a.log;function d(e){var t=e&&e.navigator;if(t.mediaDevices){var i=a.detectBrowser(e),o=function(e){if("object"!==("undefined"===typeof e?"undefined":n(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var o="object"===n(e[i])?e[i]:{ideal:e[i]};void 0!==o.exact&&"number"===typeof o.exact&&(o.min=o.max=o.exact);var a=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==o.ideal){t.optional=t.optional||[];var r={};"number"===typeof o.ideal?(r[a("min",i)]=o.ideal,t.optional.push(r),r={},r[a("max",i)]=o.ideal,t.optional.push(r)):(r[a("",i)]=o.ideal,t.optional.push(r))}void 0!==o.exact&&"number"!==typeof o.exact?(t.mandatory=t.mandatory||{},t.mandatory[a("",i)]=o.exact):["min","max"].forEach((function(e){void 0!==o[e]&&(t.mandatory=t.mandatory||{},t.mandatory[a(e,i)]=o[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,a){if(i.version>=61)return a(e);if(e=JSON.parse(JSON.stringify(e)),e&&"object"===n(e.audio)){var r=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};e=JSON.parse(JSON.stringify(e)),r(e.audio,"autoGainControl","googAutoGainControl"),r(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"===n(e.video)){var d=e.video.facingMode;d=d&&("object"===("undefined"===typeof d?"undefined":n(d))?d:{ideal:d});var l=i.version<66;if(d&&("user"===d.exact||"environment"===d.exact||"user"===d.ideal||"environment"===d.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)){delete e.video.facingMode;var c=void 0;if("environment"===d.exact||"environment"===d.ideal?c=["back","rear"]:"user"!==d.exact&&"user"!==d.ideal||(c=["front"]),c)return t.mediaDevices.enumerateDevices().then((function(t){t=t.filter((function(e){return"videoinput"===e.kind}));var i=t.find((function(e){return c.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!i&&t.length&&c.includes("back")&&(i=t[t.length-1]),i&&(e.video.deviceId=d.exact?{exact:i.deviceId}:{ideal:i.deviceId}),e.video=o(e.video),s("chrome: "+JSON.stringify(e)),a(e)}))}e.video=o(e.video)}return s("chrome: "+JSON.stringify(e)),a(e)},d=function(e){return i.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},l=function(e,i,n){r(e,(function(e){t.webkitGetUserMedia(e,i,(function(e){n&&n(d(e))}))}))};if(t.getUserMedia=l.bind(t),t.mediaDevices.getUserMedia){var c=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e,(function(e){return c(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(d(e))}))}))}}}}},{"../utils.js":15}],6:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)};i.shimRTCIceCandidate=u,i.shimMaxMessageSize=m,i.shimSendThrowTypeError=p,i.shimConnectionState=h,i.removeAllowExtmapMixed=f;var o=e("sdp"),a=l(o),r=e("./utils"),s=d(r);function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&(e=JSON.parse(JSON.stringify(e)),e.candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var i=new t(e),o=a["default"].parseCandidate(e.candidate),r=Object.assign(i,o);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function m(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var i=function(e){if(!e||!e.sdp)return!1;var t=a["default"].splitSections(e.sdp);return t.shift(),t.some((function(e){var t=a["default"].parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},n=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var i=parseInt(t[1],10);return i!==i?-1:i},o=function(e){var i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i},r=function(e,i){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var o=a["default"].matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?n=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(n=2147483637),n},d=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),a=e.sdpSemantics;"plan-b"===a&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){var s=n(arguments[0]),l=o(s),c=r(arguments[0],s),u=void 0;u=0===l&&0===c?Number.POSITIVE_INFINITY:0===l||0===c?Math.max(l,c):Math.min(l,c);var m={};Object.defineProperty(m,"maxMessageSize",{get:function(){return u}}),this._sctp=m}return d.apply(this,arguments)}}}function p(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return i(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",(function(e){return i(e.channel,e.target),e}))}function i(e,t){var i=e.send;e.send=function(){var n=arguments[0],o=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}}function h(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}}function f(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),i.apply(this,arguments)}}}}},{"./utils":15,sdp:17}],7:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),i.shimPeerConnection=m,i.shimReplaceTrack=p;var a=e("../utils"),r=u(a),s=e("./filtericeservers"),d=e("rtcpeerconnection-shim"),l=c(d);function c(e){return e&&e.__esModule?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function m(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var i=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){i.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=(0,l["default"])(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function p(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.filterIceServers=r;var n=e("../utils"),o=a(n);function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function r(e,t){var i=!1;return e=JSON.parse(JSON.stringify(e)),e.filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&o.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"===typeof t;return n&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!i?(i=!0,!0):t&&!i})),delete e.url,e.urls=n?t[0]:t,!!t.length}}))}},{"../utils":15}],9:[function(e,t,i){function n(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=n},{}],10:[function(e,t,i){function n(e){var t=e&&e.navigator,i=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e)["catch"]((function(e){return Promise.reject(i(e))}))}}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetUserMedia=n},{}],11:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)},o=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),i.shimOnTrack=u,i.shimPeerConnection=m,i.shimSenderGetStats=p,i.shimReceiverGetStats=h,i.shimRemoveStream=f,i.shimRTCDataChannel=g,i.shimAddTransceiver=v,i.shimCreateOffer=y,i.shimCreateAnswer=S;var r=e("../utils"),s=d(r);function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e){"object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function m(e){var t=s.detectBrowser(e);if("object"===("undefined"===typeof e?"undefined":n(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],n=l({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]})),t.version<68){var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],n=e[1],r=e[2];return a.apply(this,[i||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=o[e.type]||e.type}))}catch(i){if("TypeError"!==i.name)throw i;e.forEach((function(t,i){e.set(i,Object.assign({},t,{type:o[t.type]||t.type}))}))}return e})).then(n,r)}}}function p(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function h(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function f(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(i){i.track&&e.getTracks().includes(i.track)&&t.removeTrack(i)}))})}function g(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function v(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],i=e&&"sendEncodings"in e;i&&e.sendEncodings.forEach((function(e){if("rid"in e){var t=/^[a-z0-9]{0,16}$/i;if(!t.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(i){var o=n.sender,a=o.getParameters();"encodings"in a||(a.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(a)["catch"]((function(){}))))}return n})}}function y(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,i=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,i)}))["finally"]((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}}function S(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,i=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,i)}))["finally"]((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}}},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,i){function n(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=n},{}],13:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)};i.shimGetUserMedia=s;var o=e("../utils"),a=r(o);function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function s(e){var t=a.detectBrowser(e),i=e&&e.navigator,o=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,n){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){var r=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},s=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(e){return"object"===("undefined"===typeof e?"undefined":n(e))&&"object"===n(e.audio)&&(e=JSON.parse(JSON.stringify(e)),r(e.audio,"autoGainControl","mozAutoGainControl"),r(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var d=o.prototype.getSettings;o.prototype.getSettings=function(){var e=d.apply(this,arguments);return r(e,"mozAutoGainControl","autoGainControl"),r(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var l=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===("undefined"===typeof e?"undefined":n(e))&&(e=JSON.parse(JSON.stringify(e)),r(e,"autoGainControl","mozAutoGainControl"),r(e,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[e])}}}}},{"../utils":15}],14:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)};i.shimLocalStreamsAPI=s,i.shimRemoteStreamsAPI=d,i.shimCallbacksAPI=l,i.shimGetUserMedia=u,i.shimConstraints=m,i.shimRTCIceServerUrls=p,i.shimTrackEventTransceiver=h,i.shimCreateOfferLegacy=f;var o=e("../utils"),a=r(o);function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function s(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var i=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(i,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(i,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var i=arguments[1];return i&&(this._localStreams?this._localStreams.includes(i)||this._localStreams.push(i):this._localStreams=[i]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var i=this._localStreams.indexOf(e);if(-1!==i){this._localStreams.splice(i,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}}function d(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var i=new Event("addstream");i.stream=e,t.dispatchEvent(i)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}}))}),t.apply(e,arguments)}}}function l(e){if("object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,i=t.createOffer,o=t.createAnswer,a=t.setLocalDescription,r=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],o=i.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],n=o.apply(this,[i]);return t?(n.then(e,t),Promise.resolve()):n};var d=function(e,t,i){var n=a.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n};t.setLocalDescription=d,d=function(e,t,i){var n=r.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.setRemoteDescription=d,d=function(e,t,i){var n=s.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.addIceCandidate=d}}function u(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var i=t.mediaDevices,n=i.getUserMedia.bind(i);t.mediaDevices.getUserMedia=function(e){return n(m(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,i,n){t.mediaDevices.getUserMedia(e).then(i,n)}.bind(t))}function m(e){return e&&void 0!==e.video?Object.assign({},e,{video:a.compactObject(e.video)}):e}function p(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,i){if(e&&e.iceServers){for(var n=[],o=0;o<e.iceServers.length;o++){var r=e.iceServers[o];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(a.deprecated("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,n.push(r)):n.push(e.iceServers[o])}e.iceServers=n}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}function h(e){"object"===("undefined"===typeof e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function f(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var i=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveAudio||i||this.addTransceiver("audio"),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}},{"../utils":15}],15:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)};function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.extractVersion=s,i.wrapPeerConnectionEvent=d,i.disableLog=l,i.disableWarnings=u,i.log=m,i.deprecated=p,i.detectBrowser=h,i.compactObject=g,i.walkStats=v,i.filterStats=y;var a=!0,r=!0;function s(e,t,i){var n=e.match(t);return n&&n.length>=i&&parseInt(n[i],10)}function d(e,t,i){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,o=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return o.apply(this,arguments);var a=function(e){var t=i(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=a,o.apply(this,[e,a])};var a=n.removeEventListener;n.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[i])return a.apply(this,arguments);var n=this._eventMap[i];return delete this._eventMap[i],a.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function l(e){return"boolean"!==typeof e?new Error("Argument type: "+("undefined"===typeof e?"undefined":n(e))+". Please use a boolean."):(a=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function u(e){return"boolean"!==typeof e?new Error("Argument type: "+("undefined"===typeof e?"undefined":n(e))+". Please use a boolean."):(r=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function m(){if("object"===("undefined"===typeof window?"undefined":n(window))){if(a)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function p(e,t){r&&console.warn(e+" is deprecated, please use "+t+" instead.")}function h(e){var t=e.navigator,i={browser:null,version:null};if("undefined"===typeof e||!e.navigator)return i.browser="Not a browser.",i;if(t.mozGetUserMedia)i.browser="firefox",i.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)i.browser="chrome",i.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))i.browser="edge",i.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return i.browser="Not a supported browser.",i;i.browser="safari",i.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1),i.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return i}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function g(e){return f(e)?Object.keys(e).reduce((function(t,i){var n=f(e[i]),a=n?g(e[i]):e[i],r=n&&!Object.keys(a).length;return void 0===a||r?t:Object.assign(t,o({},i,a))}),{}):e}function v(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?v(e,e.get(t[n]),i):n.endsWith("Ids")&&t[n].forEach((function(t){v(e,e.get(t),i)}))})))}function y(e,t,i){var n=i?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var a=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((function(t){e.forEach((function(i){i.type===n&&i.trackId===t.id&&v(e,i,o)}))})),o}},{}],16:[function(e,t,i){var n=e("sdp");function o(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function a(e,t,i,o,a){var r=n.writeRtpDescription(e.kind,t);if(r+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":a||"active"),r+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var d="msid:"+(o?o.id:"-")+" "+s+"\r\n";r+="a="+d,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+d,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+d,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),r}function r(e,t){var i=!1;return e=JSON.parse(JSON.stringify(e)),e.filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"===typeof n;return o&&(n=[n]),n=n.filter((function(e){var n=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!i;return n?(i=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")})),delete e.url,e.urls=o?n[0]:n,!!n.length}}))}function s(e,t){var i={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var i=0;i<t.length;i++)if(t[i].payloadType===e||t[i].preferredPayloadType===e)return t[i]},o=function(e,t,i,o){var a=n(e.parameters.apt,i),r=n(t.parameters.apt,o);return a&&r&&a.name.toLowerCase()===r.name.toLowerCase()};return e.codecs.forEach((function(n){for(var a=0;a<t.codecs.length;a++){var r=t.codecs[a];if(n.name.toLowerCase()===r.name.toLowerCase()&&n.clockRate===r.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&r.parameters.apt&&!o(n,r,e.codecs,t.codecs))continue;r=JSON.parse(JSON.stringify(r)),r.numChannels=Math.min(n.numChannels,r.numChannels),i.codecs.push(r),r.rtcpFeedback=r.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var o=t.headerExtensions[n];if(e.uri===o.uri){i.headerExtensions.push(o);break}}})),i}function d(e,t,i){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(i)}function l(e,t){var i=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return i||e.addRemoteCandidate(t),!i}function c(e,t){var i=new Error(t);return i.name=e,i.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],i}t.exports=function(e,t){function i(t,i){i.addTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,i){i.removeTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function m(t,i,n,o){var a=new Event("track");a.track=i,a.receiver=n,a.transceiver={receiver:n},a.streams=o,e.setTimeout((function(){t._dispatchEvent("track",a)}))}var p=function(i){var o=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=a[e].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",i=JSON.parse(JSON.stringify(i||{})),this.usingBundle="max-bundle"===i.bundlePolicy,"negotiate"===i.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(i.rtcpMuxPolicy||(i.rtcpMuxPolicy="require"),i.iceTransportPolicy){case"all":case"relay":break;default:i.iceTransportPolicy="all";break}switch(i.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:i.bundlePolicy="balanced";break}if(i.iceServers=r(i.iceServers||[],t),this._iceGatherers=[],i.iceCandidatePoolSize)for(var s=i.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:i.iceServers,gatherPolicy:i.iceTransportPolicy}));else i.iceCandidatePoolSize=0;this._config=i,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(p.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(p.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),p.prototype.onicecandidate=null,p.prototype.onaddstream=null,p.prototype.ontrack=null,p.prototype.onremovestream=null,p.prototype.onsignalingstatechange=null,p.prototype.oniceconnectionstatechange=null,p.prototype.onconnectionstatechange=null,p.prototype.onicegatheringstatechange=null,p.prototype.onnegotiationneeded=null,p.prototype.ondatachannel=null,p.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"===typeof this["on"+e]&&this["on"+e](t))},p.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},p.prototype.getConfiguration=function(){return this._config},p.prototype.getLocalStreams=function(){return this.localStreams},p.prototype.getRemoteStreams=function(){return this.remoteStreams},p.prototype._createTransceiver=function(e,t){var i=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&i)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();n.iceTransport=o.iceTransport,n.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(n),n},p.prototype.addTrack=function(t,i){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n,o=this.transceivers.find((function(e){return e.track===t}));if(o)throw c("InvalidAccessError","Track already exists.");for(var a=0;a<this.transceivers.length;a++)this.transceivers[a].track||this.transceivers[a].kind!==t.kind||(n=this.transceivers[a]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(i)&&this.localStreams.push(i),n.track=t,n.stream=i,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},p.prototype.addStream=function(e){var i=this;if(t>=15025)e.getTracks().forEach((function(t){i.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var i=n.getTracks()[t];e.addEventListener("enabled",(function(e){i.enabled=e.enabled}))})),n.getTracks().forEach((function(e){i.addTrack(e,n)}))}},p.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var i=this.transceivers.find((function(e){return e.rtpSender===t}));if(!i)throw c("InvalidAccessError","Sender was not created by this connection.");var n=i.stream;i.rtpSender.stop(),i.rtpSender=null,i.track=null,i.stream=null;var o=this.transceivers.map((function(e){return e.stream}));-1===o.indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},p.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var i=t.getSenders().find((function(t){return t.track===e}));i&&t.removeTrack(i)}))},p.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},p.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},p.prototype._createIceGatherer=function(t,i){var n=this;if(i&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var i=!e.candidate||0===Object.keys(e.candidate).length;o.state=i?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},p.prototype._gather=function(t,i){var o=this,a=this.transceivers[i].iceGatherer;if(!a.onlocalcandidate){var r=this.transceivers[i].bufferedCandidateEvents;this.transceivers[i].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[i].bufferCandidates),a.onlocalcandidate=function(e){if(!(o.usingBundle&&i>0)){var r=new Event("icecandidate");r.candidate={sdpMid:t,sdpMLineIndex:i};var s=e.candidate,d=!s||0===Object.keys(s).length;if(d)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),s.component=1,s.ufrag=a.getLocalParameters().usernameFragment;var l=n.writeCandidate(s);r.candidate=Object.assign(r.candidate,n.parseCandidate(l)),r.candidate.candidate=l,r.candidate.toJSON=function(){return{candidate:r.candidate.candidate,sdpMid:r.candidate.sdpMid,sdpMLineIndex:r.candidate.sdpMLineIndex,usernameFragment:r.candidate.usernameFragment}}}var c=n.getMediaSections(o._localDescription.sdp);c[r.candidate.sdpMLineIndex]+=d?"a=end-of-candidates\r\n":"a="+r.candidate.candidate+"\r\n",o._localDescription.sdp=n.getDescription(o._localDescription.sdp)+c.join("");var u=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),d||o._dispatchEvent("icecandidate",r),u&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){r.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},p.prototype._createIceAndDtlsTransports=function(){var t=this,i=new e.RTCIceTransport(null);i.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(i);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:i,dtlsTransport:n}},p.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var i=this.transceivers[e].iceTransport;i&&(delete i.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},p.prototype._transceive=function(e,i,o){var a=s(e.localCapabilities,e.remoteCapabilities);i&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),o&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},p.prototype.setLocalDescription=function(e){var t,i,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!d("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),i=t.shift(),t.forEach((function(e,t){var i=n.parseRtpParameters(e);o.transceivers[t].localCapabilities=i})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=n.splitSections(o._remoteDescription.sdp),i=t.shift();var a=n.matchPrefix(i,"a=ice-lite").length>0;t.forEach((function(e,t){var r=o.transceivers[t],d=r.iceGatherer,l=r.iceTransport,c=r.dtlsTransport,u=r.localCapabilities,m=r.remoteCapabilities,p=n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length;if(!p&&!r.rejected){var h=n.getIceParameters(e,i),f=n.getDtlsParameters(e,i);a&&(f.role="server"),o.usingBundle&&0!==t||(o._gather(r.mid,t),"new"===l.state&&l.start(d,h,a?"controlling":"controlled"),"new"===c.state&&c.start(f));var g=s(u,m);o._transceive(r,g.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},p.prototype.setRemoteDescription=function(o){var a=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(c("TypeError",'Unsupported type "'+o.type+'"'));if(!d("setRemoteDescription",o.type,a.signalingState)||a._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+o.type+" in state "+a.signalingState));var r={};a.remoteStreams.forEach((function(e){r[e.id]=e}));var p=[],h=n.splitSections(o.sdp),f=h.shift(),g=n.matchPrefix(f,"a=ice-lite").length>0,v=n.matchPrefix(f,"a=group:BUNDLE ").length>0;a.usingBundle=v;var y=n.matchPrefix(f,"a=ice-options:")[0];return a.canTrickleIceCandidates=!!y&&y.substr(14).split(" ").indexOf("trickle")>=0,h.forEach((function(d,c){var m=n.splitLines(d),h=n.getKind(d),y=n.isRejected(d)&&0===n.matchPrefix(d,"a=bundle-only").length,S=m[0].substr(2).split(" ")[2],_=n.getDirection(d,f),b=n.parseMsid(d),C=n.getMid(d)||n.generateIdentifier();if(y||"application"===h&&("DTLS/SCTP"===S||"UDP/DTLS/SCTP"===S))a.transceivers[c]={mid:C,kind:h,protocol:S,rejected:!0};else{var T,w,k,E,P,I,x,R,A;!y&&a.transceivers[c]&&a.transceivers[c].rejected&&(a.transceivers[c]=a._createTransceiver(h,!0));var D,B,j=n.parseRtpParameters(d);y||(D=n.getIceParameters(d,f),B=n.getDtlsParameters(d,f),B.role="client"),x=n.parseRtpEncodingParameters(d);var L=n.parseRtcpParameters(d),M=n.matchPrefix(d,"a=end-of-candidates",f).length>0,N=n.matchPrefix(d,"a=candidate:").map((function(e){return n.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!y&&v&&c>0&&a.transceivers[c]&&(a._disposeIceAndDtlsTransports(c),a.transceivers[c].iceGatherer=a.transceivers[0].iceGatherer,a.transceivers[c].iceTransport=a.transceivers[0].iceTransport,a.transceivers[c].dtlsTransport=a.transceivers[0].dtlsTransport,a.transceivers[c].rtpSender&&a.transceivers[c].rtpSender.setTransport(a.transceivers[0].dtlsTransport),a.transceivers[c].rtpReceiver&&a.transceivers[c].rtpReceiver.setTransport(a.transceivers[0].dtlsTransport)),"offer"!==o.type||y){if("answer"===o.type&&!y){T=a.transceivers[c],w=T.iceGatherer,k=T.iceTransport,E=T.dtlsTransport,P=T.rtpReceiver,I=T.sendEncodingParameters,R=T.localCapabilities,a.transceivers[c].recvEncodingParameters=x,a.transceivers[c].remoteCapabilities=j,a.transceivers[c].rtcpParameters=L,N.length&&"new"===k.state&&(!g&&!M||v&&0!==c?N.forEach((function(e){l(T.iceTransport,e)})):k.setRemoteCandidates(N)),v&&0!==c||("new"===k.state&&k.start(w,D,"controlling"),"new"===E.state&&E.start(B));var F=s(T.localCapabilities,T.remoteCapabilities),z=F.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length;!z&&T.sendEncodingParameters[0].rtx&&delete T.sendEncodingParameters[0].rtx,a._transceive(T,"sendrecv"===_||"recvonly"===_,"sendrecv"===_||"sendonly"===_),!P||"sendrecv"!==_&&"sendonly"!==_?delete T.rtpReceiver:(A=P.track,b?(r[b.stream]||(r[b.stream]=new e.MediaStream),i(A,r[b.stream]),p.push([A,P,r[b.stream]])):(r["default"]||(r["default"]=new e.MediaStream),i(A,r["default"]),p.push([A,P,r["default"]])))}}else{T=a.transceivers[c]||a._createTransceiver(h),T.mid=C,T.iceGatherer||(T.iceGatherer=a._createIceGatherer(c,v)),N.length&&"new"===T.iceTransport.state&&(!M||v&&0!==c?N.forEach((function(e){l(T.iceTransport,e)})):T.iceTransport.setRemoteCandidates(N)),R=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(R.codecs=R.codecs.filter((function(e){return"rtx"!==e.name}))),I=T.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var O,U=!1;if("sendrecv"===_||"sendonly"===_){if(U=!T.rtpReceiver,P=T.rtpReceiver||new e.RTCRtpReceiver(T.dtlsTransport,h),U)A=P.track,b&&"-"===b.stream||(b?(r[b.stream]||(r[b.stream]=new e.MediaStream,Object.defineProperty(r[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(A,"id",{get:function(){return b.track}}),O=r[b.stream]):(r["default"]||(r["default"]=new e.MediaStream),O=r["default"])),O&&(i(A,O),T.associatedRemoteMediaStreams.push(O)),p.push([A,P,O])}else T.rtpReceiver&&T.rtpReceiver.track&&(T.associatedRemoteMediaStreams.forEach((function(e){var t=e.getTracks().find((function(e){return e.id===T.rtpReceiver.track.id}));t&&u(t,e)})),T.associatedRemoteMediaStreams=[]);T.localCapabilities=R,T.remoteCapabilities=j,T.rtpReceiver=P,T.rtcpParameters=L,T.sendEncodingParameters=I,T.recvEncodingParameters=x,a._transceive(a.transceivers[c],!1,U)}}})),void 0===a._dtlsRole&&(a._dtlsRole="offer"===o.type?"active":"passive"),a._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?a._updateSignalingState("have-remote-offer"):a._updateSignalingState("stable"),Object.keys(r).forEach((function(t){var i=r[t];if(i.getTracks().length){if(-1===a.remoteStreams.indexOf(i)){a.remoteStreams.push(i);var n=new Event("addstream");n.stream=i,e.setTimeout((function(){a._dispatchEvent("addstream",n)}))}p.forEach((function(e){var t=e[0],n=e[1];i.id===e[2].id&&m(a,t,n,[i])}))}})),p.forEach((function(e){e[2]||m(a,e[0],e[1],[])})),e.setTimeout((function(){a&&a.transceivers&&a.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},p.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},p.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},p.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},p.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t["new"]>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var i=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",i)}},p.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t["new"]>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var i=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",i)}},p.prototype.createOffer=function(){var i=this;if(i._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=i.transceivers.filter((function(e){return"audio"===e.kind})).length,r=i.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(r=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}i.transceivers.forEach((function(e){"audio"===e.kind?(o--,o<0&&(e.wantReceive=!1)):"video"===e.kind&&(r--,r<0&&(e.wantReceive=!1))}));while(o>0||r>0)o>0&&(i._createTransceiver("audio"),o--),r>0&&(i._createTransceiver("video"),r--);var d=n.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.transceivers.forEach((function(o,a){var r=o.track,s=o.kind,d=o.mid||n.generateIdentifier();o.mid=d,o.iceGatherer||(o.iceGatherer=i._createIceGatherer(a,i.usingBundle));var l=e.RTCRtpSender.getCapabilities(s);t<15019&&(l.codecs=l.codecs.filter((function(e){return"rtx"!==e.name}))),l.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),l.headerExtensions.forEach((function(e){var t=o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[];t.forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var c=o.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];r&&t>=15019&&"video"===s&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,s)),o.localCapabilities=l,o.sendEncodingParameters=c})),"max-compat"!==i._config.bundlePolicy&&(d+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",i.transceivers.forEach((function(e,t){d+=a(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+n.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},p.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var o=n.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(o+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n";var r=n.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach((function(e,n){if(!(n+1>r)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?o+="m=application 0 DTLS/SCTP 5000\r\n":o+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(o+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var d;if(e.stream)"audio"===e.kind?d=e.stream.getAudioTracks()[0]:"video"===e.kind&&(d=e.stream.getVideoTracks()[0]),d&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var l=s(e.localCapabilities,e.remoteCapabilities),c=l.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length;!c&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,o+=a(e,l,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(o+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(d)},p.prototype.addIceCandidate=function(e){var t,i=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,a){if(!i._remoteDescription)return a(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var r=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<i.transceivers.length;s++)if(i.transceivers[s].mid===e.sdpMid){r=s;break}var d=i.transceivers[r];if(!d)return a(c("OperationError","Can not add ICE candidate"));if(d.rejected)return o();var u=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return o();if(u.component&&1!==u.component)return o();if((0===r||r>0&&d.iceTransport!==i.transceivers[0].iceTransport)&&!l(d.iceTransport,u))return a(c("OperationError","Can not add ICE candidate"));var m=e.candidate.trim();0===m.indexOf("a=")&&(m=m.substr(2)),t=n.getMediaSections(i._remoteDescription.sdp),t[r]+="a="+(u.type?m:"end-of-candidates")+"\r\n",i._remoteDescription.sdp=n.getDescription(i._remoteDescription.sdp)+t.join("")}else for(var p=0;p<i.transceivers.length;p++)if(!i.transceivers[p].rejected&&(i.transceivers[p].iceTransport.addRemoteCandidate({}),t=n.getMediaSections(i._remoteDescription.sdp),t[p]+="a=end-of-candidates\r\n",i._remoteDescription.sdp=n.getDescription(i._remoteDescription.sdp)+t.join(""),i.usingBundle))break;o()}))},p.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var i=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?i=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(i=e.rtpReceiver)})),!i)throw c("InvalidAccessError","Invalid selector.");return i.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};var h=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];h.forEach((function(t){var i=e[t];if(i&&i.prototype&&i.prototype.getStats){var n=i.prototype.getStats;i.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(i){e[i].type=o(e[i]),t.set(i,e[i])})),t}))}}}));var f=["createOffer","createAnswer"];return f.forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"===typeof e[0]||"function"===typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"===typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"===typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),f=["setLocalDescription","setRemoteDescription","addIceCandidate"],f.forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"===typeof e[1]||"function"===typeof e[2]?t.apply(this,arguments).then((function(){"function"===typeof e[1]&&e[1].apply(null)}),(function(t){"function"===typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"===typeof e[1]?t.apply(this,arguments).then((function(){"function"===typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),p}},{sdp:17}],17:[function(e,t,i){var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},n.splitSections=function(e){var t=e.split("\nm=");return t.map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},n.getDescription=function(e){var t=n.splitSections(e);return t&&t[0]},n.getMediaSections=function(e){var t=n.splitSections(e);return t.shift(),t},n.matchPrefix=function(e,t){return n.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},n.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var i={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":i.relatedAddress=t[n+1];break;case"rport":i.relatedPort=parseInt(t[n+1],10);break;case"tcptype":i.tcpType=t[n+1];break;case"ufrag":i.ufrag=t[n+1],i.usernameFragment=t[n+1];break;default:i[t[n]]=t[n+1];break}return i},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},n.parseIceOptions=function(e){return e.substr(14).split(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},n.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,i={},n=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<n.length;o++)t=n[o].trim().split("="),i[t[0].trim()]=t[1];return i},n.writeFmtp=function(e){var t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+i+" "+n.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),i={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(i.attribute=e.substr(t+1,n-t-1),i.value=e.substr(n+1)):i.attribute=e.substr(t+1),i},n.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},n.getMid=function(e){var t=n.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},n.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},n.getDtlsParameters=function(e,t){var i=n.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:i.map(n.parseFingerprint)}},n.writeDtlsParameters=function(e,t){var i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},n.getIceParameters=function(e,t){var i=n.splitLines(e);i=i.concat(n.splitLines(t));var o={usernameFragment:i.filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:i.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)};return o},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=n.splitLines(e),o=i[0].split(" "),a=3;a<o.length;a++){var r=o[a],s=n.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(s){var d=n.parseRtpMap(s),l=n.matchPrefix(e,"a=fmtp:"+r+" ");switch(d.parameters=l.length?n.parseFmtp(l[0]):{},d.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(n.parseRtcpFb),t.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(d.name.toUpperCase());break}}}return n.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(n.parseExtmap(e))})),t},n.writeRtpDescription=function(e,t){var i="";i+="m="+e+" ",i+=t.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){i+=n.writeRtpMap(e),i+=n.writeFmtp(e),i+=n.writeRtcpFb(e)}));var o=0;return t.codecs.forEach((function(e){e.maxptime>o&&(o=e.maxptime)})),o>0&&(i+="a=maxptime:"+o+"\r\n"),i+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){i+=n.writeExtmap(e)})),i},n.parseRtpEncodingParameters=function(e){var t,i=[],o=n.parseRtpParameters(e),a=-1!==o.fecMechanisms.indexOf("RED"),r=-1!==o.fecMechanisms.indexOf("ULPFEC"),s=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),d=s.length>0&&s[0].ssrc,l=n.matchPrefix(e,"a=ssrc-group:FID").map((function(e){var t=e.substr(17).split(" ");return t.map((function(e){return parseInt(e,10)}))}));l.length>0&&l[0].length>1&&l[0][0]===d&&(t=l[0][1]),o.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:d,codecPayloadType:parseInt(e.parameters.apt,10)};d&&t&&(n.rtx={ssrc:t}),i.push(n),a&&(n=JSON.parse(JSON.stringify(n)),n.fec={ssrc:d,mechanism:r?"red+ulpfec":"red"},i.push(n))}})),0===i.length&&d&&i.push({ssrc:d});var c=n.matchPrefix(e,"b=");return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substr(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=c}))),i},n.parseRtcpParameters=function(e){var t={},i=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(t.cname=i.value,t.ssrc=i.ssrc);var o=n.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=o.length>0,t.compound=0===o.length;var a=n.matchPrefix(e,"a=rtcp-mux");return t.mux=a.length>0,t},n.parseMsid=function(e){var t,i=n.matchPrefix(e,"a=msid:");if(1===i.length)return t=i[0].substr(7).split(" "),{stream:t[0],track:t[1]};var o=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return o.length>0?(t=o[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},n.parseSctpDescription=function(e){var t,i=n.parseMLine(e),o=n.matchPrefix(e,"a=max-message-size:");o.length>0&&(t=parseInt(o[0].substr(19),10)),isNaN(t)&&(t=65536);var a=n.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:i.fmt,maxMessageSize:t};var r=n.matchPrefix(e,"a=sctpmap:");if(r.length>0){var s=n.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},n.writeSctpDescription=function(e,t){var i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(e,t,i){var o,a=void 0!==t?t:2;o=e||n.generateSessionId();var r=i||"thisisadapterortc";return"v=0\r\no="+r+" "+o+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,i,o){var a=n.writeRtpDescription(e.kind,t);if(a+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var r="msid:"+o.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+r,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),a},n.getDirection=function(e,t){for(var i=n.splitLines(e),o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substr(2)}return t?n.getDirection(t):"sendrecv"},n.getKind=function(e){var t=n.splitLines(e),i=t[0].split(" ");return i[0].substr(2)},n.isRejected=function(e){return"0"===e.split(" ",2)[1]},n.parseMLine=function(e){var t=n.splitLines(e),i=t[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},n.parseOLine=function(e){var t=n.matchPrefix(e,"o=")[0],i=t.substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},n.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;for(var t=n.splitLines(e),i=0;i<t.length;i++)if(t[i].length<2||"="!==t[i].charAt(1))return!1;return!0},"object"===c(t)&&(t.exports=n)},{}]},{},[1])(1)})),he.sessions={},he.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||he.extension.isInstalled()}return!0};var pe={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var i=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var n=new Error("NavigatorUserMediaError");n.name="You cancelled the request for permission, giving up...",i(n)}else i(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function he(e){if(void 0===he.initDone)return e.error("Library not initialized"),{};if(!he.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(he.log("Library initialized: "+he.initDone),e=e||{},e.success="function"==typeof e.success?e.success:he.noop,e.error="function"==typeof e.error?e.error:he.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:he.noop,null===e.server||void 0===e.server)return e.error("Invalid server url"),{};var t=!1,i=null,n={},o=null,a=null,r=0,s=e.server;he.isArray(s)?(he.log("Multiple servers provided ("+s.length+"), will use the first that works"),s=null,a=e.server,he.debug(a)):0===s.indexOf("ws")?(t=!0,he.log("Using WebSockets to contact Janus: "+s)):(t=!1,he.log("Using REST API to contact Janus: "+s));var d=e.iceServers;void 0!==d&&null!==d||(d=[{urls:"stun:stun.l.google.com:19302"}]);var l=e.iceTransportPolicy,u=e.bundlePolicy,m=e.ipv6;void 0!==m&&null!==m||(m=!1);var p=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(p=!0===e.withCredentials);var h=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(h=e.max_poll_events),h<1&&(h=1);var f=null;void 0!==e.token&&null!==e.token&&(f=e.token);var g=null;void 0!==e.apisecret&&null!==e.apisecret&&(g=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var v=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(v=e.keepAlivePeriod),isNaN(v)&&(v=25e3);var y=6e4;function S(e){var t={high:9e5,medium:3e5,low:1e5};return void 0!==e&&null!==e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(y=e.longPollTimeout),isNaN(y)&&(y=6e4);var _=!1,b=null,C={},T=this,w=0,k={};function E(){if(null!=b)if(he.debug("Long poll..."),_){var t=s+"/"+b+"?rid="+(new Date).getTime();void 0!==h&&null!==h&&(t=t+"&maxev="+h),null!==f&&void 0!==f&&(t=t+"&token="+encodeURIComponent(f)),null!==g&&void 0!==g&&(t=t+"&apisecret="+encodeURIComponent(g)),he.httpAPICall(t,{verb:"GET",withCredentials:p,success:P,timeout:y,error:function(t,i){if(he.error(t+":",i),w++,w>3)return _=!1,void e.error("Lost connection to the server (is it down?)");E()}})}else he.warn("Is the server down? (connected=false)")}function P(e,n){if(w=0,t||void 0===b||null===b||!0===n||E(),t||!he.isArray(e))if("keepalive"!==e["rtcgw"])if("ack"!==e["rtcgw"])if("success"!==e["rtcgw"])if("trickle"===e["rtcgw"]){var o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");var a=C[o];if(void 0===a||null===a)return void he.debug("This handle is not attached to this session");var r=e["candidate"];he.debug("Got a trickled candidate on session "+b),he.debug(r);var s=a.webrtcStuff;s.pc&&s.remoteSdp?(he.debug("Adding remote candidate:",r),r&&!0!==r.completed?s.pc.addIceCandidate(r):s.pc.addIceCandidate(he.endOfCandidates)):(he.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),s.candidates||(s.candidates=[]),s.candidates.push(r),he.debug(s.candidates))}else{if("webrtcup"===e["rtcgw"]){he.debug("Got a webrtcup event on session "+b),he.debug(e);o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");a=C[o];return void 0===a||null===a?void he.debug("This handle is not attached to this session"):void a.webrtcState(!0)}if("hangup"===e["rtcgw"]){he.debug("Got a hangup event on session "+b),he.debug(e);o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");a=C[o];if(void 0===a||null===a)return void he.debug("This handle is not attached to this session");a.webrtcState(!1,e["reason"]),a.hangup()}else if("detached"===e["rtcgw"]){he.debug("Got a detached event on session "+b),he.debug(e);o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");a=C[o];if(void 0===a||null===a)return;a.detached=!0,a.ondetached(),a.detach()}else if("media"===e["rtcgw"]){he.debug("Got a media event on session "+b),he.debug(e);o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");a=C[o];if(void 0===a||null===a)return void he.debug("This handle is not attached to this session");a.mediaState(e["type"],e["receiving"])}else if("slowlink"===e["rtcgw"]){he.debug("Got a slowlink event on session "+b),he.debug(e);o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");a=C[o];if(void 0===a||null===a)return void he.debug("This handle is not attached to this session");a.slowLink(e["uplink"],e["lost"])}else{if("error"===e["rtcgw"]){he.error("Ooops: "+e["error"].code+" "+e["error"].reason),he.debug(e);m=e["transaction"];if(null!==m&&void 0!==m){p=k[m];null!==p&&void 0!==p&&p(e),delete k[m]}return}if("event"===e["rtcgw"]){he.debug("Got a plugin event on session "+b),he.debug(e);o=e["sender"];if(void 0===o||null===o)return void he.warn("Missing sender...");var d=e["plugindata"];if(void 0===d||null===d)return void he.warn("Missing plugindata...");he.debug("  -- Event is coming from "+o+" ("+d["plugin"]+")");var l=d["data"];he.debug(l);a=C[o];if(void 0===a||null===a)return void he.warn("This handle is not attached to this session");var c=e["jsep"];void 0!==c&&null!==c&&(he.debug("Handling SDP as well..."),he.debug(c));var u=a.onmessage;null!==u&&void 0!==u?(he.debug("Notifying application..."),u(l,c)):he.debug("No provided notification callback")}else{if("timeout"===e["rtcgw"])return he.error("Timeout on session "+b),he.debug(e),void(t&&i.close(3504,"Gateway timeout"));he.warn("Unknown message/event  '"+e["rtcgw"]+"' on session "+b),he.debug(e)}}}else{he.debug("Got a success on session "+b),he.debug(e);var m=e["transaction"];if(null!==m&&void 0!==m){var p=k[m];null!==p&&void 0!==p&&p(e),delete k[m]}}else{he.debug("Got an ack on session "+b),he.debug(e);var m=e["transaction"];if(null!==m&&void 0!==m){var p=k[m];null!==p&&void 0!==p&&p(e),delete k[m]}}else he.vdebug("Got a keepalive on session "+b);else for(var h=0;h<e.length;h++)P(e[h],!0)}function I(){if(null!==s&&t&&_){o=setTimeout(I,v);var e={rtcgw:"keepalive",session_id:b,transaction:he.randomString(12)};null!==f&&void 0!==f&&(e["token"]=f),null!==g&&void 0!==g&&(e["apisecret"]=g),i.send(JSON.stringify(e))}}function x(d){var l=he.randomString(12),c={rtcgw:"create",transaction:l,token:window.EZUIKit.opt.stream,device:window.EZUIKit.opt.deviceSerial,channel:window.EZUIKit.opt.channelNo};if(d["reconnect"]&&(_=!1,c["rtcgw"]="claim",c["session_id"]=b,i&&(i.onopen=null,i.onerror=null,i.onclose=null,o&&(clearTimeout(o),o=null))),null!==f&&void 0!==f&&(c["token"]=f),null!==g&&void 0!==g&&(c["apisecret"]=g),null===s&&he.isArray(a)&&(s=a[r],0===s.indexOf("ws")?(t=!0,he.log("Server #"+(r+1)+": trying WebSockets to contact Janus ("+s+")")):(t=!1,he.log("Server #"+(r+1)+": trying REST API to contact Janus ("+s+")"))),t)for(var u in i=he.newWebSocket(s,"rtcgw-protocol"),n={error:function(){if(he.error("Error connecting to the Janus WebSockets server... "+s),he.isArray(a)&&!d["reconnect"])return r++,r==a.length?void d.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){x(d)}),200));d.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){k[l]=function(e){if(he.debug(e),"success"!==e["rtcgw"])return he.error("Ooops: "+e["error"].code+" "+e["error"].reason),void d.error(e["error"].reason);o=setTimeout(I,v),_=!0,b=e["session_id"]?e["session_id"]:e.data["id"],d["reconnect"]?he.log("Claimed session: "+b):he.log("Created session: "+b),he.sessions[b]=T,d.success()},i.send(JSON.stringify(c))},message:function(e){P(JSON.parse(e.data))},close:function(){null!==s&&_&&(_=!1,e.error("Lost connection to the server (is it down?)"))}},n)i.addEventListener(u,n[u]);else he.httpAPICall(s,{verb:"POST",withCredentials:p,body:c,success:function(e){if(he.debug(e),"success"!==e["rtcgw"])return he.error("Ooops: "+e["error"].code+" "+e["error"].reason),void d.error(e["error"].reason);_=!0,b=e["session_id"]?e["session_id"]:e.data["id"],d["reconnect"]?he.log("Claimed session: "+b):he.log("Created session: "+b),he.sessions[b]=T,E(),d.success()},error:function(e,t){if(he.error(e+":",t),he.isArray(a)&&!d["reconnect"])return r++,r==a.length?void d.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){x(d)}),200));""===t?d.error(e+": Is the server down?"):d.error(e+": "+t)}})}function R(a){a=a||{},a.success="function"==typeof a.success?a.success:he.noop;var r=!0;void 0!==a.asyncRequest&&null!==a.asyncRequest&&(r=!0===a.asyncRequest);var d=!0;void 0!==a.notifyDestroyed&&null!==a.notifyDestroyed&&(d=!0===a.notifyDestroyed);var l=!1;if(void 0!==a.cleanupHandles&&null!==a.cleanupHandles&&(l=!0===a.cleanupHandles),he.log("Destroying session "+b+" (async="+r+")"),!_)return he.warn("Is the server down? (connected=false)"),void a.success();if(void 0===b||null===b)return he.warn("No session to destroy"),a.success(),void(d&&e.destroyed());if(l)for(var c in C)N(c,{noRequest:!0});var u={rtcgw:"destroy",transaction:he.randomString(12)};if(null!==f&&void 0!==f&&(u["token"]=f),null!==g&&void 0!==g&&(u["apisecret"]=g),t){u["session_id"]=b;var m=function(){for(var e in n)i.removeEventListener(e,n[e]);i.removeEventListener("message",h),i.removeEventListener("error",v),o&&clearTimeout(o),i.close()},h=function(t){var i=JSON.parse(t.data);i.session_id==u.session_id&&i.transaction==u.transaction&&(m(),a.success(),d&&e.destroyed())},v=function(t){m(),a.error("Failed to destroy the server: Is the server down?"),d&&e.destroyed()};return i.addEventListener("message",h),i.addEventListener("error",v),void i.send(JSON.stringify(u))}he.httpAPICall(s+"/"+b,{verb:"POST",async:r,withCredentials:p,body:u,success:function(t){he.log("Destroyed session:"),he.debug(t),b=null,_=!1,"success"!==t["rtcgw"]&&he.error("Ooops: "+t["error"].code+" "+t["error"].reason),a.success(),d&&e.destroyed()},error:function(t,i){he.error(t+":",i),b=null,_=!1,a.success(),d&&e.destroyed()}})}function A(e){if(e=e||{},e.success="function"==typeof e.success?e.success:he.noop,e.error="function"==typeof e.error?e.error:he.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:he.noop,e.iceState="function"==typeof e.iceState?e.iceState:he.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:he.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:he.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:he.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:he.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:he.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:he.noop,e.ondata="function"==typeof e.ondata?e.ondata:he.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:he.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:he.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:he.noop,!_)return he.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=e.plugin;if(void 0===n||null===n)return he.error("Invalid plugin"),void e.error("Invalid plugin");var o=e.opaqueId,a=e.token?e.token:f,r=he.randomString(12),d={rtcgw:"attach",plugin:n,opaque_id:o,transaction:r};if(null!==a&&void 0!==a&&(d["token"]=a),null!==g&&void 0!==g&&(d["apisecret"]=g),t)return k[r]=function(t){if(he.debug(t),"success"!==t["rtcgw"])return he.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var i=t.data["id"];he.log("Created handle: "+i);var o={session:T,plugin:n,id:i,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return n},getVolume:function(){return H(i,!0)},getRemoteVolume:function(){return H(i,!0)},getLocalVolume:function(){return H(i,!1)},isAudioMuted:function(){return G(i,!1)},muteAudio:function(){return W(i,!1,!0)},unmuteAudio:function(){return W(i,!1,!1)},isVideoMuted:function(){return G(i,!0)},muteVideo:function(){return W(i,!0,!0)},unmuteVideo:function(){return W(i,!0,!1)},getBitrate:function(){return q(i)},send:function(e){D(i,e)},data:function(e){L(i,e)},dtmf:function(e){M(i,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){z(i,!0,e)},createAnswer:function(e){z(i,!1,e)},handleRemoteJsep:function(e){O(i,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){J(i,!0===e)},detach:function(e){N(i,e)}};C[i]=o,e.success(o)},d["session_id"]=b,void i.send(JSON.stringify(d));he.httpAPICall(s+"/"+b,{verb:"POST",withCredentials:p,body:d,success:function(t){if(he.debug(t),"success"!==t["rtcgw"])return he.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var i=t.data["id"];he.log("Created handle: "+i);var o={session:T,plugin:n,id:i,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return n},getVolume:function(){return H(i,!0)},getRemoteVolume:function(){return H(i,!0)},getLocalVolume:function(){return H(i,!1)},isAudioMuted:function(){return G(i,!1)},muteAudio:function(){return W(i,!1,!0)},unmuteAudio:function(){return W(i,!1,!1)},isVideoMuted:function(){return G(i,!0)},muteVideo:function(){return W(i,!0,!0)},unmuteVideo:function(){return W(i,!0,!1)},getBitrate:function(){return q(i)},send:function(e){D(i,e)},data:function(e){L(i,e)},dtmf:function(e){M(i,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){z(i,!0,e)},createAnswer:function(e){z(i,!1,e)},handleRemoteJsep:function(e){O(i,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){J(i,!0===e)},detach:function(e){N(i,e)}};C[i]=o,e.success(o)},error:function(e,t){he.error(e+":",t)}})}function D(e,n){if(n=n||{},n.success="function"==typeof n.success?n.success:he.noop,n.error="function"==typeof n.error?n.error:he.noop,!_)return he.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var o=C[e];if(null===o||void 0===o||null===o.webrtcStuff||void 0===o.webrtcStuff)return he.warn("Invalid handle"),void n.error("Invalid handle");var a=n.message,r=n.jsep,d=he.randomString(12),l={rtcgw:"message",body:a,transaction:d};if(null!==o.token&&void 0!==o.token&&(l["token"]=o.token),null!==g&&void 0!==g&&(l["apisecret"]=g),null!==r&&void 0!==r&&(l.jsep=r),he.debug("Sending message to plugin (handle="+e+"):"),he.debug(l),t)return l["session_id"]=b,l["handle_id"]=e,k[d]=function(e){if(he.debug("Message sent!"),he.debug(e),"success"===e["rtcgw"]){var t=e["plugindata"];if(void 0===t||null===t)return he.warn("Request succeeded, but missing plugindata..."),void n.success();he.log("Synchronous transaction successful ("+t["plugin"]+")");var i=t["data"];return he.debug(i),void n.success(i)}"ack"===e["rtcgw"]?n.success():void 0!==e["error"]&&null!==e["error"]?(he.error("Ooops: "+e["error"].code+" "+e["error"].reason),n.error(e["error"].code+" "+e["error"].reason)):(he.error("Unknown error"),n.error("Unknown error"))},void i.send(JSON.stringify(l));he.httpAPICall(s+"/"+b+"/"+e,{verb:"POST",withCredentials:p,body:l,success:function(e){if(he.debug("Message sent!"),he.debug(e),"success"===e["rtcgw"]){var t=e["plugindata"];if(void 0===t||null===t)return he.warn("Request succeeded, but missing plugindata..."),void n.success();he.log("Synchronous transaction successful ("+t["plugin"]+")");var i=t["data"];return he.debug(i),void n.success(i)}"ack"===e["rtcgw"]?n.success():void 0!==e["error"]&&null!==e["error"]?(he.error("Ooops: "+e["error"].code+" "+e["error"].reason),n.error(e["error"].code+" "+e["error"].reason)):(he.error("Unknown error"),n.error("Unknown error"))},error:function(e,t){he.error(e+":",t),n.error(e+": "+t)}})}function B(e,n){if(_){var o=C[e];if(null!==o&&void 0!==o&&null!==o.webrtcStuff&&void 0!==o.webrtcStuff){var a={rtcgw:"trickle",candidate:n,transaction:he.randomString(12)};if(null!==o.token&&void 0!==o.token&&(a["token"]=o.token),null!==g&&void 0!==g&&(a["apisecret"]=g),he.vdebug("Sending trickle candidate (handle="+e+"):"),he.vdebug(a),t)return a["session_id"]=b,a["handle_id"]=e,void i.send(JSON.stringify(a));he.httpAPICall(s+"/"+b+"/"+e,{verb:"POST",withCredentials:p,body:a,success:function(e){he.vdebug("Candidate sent!"),he.vdebug(e),"ack"===e["rtcgw"]||he.error("Ooops: "+e["error"].code+" "+e["error"].reason)},error:function(e,t){he.error(e+":",t)}})}else he.warn("Invalid handle")}else he.warn("Is the server down? (connected=false)")}function j(e,t,i,n){var o=C[e];if(null!==o&&void 0!==o&&null!==o.webrtcStuff&&void 0!==o.webrtcStuff){var a=o.webrtcStuff,r=function(e){he.log("Received message on data channel:",e);var t=e.target.label;o.ondata(e.data,t)},s=function(e){he.log("Received state change on data channel:",e);var t=e.target.label,i=a.dataChannel[t]?a.dataChannel[t].readyState:"null";if(he.log("State change on <"+t+"> data channel: "+i),"open"===i){if(a.dataChannel[t].pending&&a.dataChannel[t].pending.length>0){for(var n in he.log("Sending pending messages on <"+t+">:",a.dataChannel[t].pending.length),a.dataChannel[t].pending){var r=a.dataChannel[t].pending[n];he.log("Sending string on data channel <"+t+">: "+r),a.dataChannel[t].send(r)}a.dataChannel[t].pending=[]}o.ondataopen(t)}},d=function(e){he.error("Got error on data channel:",e)};a.dataChannel[t]=i||a.pc.createDataChannel(t,{ordered:!1}),a.dataChannel[t].onmessage=r,a.dataChannel[t].onopen=s,a.dataChannel[t].onclose=s,a.dataChannel[t].onerror=d,a.dataChannel[t].pending=[],n&&a.dataChannel[t].pending.push(n)}else he.warn("Invalid handle")}function L(e,t){t=t||{},t.success="function"==typeof t.success?t.success:he.noop,t.error="function"==typeof t.error?t.error:he.noop;var i=C[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return he.warn("Invalid handle"),void t.error("Invalid handle");var n=i.webrtcStuff,o=t.text;if(null===o||void 0===o)return he.warn("Invalid text"),void t.error("Invalid text");var a=t.label?t.label:he.dataChanDefaultLabel;return n.dataChannel[a]?"open"!==n.dataChannel[a].readyState?(n.dataChannel[a].pending.push(o),void t.success()):(he.log("Sending string on data channel <"+a+">: "+o),n.dataChannel[a].send(o),void t.success()):(j(e,a,!1,o),void t.success())}function M(e,t){t=t||{},t.success="function"==typeof t.success?t.success:he.noop,t.error="function"==typeof t.error?t.error:he.noop;var i=C[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return he.warn("Invalid handle"),void t.error("Invalid handle");var n=i.webrtcStuff;if(null===n.dtmfSender||void 0===n.dtmfSender){if(void 0!==n.pc&&null!==n.pc){var o=n.pc.getSenders(),a=o.find((function(e){return e.track&&"audio"===e.track.kind}));if(!a)return he.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");n.dtmfSender=a.dtmf,n.dtmfSender&&(he.log("Created DTMF Sender"),n.dtmfSender.ontonechange=function(e){he.debug("Sent DTMF tone: "+e.tone)})}if(null===n.dtmfSender||void 0===n.dtmfSender)return he.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var r=t.dtmf;if(null===r||void 0===r)return he.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var s=r.tones;if(null===s||void 0===s)return he.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var d=r.duration;null!==d&&void 0!==d||(d=500);var l=r.gap;null!==l&&void 0!==l||(l=50),he.debug("Sending DTMF string "+s+" (duration "+d+"ms, gap "+l+"ms)"),n.dtmfSender.insertDTMF(s,d,l),t.success()}function N(e,n){n=n||{},n.success="function"==typeof n.success?n.success:he.noop,n.error="function"==typeof n.error?n.error:he.noop;var o=!0;void 0!==n.asyncRequest&&null!==n.asyncRequest&&(o=!0===n.asyncRequest);var a=!0;void 0!==n.noRequest&&null!==n.noRequest&&(a=!0===n.noRequest),he.log("Destroying handle "+e+" (async="+o+")"),J(e);var r=C[e];if(null===r||void 0===r||r.detached)return delete C[e],void n.success();if(a)return delete C[e],void n.success();if(!_)return he.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var d={rtcgw:"detach",transaction:he.randomString(12)};if(null!==r.token&&void 0!==r.token&&(d["token"]=r.token),null!==g&&void 0!==g&&(d["apisecret"]=g),t)return d["session_id"]=b,d["handle_id"]=e,i.send(JSON.stringify(d)),delete C[e],void n.success();he.httpAPICall(s+"/"+b+"/"+e,{verb:"POST",async:o,withCredentials:p,body:d,success:function(t){he.log("Destroyed handle:"),he.debug(t),"success"!==t["rtcgw"]&&he.error("Ooops: "+t["error"].code+" "+t["error"].reason),delete C[e],n.success()},error:function(t,i){he.error(t+":",i),delete C[e],n.success()}})}function F(e,t,i,n,o){var a=C[e];if(null===a||void 0===a||null===a.webrtcStuff||void 0===a.webrtcStuff)return he.warn("Invalid handle"),void n.error("Invalid handle");var r=a.webrtcStuff;he.debug("streamsDone:",o),o&&(he.debug("  -- Audio tracks:",o.getAudioTracks()),he.debug("  -- Video tracks:",o.getVideoTracks()));var s=!1;if(r.myStream&&i.update&&!r.streamExternal){if((!i.update&&X(i)||i.update&&(i.addAudio||i.replaceAudio))&&o.getAudioTracks()&&o.getAudioTracks().length)if(r.myStream.addTrack(o.getAudioTracks()[0]),he.unifiedPlan){he.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",o.getAudioTracks()[0]);var p=null,h=r.pc.getTransceivers();if(h&&h.length>0)for(var f in h){var g=h[f];if(g.sender&&g.sender.track&&"audio"===g.sender.track.kind||g.receiver&&g.receiver.track&&"audio"===g.receiver.track.kind){p=g;break}}p&&p.sender?p.sender.replaceTrack(o.getAudioTracks()[0]):r.pc.addTrack(o.getAudioTracks()[0],o)}else he.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",o.getAudioTracks()[0]),r.pc.addTrack(o.getAudioTracks()[0],o);if((!i.update&&ee(i)||i.update&&(i.addVideo||i.replaceVideo))&&o.getVideoTracks()&&o.getVideoTracks().length)if(r.myStream.addTrack(o.getVideoTracks()[0]),he.unifiedPlan){he.log((i.replaceVideo?"Replacing":"Adding")+" video track:",o.getVideoTracks()[0]);var v=null;h=r.pc.getTransceivers();if(h&&h.length>0)for(var f in h){g=h[f];if(g.sender&&g.sender.track&&"video"===g.sender.track.kind||g.receiver&&g.receiver.track&&"video"===g.receiver.track.kind){v=g;break}}v&&v.sender?v.sender.replaceTrack(o.getVideoTracks()[0]):r.pc.addTrack(o.getVideoTracks()[0],o)}else he.log((i.replaceVideo?"Replacing":"Adding")+" video track:",o.getVideoTracks()[0]),r.pc.addTrack(o.getVideoTracks()[0],o)}else r.myStream=o,s=!0;if(!r.pc){var y={iceServers:d,iceTransportPolicy:l,bundlePolicy:u};"chrome"===he.webRTCAdapter.browserDetails.browser&&(y["sdpSemantics"]=he.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var _={optional:[{DtlsSrtpKeyAgreement:!0}]};if(!0===m&&_.optional.push({googIPv6:!0}),n.rtcConstraints&&"object"===c(n.rtcConstraints))for(var f in he.debug("Adding custom PeerConnection constraints:",n.rtcConstraints),n.rtcConstraints)_.optional.push(n.rtcConstraints[f]);"edge"===he.webRTCAdapter.browserDetails.browser&&(y.bundlePolicy="max-bundle"),he.log("Creating PeerConnection"),he.debug(_),r.pc=new RTCPeerConnection(y,_),he.debug(r.pc),r.pc.getStats&&(r.volume={},r.bitrate.value="0 kbits/sec"),he.log("Preparing local SDP and gathering candidates (trickle="+r.trickle+")"),r.pc.oniceconnectionstatechange=function(e){r.pc&&a.iceState(r.pc.iceConnectionState)},r.pc.onicecandidate=function(t){if(null==t.candidate||"edge"===he.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)he.log("End of candidates."),r.iceDone=!0,!0===r.trickle?B(e,{completed:!0}):V(e,n);else{var i={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===r.trickle&&B(e,i)}},r.pc.ontrack=function(e){he.log("Handling Remote Track"),he.debug(e),e.streams&&(r.remoteStream=e.streams[0],a.onremotestream(r.remoteStream),e.track.onended||(he.log("Adding onended callback to track:",e.track),e.track.onended=function(e){he.log("Remote track muted/removed:",e),r.remoteStream&&(r.remoteStream.removeTrack(e.target),a.onremotestream(r.remoteStream))},e.track.onmute=e.track.onended,e.track.onunmute=function(e){he.log("Remote track flowing again:",e);try{r.remoteStream.addTrack(e.target),a.onremotestream(r.remoteStream)}catch(t){he.error(t)}}))}}if(s&&null!==o&&void 0!==o){he.log("Adding local stream");var b=!0===n.simulcast2;o.getTracks().forEach((function(e){if(he.log("Adding local track:",e),b)if("audio"===e.kind)r.pc.addTrack(e,o);else{he.log("Enabling rid-based simulcasting:",e);var t=S(n.simulcastMaxBitrates);r.pc.addTransceiver(e,{direction:"sendrecv",streams:[o],sendEncodings:[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]})}else r.pc.addTrack(e,o)}))}oe(i)&&!r.dataChannel[he.dataChanDefaultLabel]&&(he.log("Creating data channel"),j(e,he.dataChanDefaultLabel,!1),r.pc.ondatachannel=function(t){he.log("Data channel created by Janus:",t),j(e,t.channel.label,t.channel)}),r.myStream&&a.onlocalstream(r.myStream),null===t||void 0===t?U(e,i,n):r.pc.setRemoteDescription(t).then((function(){if(he.log("Remote description accepted!"),r.remoteSdp=t.sdp,r.candidates&&r.candidates.length>0){for(var o=0;o<r.candidates.length;o++){var a=r.candidates[o];he.debug("Adding remote candidate:",a),a&&!0!==a.completed?r.pc.addIceCandidate(a):r.pc.addIceCandidate(he.endOfCandidates)}r.candidates=[]}Z(e,i,n)}),n.error)}function z(e,t,i){i=i||{},i.success="function"==typeof i.success?i.success:he.noop,i.error="function"==typeof i.error?i.error:K;var n=i.jsep;if(t&&n)return he.error("Provided a JSEP to a createOffer"),void i.error("Provided a JSEP to a createOffer");if(!t&&(!n||!n.type||!n.sdp))return he.error("A valid JSEP is required for createAnswer"),void i.error("A valid JSEP is required for createAnswer");i.media=i.media||{audio:!0,video:!0};var o=i.media,a=C[e];if(null===a||void 0===a||null===a.webrtcStuff||void 0===a.webrtcStuff)return he.warn("Invalid handle"),void i.error("Invalid handle");var r=a.webrtcStuff;if(r.trickle=ae(i.trickle),void 0===r.pc||null===r.pc)o.update=!1,o.keepAudio=!1,o.keepVideo=!1;else if(void 0!==r.pc&&null!==r.pc){if(he.log("Updating existing media session"),o.update=!0,null!==i.stream&&void 0!==i.stream)i.stream!==r.myStream&&he.log("Renegotiation involves a new external stream");else{if(o.addAudio){if(o.keepAudio=!1,o.replaceAudio=!1,o.removeAudio=!1,o.audioSend=!0,r.myStream&&r.myStream.getAudioTracks()&&r.myStream.getAudioTracks().length)return he.error("Can't add audio stream, there already is one"),void i.error("Can't add audio stream, there already is one")}else o.removeAudio?(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!1,o.audioSend=!1):o.replaceAudio&&(o.keepAudio=!1,o.addAudio=!1,o.removeAudio=!1,o.audioSend=!0);if(null===r.myStream||void 0===r.myStream?(o.replaceAudio&&(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!0,o.audioSend=!0),X(o)&&(o.keepAudio=!1,o.addAudio=!0)):null===r.myStream.getAudioTracks()||void 0===r.myStream.getAudioTracks()||0===r.myStream.getAudioTracks().length?(o.replaceAudio&&(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!0,o.audioSend=!0),X(o)&&(o.keepVideo=!1,o.addAudio=!0)):!X(o)||o.removeAudio||o.replaceAudio||(o.keepAudio=!0),o.addVideo){if(o.keepVideo=!1,o.replaceVideo=!1,o.removeVideo=!1,o.videoSend=!0,r.myStream&&r.myStream.getVideoTracks()&&r.myStream.getVideoTracks().length)return he.error("Can't add video stream, there already is one"),void i.error("Can't add video stream, there already is one")}else o.removeVideo?(o.keepVideo=!1,o.replaceVideo=!1,o.addVideo=!1,o.videoSend=!1):o.replaceVideo&&(o.keepVideo=!1,o.addVideo=!1,o.removeVideo=!1,o.videoSend=!0);null===r.myStream||void 0===r.myStream||null===r.myStream.getVideoTracks()||void 0===r.myStream.getVideoTracks()||0===r.myStream.getVideoTracks().length?(o.replaceVideo&&(o.keepVideo=!1,o.replaceVideo=!1,o.addVideo=!0,o.videoSend=!0),ee(o)&&(o.keepVideo=!1,o.addVideo=!0)):!ee(o)||o.removeVideo||o.replaceVideo||(o.keepVideo=!0),o.addData&&(o.data=!0)}if(X(o)&&o.keepAudio&&ee(o)&&o.keepVideo)return a.consentDialog(!1),void F(e,n,o,i,r.myStream)}if(o.update&&!r.streamExternal){if(o.removeAudio||o.replaceAudio){if(r.myStream&&r.myStream.getAudioTracks()&&r.myStream.getAudioTracks().length){var s=r.myStream.getAudioTracks()[0];he.log("Removing audio track:",s),r.myStream.removeTrack(s);try{s.stop()}catch(x){}}if(r.pc.getSenders()&&r.pc.getSenders().length){var d=!0;if(o.replaceAudio&&he.unifiedPlan&&(d=!1),d)for(var l in r.pc.getSenders()){s=r.pc.getSenders()[l];s&&s.track&&"audio"===s.track.kind&&(he.log("Removing audio sender:",s),r.pc.removeTrack(s))}}}if(o.removeVideo||o.replaceVideo){if(r.myStream&&r.myStream.getVideoTracks()&&r.myStream.getVideoTracks().length){s=r.myStream.getVideoTracks()[0];he.log("Removing video track:",s),r.myStream.removeTrack(s);try{s.stop()}catch(x){}}if(r.pc.getSenders()&&r.pc.getSenders().length){var u=!0;if(o.replaceVideo&&he.unifiedPlan&&(u=!1),u)for(var l in r.pc.getSenders()){s=r.pc.getSenders()[l];s&&s.track&&"video"===s.track.kind&&(he.log("Removing video sender:",s),r.pc.removeTrack(s))}}}}if(null!==i.stream&&void 0!==i.stream){var m=i.stream;if(he.log("MediaStream provided by the application"),he.debug(m),o.update&&r.myStream&&r.myStream!==i.stream&&!r.streamExternal){try{var p=r.myStream.getTracks();for(var h in p){var f=p[h];he.log(f),null!==f&&void 0!==f&&f.stop()}}catch(x){}r.myStream=null}return r.streamExternal=!0,a.consentDialog(!1),void F(e,n,o,i,m)}if(X(o)||ee(o)){if(!he.isGetUserMediaAvailable())return void i.error("getUserMedia not available");var g={mandatory:{},optional:[]};a.consentDialog(!0);var v=X(o);!0===v&&void 0!=o&&null!=o&&"object"===c(o.audio)&&(v=o.audio);var y=ee(o);if(!0===y&&void 0!=o&&null!=o){var S=!0===i.simulcast,_=!0===i.simulcast2;if(!S&&!_||n||void 0!==o.video&&!1!==o.video||(o.video="hires"),o.video&&"screen"!=o.video&&"window"!=o.video)if("object"===c(o.video))y=o.video;else{var b=0,T=0;"lowres"===o.video?(T=240,b=320):"lowres-16:9"===o.video?(T=180,b=320):"hires"===o.video||"hires-16:9"===o.video||"hdres"===o.video?(T=720,b=1280):"fhdres"===o.video?(T=1080,b=1920):"4kres"===o.video?(T=2160,b=3840):"stdres"===o.video?(T=480,b=640):"stdres-16:9"===o.video?(T=360,b=640):(he.log("Default video setting is stdres 4:3"),T=480,b=640),he.log("Adding media constraint:",o.video),y={height:{ideal:T},width:{ideal:b}},he.log("Adding video constraint:",y)}else if("screen"===o.video||"window"===o.video){var w=function(t,r){a.consentDialog(!1),t?i.error(t):F(e,n,o,i,r)},k=function(e,t,i){he.log("Adding media constraint (screen capture)"),he.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){i?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(i){e.addTrack(i.getAudioTracks()[0]),t(null,e)})):t(null,e)}))["catch"]((function(e){a.consentDialog(!1),t(e)}))};if(o.screenshareFrameRate||(o.screenshareFrameRate=3),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return void navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(t){a.consentDialog(!1),X(o)&&!o.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(a){t.addTrack(a.getAudioTracks()[0]),F(e,n,o,i,t)})):F(e,n,o,i,t)}),(function(e){a.consentDialog(!1),i.error(e)}));if("chrome"===he.webRTCAdapter.browserDetails.browser){var E=he.webRTCAdapter.browserDetails.version,P=33;window.navigator.userAgent.match("Linux")&&(P=35),E>=26&&E<=P?(g={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:o.screenshareFrameRate,maxFrameRate:o.screenshareFrameRate,chromeMediaSource:"screen"}},audio:X(o)&&!o.keepAudio},k(g,w)):he.extension.getScreen((function(e,t){if(e)return a.consentDialog(!1),i.error(e);g={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:o.screenshareFrameRate,maxFrameRate:o.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},g.video.mandatory.chromeMediaSourceId=t,k(g,w,X(o)&&!o.keepAudio)}))}else if("firefox"===he.webRTCAdapter.browserDetails.browser){if(!(he.webRTCAdapter.browserDetails.version>=33)){var I=new Error("NavigatorUserMediaError");return I.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",a.consentDialog(!1),void i.error(I)}g={video:{mozMediaSource:o.video,mediaSource:o.video},audio:X(o)&&!o.keepAudio},k(g,(function(e,t){if(w(e,t),!e)var i=t.currentTime,n=window.setInterval((function(){t||window.clearInterval(n),t.currentTime==i&&(window.clearInterval(n),t.onended&&t.onended()),i=t.currentTime}),500)}))}return}}null!==o&&void 0!==o&&"screen"===o.video||navigator.mediaDevices.enumerateDevices().then((function(t){var r=t.some((function(e){return"audioinput"===e.kind})),s=ne(o)||t.some((function(e){return"videoinput"===e.kind})),d=X(o),l=ee(o),c=Y(o),u=te(o);if(d||l||c||u){var p=!!d&&r,h=!!l&&s;if(!p&&!h)return a.consentDialog(!1),i.error("No capture device found"),!1;if(!p&&c)return a.consentDialog(!1),i.error("Audio capture is required, but no capture device found"),!1;if(!h&&u)return a.consentDialog(!1),i.error("Video capture is required, but no capture device found"),!1}var f={audio:!(!r||o.keepAudio)&&v,video:!(!s||o.keepVideo)&&y};he.debug("getUserMedia constraints",f),f.audio||f.video?navigator.mediaDevices.getUserMedia(f).then((function(t){a.consentDialog(!1),F(e,n,o,i,t)}))["catch"]((function(e){a.consentDialog(!1),i.error({code:e.code,name:e.name,message:e.message})})):(a.consentDialog(!1),F(e,n,o,i,m))}))["catch"]((function(e){a.consentDialog(!1),i.error("enumerateDevices error",e)}))}else F(e,n,o,i)}function O(e,t){t=t||{},t.success="function"==typeof t.success?t.success:he.noop,t.error="function"==typeof t.error?t.error:K;var i=t.jsep,n=C[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return he.warn("Invalid handle"),void t.error("Invalid handle");var o=n.webrtcStuff;if(void 0!==i&&null!==i){if(null===o.pc)return he.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");o.pc.setRemoteDescription(i).then((function(){if(he.log("Remote description accepted!"),o.remoteSdp=i.sdp,o.candidates&&o.candidates.length>0){for(var e=0;e<o.candidates.length;e++){var n=o.candidates[e];he.debug("Adding remote candidate:",n),n&&!0!==n.completed?o.pc.addIceCandidate(n):o.pc.addIceCandidate(he.endOfCandidates)}o.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function U(e,t,i){i=i||{},i.success="function"==typeof i.success?i.success:he.noop,i.error="function"==typeof i.error?i.error:he.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:he.noop;var n=C[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return he.warn("Invalid handle"),void i.error("Invalid handle");var o=n.webrtcStuff,a=!0===i.simulcast;a?he.log("Creating offer (iceDone="+o.iceDone+", simulcast="+a+")"):he.log("Creating offer (iceDone="+o.iceDone+")");var r={};if(he.unifiedPlan){var s=null,d=null,l=o.pc.getTransceivers();if(l&&l.length>0)for(var c in l){var u=l[c];u.sender&&u.sender.track&&"audio"===u.sender.track.kind||u.receiver&&u.receiver.track&&"audio"===u.receiver.track.kind?s||(s=u):(u.sender&&u.sender.track&&"video"===u.sender.track.kind||u.receiver&&u.receiver.track&&"video"===u.receiver.track.kind)&&(d||(d=u))}var m=X(t),p=Q(t);m||p?m&&p?s&&(s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",he.log("Setting audio transceiver to sendrecv:",s)):m&&!p?s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",he.log("Setting audio transceiver to sendonly:",s)):!m&&p&&(s?(s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",he.log("Setting audio transceiver to recvonly:",s)):(s=o.pc.addTransceiver("audio",{direction:"recvonly"}),he.log("Adding recvonly audio transceiver:",s))):t.removeAudio&&s&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive",he.log("Setting audio transceiver to inactive:",s));var h=ee(t),f=ie(t);h||f?h&&f?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",he.log("Setting video transceiver to sendrecv:",d)):h&&!f?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",he.log("Setting video transceiver to sendonly:",d)):!h&&f&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",he.log("Setting video transceiver to recvonly:",d)):(d=o.pc.addTransceiver("video",{direction:"recvonly"}),he.log("Adding recvonly video transceiver:",d))):t.removeVideo&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",he.log("Setting video transceiver to inactive:",d))}else r["offerToReceiveAudio"]=Q(t),r["offerToReceiveVideo"]=ie(t);var g=!0===i.iceRestart;g&&(r["iceRestart"]=!0),he.debug(r);var v=ee(t);if(v&&a&&"firefox"===he.webRTCAdapter.browserDetails.browser){he.log("Enabling Simulcasting for Firefox (RID)");var y=o.pc.getSenders().find((function(e){return"video"==e.track.kind}));if(y){var _=y.getParameters();_||(_={});var b=S(i.simulcastMaxBitrates);_.encodings=[{rid:"h",active:!0,maxBitrate:b.high},{rid:"m",active:!0,maxBitrate:b.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:b.low,scaleResolutionDownBy:4}],y.setParameters(_)}}o.pc.createOffer(r).then((function(e){he.debug(e);var t={type:e.type,sdp:e.sdp};i.customizeSdp(t),e.sdp=t.sdp,he.log("Setting local description"),v&&a&&("chrome"===he.webRTCAdapter.browserDetails.browser||"safari"===he.webRTCAdapter.browserDetails.browser?(he.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=$(e.sdp)):"firefox"!==he.webRTCAdapter.browserDetails.browser&&he.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp=e.sdp,o.pc.setLocalDescription(e)["catch"](i.error),o.mediaConstraints=r,o.iceDone||o.trickle?(he.log("Offer ready"),he.debug(i),i.success(e)):he.log("Waiting for all candidates...")}),i.error)}function Z(e,t,i){i=i||{},i.success="function"==typeof i.success?i.success:he.noop,i.error="function"==typeof i.error?i.error:he.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:he.noop;var n=C[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return he.warn("Invalid handle"),void i.error("Invalid handle");var o=n.webrtcStuff,a=!0===i.simulcast;a?he.log("Creating answer (iceDone="+o.iceDone+", simulcast="+a+")"):he.log("Creating answer (iceDone="+o.iceDone+")");var r=null;if(he.unifiedPlan){r={};var s=null,d=null,l=o.pc.getTransceivers();if(l&&l.length>0)for(var c in l){var u=l[c];u.sender&&u.sender.track&&"audio"===u.sender.track.kind||u.receiver&&u.receiver.track&&"audio"===u.receiver.track.kind?s||(s=u):(u.sender&&u.sender.track&&"video"===u.sender.track.kind||u.receiver&&u.receiver.track&&"video"===u.receiver.track.kind)&&(d||(d=u))}var m=X(t),p=Q(t);if(m||p){if(m&&p){if(s)try{s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",he.log("Setting audio transceiver to sendrecv:",s)}catch(b){he.error(b)}}else if(m&&!p)try{s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",he.log("Setting audio transceiver to sendonly:",s))}catch(b){he.error(b)}else if(!m&&p)if(s)try{s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",he.log("Setting audio transceiver to recvonly:",s)}catch(b){he.error(b)}else s=o.pc.addTransceiver("audio",{direction:"recvonly"}),he.log("Adding recvonly audio transceiver:",s)}else if(t.removeAudio&&s)try{s.setDirection?s.setDirection("inactive"):s.direction="inactive",he.log("Setting audio transceiver to inactive:",s)}catch(b){he.error(b)}var h=ee(t),f=ie(t);if(h||f){if(h&&f){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",he.log("Setting video transceiver to sendrecv:",d)}catch(b){he.error(b)}}else if(h&&!f){if(d)try{d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",he.log("Setting video transceiver to sendonly:",d)}catch(b){he.error(b)}}else if(!h&&f)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",he.log("Setting video transceiver to recvonly:",d)}catch(b){he.error(b)}else d=o.pc.addTransceiver("video",{direction:"recvonly"}),he.log("Adding recvonly video transceiver:",d)}else if(t.removeVideo&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",he.log("Setting video transceiver to inactive:",d)}catch(b){he.error(b)}}else r="firefox"==he.webRTCAdapter.browserDetails.browser||"edge"==he.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:Q(t),offerToReceiveVideo:ie(t)}:{mandatory:{OfferToReceiveAudio:Q(t),OfferToReceiveVideo:ie(t)}};he.debug(r);var g=ee(t);if(g&&a&&"firefox"===he.webRTCAdapter.browserDetails.browser){he.log("Enabling Simulcasting for Firefox (RID)");var v=o.pc.getSenders()[1];he.log(v);var y=v.getParameters();he.log(y);var _=S(i.simulcastMaxBitrates);v.setParameters({encodings:[{rid:"high",active:!0,priority:"high",maxBitrate:_.high},{rid:"medium",active:!0,priority:"medium",maxBitrate:_.medium},{rid:"low",active:!0,priority:"low",maxBitrate:_.low}]})}o.pc.createAnswer(r).then((function(e){he.debug(e);var t={type:e.type,sdp:e.sdp};i.customizeSdp(t),e.sdp=t.sdp,he.log("Setting local description"),g&&a&&("chrome"===he.webRTCAdapter.browserDetails.browser?he.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==he.webRTCAdapter.browserDetails.browser&&he.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp=e.sdp,o.pc.setLocalDescription(e)["catch"](i.error),o.mediaConstraints=r,o.iceDone||o.trickle?i.success(e):he.log("Waiting for all candidates...")}),i.error)}function V(e,t){t=t||{},t.success="function"==typeof t.success?t.success:he.noop,t.error="function"==typeof t.error?t.error:he.noop;var i=C[e];if(null!==i&&void 0!==i&&null!==i.webrtcStuff&&void 0!==i.webrtcStuff){var n=i.webrtcStuff;he.log("Sending offer/answer SDP..."),null!==n.mySdp&&void 0!==n.mySdp?(n.mySdp={type:n.pc.localDescription.type,sdp:n.pc.localDescription.sdp},!1===n.trickle&&(n.mySdp["trickle"]=!1),he.debug(t),n.sdpSent=!0,t.success(n.mySdp)):he.warn("Local SDP instance is invalid, not sending anything...")}else he.warn("Invalid handle, not sending anything")}function H(e,t){var i=C[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return he.warn("Invalid handle"),0;var n=t?"remote":"local",o=i.webrtcStuff;return o.volume[n]||(o.volume[n]={value:0}),o.pc.getStats&&"chrome"===he.webRTCAdapter.browserDetails.browser?!t||null!==o.remoteStream&&void 0!==o.remoteStream?t||null!==o.myStream&&void 0!==o.myStream?null===o.volume[n].timer||void 0===o.volume[n].timer?(he.log("Starting "+n+" volume monitor"),o.volume[n].timer=setInterval((function(){o.pc.getStats((function(e){for(var i=e.result(),a=0;a<i.length;a++){var r=i[a];"ssrc"==r.type&&(t&&r.stat("audioOutputLevel")?o.volume[n].value=parseInt(r.stat("audioOutputLevel")):!t&&r.stat("audioInputLevel")&&(o.volume[n].value=parseInt(r.stat("audioInputLevel"))))}}))}),200),0):o.volume[n].value:(he.warn("Local stream unavailable"),0):(he.warn("Remote stream unavailable"),0):(he.warn("Getting the "+n+" volume unsupported by browser"),0)}function G(e,t){var i=C[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return he.warn("Invalid handle"),!0;var n=i.webrtcStuff;return null===n.pc||void 0===n.pc?(he.warn("Invalid PeerConnection"),!0):void 0===n.myStream||null===n.myStream?(he.warn("Invalid local MediaStream"),!0):t?null===n.myStream.getVideoTracks()||void 0===n.myStream.getVideoTracks()||0===n.myStream.getVideoTracks().length?(he.warn("No video track"),!0):!n.myStream.getVideoTracks()[0].enabled:null===n.myStream.getAudioTracks()||void 0===n.myStream.getAudioTracks()||0===n.myStream.getAudioTracks().length?(he.warn("No audio track"),!0):!n.myStream.getAudioTracks()[0].enabled}function W(e,t,i){var n=C[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return he.warn("Invalid handle"),!1;var o=n.webrtcStuff;return null===o.pc||void 0===o.pc?(he.warn("Invalid PeerConnection"),!1):void 0===o.myStream||null===o.myStream?(he.warn("Invalid local MediaStream"),!1):t?null===o.myStream.getVideoTracks()||void 0===o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length?(he.warn("No video track"),!1):(o.myStream.getVideoTracks()[0].enabled=!i,!0):null===o.myStream.getAudioTracks()||void 0===o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length?(he.warn("No audio track"),!1):(o.myStream.getAudioTracks()[0].enabled=!i,!0)}function q(e){var t=C[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return he.warn("Invalid handle"),"Invalid handle";var i=t.webrtcStuff;return null===i.pc||void 0===i.pc?"Invalid PeerConnection":i.pc.getStats?null===i.bitrate.timer||void 0===i.bitrate.timer?(he.log("Starting bitrate timer (via getStats)"),i.bitrate.timer=setInterval((function(){i.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(i.bitrate.bsnow=e.bytesReceived,i.bitrate.tsnow=e.timestamp,null===i.bitrate.bsbefore||null===i.bitrate.tsbefore)i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow;else{var n=i.bitrate.tsnow-i.bitrate.tsbefore;"safari"==he.webRTCAdapter.browserDetails.browser&&(n/=1e3);var o=Math.round(8*(i.bitrate.bsnow-i.bitrate.bsbefore)/n);"safari"===he.webRTCAdapter.browserDetails.browser&&(o=parseInt(o/1e3)),i.bitrate.value=o+" kbits/sec",i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):i.bitrate.value:(he.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser")}function K(e){he.error("WebRTC error:",e)}function J(e,n){he.log("Cleaning WebRTC stuff");var o=C[e];if(null!==o&&void 0!==o){var a=o.webrtcStuff;if(null!==a&&void 0!==a){if(!0===n){var r={rtcgw:"hangup",transaction:he.randomString(12)};null!==o.token&&void 0!==o.token&&(r["token"]=o.token),null!==g&&void 0!==g&&(r["apisecret"]=g),he.debug("Sending hangup request (handle="+e+"):"),he.debug(r),t?(r["session_id"]=b,r["handle_id"]=e,i.send(JSON.stringify(r))):he.httpAPICall(s+"/"+b+"/"+e,{verb:"POST",withCredentials:p,body:r})}a.remoteStream=null,a.volume&&(a.volume["local"]&&a.volume["local"].timer&&clearInterval(a.volume["local"].timer),a.volume["remote"]&&a.volume["remote"].timer&&clearInterval(a.volume["remote"].timer)),a.volume={},a.bitrate.timer&&clearInterval(a.bitrate.timer),a.bitrate.timer=null,a.bitrate.bsnow=null,a.bitrate.bsbefore=null,a.bitrate.tsnow=null,a.bitrate.tsbefore=null,a.bitrate.value=null;try{if(!a.streamExternal&&null!==a.myStream&&void 0!==a.myStream){he.log("Stopping local stream tracks");var d=a.myStream.getTracks();for(var l in d){var c=d[l];he.log(c),null!==c&&void 0!==c&&c.stop()}}}catch(u){}a.streamExternal=!1,a.myStream=null;try{a.pc.close()}catch(u){}a.pc=null,a.candidates=null,a.mySdp=null,a.remoteSdp=null,a.iceDone=!1,a.dataChannel={},a.dtmfSender=null}o.oncleanup()}}function $(e){for(var t=e.split("\r\n"),i=!1,n=[-1],o=[-1],a=null,r=null,s=null,d=null,l=-1,c=0;c<t.length;c++){var u=t[c].match(/m=(\w+) */);if(u){var m=u[1];if("video"===m){if(!(n[0]<0)){l=c;break}i=!0}else if(n[0]>-1){l=c;break}}else if(i){var p=t[c].match(/a=ssrc-group:FID (\d+) (\d+)/);if(p)n[0]=p[1],o[0]=p[2],t.splice(c,1),c--;else{if(n[0]){var h=t[c].match("a=ssrc:"+n[0]+" cname:(.+)");if(h&&(a=h[1]),h=t[c].match("a=ssrc:"+n[0]+" msid:(.+)"),h&&(r=h[1]),h=t[c].match("a=ssrc:"+n[0]+" mslabel:(.+)"),h&&(s=h[1]),h=t[c].match("a=ssrc:"+n[0]+" label:(.+)"),h&&(d=h[1]),0===t[c].indexOf("a=ssrc:"+o[0])){t.splice(c,1),c--;continue}if(0===t[c].indexOf("a=ssrc:"+n[0])){t.splice(c,1),c--;continue}}0!=t[c].length||(t.splice(c,1),c--)}}}if(n[0]<0){l=-1,i=!1;for(c=0;c<t.length;c++){u=t[c].match(/m=(\w+) */);if(u){m=u[1];if("video"===m){if(!(n[0]<0)){l=c;break}i=!0}else if(n[0]>-1){l=c;break}}else if(i){if(n[0]<0){var f=t[c].match(/a=ssrc:(\d+)/);if(f){n[0]=f[1],t.splice(c,1),c--;continue}}else{h=t[c].match("a=ssrc:"+n[0]+" cname:(.+)");if(h&&(a=h[1]),h=t[c].match("a=ssrc:"+n[0]+" msid:(.+)"),h&&(r=h[1]),h=t[c].match("a=ssrc:"+n[0]+" mslabel:(.+)"),h&&(s=h[1]),h=t[c].match("a=ssrc:"+n[0]+" label:(.+)"),h&&(d=h[1]),0===t[c].indexOf("a=ssrc:"+o[0])){t.splice(c,1),c--;continue}if(0===t[c].indexOf("a=ssrc:"+n[0])){t.splice(c,1),c--;continue}}0!=t[c].length||(t.splice(c,1),c--)}}}if(n[0]<0)return he.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length),n[1]=Math.floor(4294967295*Math.random()),n[2]=Math.floor(4294967295*Math.random()),o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random());for(c=0;c<n.length;c++)a&&(t.splice(l,0,"a=ssrc:"+n[c]+" cname:"+a),l++),r&&(t.splice(l,0,"a=ssrc:"+n[c]+" msid:"+r),l++),s&&(t.splice(l,0,"a=ssrc:"+n[c]+" mslabel:"+s),l++),d&&(t.splice(l,0,"a=ssrc:"+n[c]+" label:"+d),l++),a&&(t.splice(l,0,"a=ssrc:"+o[c]+" cname:"+a),l++),r&&(t.splice(l,0,"a=ssrc:"+o[c]+" msid:"+r),l++),s&&(t.splice(l,0,"a=ssrc:"+o[c]+" mslabel:"+s),l++),d&&(t.splice(l,0,"a=ssrc:"+o[c]+" label:"+d),l++);return t.splice(l,0,"a=ssrc-group:FID "+n[2]+" "+o[2]),t.splice(l,0,"a=ssrc-group:FID "+n[1]+" "+o[1]),t.splice(l,0,"a=ssrc-group:FID "+n[0]+" "+o[0]),t.splice(l,0,"a=ssrc-group:SIM "+n[0]+" "+n[1]+" "+n[2]),e=t.join("\r\n"),e.endsWith("\r\n")||(e+="\r\n"),e}function X(e){return he.debug("isAudioSendEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function Y(e){return he.debug("isAudioSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}function Q(e){return he.debug("isAudioRecvEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function ee(e){return he.debug("isVideoSendEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function te(e){return he.debug("isVideoSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}function ie(e){return he.debug("isVideoRecvEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}function ne(e){if(he.debug("isScreenSendEnabled:",e),void 0===e||null===e)return!1;if("object"!==c(e.video)||"object"!==c(e.video.mandatory))return!1;var t=e.video.mandatory;return t.chromeMediaSource?"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource:t.mozMediaSource?"window"===t.mozMediaSource||"screen"===t.mozMediaSource:!!t.mediaSource&&("window"===t.mediaSource||"screen"===t.mediaSource)}function oe(e){return he.debug("isDataEnabled:",e),"edge"==he.webRTCAdapter.browserDetails.browser?(he.warn("Edge doesn't support data channels yet"),!1):void 0!==e&&null!==e&&!0===e.data}function ae(e){return he.debug("isTrickleEnabled:",e),void 0===e||null===e||!0===e}x(e),this.getServer=function(){return s},this.isConnected=function(){return _},this.reconnect=function(e){e=e||{},e.success="function"==typeof e.success?e.success:he.noop,e.error="function"==typeof e.error?e.error:he.noop,e["reconnect"]=!0,x(e)},this.getSessionId=function(){return b},this.destroy=function(e){R(e)},this.attach=function(e){A(e)}}he.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,i=e&&e.Promise||Promise,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},extension:e&&e.extension||pe,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||window.adapter,httpAPICall:function(e,n){var o={method:n.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===n.verb&&(o.headers["Content-Type"]="application/json"),void 0!==n.withCredentials&&(o.credentials=!0===n.withCredentials?"include":n.withCredentials?n.withCredentials:"omit"),void 0!==n.body&&(o.body=JSON.stringify(n.body));var a=t(e,o)["catch"]((function(e){return i.reject({message:"Probably a network error, is the server down?",error:e})}));if(void 0!==n.timeout){var r=new i((function(e,t){var i=setTimeout((function(){return clearTimeout(i),t({message:"Request timed out",timeout:n.timeout})}),n.timeout)}));a=i.race([a,r])}return a.then((function(e){return e.ok?c(n.success)===c(he.noop)?e.json().then((function(e){n.success(e)}))["catch"]((function(t){return i.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:i.reject({message:"API call failed",response:e})}))["catch"]((function(e){c(n.error)===c(he.noop)&&n.error(e.message||"<< internal error >>",e)})),a}}},he.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,i=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new i(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||pe,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,i){var n=void 0!==i.body?{contentType:"application/json",data:JSON.stringify(i.body)}:{},o=void 0!==i.withCredentials?{xhrFields:{withCredentials:i.withCredentials}}:{};return t.ajax(t.extend(n,o,{url:e,type:i.verb,cache:!1,dataType:"json",async:i.async,timeout:i.timeout,success:function(e){c(i.success)===c(he.noop)&&i.success(e)},error:function(e,t,n){c(i.error)===c(he.noop)&&i.error(t,n)}}))}}},he.noop=function(){},he.dataChanDefaultLabel="JanusDataChannel",he.endOfCandidates=null,he.init=function(e){if(e=e||{},e.callback="function"==typeof e.callback?e.callback:he.noop,!0===he.initDone)e.callback();else{if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={log:function(){}}),he.trace=he.noop,he.debug=he.noop,he.vdebug=he.noop,he.log=he.noop,he.warn=he.noop,he.error=he.noop,!0===e.debug||"all"===e.debug)he.trace=console.trace.bind(console),he.debug=console.debug.bind(console),he.vdebug=console.debug.bind(console),he.log=console.log.bind(console),he.warn=console.warn.bind(console),he.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var t in e.debug){var i=e.debug[t];switch(i){case"trace":he.trace=console.trace.bind(console);break;case"debug":he.debug=console.debug.bind(console);break;case"vdebug":he.vdebug=console.debug.bind(console);break;case"log":he.log=console.log.bind(console);break;case"warn":he.warn=console.warn.bind(console);break;case"error":he.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+i+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')");break}}he.log("Initializing library");var n=e.dependencies||he.useDefaultDependencies();he.isArray=n.isArray,he.webRTCAdapter=n.webRTCAdapter,he.httpAPICall=n.httpAPICall,he.newWebSocket=n.newWebSocket,he.extension=n.extension,he.extension.init(),he.listDevices=function(e,t){e="function"==typeof e?e:he.noop,null==t&&(t={audio:!0,video:!0}),he.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(i){he.debug(i),e(i);try{var n=t.getTracks();for(var o in n){var a=n[o];null!==a&&void 0!==a&&a.stop()}}catch(r){}}))}))["catch"]((function(t){he.error(t),e([])})):(he.warn("navigator.mediaDevices unavailable"),e([]))},he.attachMediaStream=function(e,t){if("chrome"===he.webRTCAdapter.browserDetails.browser){var i=he.webRTCAdapter.browserDetails.version;i>=52?e.srcObject=t:he.error("Error attaching stream to element")}else e.srcObject=t},he.reattachMediaStream=function(e,t){if("chrome"===he.webRTCAdapter.browserDetails.browser){var i=he.webRTCAdapter.browserDetails.version;i>=52?e.srcObject=t.srcObject:"undefined"!==typeof e.src?e.src=t.src:he.error("Error reattaching stream to element")}else e.srcObject=t.srcObject};var o=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,a=o?"pagehide":"beforeunload",r=window["on"+a];if(window.addEventListener(a,(function(e){for(var t in he.log("Closing window"),he.sessions)null!==he.sessions[t]&&void 0!==he.sessions[t]&&he.sessions[t].destroyOnUnload&&(he.log("Destroying session "+t),he.sessions[t].destroy({asyncRequest:!1,notifyDestroyed:!1}));r&&"function"==typeof r&&r()})),he.safariVp8=!1,"safari"===he.webRTCAdapter.browserDetails.browser&&he.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var t in RTCRtpSender.getCapabilities("video").codecs){var s=RTCRtpSender.getCapabilities("video").codecs[t];if(s&&s.mimeType&&"video/vp8"===s.mimeType.toLowerCase()){he.safariVp8=!0;break}}he.safariVp8?he.log("This version of Safari supports VP8"):he.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var d=new RTCPeerConnection({},{});d.createOffer({offerToReceiveVideo:!0}).then((function(e){he.safariVp8=-1!==e.sdp.indexOf("VP8"),he.safariVp8?he.log("This version of Safari supports VP8"):he.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),d.close(),d=null}))}if(he.unifiedPlan=!1,"firefox"===he.webRTCAdapter.browserDetails.browser&&he.webRTCAdapter.browserDetails.version>=59)he.unifiedPlan=!0;else if("chrome"===he.webRTCAdapter.browserDetails.browser&&he.webRTCAdapter.browserDetails.version<72)he.unifiedPlan=!1;else if("undefined"===typeof RTCRtpTransceiver||"currentDirection"in RTCRtpTransceiver.prototype){var l=new RTCPeerConnection;try{l.addTransceiver("audio"),he.unifiedPlan=!0}catch(c){}l.close()}else he.unifiedPlan=!1;he.initDone=!0,e.callback()}},he.isWebrtcSupported=function(){return void 0!==window.RTCPeerConnection&&null!==window.RTCPeerConnection},he.isGetUserMediaAvailable=function(){return void 0!==navigator.mediaDevices&&null!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia&&null!==navigator.mediaDevices.getUserMedia},he.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",n=0;n<e;n++){var o=Math.floor(Math.random()*t.length);i+=t.substring(o,o+1)}return i},window.Janus_Talk=he;var fe=window.Janus_Talk,ge=null,ve=null,ye="tts-"+Janus_Talk.randomString(12),Se=null;fe.init({debug:"all",callback:function(){window.stopTalk=function(){ge.destroy()},window.startTalk=function(){fe.isWebrtcSupported()?ge=new fe({server:window.EZUIKit.opt.rtcUrl,success:function(){ge.attach({plugin:"rtcgw.plugin.tts",opaqueId:ye,success:function(e){ve=e,fe.log("Plugin attached! ("+ve.getPlugin()+", id="+ve.getId()+")");var t=window.EZUIKit.opt.talkLink;console.log("ttsUlr",t);var i={request:"start",url:t,codec:"opus",dir:"sendrecv",audio_debug:1};"gb28181"===window.EZUIKit.opt.talkType&&(i["devProto"]="gb28181"),fe.debug("Trying a createOffer too (audio/video sendrecv)"),ve.createOffer({media:{audio:!0,video:!1,data:!1},simulcast:!1,simulcast2:!1,success:function(e){fe.debug("Got SDP!"),fe.debug(e),ve.send({message:i,jsep:e}),"undefined"!==typeof window.EZUIKit.handleTalkSuccess&&window.EZUIKit.handleTalkSuccess()},error:function(e){fe.error("WebRTC error:",e),"undefined"!==typeof window.EZUIKit.handleTalkError&&window.EZUIKit.handleTalkError(e)}})},error:function(e){console.error("  -- Error attaching plugin...",e),bootbox.alert("Error attaching plugin... "+e),"undefined"!==window.EZUIKit.handleTalkError&&window.EZUIKit.handleTalkError(e)},consentDialog:function(e){fe.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){fe.log("ICE state changed to "+e)},mediaState:function(e,t){fe.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){fe.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:function(e,t){fe.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on this PeerConnection ("+t+" lost packets)")},onmessage:function(e,t){fe.debug(" ::: Got a message :::"),fe.debug(e),void 0!==t&&null!==t&&(fe.debug("Handling SDP as well..."),fe.debug(t),ve.handleRemoteJsep({jsep:t}));var i=e["result"];if(null!==i&&void 0!==i){if("done"===i)return bootbox.alert("The TTS Test is over"),null!==Se&&void 0!==Se&&Se.stop(),void(Se=null);"msg"===i&&"undefined"!==typeof window.EZUIKit.handleTalkMessage&&window.EZUIKit.handleTalkMessage(e);var n=i["status"];"slow_link"===n&&toastr.warning("Janus apparently missed many packets we sent, maybe we should reduce the bitrate","Packet loss?",{timeOut:2e3})}},onlocalstream:function(e){fe.debug(" ::: Got a local stream :::"),fe.debug(e),fe.attachMediaStream(document.getElementById("myaudio"),e),"completed"!==ve.webrtcStuff.pc.iceConnectionState&&"connected"!==ve.webrtcStuff.pc.iceConnectionState&&(null==Se?document.getElementById("audioright"):Se.spin());var t=e.getAudioTracks();null===t||void 0===t||t.length},onremotestream:function(e){fe.debug(" ::: Got a remote stream :::"),fe.debug(e),fe.attachMediaStream(document.getElementById("peeraudio"),e);var t=e.getAudioTracks();null===t||void 0===t||0===t.length||document.getElementById("peeraudio").play()},ondataopen:function(e){fe.log("The DataChannel is available!")},ondata:function(e){fe.debug("We got data from the DataChannel! "+e)},oncleanup:function(){fe.log(" ::: Got a cleanup notification :::"),null!==Se&&void 0!==Se&&Se.stop(),Se=null}})},error:function(e){fe.error(e),"undefined"!==window.EZUIKit.handleTalkError&&window.EZUIKit.handleTalkError(e)},destroyed:function(){}}):bootbox.alert("No WebRTC support... ")}}}),window.janus=ge,window.tts=ve;var _e=function(){function e(t){var i=this;p(this,e),this.jSPlugin=t,this.codeHandler=new ue,this.pluginStatus=new V(this,this.jSPlugin.params.id);var n=document.createElement("div");n.id="audioleft";var o=document.createElement("div");o.id="audioright",o.style="display:none;";var a=document.createElement("audio");a.id="myaudio",a.muted=!0,a.setAttribute("autoplay",!0),a.setAttribute("controls",!0),n.appendChild(a),n.style="display:none;";var r=document.createElement("audio");r.id="peeraudio",r.setAttribute("autoplay",!0),r.setAttribute("controls",!0),o.appendChild(r),window.EZUIKit["handleTalkError"]=function(e){console.log("talk err",e),"undefined"!==typeof i.jSPlugin.handleTalkError&&i.jSPlugin.handleTalkError(e)},window.EZUIKit["handleTalkSuccess"]=function(e){console.log("talk success",e),"undefined"!==typeof i.jSPlugin.handleTalkSuccess&&i.jSPlugin.handleTalkSuccess(e)},window.EZUIKit.opt={rtcUrl:"",talkLink:"",ttsUrl:"",stream:"",deviceSerial:j(this.jSPlugin.url).deviceSerial,channelNo:j(this.jSPlugin.url).channelNo},document.body.appendChild(n),document.body.appendChild(o)}return f(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"startTalk",value:function(e){var t=this;if(this.jSPlugin.capacity&&this.jSPlugin.capacity.support_talk&&(!this.jSPlugin.capacity||"3"!==this.jSPlugin.capacity.support_talk&&"1"!==this.jSPlugin.capacity.support_talk))return"function"===typeof this.jSPlugin.params.handleError&&(this.pluginStatus.loadingSetText({text:"设备不支持对讲",color:"red",delayClear:2e3}),this.jSPlugin.params.handleError({msg:"设备不支持对讲",retcode:-1e3,id:this.jSPlugin.params.id,type:"handleError"})),console.log("设备不支持对讲"),!1;var i=new FormData;i.append("accessToken",this.jSPlugin.accessToken),i.append("deviceSerial",j(this.jSPlugin.url).deviceSerial),i.append("channelNo",j(this.jSPlugin.url).channelNo),fetch(this.jSPlugin.env.domain+"/api/lapp/live/talk/url",{method:"POST",body:i}).then((function(e){return e.json()})).then((function(i){if(200==i.code){var n=i.data;if(n){var o=n.rtcUrl;-1===o.indexOf("ws")&&(o=o.replace("https","wss").replace("rtcgw","rtcgw-ws")),window.EZUIKit.opt.rtcUrl=o,window.EZUIKit.opt.ttsUrl="tts://"+n.ttsUrl,window.EZUIKit.opt.deviceSerial=j(t.jSPlugin.url).deviceSerial,window.EZUIKit.opt.channelNo=j(t.jSPlugin.url).channelNo;var a=window.EZUIKit.opt.ttsUrl.split("?");if(2===a.length||-1!==window.EZUIKit.opt.deviceSerial.indexOf(":")){var r="talk?dev="+window.EZUIKit.opt.deviceSerial+"&chann="+window.EZUIKit.opt.channelNo+"&encodetype=2";window.EZUIKit.opt.talkLink=window.EZUIKit.opt.ttsUrl.split("?")[0]+"/"+r,n.ttsUrl.indexOf("gb28181")>-1&&(window.EZUIKit.opt.talkType="gb28181")}else{r="talk://"+window.EZUIKit.opt.deviceSerial+":0:"+window.EZUIKit.opt.channelNo+":cas.ys7.com:6500";window.EZUIKit.opt.talkLink=window.EZUIKit.opt.ttsUrl.split("?")[0]+"/"+r}e&&e(n.ttsUrl.indexOf("gb28181")>-1),window.EZUIKit.opt.stream=n.stream,window.startTalk()}}else console.log(i.code,t.codeHandler.matchInfo(i.code,"talk")),t.pluginStatus.loadingSetText({text:t.codeHandler.matchInfo(i.code,"talk").msg||i.msg,color:"red",delayClear:2e3}),"function"===typeof t.jSPlugin.params.handleError&&t.jSPlugin.params.handleError({msg:i.msg,retcode:i.code,id:t.jSPlugin.params.id,type:"handleError"})}))["catch"]((function(e){console.log("err",e)}))}},{key:"stopTalk",value:function(){window.stopTalk(),document.getElementById("myaudio")&&document.getElementById("myaudio").srcObject&&document.getElementById("myaudio").srcObject.getTracks()[0].stop()}}]),e}(),be=function(){function e(t){var i=this;p(this,e),this.jSPlugin=t;var n=document.createElement("style");n.innerHTML="\n    body{\n      padding: 0;\n      margin: 0;\n    }\n    #mobile-ez-ptz-container {\n      display: inline-block;\n      width: 375px;\n      text-align: center;\n    }\n    .live-ptz-title{\n      height: 25px;\n      font-size: 18px;\n      color: #2c2c2c;\n      text-align: center;\n      font-weight: 700;\n      margin: 24px 0 12px;\n    }\n    .live-ptz-intro {\n      margin-bottom: 24px;\n      color: #aaaaaa;\n    }\n    .mobile-ez-ptz-wrap {\n      background-image: linear-gradient(180deg, #f6f8ff 0%, #ededed6b 50%)\n    }\n    #mobile-ez-ptz-container .mobile-ez-ptz-container {\n      position: relative;\n      width: 260px;\n      height: 260px;\n      background: rgba(255, 255, 255, 0.80);\n      border: 1px solid rgba(255, 255, 255, 0.80);\n      border-radius: 100%;\n      cursor: pointer;\n      overflow: hidden;\n      margin: auto;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.top {\n      width: 0;\n      height: 0;\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 6px);\n      top: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.top.active {\n      border-bottom-color: #1890FF;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.bottom {\n      width: 0;\n      height: 0;\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-top: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 6px);\n      bottom: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.bottom.active {\n      border-top-color: #1890FF;\n\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.right {\n      width: 0;\n      height: 0;\n      border-top: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-left: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 6px);\n      right: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.right.active {\n      border-left-color: #1890FF;\n\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.left {\n      width: 0;\n      height: 0;\n      border-top: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-right: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 6px);\n      left: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.left.active {\n      border-right-color: #1890FF;\n\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .ez-ptz-main.center {\n      width: 52px;\n      height: 52px;\n      background: #FFFFFF;\n      border: 2px solid #eee;\n      border-radius: 100%;\n      top: calc(50% - 26px);\n      left: calc(50% - 26px);\n      position: absolute;\n      /* box-shadow: 0px -39px 40px 6px #1890ff; */\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-wrap {\n      display: inline-block;\n      padding: 24px 24px;\n      border-radius: 100%;\n      overflow: hidden;\n    }\n\n    #mobile-ez-ptz-container .ez-ptz-close {\n      position: absolute;\n      color: #FFFFFF;\n      top: 0;\n      right: 0px;\n    }",document.getElementsByTagName("head")[0].appendChild(n);var o=document.createElement("div");o.className="mobile-ez-ptz-container",o.id="mobile-ez-ptz-container",o.style="display:inline-block;width: ".concat(this.jSPlugin.width,"px;text-align:center;");var a=document.createElement("div");a.className="live-ptz-title",a.id="live-ptz-title",a.innerHTML="云台控制",document.getElementById("live-ptz-title")||o.appendChild(a);var r=document.createElement("div");r.className="live-ptz-intro",r.id="live-ptz-intro",r.innerHTML="请通过操控云台来调整摄像机视角",document.getElementById("live-ptz-intro")||o.appendChild(r);var s=document.createElement("div");s.id="mobile-ez-ptz-item",s.className="mobile-ez-ptz-wrap",s.innerHTML='\n    <div class="mobile-ez-ptz-container" id="mobile-ez-ptz-container">\n      <div class="ez-ptz-main center"></div>\n      <div class="mobile-ez-ptz-icon top default"></div>\n      <div class="mobile-ez-ptz-icon left default"></div>\n      <div class="mobile-ez-ptz-icon bottom default"></div>\n      <div class="mobile-ez-ptz-icon right default"></div>\n    </div>\n      ',document.getElementById("mobile-ez-ptz-item")||o.appendChild(s),P(o,document.getElementById("".concat(this.jSPlugin.id,"-wrap"))),document.getElementById("mobile-ez-ptz-item").ontouchstart=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("mobile-ez-ptz-item").ontouchend=function(e){e.preventDefault(),console.log("触摸结束",e),i._handlePtzTouch(e,"stop")},document.getElementById("mobile-ez-ptz-item").onmousedown=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("mobile-ez-ptz-item").onmouseup=function(e){e.preventDefault(),console.log("触摸结束",e),i._handlePtzTouch(e,"stop")}}return f(e,[{key:"show",value:function(){document.getElementById("mobile-ez-ptz-item").style="display: inline-block"}},{key:"hide",value:function(){document.getElementById("mobile-ez-ptz-item").style="display: none"}},{key:"_handlePtzTouch",value:function(e,t){var i=document.getElementById("mobile-ez-ptz-item").getBoundingClientRect(),n=i.left+130,o=i.top+130,a=e.x||e.changedTouches[0].clientX,r=e.y||e.changedTouches[0].clientY,s=a-n,d=r-o,l=0,c=this.jSPlugin.env.domain+"/api/lapp/device/ptz/start";Math.abs(s)>Math.abs(d)?s>0?(l=3,document.getElementsByClassName("mobile-ez-ptz-icon")[3].className=document.getElementsByClassName("mobile-ez-ptz-icon")[3].className.replace("default","active")):(l=2,document.getElementsByClassName("mobile-ez-ptz-icon")[1].className=document.getElementsByClassName("mobile-ez-ptz-icon")[1].className.replace("default","active")):d>0?(l=1,document.getElementsByClassName("mobile-ez-ptz-icon")[2].className=document.getElementsByClassName("mobile-ez-ptz-icon")[2].className.replace("default","active")):(l=0,document.getElementsByClassName("mobile-ez-ptz-icon")[0].className=document.getElementsByClassName("mobile-ez-ptz-icon")[0].className.replace("default","active")),document.getElementById("mobile-ez-ptz-item").style="background-image:linear-gradient(".concat(0===l?180:1===l?0:2===l?90:270,"deg, #c0ddf1 0%, rgba(100,143,252,0.00) 50%)"),"stop"===t&&(c=this.jSPlugin.env.domain+"/api/lapp/device/ptz/stop",document.getElementById("mobile-ez-ptz-item").style="",document.getElementsByClassName("mobile-ez-ptz-icon")[3].className=document.getElementsByClassName("mobile-ez-ptz-icon")[3].className.replace("active","default"),document.getElementsByClassName("mobile-ez-ptz-icon")[1].className=document.getElementsByClassName("mobile-ez-ptz-icon")[1].className.replace("active","default"),document.getElementsByClassName("mobile-ez-ptz-icon")[2].className=document.getElementsByClassName("mobile-ez-ptz-icon")[2].className.replace("active","default"),document.getElementsByClassName("mobile-ez-ptz-icon")[0].className=document.getElementsByClassName("mobile-ez-ptz-icon")[0].className.replace("active","default"));var u=new FormData;u.append("deviceSerial",j(this.jSPlugin.url).deviceSerial),u.append("channelNo",j(this.jSPlugin.url).channelNo),u.append("speed",1),u.append("direction",l),u.append("accessToken",this.jSPlugin.accessToken),fetch(c,{method:"POST",body:u}).then((function(e){return e.json()})).then((function(e){200==e.code||60005!=e.code&&60002!=e.code&&60003!=e.code&&60004!=e.code||(document.getElementById("mobile-ez-ptz-item").style="background-image:linear-gradient(".concat(0===l?180:1===l?0:2===l?90:270,"deg, #f45656 0%, rgba(100,143,252,0.00) 50%)"))}))["catch"]((function(e){console.log("云台调用异常",e)}))}}]),e}(),Ce=0,Te="成功",we={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-0",iconId:"deviceID",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-1",iconId:"deviceName",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-2",iconId:"cloudRec",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-3",iconId:"rec",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"}]},footer:{color:"#FFFFFF",backgroundColor:"rgb(0 0 0 / 0%)",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-0",iconId:"play",part:"left",defaultActive:1,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-1",iconId:"capturePicture",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-2",iconId:"sound",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-3",iconId:"pantile",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-4",iconId:"recordvideo",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-5",iconId:"talk",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-6",iconId:"hd",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-7",iconId:"webExpend",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-8",iconId:"expend",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"}]}},ke={retcode:Ce,msg:Te,data:we},Ee={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:1},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:1},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}},Pe={data:Ee},Ie={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:1},{iconId:"rec",part:"right",defaultActive:0,isrender:1}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"speed",part:"right",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}},xe={data:Ie},Re={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-0",iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-1",iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-2",iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-3",iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:1},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:1},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"speed",part:"right",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:1},{iconId:"webExpend",part:"right",defaultActive:0,isrender:1},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}},Ae={data:Re},De={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-0",iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-1",iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-2",iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-3",iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:1},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:1},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}},Be={data:De},je={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:0},{iconId:"deviceName",part:"left",defaultActive:0,isrender:0},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:0},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:0},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:0}]}},Le={data:je},Me={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}},Ne={data:Me},Fe={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:1},{iconId:"rec",part:"right",defaultActive:0,isrender:1}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:1},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"speed",part:"right",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:1},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}},ze={data:Fe},Oe={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:0},{iconId:"deviceName",part:"left",defaultActive:0,isrender:0},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:0},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:0},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:0},{iconId:"speed",part:"right",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:0}]}},Ue={data:Oe},Ze=[{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"pcLive",themeIntro:"PC直播全量版",themeName:"PC直播全量版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:Ae.data.header,footer:Ae.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"security",themeIntro:"PC直播安防版",themeName:"PC直播安防版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:Be.data.header,footer:Be.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"voice",themeIntro:"PC直播语音版",themeName:"PC直播语音版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:Ne.data.header,footer:Ne.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"simple",themeIntro:"PC直播极简版",themeName:"PC直播极简版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"",header:Le.data.header,footer:Le.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"pcRec",themeIntro:"PC回放全量版",themeName:"PC回放全量版",themeType:"webRec",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:ze.data.header,footer:ze.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"mobileLive",themeIntro:"Mobile直播全量版",themeName:"Mobile直播全量版",themeType:"mobileLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_GmAL5IhAABZs1vUK0s564.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:Pe.data.header,footer:Pe.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"mobileRec",themeIntro:"Mobile回放全量版",themeName:"Mobile回放全量版",themeType:"mobileRec",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_GmAL5IhAABZs1vUK0s564.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:xe.data.header,footer:xe.data.footer},{autoFocus:0,createTime:"2021-06-14T08:04:37.000Z",themeId:"miniRec",themeIntro:"Mobile回放全量版",themeName:"Mobile回放全量版",themeType:"mobileRec",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_GmAL5IhAABZs1vUK0s564.png",poster:"",header:Ue.data.header,footer:Ue.data.footer}],Ve=function(){function e(t){var i=this;p(this,e),this.jSPlugin=t,this.enableZoom=!1,this.isMouseDown=!1,this.videoWidth=1920,this.videoHeight=1080,this.currentScale=1,this.currentPosition={x:0,y:0,xPercent:.1,yPercent:.1,xCurrentVideo:0,yCurrentVideo:0,left:0,top:0,right:1920,bottom:1080},this.DOM=document.getElementById(t.id),this.clientRect=document.getElementById(t.id).getBoundingClientRect();var n=document.createElement("div");n.id="".concat(t.id,"-zoom-container"),n.style="position: absolute;\n    display:none;\n    left: 12px;\n    bottom: 80px;";var o='\n    <div\n    style="display: inline-flex;flex-direction: column;width: 38px;height: 160px;background:rgba(0,0,0,0.60);border-radius: 8px;align-items: center;">\n    <div id="'.concat(this.jSPlugin.id,'-scale-value" style="font-size: 12px;color:#FFFFFF;margin-top:10px;margin-bottom:4px;">2.0X</div>\n    <div style="width: 24px;" id="').concat(this.jSPlugin.id,'-addScale">\n      <?xml version="1.0" encoding="utf-8"?>\n      <svg version="1.1" fill="#FFFFFF" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n         viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n      <title>放大</title>\n      <g id="矩形">\n        <rect class="st0" width="20" height="20" fill="none"/>\n      </g>\n      <g id="形状结合">\n        <path class="st1" d="M10,3.8c3.5,0,6.2,2.8,6.2,6.2s-2.8,6.2-6.2,6.2S3.8,13.5,3.8,10S6.5,3.8,10,3.8z M10,5c-2.8,0-5,2.2-5,5\n          s2.2,5,5,5s5-2.2,5-5S12.8,5,10,5z"/>\n      </g>\n      <g id="路径-4">\n        <path class="st2" d="M12.5,10.7h-5c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6h5c0.3,0,0.6,0.3,0.6,0.6S12.8,10.7,12.5,10.7z"/>\n      </g>\n      <g id="路径-4备份">\n        <path class="st2" d="M10,13.2c-0.3,0-0.6-0.3-0.6-0.6v-5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v5C10.6,12.9,10.3,13.2,10,13.2z"/>\n      </g>\n      </svg>\n    </div>\n    <div style="\n    position: relative;\n    width: 1px;\n    height: 64px;\n    border: 1px solid rgba(255,255,255,0.75);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: flex-end;">\n    <div class="scale-body-line-dot" id="').concat(this.jSPlugin.id,'-scale-body-line-dot" style="width: 8px;\n      height: 8px;\n      background: #FFFFFF;\n      border-radius: 100%;\n      position: absolute;\n      border: 1.5px solid rgba(64,122,255,1);"></div>\n      <div id="').concat(this.jSPlugin.id,'-line-dot" style="width: 1px;\n      height: 0%;\n      background: #1890FF;\n      bottom: 0;"></div>\n    </div>\n    <div style="width: 24px;margin-top: 6px;" id="').concat(this.jSPlugin.id,'-subScale">\n      <?xml version="1.0" encoding="utf-8"?>\n      <svg fill="#FFFFFF" version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n        viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n        <title>缩小</title>\n        <g id="矩形">\n          <rect class="st0" width="20" height="20" fill="none"/>\n        </g>\n        <g id="形状结合">\n          <path class="st1" d="M10,3.8c3.5,0,6.2,2.8,6.2,6.2s-2.8,6.2-6.2,6.2S3.8,13.5,3.8,10S6.5,3.8,10,3.8z M10,5c-2.8,0-5,2.2-5,5\n            s2.2,5,5,5s5-2.2,5-5S12.8,5,10,5z"/>\n        </g>\n        <g id="路径-4">\n          <path class="st2" d="M12.5,10.7h-5c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6h5c0.3,0,0.6,0.3,0.6,0.6S12.8,10.7,12.5,10.7z"/>\n        </g>\n      </svg>\n    </div>\n  </div>\n    ');n.innerHTML=o,document.getElementById("".concat(t.id,"-audioControls-left")).parentNode.appendChild(n),document.getElementById("".concat(t.id,"-addScale")).onclick=function(){i.addScale()},document.getElementById("".concat(t.id,"-subScale")).onclick=function(){i.subScale()}}return f(e,[{key:"onMouseDown",value:function(e){this.currentPosition,this.currentScale;var t=this.enableZoom;if(!t)return!1;this.moveX=e.clientX,this.moveY=e.clientY,this.isMouseDown=!0}},{key:"onMouseUp",value:function(e){var t=this.currentPosition,i=this.enableZoom;if(!i)return!1;this.isMouseDown=!1,t.left=t.left-(e.clientX-this.moveX),t.top=t.top-(e.clientY-this.moveY),this.doScale()}},{key:"onMouseOut",value:function(e){var t=this.enableZoom;if(!t)return!1;this.isMouseDown&&(console.log("鼠标按上",e),this.isMouseDown=!1),this.isMouseDown=!1}},{key:"renderDot",value:function(){var e=this.currentScale;document.getElementById("".concat(this.jSPlugin.id,"-scale-value"))&&(document.getElementById("".concat(this.jSPlugin.id,"-scale-value")).innerHTML="".concat(e,".0X")),document.getElementById("".concat(this.jSPlugin.id,"-line-dot"))&&(document.getElementById("".concat(this.jSPlugin.id,"-line-dot")).style.height="".concat((e-1)/7*100,"%")),document.getElementById("".concat(this.jSPlugin.id,"-scale-body-line-dot"))&&(document.getElementById("".concat(this.jSPlugin.id,"-scale-body-line-dot")).style.bottom="calc(".concat((e-1)/7*100,"% - 6px)"))}},{key:"startZoom",value:function(){var e=this,t=this.jSPlugin.jSPlugin._JSPlayM4_GetFrameInfo(0);this.videoWidth=t.width,this.videoHeight=t.height,this.currentPosition.right=t.width,this.currentPosition.bottom=t.height,this.currentScale=1,document.getElementById("".concat(this.jSPlugin.id,"-zoom-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="block");try{this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),this.jSPlugin.jSPlugin.bEZoom=!0}catch(i){console.log(i)}this.renderDot(),this.enableZoom=!0,document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0"))?(document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0")).addEventListener("mousedown",(function(t){return e.onMouseDown(t)})),document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0")).addEventListener("mouseup",(function(t){return e.onMouseUp(t)})),document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0")).addEventListener("mouseout",(function(t){return e.onMouseOut(t)}))):document.getElementById("".concat(this.jSPlugin.id,"-player"))&&(document.getElementById("".concat(this.jSPlugin.id,"-player")).addEventListener("mousedown",(function(t){return e.onMouseDown(t)})),document.getElementById("".concat(this.jSPlugin.id,"-player")).addEventListener("mouseup",(function(t){return e.onMouseUp(t)})),document.getElementById("".concat(this.jSPlugin.id,"-player")).addEventListener("mouseout",(function(t){return e.onMouseOut(t)})))}},{key:"stopZoom",value:function(){var e=this;this.currentScale=1;try{this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight)}catch(t){console.log(t)}document.getElementById("".concat(this.jSPlugin.id,"-zoom-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="none"),this.renderDot(),this.enableZoom=!1,document.getElementById(this.jSPlugin.id).removeEventListener("mousedown",(function(t){return e.onMouseDown(t)})),document.getElementById(this.jSPlugin.id).removeEventListener("mouseup",(function(t){return e.onMouseUp(t)})),document.getElementById(this.jSPlugin.id).removeEventListener("mouseout",(function(t){return e.onMouseOut(t)}))}},{key:"doScale",value:function(){console.log("执行放大");var e=this.currentPosition,t=this.currentScale;e.left=e.left+e.xPercent*(e.right-e.left)-this.videoWidth/t*.5,e.left<0?e.left=0:e.left>this.videoWidth-this.videoWidth/t&&(e.left=this.videoWidth-this.videoWidth/t),e.right=e.left+this.videoWidth/t,e.top=e.top+e.yPercent*(e.bottom-e.top)-this.videoHeight/t*.5,e.top<0?e.top=0:e.top>this.videoHeight-this.videoHeight/t&&(e.top=this.videoHeight-this.videoHeight/t),e.bottom=e.top+this.videoHeight/t,e.left=parseInt(e.left,10),e.right=parseInt(e.right,10),e.top=parseInt(e.top,10),e.bottom=parseInt(e.bottom,10),console.log("计算后，",this.jSPlugin.jSPlugin,e.left,e.right,e.top,e.bottom,e.xPercent,e.yPercent);try{this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(e.left,e.right,e.top,e.bottom)}catch(i){console.log(i)}this.renderDot()}},{key:"calCurrentPosition",value:function(e){var t=this.currentPosition,i=this.clientRect;t.x=e.clientX,t.y=e.clientY,t.xPercent=(e.clientX-i.x)/i.width,t.yPercent=(e.clientY-i.y)/i.height,this.doScale()}},{key:"addScale",value:function(){var e=this.currentScale,t=this.currentPosition;if(e>=8)return console.log("达到最大倍率了"),this.jSPlugin.Message&&this.jSPlugin.Message["default"]("已经放大到最大倍数8.0X"),!1;this.currentScale++,t.xPercent=.5,t.yPercent=.5,this.doScale()}},{key:"subScale",value:function(){var e=this.currentScale,t=this.currentPosition;if(e<=1)return console.log("达到最小倍率了"),!1;this.currentScale--,t.xPercent=.5,t.yPercent=.5,this.doScale()}}]),e}();function He(e,t){return Math.abs(t.clientX-e.clientX)*Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)*Math.abs(t.clientY-e.clientY)}var Ge=function(){function e(t){var i=this;p(this,e),this.jSPlugin=t,this.enableZoom=!1,this.videoWidth=0,this.videoHeight=0,this.currentScale=1,this.currentPosition={x:0,y:0,xPercent:.1,yPercent:.1,xCurrentVideo:0,yCurrentVideo:0,left:0,top:0,right:1920,bottom:1080},this.DOM=document.getElementById(t.id),this.clientRect=document.getElementById(t.id).getBoundingClientRect(),this.point1={clientX:0,clientY:0},this.point2={clientX:0,clientY:0},this.touchLineLength=0,this.inited=!1,this.hasScale=!1;var n=document.createElement("div");n.id="".concat(t.id,"-zoom-container"),n.style="display:none;\n    position: absolute;\n    left: 10px;\n    top: -30px;\n    border: 1px solid rgba(0,0,0,0.6);\n    color: #FFFFFF;\n    background: rgba(0,0,0,0.6);\n    border-radius: 10px;\n    width: 36px;\n    font-size: 12px;\n    text-align: center;\n    height: 22px;\n    line-height: 22px;";var o="1X";n.innerHTML=o,document.getElementById("".concat(t.id,"-audioControls-left")).parentNode.appendChild(n),t.use3DZoom||(document.getElementById(this.jSPlugin.id).addEventListener("touchstart",(function(e){return i.onTouchstart(e)})),document.getElementById(this.jSPlugin.id).addEventListener("touchmove",(function(e){return i.onTouchmove(e)})),document.getElementById(this.jSPlugin.id).addEventListener("touchend",(function(e){return i.onTouchend(e)})))}return f(e,[{key:"onTouchstart",value:function(e){if(!this.jSPlugin.use3DZoom){console.log("手势触摸：",e);var t=this.jSPlugin.beforeMobileZoomVerify();if(!t)return!1;if(!this.inited){var i=this.jSPlugin.jSPlugin._JSPlayM4_GetFrameInfo(0);this.videoWidth=i.width,this.videoHeight=i.height,this.currentPosition.right=i.width,this.currentPosition.bottom=i.height,this.inited=!0}var n=e.touches,o=n[0],a=n[1];o&&(this.point1.clientX=o.clientX,this.point1.clientY=o.clientY),a&&(this.point2.clientX=a.clientX,this.point2.clientY=a.clientY,this.touchLineLength=He(this.point1,this.point2),this.moveX=o.clientX,this.moveY=o.clientY)}}},{key:"onTouchmove",value:function(e){if(e&&e.touches.length>1&&e.preventDefault(),!this.jSPlugin.use3DZoom){var t=this.currentPosition,i=this.clientRect,n=this.jSPlugin.beforeMobileZoomVerify();if(!n)return!1;if(1===e.touches.length){var o=e.touches[0];t.xPercent=t.xPercent+(this.point1.clientX-o.clientX)/i.width/this.currentScale,t.yPercent=t.yPercent+(this.point1.clientY-o.clientY)/i.height/this.currentScale,this.doScale(),this.point1.clientX=o.clientX,this.point1.clientY=o.clientY}else{var a=e.touches,r=(o=a[0],a[1]);if(this.point1.clientX=o.clientX,this.point1.clientY=o.clientY,r){this.point2.clientX=r.clientX,this.point2.clientY=r.clientY;var s=He(this.point1,this.point2);s===this.touchLineLength||this.hasScale||(s>this.touchLineLength?this.currentScale<8?(this.currentScale=this.currentScale+1,t.xPercent=.5,t.yPercent=.5,this.doScale()):console.log("已经是最大8倍率了"):this.currentScale>1?(this.currentScale=this.currentScale-1,t.xPercent=.5,t.yPercent=.5,this.doScale()):console.log("已经是最小1倍率了"),this.hasScale=!0)}}}}},{key:"onTouchend",value:function(e){this.hasScale=!1}},{key:"renderDot",value:function(){var e=this.currentScale;document.getElementById("".concat(this.jSPlugin.id,"-scale-value"))&&(document.getElementById("".concat(this.jSPlugin.id,"-scale-value")).innerHTML="".concat(e,".0X")),document.getElementById("".concat(this.jSPlugin.id,"-line-dot"))&&(document.getElementById("".concat(this.jSPlugin.id,"-line-dot")).style.height="".concat((e-1)/7*100,"%")),document.getElementById("".concat(this.jSPlugin.id,"-scale-body-line-dot"))&&(document.getElementById("".concat(this.jSPlugin.id,"-scale-body-line-dot")).style.bottom="calc(".concat((e-1)/7*100,"% - 6px)"))}},{key:"startZoom",value:function(){var e=this.jSPlugin.jSPlugin._JSPlayM4_GetFrameInfo(0);this.videoWidth=e.width,this.videoHeight=e.height,this.currentPosition.right=e.width,this.currentPosition.bottom=e.height,this.currentScale=1,document.getElementById("".concat(this.jSPlugin.id,"-zoom-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="block"),this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),this.renderDot()}},{key:"stopZoom",value:function(){this.currentScale=1,this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="none"),this.renderDot()}},{key:"resetZoom",value:function(){this.currentScale=1,document.getElementById("".concat(this.jSPlugin.id,"-zoom-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="none")}},{key:"doScale",value:function(){var e=this.currentPosition,t=this.currentScale;e.left=e.left+e.xPercent*(e.right-e.left)-this.videoWidth/t*.5,e.left<0?e.left=0:e.left>this.videoWidth-this.videoWidth/t&&(e.left=this.videoWidth-this.videoWidth/t),e.right=e.left+this.videoWidth/t,e.top=e.top+e.yPercent*(e.bottom-e.top)-this.videoHeight/t*.5,e.top<0?e.top=0:e.top>this.videoHeight-this.videoHeight/t&&(e.top=this.videoHeight-this.videoHeight/t),e.bottom=e.top+this.videoHeight/t,e.left=parseInt(e.left,10),e.right=parseInt(e.right,10),e.top=parseInt(e.top,10),e.bottom=parseInt(e.bottom,10),console.log("视频宽高",this.videoWidth,this.videoHeight),console.log("计算后，",e.left,e.right,e.top,e.bottom,e.xPercent,e.yPercent),e.left<e.right&&e.top<e.bottom&&e.bottom<=this.videoHeight&&e.right<=this.videoWidth&&this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(e.left,e.right,e.top,e.bottom,1!=t),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).innerHTML="".concat(t,".0X"),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display=1===t?"none":"inline-block"}},{key:"addScale",value:function(){var e=this.currentScale,t=this.currentPosition;if(e>=8)return console.log("达到最大倍率了"),this.jSPlugin.Message&&this.jSPlugin.Message["default"]("已经放大到最大倍数8.0X"),!1;this.currentScale++,t.xPercent=.5,t.yPercent=.5,this.doScale()}},{key:"subScale",value:function(){var e=this.currentScale,t=this.currentPosition;if(e<=1)return console.log("达到最小倍率了"),!1;this.currentScale--,t.xPercent=.5,t.yPercent=.5,this.doScale()}}]),e}(),We=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},r={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},s="";r=Object.assign(r,a);var d=new Headers;Object.keys(r).map((function(e){d.append(e,r[e])})),r=d,Object.keys(Object.assign({},i)).forEach((function(e){var t=i[e];"string"===typeof i[e]&&(t=i[e].replace("%","%25")),"undefined"!==typeof i[e]&&(s+="&".concat(e,"=").concat(encodeURIComponent(t)))})),s.length>0&&(s=-1!==["GET","PUT","DELETE"].indexOf(t.toUpperCase())?"?".concat(s.slice(1)):s.slice(1));var l=e+(-1!==["GET","PUT","DELETE"].indexOf(t.toUpperCase())?s:""),c={headers:r,method:t};"POST"===t&&(c.body=s),"POST"===t&&a&&"application/json"===a["Content-Type"]&&(c.body=JSON.stringify(i)),"GET"===t&&(-1===l.indexOf("?")?l+="?_r=".concat(Math.random()):l+="&_r=".concat(Math.random())),c.credentials="include",fetch(l,c).then((function(e){return e.json()})).then((function(e){n(e)}))["catch"]((function(e){o&&o(e)}))},qe=function(e,t,i,n,o){return'\n<svg  id="'.concat(e,'-hdSelect-icon" class="theme-icon-item-icon ').concat(t,"-btn\" data-type='hd'  fill=\"").concat(i,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(n>o?48:32,'" height="').concat(n>o?48:32,'" viewBox="-6 -6 32 32">\n    <path d="M17.4,16.5H3.1c-0.8,0-1.4-0.6-1.4-1.4V5.4c0-0.9,0.7-1.6,1.6-1.6h14.1c0.8,0,1.4,0.6,1.4,1.4v9.8 C18.8,15.9,18.2,16.5,17.4,16.5z M3.3,5C3.1,5,2.9,5.2,2.9,5.4v9.7c0,0.2,0.1,0.3,0.3,0.3h14.3c0.2,0,0.3-0.1,0.3-0.3V5.3 c0-0.2-0.1-0.3-0.3-0.3H3.3z" />\n    <path d="M13.3,13.6h-1.6c-0.4,0-0.7-0.3-0.7-0.7V7.4c0-0.4,0.3-0.7,0.7-0.7h1.6c1.2,0,2.2,1,2.2,2.2v2.4 C15.6,12.6,14.6,13.6,13.3,13.6z M12.2,12.5h1.1c0.6,0,1.1-0.5,1.1-1.1V9c0-0.6-0.5-1.1-1.1-1.1h-1.1V12.5z" />\n    <path d="M5.5,13.6c-0.3,0-0.6-0.2-0.6-0.6V7.3C5,7,5.2,6.8,5.5,6.8S6.1,7,6.1,7.3v5.7C6.1,13.4,5.8,13.6,5.5,13.6z" />\n    <path d="M9.2,13.6c-0.3,0-0.6-0.2-0.6-0.6V7.3c0-0.3,0.2-0.6,0.6-0.6S9.8,7,9.8,7.3v5.7C9.8,13.4,9.5,13.6,9.2,13.6z" />\n    <rect x="5.6" y="9.6" width="3.6" height="1.1" />\n</svg>\n')},Ke=function(e,t,i,n,o){return'\n<svg id="'.concat(e,'-sdSelect-icon" class="theme-icon-item-icon ').concat(t,"-btn\" data-type='sd' fill=\"").concat(i,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(n>o?48:32,'" height="').concat(n>o?48:32,'" viewBox="-6 -8 40 44">\n    <path d="M24.1,23.8h-20c-1.1,0-1.9-0.9-1.9-1.9V8.4c0-1.2,1-2.2,2.1-2.2h19.7c1.1,0,1.9,0.9,1.9,1.9v13.8\n        C26,23,25.1,23.8,24.1,23.8z M4.3,7.7C4,7.7,3.7,8,3.7,8.4v13.5c0,0.2,0.2,0.4,0.4,0.4h20c0.2,0,0.4-0.2,0.4-0.4V8.2\n        c0-0.2-0.2-0.4-0.4-0.4H4.3z"/>\n    <path d="M18.4,19.8h-2.2c-0.5,0-0.9-0.4-0.9-0.9v-7.8c0-0.5,0.4-0.9,0.9-0.9h2.2c1.7,0,3.1,1.4,3.1,3.1v3.3\n    C21.5,18.4,20.1,19.8,18.4,19.8z M16.7,18.3h1.6c0.9,0,1.6-0.7,1.6-1.6v-3.3c0-0.9-0.7-1.6-1.6-1.6h-1.6V18.3z"/>\n    <path d="M10.5,19.8c1.2,0,2.1-0.3,2.7-0.9c0.6-0.6,0.9-1.3,0.9-2.1c0-0.8-0.3-1.4-0.9-1.8c-0.4-0.2-1.1-0.5-2.2-0.8\n        l0,0l-1-0.2c-0.4-0.1-0.8-0.2-1-0.4c-0.4-0.2-0.6-0.5-0.6-0.9c0-0.4,0.1-0.6,0.4-0.9s0.7-0.3,1.3-0.3c0.8,0,1.4,0.2,1.8,0.6\n        c0.2,0.3,0.3,0.6,0.4,0.9l0,0h1.4c0-0.6-0.2-1.1-0.5-1.6c-0.6-0.8-1.6-1.2-2.9-1.2c-1,0-1.8,0.3-2.4,0.8c-0.6,0.5-0.9,1.2-0.9,2\n        c0,0.7,0.3,1.3,1,1.7c0.4,0.2,0.9,0.4,1.7,0.6l0,0l1.2,0.3c0.6,0.2,1.1,0.3,1.3,0.4c0.3,0.2,0.5,0.5,0.5,0.9c0,0.5-0.2,0.9-0.6,1.1\n        s-0.9,0.4-1.5,0.4c-0.9,0-1.6-0.2-2-0.7c-0.2-0.3-0.3-0.6-0.4-1.1l0,0H6.8c0,0.9,0.3,1.6,0.9,2.2C8.2,19.5,9.2,19.8,10.5,19.8z"/>\n    <defs>\n    <filter id="Adobe_OpacityMaskFilter" filterUnits="userSpaceOnUse" x="15.2" y="10.3" width="6.2" height="9.5">\n        <feColorMatrix  type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"/>\n    </filter>\n    </defs>\n    <mask maskUnits="userSpaceOnUse" x="15.2" y="10.3" width="6.2" height="9.5" id="mask-2_2_">\n    <g class="st2">\n        <path id="path-1_2_" class="st3" d="M24.1,23.1h-20c-0.6,0-1.2-0.5-1.2-1.2V8.2C2.9,7.5,3.5,7,4.1,7h19.7c0.8,0,1.4,0.6,1.4,1.4\n        v13.5C25.2,22.6,24.7,23.1,24.1,23.1z"/>\n    </g>\n    </mask>\n    <defs>\n    <filter id="Adobe_OpacityMaskFilter_1_" filterUnits="userSpaceOnUse" x="6.8" y="10.3" width="7.3" height="9.5">\n        <feColorMatrix  type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"/>\n    </filter>\n    </defs>\n    <mask maskUnits="userSpaceOnUse" x="6.8" y="10.3" width="7.3" height="9.5" id="mask-2_3_">\n    <g class="st5">\n        <path id="path-1_3_" class="st3" d="M24.1,23.1h-20c-0.6,0-1.2-0.5-1.2-1.2V8.2C2.9,7.5,3.5,7,4.1,7h19.7c0.8,0,1.4,0.6,1.4,1.4\n        v13.5C25.2,22.6,24.7,23.1,24.1,23.1z"/>\n    </g>\n    </mask>\n</svg>\n')},Je=[{name:"高清",level:"0",streamType:1,icon:qe},{name:"标清",level:"1",streamType:1,icon:Ke}],$e=[{name:"高清",level:"hd",streamType:1,icon:qe},{name:"标清",level:"sd",streamType:2,icon:Ke}],Xe=function(e,t,i,n){var o=function(e){console.log(e),e.meta&&i(e)},a=function(e){console.log(e),n(e)},r="".concat(e.env.domain,"/api/service/media/template/getDetail?accessToken=").concat(e.accessToken,"&id=").concat(t);fetch(r,{method:"GET"}).then((function(e){return e.json()})).then((function(e){console.log("get theme data",e),o(e)}))["catch"]((function(e){a(e)}))},Ye=function(e,t,i,n,o){return new Promise((function(a,r){M("".concat(e,"/api/lapp/device/ptz/mirror"),"POST",{accessToken:t,deviceSerial:i,channelNo:n,command:o},"",a)}))},Qe=function(e,t,i,n){var o="".concat(e,"/api/service/device/capacity/video/quality?accessToken=").concat(t,"&deviceSerial=").concat(i,"&channelNo=").concat(n);return fetch(o,{method:"GET"}).then((function(e){return e.json()})).then((function(e){if(e.meta&&200===e.meta.code&&e.data&&e.data.length>0){var t=e.data.find((function(e){return 2===e.streamTypeIn}));if(t)return $e}return Je}))["catch"]((function(){return Je}))},et=function(e){var t="";return Object.keys(e).map((function(i,n){t+="".concat(i,":").concat(e[i]).concat(n<Object.keys(e).length-1?";":"")})),t},tt=500,it=function(){function e(t){var i=this;if(p(this,e),this.jSPlugin=t,this.isNeedRenderHeader=!1,this.isNeedRenderFooter=!1,this.autoFocus=0,this.autoFocusTimer=null,this.recordTimer=null,this.nextRate=1,this.showHD=!1,this.themeInited=!1,this.decoderState={state:{isEditing:!1,play:!1,sound:!1,recordvideo:!1,recordCount:"00:00",talk:!1,zoom:!1,pantile:!1,hd:{},hdList:[],speed:!1,expend:!1,webExpend:!1,cloudRec:"cloud.rec"===j(t.url).type,rec:"rec"===j(t.url).type,type:j(t.url).type}},this.allowZoom=!this.jSPlugin.use3DZoom,this.zoomDisable=!1,this.pluginStatus=new V(this,this.jSPlugin.params.id),this.inited=!1,this.isMobile=N(),"undefined"!==typeof t.isMobile&&(this.isMobile=t.isMobile),this.pauseTime=null,this.themeData=ke.data,this.deviceQ,this.jSPlugin.themeId)switch(this.jSPlugin.themeId){case"pcLive":case"pcRec":case"mobileLive":case"mobileRec":case"security":case"voice":case"simple":case"miniRec":var n=Z.find(Ze,(function(e){return e.themeId===i.jSPlugin.themeId}));n&&(this.themeData=n),this.initThemeData();break;case"themeData":this.themeData=this.jSPlugin.params.themeData,this.initThemeData();break;default:this.fetchThemeData(this.jSPlugin.themeId);break}this.jSPlugin.Talk||(this.jSPlugin.Talk=new _e(this.jSPlugin)),w("".concat(this.jSPlugin.staticPath,"/speed/speed.css")),w("".concat(this.jSPlugin.staticPath,"/css/theme.css"))}return f(e,[{key:"fetchThemeData",value:function(e){var t=this,i=function(e){0==e.meta.code&&e.data?(t.themeData=e.data,e.data.header&&(t.themeData.header=e.data.header,t.themeData.header.btnList=t.themeData.header.btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),e.data.footer&&(t.themeData.footer=e.data.footer,t.themeData.footer.btnList=t.themeData.footer.btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),t.initThemeData()):t.renderThemeData()},n=function(){t.renderThemeData()};Xe(this.jSPlugin,e,i,n)}},{key:"changeTheme",value:function(e){var t=this;if("string"===typeof e)switch(this.jSPlugin.themeId=e,this.jSPlugin.themeId){case"pcLive":case"pcRec":case"mobileLive":case"mobileRec":case"security":case"voice":case"simple":case"miniRec":var i=Z.find(Ze,(function(e){return e.themeId===t.jSPlugin.themeId}));i&&(this.themeData=i),this.initThemeData();break;default:this.fetchThemeData(e);break}else"object"===c(e)&&(this.themeData=e,this.initThemeData(),this.decoderState.state.isEditing&&this.editStart());this.jSPlugin&&this.jSPlugin.handleThemeChange&&this.jSPlugin.handleThemeChange(e)}},{key:"renderThemeData",value:function(){var e=this,t=this.themeData,i=t.header,n=t.footer;if(this.isNeedRenderHeader&&i&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.background=i.backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=i.color.replace("-diy",""),i.btnList.map((function(t,i){t.isrender&&e.setDecoderState(g({},t.iconId,e.decoderState.state[t.iconId]))}))),this.isNeedRenderFooter&&n)document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=n.backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=n.color.replace("-diy",""),n.btnList.map((function(t,i){if(t.isrender&&e.setDecoderState(g({},t.iconId,e.decoderState.state[t.iconId])),"play"===t.iconId&&t.defaultActive&&!e.themeInited)var n=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(n),e.jSPlugin.play(),e.themeInited=!0)}),50)})),this.themeData.autoFocus>0&&(this.autoFocus=parseInt(this.themeData.autoFocus),this.startAutoFocus(),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).addEventListener("click",(function(){e.stopAutoFocus()}))),this.setDecoderState({cloudRec:"cloud.rec"===j(this.jSPlugin.url).type,rec:"rec"===j(this.jSPlugin.url).type,type:j(this.jSPlugin.url).type});else if(!this.themeInited)var o=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(o),e.jSPlugin.play(),e.themeInited=!0)}),50);var a=Z.findIndex(this.themeData.footer.btnList,(function(e){return"zoom"===e.iconId&&e.isrender>0}))>=0;a&&(this.isMobile&&!this.jSPlugin.use3DZoom?(this.jSPlugin.beforeMobileZoomVerify=function(){var t=e.decoderState.state.play;return console.log("手机端电子放大前校验回调play------------",t),!!t},this.jSPlugin.Zoom=new Ge(this.jSPlugin)):this.jSPlugin.Zoom=new Ve(this.jSPlugin));var r=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(r),e.jSPlugin.reSize(e.jSPlugin.params.width,e.jSPlugin.params.height))}),50)}},{key:"setDecoderState",value:function(e){var t=this,i=this.themeData,n=i.header,o=i.footer;Object.keys(e).map((function(i,a){var r="#FFFFFF",s="#FFFFFF",d=n.btnList.findIndex((function(e){return e.iconId===i}));switch(-1===d?(r=o.color.replace("-diy",""),s=o.activeColor.replace("-diy","")):(r=n.color.replace("-diy",""),s=o.activeColor.replace("-diy","")),i){case"play":e[i]?document.getElementById("".concat(t.jSPlugin.id,"-play"))&&(document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[1].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-play")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).childNodes[0].children[0].style.fill=e[i]?s:r):document.getElementById("".concat(t.jSPlugin.id,"-play"))&&(document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[0].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-play")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).childNodes[0].children[1].style.fill=e[i]?s:r);break;case"sound":document.getElementById("".concat(t.jSPlugin.id,"-sound"))&&(e[i]?(document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[0].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-sound")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).childNodes[0].children[1].style.fill=e[i]?s:r):(document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[1].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-sound")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).childNodes[0].children[0].style.fill=e[i]?s:r));break;case"recordvideo":document.getElementById("".concat(t.jSPlugin.id,"-recordvideo"))&&(document.getElementById("".concat(t.jSPlugin.id,"-recordvideo")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-recordvideo-content")).childNodes[0].style.fill=e[i]?s:r,e[i]?t.countTime("add",0):t.countTime("destroy",0));break;case"talk":document.getElementById("".concat(t.jSPlugin.id,"-talk"))&&(document.getElementById("".concat(t.jSPlugin.id,"-talk")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-talk-content")).childNodes[1].style.fill=e[i]?s:r);break;case"zoom":document.getElementById("".concat(t.jSPlugin.id,"-zoom"))&&(document.getElementById("".concat(t.jSPlugin.id,"-zoom")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-zoom-content")).childNodes[1].style.fill=e[i]?s:r);break;case"pantile":document.getElementById("".concat(t.jSPlugin.id,"-pantile"))&&(document.getElementById("".concat(t.jSPlugin.id,"-pantile")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-pantile-content")).childNodes[0].style.fill=e[i]?s:r);break;case"webExpend":e[i]?(document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[0].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend")).className="disabled")):(document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[1].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend")).className="")),document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).childNodes[0].childNodes[0].style.fill=e[i]?s:r,document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).childNodes[0].childNodes[1].style.fill=e[i]?s:r);break;case"capturePicture":document.getElementById("".concat(t.jSPlugin.id,"-capturePicture"))&&(document.getElementById("".concat(t.jSPlugin.id,"-capturePicture")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-capturePicture-content")).childNodes[0].style.fill=e[i]?s:r);break;case"expend":e[i]?(document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[0].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend")).className="disabled")):(document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[1].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend")).className="")),document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).childNodes[0].childNodes[0].style.fill=e[i]?s:r,document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).childNodes[0].childNodes[1].style.fill=e[i]?s:r);break;case"hd":break;case"speed":document.getElementById("".concat(t.jSPlugin.id,"-speed"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speed-content")).children[1].children[0].style.color=e[i]?s:r,document.getElementById("".concat(t.jSPlugin.id,"-speed-content")).children[1].children[0].style.borderColor=e[i]?s:r),document.getElementById("".concat(t.jSPlugin.id,"-select-mask"))&&(t.isMobile&&e[i]?document.getElementById("".concat(t.jSPlugin.id,"-select-mask")).style.display="block":document.getElementById("".concat(t.jSPlugin.id,"-select-mask")).style.display="none");break;case"cloudRec":document.getElementById("".concat(t.jSPlugin.id,"-cloudRec"))&&(console.log("document.getElementById(`${this.jSPlugin.id}-cloudRec-content`)",document.getElementById("".concat(t.jSPlugin.id,"-cloudRec"))),document.getElementById("".concat(t.jSPlugin.id,"-cloudRec")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-cloudRec-content")).children[0].children[0].style.fill=e[i]?s:r),document.getElementById("".concat(t.jSPlugin.id,"-rec"))&&(document.getElementById("".concat(t.jSPlugin.id,"-rec")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-rec-content")).children[0].children[0].style.fill=e[i]?r:s);break;case"rec":document.getElementById("".concat(t.jSPlugin.id,"-cloudRec"))&&(document.getElementById("".concat(t.jSPlugin.id,"-cloudRec")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-cloudRec-content")).children[0].children[0].style.fill=e[i]?r:s),document.getElementById("".concat(t.jSPlugin.id,"-rec"))&&(document.getElementById("".concat(t.jSPlugin.id,"-rec")).className=e[i]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-rec-content")).children[0].children[0].style.fill=e[i]?s:r);break}t.decoderState.state=Object.assign(t.decoderState.state,e)}))}},{key:"startAutoFocus",value:function(){var e=this,t=this.autoFocus;this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.autoFocusTimer=setTimeout((function(){document.getElementById("".concat(e.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.opacity=0,document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.pointerEvents="none")}),1e3*t)}},{key:"stopAutoFocus",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.opacity=1,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.pointerEvents="all"),this.autoFocusTimer&&clearTimeout(this.autoFocusTimer)}},{key:"hideFooter",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.display="none")}},{key:"showFooter",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.display="block")}},{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"renderFooter",value:function(e,t){var i=this;return this.matchBtn(e).then((function(e){if(i.isMobile&&"zoom"===e.id)return!1;var n=document.createElement("div");n.className="theme-icon-item",n.innerHTML="".concat('<span id="'.concat(i.jSPlugin.id,"-").concat(e.id,'" style="position:relative;">')+'<div id="'.concat(i.jSPlugin.id,"-").concat(e.id,'-content" title="').concat(e.title,'" style="height:').concat(i.jSPlugin.width>tt?48:32,'px;display: flex;align-items: center;position:relative;">')).concat(e.domString,"</div>")+"</span>",n.onclick=function(t){if(i.decoderState.state.isEditing)return!1;e.onclick(t)},e.onmouseenter&&(n.onmouseenter=function(t){if(i.decoderState.state.isEditing)return!1;e.onmouseenter(t)}),e.onmouseleave&&(n.onmouseleave=function(t){if(i.decoderState.state.isEditing)return!1;e.onmouseleave(t)});var o=document.createElement("span");o.className="icon-move left",o.innerHTML='<span id="'.concat(i.jSPlugin.id,"-").concat(e.id,'-left" title="左移" style="position: absolute;top: calc(50% - 10px);left: -4px;"><svg fill="#ffffff" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="24" viewBox="0 0 10 15" style="background:#00000080;"><path d="M7.4,10V5.3c0-0.3-0.3-0.6-0.6-0.6c-0.1,0-0.3,0.1-0.4,0.2L3.7,7.4c-0.2,0.2-0.3,0.6,0,0.8 c0,0,0,0,0.1,0.1l2.7,2.2c0.2,0.2,0.6,0.2,0.8-0.1C7.3,10.3,7.4,10.2,7.4,10z"></path></svg></span>'),o.onclick=function(){i.editIcon(e.id,"left","footer")},n.appendChild(o);var a=document.createElement("span");a.className="icon-move right",a.innerHTML='<span id="'.concat(i.jSPlugin.id,"-").concat(e.id,'-right" class="ezuikit-theme-icon" title="右移" style="position: absolute;top: calc(50% - 10px);left: calc(100% - 8px);"><svg fill="#ffffff" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="24" viewBox="0 0 10 15" style="background:#00000080"><path d="M3.4,5.2v4.7c0,0.3,0.3,0.6,0.6,0.6c0.1,0,0.3-0.1,0.4-0.2l2.7-2.5c0.2-0.2,0.3-0.6,0-0.8 c0,0,0,0-0.1-0.1L4.4,4.8C4.1,4.6,3.8,4.6,3.6,4.9C3.5,5,3.4,5.1,3.4,5.2z"></path></svg></span>'),a.onclick=function(){i.editIcon(e.id,"right","footer")},n.appendChild(a);var r=document.createElement("span");r.className="icon-move close",r.innerHTML='<span id="'.concat(e.id,'-remove" class="ezuikit-theme-icon" title="移除" style="position: absolute;top: -10px;right: -10px;">')+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 15 15"><circle style="fill-rule:evenodd;clip-rule:evenodd;fill-opacity:0.8011;" cx="7.5" cy="7.6" r="7" /><rect x="3.9" y="3.5" class="st1" style="fill:none;" width="8.1" height="8.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="5" x2="10" y2="10.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="10.1" x2="10" y2="5" /></svg></span>',r.onclick=function(){i.editIcon(e.id,"delete","footer")},n.appendChild(r),"left"===t?document.getElementById("".concat(i.jSPlugin.id,"-audioControls")).childNodes[0].appendChild(n):document.getElementById("".concat(i.jSPlugin.id,"-audioControls")).childNodes[1].appendChild(n)}))}},{key:"editIcon",value:function(e,t,i){console.log("编辑组件",e,t,i);var n=this.themeData;console.log("themeData",this.themeData);var o=this.themeData[i].btnList,a=Z.findIndex(o,(function(t){return t.iconId===e})),r=o[a];switch(t){case"delete":if("rec"===e){if(-1===Z.findIndex(o,(function(e){return"cloudRec"===e.iconId&&1==e.isrender})))return this.jSPlugin.Message&&this.jSPlugin.Message["default"]("必须选中一种存储介质"),!1}else if("cloudRec"===e&&-1===Z.findIndex(o,(function(e){return"rec"===e.iconId&&1==e.isrender})))return this.jSPlugin.Message&&this.jSPlugin.Message["default"]("必须选中一种存储介质"),!1;o[a].isrender=0;break;case"right":for(var s=-1,d=a+1;d<o.length;d++)if(o[d].part===o[a].part&&1==o[d].isrender){s=d;break}-1!==s&&(o[a]=o[s],o[s]=r);break;case"left":for(var l=-1,c=a-1;c>=0;c--)if(o[c].part===o[a].part&&1==o[c].isrender){l=c;break}-1!==l&&(o[a]=o[l],o[l]=r);break}console.log("new btnList",o),n[i].btnList=o,this.changeTheme(n)}},{key:"renderHeader",value:function(e,t){var i=this;return this.matchBtn(e).then((function(e){var n=document.createElement("div");n.className="theme-icon-item",n.style="max-width:50%;",n.innerHTML="".concat('<span id="'.concat(i.jSPlugin.id,"-").concat(e.id,'" style="position:relative;";>')+'<span id="'.concat(i.jSPlugin.id,"-").concat(e.id,'-content" title="').concat(e.title,'" style="display:inline-block;height:').concat(i.width>tt?48:32,'px;">')).concat(e.domString,"</span>")+'<span id="'.concat(i.jSPlugin.id,"-").concat(e.id,'-remove" title="移除" style="position: absolute;top: -6px;left: 38px;display: none;">')+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 15 15"><circle style="fill-rule:evenodd;clip-rule:evenodd;fill-opacity:0.8011;" cx="7.5" cy="7.6" r="7" /><rect x="3.9" y="3.5" class="st1" style="fill:none;" width="8.1" height="8.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="5" x2="10" y2="10.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="10.1" x2="10" y2="5" /></svg></span></span>',n.onclick=function(t){if(i.decoderState.state.isEditing)return!1;e.onclick(t)};var o=document.createElement("span");o.className="icon-move close",o.innerHTML='<span id="'.concat(e.id,'-remove" class="ezuikit-theme-icon" title="移除" style="position: absolute;top: -6px;right: -6px;">')+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 15 15"><circle style="fill-rule:evenodd;clip-rule:evenodd;fill-opacity:0.8011;" cx="7.5" cy="7.6" r="7" /><rect x="3.9" y="3.5" class="st1" style="fill:none;" width="8.1" height="8.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="5" x2="10" y2="10.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="10.1" x2="10" y2="5" /></svg></span>',o.onclick=function(){i.editIcon(e.id,"delete","header")},n.appendChild(o),"left"===t?document.getElementById("".concat(i.jSPlugin.id,"-headControl")).childNodes[0].appendChild(n):document.getElementById("".concat(i.jSPlugin.id,"-headControl")).childNodes[1].appendChild(n)}))}},{key:"countTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this;if(!document.getElementById(this.jSPlugin.id+"time-area")){var n=document.createElement("div");n.id=this.jSPlugin.id+"time-area",n.className="time-area",n.innerHTML='<span class="dot"></span><span class="value">00:00</span>',document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).appendChild(n)}if(this.countTimer&&clearInterval(this.countTimer),"add"===e){var o=t;document.getElementById(i.jSPlugin.id+"time-area").style.display="flex",this.countTimer=setInterval((function(){++o,document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML=a(o)}),1e3)}else"destroy"===e&&(this.countTimer&&clearInterval(this.countTimer),this.countTimer=void 0,document.getElementById(i.jSPlugin.id+"time-area")&&(document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML="00:00",document.getElementById(i.jSPlugin.id+"time-area").style.display="none"));function a(e){var t=parseInt(e),i=0,n=0,o="00",a="00",r="00";return t>59&&(i=parseInt(t/60),t=parseInt(t%60),i>59&&(n=parseInt(i/60),i=parseInt(i%60))),o=parseInt(t)>9?parseInt(t):"0"+parseInt(t),a=parseInt(i)>9?parseInt(i):"0"+parseInt(i),r=parseInt(n)>9?parseInt(n):"0"+parseInt(n),n>0?r+":"+a+":"+o:i>0?a+":"+o:"00:"+o}}},{key:"setDisabled",value:function(e){var t=this.decoderState.state,i=t.sound;t.hd;var n=e?"cursor: not-allowed; fill: gray; color: gray":"cursor: default";null!=document.getElementById("".concat(this.jSPlugin.id,i?"-sound-icon":"-nosound-icon"))&&document.getElementById("".concat(this.jSPlugin.id,i?"-sound-icon":"-nosound-icon")).setAttribute("style",e?"cursor: not-allowed;fill: gray":"cursor: default"),null!=document.getElementById("".concat(this.jSPlugin.id,"-recordvideo-icon"))&&document.getElementById("".concat(this.jSPlugin.id,"-recordvideo-icon")).setAttribute("style",n),null!=document.getElementById("".concat(this.jSPlugin.id,"-capturePicture-icon"))&&document.getElementById("".concat(this.jSPlugin.id,"-capturePicture-icon")).setAttribute("style",n),null!=document.getElementById("".concat(this.jSPlugin.id,"-talk-icon"))&&document.getElementById("".concat(this.jSPlugin.id,"-talk-icon")).setAttribute("style",n),this.allowZoom||null!=document.getElementById("".concat(this.jSPlugin.id,"-zoom-icon"))&&document.getElementById("".concat(this.jSPlugin.id,"-zoom-icon")).setAttribute("style",n),null!=document.getElementById("".concat(this.jSPlugin.id,"-pantile-icon"))&&document.getElementById("".concat(this.jSPlugin.id,"-pantile-icon")).setAttribute("style",n);var o=document.getElementsByClassName("".concat(this.jSPlugin.id,"-select-quality-btn"));if(o.length)for(var a=0;a<o.length;a++)e?(o[a].style.cursor="not-allowed",o[a].style.fill="gray",o[a].style.color="gray"):(o[a].style.cursor="default",o[a].style.fill="",o[a].style.color="");null!=document.getElementById("".concat(this.jSPlugin.id,"-speed-text"))&&document.getElementById("".concat(this.jSPlugin.id,"-speed-text")).setAttribute("style",document.getElementById("".concat(this.jSPlugin.id,"-speed-text")).getAttribute("style")+";"+(e?"cursor: not-allowed;color: gray;border-color: gray;":"cursor: default;color: #ffffff;border-color: #ffffff;")),this.zoomDisable=this.jSPlugin.use3DZoom&&e}},{key:"matchBtn",value:function(e){var t=this,i=this.themeData,n=i.header,o=i.footer,a={title:"",id:"",domString:"",color:"#FFFFFF",activeColor:"#FFFFFF",onclick:function(){},onmoveleft:function(){},onmoveright:function(){},onremove:function(){}},r=n.btnList.findIndex((function(t){return t.iconId===e}));switch(-1===r?(a.color=o.color,a.backgroundColor=o.backgroundColor,a.activeColor=o.activeColor):(a.color=n.color,a.backgroundColor=n.backgroundColor,a.activeColor=n.activeColor),e){case"play":a.title="播放/结束播放",a.id=e,a.domString='<div style="height: 100%">'+'<svg id="'.concat(this.jSPlugin.id+"-play-icon",'" class="theme-icon-item-icon" style="display:none" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'"  fill="').concat(a.color,'" viewBox="-6 -6 32 32">\n            <path id="Stroke-1" class="st1" d="M10.5,1.7c-4.9,0-8.8,4-8.8,8.8s4,8.8,8.8,8.8s8.8-4,8.8-8.8S15.4,1.7,10.5,1.7z M10.5,2.7\n              c4.3,0,7.8,3.5,7.8,7.8s-3.5,7.8-7.8,7.8s-7.8-3.5-7.8-7.8S6.2,2.7,10.5,2.7z"/>\n            <path class="st2" d="M8.7,8C9,8,9.3,8.3,9.3,8.6v3.8C9.3,12.7,9,13,8.7,13C8.3,13,8,12.7,8,12.4V8.6C8,8.3,8.3,8,8.7,8z"/>\n            <path id="Rectangle-Copy-10" class="st2" d="M12.8,8c0.3,0,0.6,0.3,0.6,0.6v3.8c0,0.3-0.3,0.6-0.6,0.6c-0.3,0-0.6-0.3-0.6-0.6V8.6\n              C12.2,8.3,12.5,8,12.8,8z"/>\n          </svg>')+'<svg id="'.concat(this.jSPlugin.id+"-stop-icon",'" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M13,9.8L10.1,8C9.9,7.9,9.7,7.9,9.5,7.9c-0.6,0-1,0.4-1,1v3.7c0,0.2,0.1,0.4,0.2,0.5c0.3,0.5,0.9,0.6,1.4,0.3 l2.9-1.8c0.1-0.1,0.2-0.2,0.3-0.3C13.6,10.7,13.4,10.1,13,9.8z" /><path d="M10.5,1.9c-4.9,0-8.8,4-8.8,8.8c0,4.9,4,8.8,8.8,8.8s8.8-4,8.8-8.8C19.4,5.8,15.4,1.9,10.5,1.9z M10.5,18.5 c-4.3,0-7.8-3.5-7.8-7.8s3.5-7.8,7.8-7.8c4.3,0,7.8,3.5,7.8,7.8S14.9,18.5,10.5,18.5z" /></svg></div>',a.onclick=function(){var e=t.decoderState.state,i=e.play,n=e.isEditing,o=e.rec,a=e.cloudRec,r=e.recordvideo;if(n)return!1;i?(o||a?t.isMobile?t.jSPlugin.jSPlugin.JS_GetOSDTime(0).then((function(e){var i=new Date(1e3*e),n="".concat(i.getFullYear())+(i.getMonth()>8?i.getMonth()+1:"0".concat(i.getMonth()+1))+(i.getDate()>9?i.getDate():"0".concat(i.getDate()))+(i.getHours()>9?i.getHours():"0".concat(i.getHours()))+(i.getMinutes()>9?i.getMinutes():"0".concat(i.getMinutes()))+(i.getSeconds()>9?i.getSeconds():"0".concat(i.getSeconds()));t.pauseTime=n,t.jSPlugin.pause(n)})):t.jSPlugin.pause():(t.jSPlugin.stop(),t.jSPlugin.Zoom.stopZoom(),t.jSPlugin.close3DZoom()),r&&t.setDecoderState({recordvideo:!1})):(o||a?t.isMobile?(t.jSPlugin.resume(t.pauseTime),t.pauseTime=null):t.jSPlugin.resume():t.jSPlugin.play(),t.jSPlugin.use3DZoom&&t.resetMobileZoomStatus()),t.jSPlugin.use3DZoom?(t.setDecoderState({zoom:!1}),t.allowZoom=!1):t.allowZoom=o||a,t.setDecoderState({play:!i}),t.setDisabled(i)};break;case"sound":a.title="声音",a.id=e,a.domString='<span style="height: 100%">'+'<svg class="theme-icon-item-icon" id="'.concat(this.jSPlugin.id,'-nosound-icon" style="display:none" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">\n            <path d="M8.5,4.2c0.8-0.7,2.1-0.2,2.2,0.9l0,0.1v10c0,1.1-1.2,1.7-2.1,1.1l-0.1-0.1l-3.3-2.8C5,13.2,5,12.9,5.1,12.7 c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.3,2.8c0.2,0.2,0.5,0.1,0.5-0.2l0-0.1v-10c0-0.3-0.3-0.4-0.5-0.3L9.2,5L5.9,7.8 C5.6,7.9,5.3,7.9,5.1,7.7C5,7.5,5,7.3,5.1,7.1L5.2,7L8.5,4.2z"/>\n            <path d="M5.5,6.9C5.8,6.9,6,7.1,6,7.4c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2C3.4,7.9,3.3,8,3.2,8.2l0,0.1v4 c0,0.2,0.1,0.3,0.3,0.3l0.1,0h2C5.8,12.5,6,12.7,6,13c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2c-0.7,0-1.3-0.5-1.3-1.2l0-0.1v-4 c0-0.7,0.5-1.3,1.2-1.3l0.1,0H5.5z"/>\n            <path d="M17.4,7.9c0.2-0.2,0.5-0.2,0.7,0c0.2,0.2,0.2,0.4,0.1,0.6l-0.1,0.1l-3.8,3.8c-0.2,0.2-0.5,0.2-0.7,0 c-0.2-0.2-0.2-0.4-0.1-0.6l0.1-0.1L17.4,7.9z"/>\n            <path d="M13.7,7.9c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.8,3.8c0.2,0.2,0.2,0.5,0,0.7c-0.2,0.2-0.4,0.2-0.6,0.1l-0.1-0.1 l-3.7-3.8C13.5,8.4,13.5,8.1,13.7,7.9z"/>\n            </svg>')+'<svg class="theme-icon-item-icon" id="'.concat(this.jSPlugin.id,'-sound-icon" style="display:inline-block" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" fill="').concat(a.color,'" viewBox="-6 -6 32 32">\n              <path d="M13.2,7.1c0.1-0.2,0.5-0.3,0.7-0.2c1.1,0.7,1.9,2.2,1.9,3.7c0,1.6-0.7,3-1.9,3.7\n                c-0.2,0.1-0.5,0.1-0.7-0.2c-0.1-0.2-0.1-0.5,0.2-0.7c0.8-0.5,1.4-1.6,1.4-2.9c0-1.3-0.6-2.4-1.4-2.9C13.1,7.6,13,7.3,13.2,7.1z"/>\n              <path d="M15.7,4.5c0.2-0.2,0.5-0.2,0.7-0.1C18,5.8,19,8.2,19,10.7c0,2.5-1,4.8-2.7,6.3\n                c-0.2,0.2-0.5,0.2-0.7-0.1c-0.2-0.2-0.2-0.5,0.1-0.7c1.4-1.2,2.3-3.3,2.3-5.5c0-2.2-0.9-4.3-2.3-5.5C15.5,5,15.5,4.7,15.7,4.5z"/>\n              <path id="Stroke-5" class="st1" d="M8.5,4.7c0.8-0.7,2.1-0.2,2.2,0.9l0,0.1v10c0,1.1-1.2,1.7-2.1,1.1l-0.1-0.1l-3.3-2.8\n                C5,13.7,5,13.4,5.1,13.2c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.3,2.8c0.2,0.2,0.5,0.1,0.5-0.2l0-0.1v-10c0-0.3-0.3-0.4-0.5-0.3l-0.1,0\n                L5.9,8.3C5.6,8.4,5.3,8.4,5.1,8.2C5,8,5,7.7,5.1,7.6l0.1-0.1L8.5,4.7z"/>\n              <path  d="M5.5,7.4C5.8,7.4,6,7.6,6,7.9c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2c-0.2,0-0.3,0.1-0.3,0.3l0,0.1v4\n                c0,0.2,0.1,0.3,0.3,0.3l0.1,0h2C5.8,13,6,13.2,6,13.5c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2c-0.7,0-1.3-0.5-1.3-1.2l0-0.1v-4\n                c0-0.7,0.5-1.3,1.2-1.3l0.1,0H5.5z"/>\n            </svg>')+"</span>",a.onclick=function(){var e=t.decoderState.state,i=e.play,n=e.sound,o=e.talk;i&&!o&&(n?(t.jSPlugin.closeSound(),t.setDecoderState({sound:!1})):(t.jSPlugin.openSound(),t.setDecoderState({sound:!0})))};break;case"recordvideo":a.title="录屏",a.id=e,a.domString='<svg id="'.concat(this.jSPlugin.id,'-recordvideo-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M11.6,5.3H4.7c-1.4,0-2.5,1.1-2.5,2.5v5.9c0,1.4,1.1,2.5,2.5,2.5h6.9c1.4,0,2.5-1.1,2.5-2.5V7.7 C14.1,6.4,13,5.3,11.6,5.3z M4.7,6.3h6.9c0.8,0,1.5,0.7,1.5,1.5v5.9c0,0.8-0.7,1.5-1.5,1.5H4.7c-0.8,0-1.5-0.7-1.5-1.5V7.7 C3.3,6.9,3.9,6.3,4.7,6.3z" /><path d="M16.6,6.7c0.9-0.8,2.3-0.1,2.4,1l0,0.1v5.7c0,1.2-1.3,1.9-2.3,1.2l-0.1-0.1L13.3,12 c-0.2-0.2-0.2-0.5-0.1-0.7c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.3,2.7c0.3,0.2,0.7,0.1,0.8-0.3l0-0.1V7.8c0-0.4-0.4-0.6-0.7-0.4 l-0.1,0l-3.3,2.7c-0.2,0.2-0.5,0.1-0.7-0.1c-0.2-0.2-0.1-0.5,0-0.6l0.1-0.1L16.6,6.7z" /></svg>',a.onclick=function(){var e=t.decoderState.state,i=e.play,n=e.recordvideo;i&&(n?(t.jSPlugin.stopSave(),t.setDecoderState({recordvideo:!1})):(t.jSPlugin.startSave("".concat((new Date).getTime())),t.setDecoderState({recordvideo:!0})))};break;case"capturePicture":a.title="截图",a.id=e,a.domString='<svg id="'.concat(this.jSPlugin.id,'-capturePicture-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M10.8,7.7c-2,0-3.7,1.6-3.7,3.7S8.7,15,10.8,15c2,0,3.7-1.6,3.7-3.7S12.8,7.7,10.8,7.7z M10.8,8.7c1.5,0,2.7,1.2,2.7,2.7S12.2,14,10.8,14c-1.5,0-2.7-1.2-2.7-2.7S9.3,8.7,10.8,8.7z" /><path d="M8.6,3.7l-0.1,0C8,3.7,7.7,4,7.5,4.3l-1,1.7l-1.3,0C4,6.1,3.1,7,3.1,8.2v7.1 c0,1.2,0.9,2.1,2.1,2.1h11.1c1.2,0,2.1-0.9,2.1-2.1V8.2l0-0.1c-0.1-1.1-1-1.9-2.1-1.9l-1.3,0l-1.1-1.8c-0.2-0.4-0.7-0.6-1.1-0.6H8.6 z M8.6,4.7h4.2c0.1,0,0.2,0.1,0.3,0.1l1.2,2c0.1,0.2,0.3,0.2,0.4,0.2h1.6c0.6,0,1.1,0.5,1.1,1.1v7.1c0,0.6-0.5,1.1-1.1,1.1H5.1 c-0.6,0-1.1-0.5-1.1-1.1V8.2c0-0.6,0.5-1.1,1.1-1.1h1.6c0.2,0,0.3-0.1,0.4-0.2l1.2-2C8.4,4.7,8.5,4.7,8.6,4.7z" /></svg>',a.onclick=function(){var e=t.decoderState.state.play;e?t.jSPlugin.capturePicture("".concat((new Date).getTime())):console.log("视频未播放，无法截图")};break;case"talk":a.title="对讲",a.id=e,a.domString="<div></div>"+'<svg id="'.concat(this.jSPlugin.id,'-talk-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M10.1,2.7C8.5,2.7,7.2,4,7.2,5.6v5.2c0,1.6,1.3,2.9,2.9,2.9l0.2,0c1.5-0.1,2.7-1.4,2.7-2.9V5.6\tC13,4,11.7,2.7,10.1,2.7z M10.1,3.7c1.1,0,1.9,0.9,1.9,1.9v5.2c0,1-0.8,1.8-1.8,1.9l-0.1,0c-1,0-1.9-0.9-1.9-1.9V5.6 C8.2,4.5,9,3.7,10.1,3.7z" /><path d="M15.1,8.5c0.2,0,0.4,0.2,0.5,0.4l0,0.1v1.7c0,3-2.5,5.5-5.5,5.5c-3,0-5.4-2.3-5.5-5.3l0-0.2V9 c0-0.3,0.2-0.5,0.5-0.5c0.2,0,0.4,0.2,0.5,0.4l0,0.1v1.7c0,2.5,2,4.5,4.5,4.5c2.4,0,4.4-1.9,4.5-4.3l0-0.2V9 C14.6,8.7,14.8,8.5,15.1,8.5z" /><path d="M13.5,17.7c0.3,0,0.5,0.2,0.5,0.5c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-7c-0.3,0-0.5-0.2-0.5-0.5 c0-0.2,0.2-0.4,0.4-0.5l0.1,0H13.5z" /><path d="M10.1,15.2c0.2,0,0.4,0.2,0.5,0.4l0,0.1v2.5c0,0.3-0.2,0.5-0.5,0.5c-0.2,0-0.4-0.2-0.5-0.4l0-0.1 v-2.5C9.6,15.4,9.8,15.2,10.1,15.2z" /></svg>',a.onclick=function(){var e=t.decoderState.state,i=e.talk,n=e.sound,o=e.play;if(o)if(i){console.log("结束对讲"),t.setDecoderState({talk:!1}),t.jSPlugin.Talk.stopTalk();var a=Z.findIndex(t.themeData.footer.btnList,(function(e){return"sound"===e.iconId&&1===e.isrender&&1===e.defaultActive}))>-1;t.themeData&&a&&(t.jSPlugin.openSound(),t.setDecoderState({sound:!0}))}else console.log("开始对讲"),t.setDecoderState({talk:!0}),t.jSPlugin.Talk.startTalk((function(e){n&&!e&&(t.jSPlugin.closeSound(),t.setDecoderState({sound:!1}))}))};break;case"zoom":a.title=this.jSPlugin.use3DZoom?"3D定位":"电子放大",a.id=e,a.domString="<div></div>"+'<svg id="'.concat(this.jSPlugin.id,'-zoom-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n          width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="5 -6 5 32" style="enable-background:new 0 0 20 20.1;" xml:space="preserve">\n              <path class="st1" d="M8.8,2.6c3.5,0,6.2,2.8,6.2,6.2s-2.8,6.2-6.2,6.2s-6.2-2.8-6.2-6.2S5.3,2.6,8.8,2.6z M8.8,3.9\n                c-2.8,0-5,2.2-5,5s2.2,5,5,5s5-2.2,5-5S11.5,3.9,8.8,3.9z M12.7,12.7l3.9,3.9"/>\n              <path class="st2" d="M11.2,9.5h-5c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6h5c0.3,0,0.6,0.3,0.6,0.6S11.6,9.5,11.2,9.5z"/>\n              <path class="st2" d="M8.7,12c-0.3,0-0.6-0.3-0.6-0.6v-5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v5C9.3,11.8,9.1,12,8.7,12z"/>\n              <path class="st2" d="M16.9,17.6c-0.1,0-0.3-0.1-0.4-0.2l-3.9-3.9c-0.2-0.2-0.2-0.6,0-0.8s0.6-0.2,0.8,0l3.9,3.9\n                c0.2,0.2,0.2,0.6,0,0.8C17.2,17.5,17,17.6,16.9,17.6z"/>\n          </svg>'),a.onclick=function(){var e=t.decoderState.state,i=e.zoom,n=e.play;if(t.jSPlugin.use3DZoom){if(!n)return!1;i?t.jSPlugin.close3DZoom():t.jSPlugin.enable3DZoom()}else{if(t.zoomDisable)return!1;i?(console.log("结束电子放大"),t.jSPlugin.Zoom.stopZoom()):(console.log("开始电子放大"),t.jSPlugin.Zoom.startZoom())}t.setDecoderState({zoom:!i})};break;case"pantile":a.title="云台控制",a.id=e,a.domString='<svg id="'.concat(this.jSPlugin.id,'-pantile-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M10.2,7.8c1.6,0,2.9,1.3,2.9,2.9s-1.3,2.9-2.9,2.9s-2.9-1.3-2.9-2.9S8.5,7.8,10.2,7.8z M10.2,8.8c-1.1,0-1.9,0.9-1.9,1.9s0.9,1.9,1.9,1.9s1.9-0.9,1.9-1.9S11.2,8.8,10.2,8.8z" /><path d="M8.8,3.5c0.7-0.6,1.8-0.6,2.5-0.1l0.1,0.1l1.4,1.1c0.2,0.2,0.3,0.5,0.1,0.7 c-0.2,0.2-0.4,0.2-0.6,0.1l-0.1,0l-1.4-1.1C10.5,3.9,10,3.9,9.6,4.2L9.4,4.3L8,5.4C7.8,5.5,7.5,5.5,7.3,5.3c-0.2-0.2-0.1-0.5,0-0.6 l0.1-0.1L8.8,3.5z" /><path d="M2.5,12.3c-0.6-0.7-0.6-1.8-0.1-2.5l0.1-0.1l1.1-1.4c0.2-0.2,0.5-0.3,0.7-0.1 c0.2,0.2,0.2,0.4,0.1,0.6l0,0.1l-1.1,1.4C3,10.6,3,11.1,3.2,11.5l0.1,0.1L4.4,13c0.2,0.2,0.1,0.5-0.1,0.7c-0.2,0.2-0.5,0.1-0.6,0 l-0.1-0.1L2.5,12.3z" /><path d="M17.7,12.3c0.6-0.7,0.6-1.8,0.1-2.5l-0.1-0.1l-1.1-1.4c-0.2-0.2-0.5-0.3-0.7-0.1 c-0.2,0.2-0.2,0.4-0.1,0.6l0,0.1l1.1,1.4c0.3,0.4,0.3,0.9,0.1,1.3l-0.1,0.1L15.8,13c-0.2,0.2-0.1,0.5,0.1,0.7c0.2,0.2,0.5,0.1,0.6,0 l0.1-0.1L17.7,12.3z" /><path d="M8.8,18.2c0.7,0.6,1.8,0.6,2.5,0.1l0.1-0.1l1.4-1.1c0.2-0.2,0.3-0.5,0.1-0.7 c-0.2-0.2-0.4-0.2-0.6-0.1l-0.1,0l-1.4,1.1c-0.4,0.3-0.9,0.3-1.3,0.1l-0.1-0.1L8,16.3c-0.2-0.2-0.5-0.1-0.7,0.1 c-0.2,0.2-0.1,0.5,0,0.6l0.1,0.1L8.8,18.2z" /></svg>',a.onclick=function(){var e=t.decoderState.state,i=e.play,n=e.pantile,o=e.expend;if(i)if(n)console.log("隐藏云台"),t.Ptz.hide(),t.setDecoderState({pantile:!1});else{if(console.log("显示云台"),t.isMobile&&!o)return console.log("移动端，非全屏状态不展示云台"),!1;t.Ptz.show(),t.setDecoderState({pantile:!0})}};break;case"expend":a.title="全局全屏",a.id=e,a.domString='<span><svg id="'.concat(this.jSPlugin.id,'-expend-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M3.4,7.6c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-1.2,1-2.3,2.2-2.3h1.8c0.3,0,0.5,0.2,0.5,0.5S7.2,4.1,6.9,4.1H5.2 c-0.7,0-1.2,0.6-1.2,1.3v1.8C3.9,7.4,3.7,7.6,3.4,7.6z" /><path d="M6.9,18.1H5.2c-1.2,0-2.2-1-2.2-2.2v-1.8c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v1.8c0,0.7,0.6,1.2,1.2,1.2 h1.8c0.3,0,0.5,0.2,0.5,0.5S7.2,18.1,6.9,18.1z" /><path d="M15.7,18.1h-1.8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h1.8c0.7,0,1.2-0.6,1.2-1.2v-1.8 c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v1.8C17.9,17.1,16.9,18.1,15.7,18.1z" /><path d="M17.4,7.6c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-0.7-0.6-1.3-1.2-1.3h-1.8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h1.8 c1.2,0,2.2,1,2.2,2.3v1.8C17.9,7.4,17.7,7.6,17.4,7.6z" /></svg>'+'<svg class="theme-icon-item-icon" style="display:none" width="'.concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" fill="').concat(a.color,'" viewBox="-6 -6 32 32">\n            <path class="st1" d="M5.7,8.1H3.9c-0.3,0-0.6-0.2-0.6-0.6S3.6,7,3.9,7h1.9c0.7,0,1.3-0.6,1.3-1.3V3.8c0-0.3,0.2-0.6,0.6-0.6\n              s0.6,0.2,0.6,0.6v1.9C8.2,7,7.1,8.1,5.7,8.1z"/>\n            <path class="st1" d="M7.6,17.7c-0.3,0-0.6-0.2-0.6-0.6v-1.9c0-0.7-0.6-1.3-1.3-1.3H3.9c-0.3,0-0.6-0.2-0.6-0.6s0.2-0.6,0.6-0.6h1.9\n              c1.3,0,2.4,1.1,2.4,2.4v1.9C8.2,17.5,7.9,17.7,7.6,17.7z"/>\n            <path class="st1" d="M13.4,17.7c-0.3,0-0.6-0.2-0.6-0.6v-1.9c0-1.3,1.1-2.4,2.4-2.4h1.9c0.3,0,0.6,0.2,0.6,0.6S17.5,14,17.2,14\n              h-1.9c-0.7,0-1.3,0.6-1.3,1.3v1.9C14,17.5,13.8,17.7,13.4,17.7z"/>\n            <path class="st1" d="M17.2,8.1h-1.9c-1.3,0-2.4-1.1-2.4-2.4V3.8c0-0.3,0.2-0.6,0.6-0.6S14,3.5,14,3.8v1.9C14,6.4,14.6,7,15.3,7h1.9\n              c0.3,0,0.6,0.2,0.6,0.6S17.5,8.1,17.2,8.1z"/>\n          </svg>\n          </span>'),a.onclick=function(){var e=t.decoderState.state;e.webExpend;var i=e.expend;e.play;var n=e.pantile;if(i)if(t.isMobile){a=parseInt(getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))).height,10)-parseInt(getComputedStyle(document.getElementById(t.jSPlugin.id)).height,10);document.getElementById("".concat(t.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(t.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop="-32px"),document.getElementById("".concat(t.jSPlugin.id,"-headControl"))&&(document.getElementById("".concat(t.jSPlugin.id,"-headControl")).style.position="relative"),A(document.getElementById("".concat(t.jSPlugin.id,"-wrap")),t.jSPlugin.width,t.jSPlugin.height+a),t.jSPlugin.jSPlugin.JS_Resize(t.jSPlugin.width,t.jSPlugin.height),n&&(t.Ptz.hide(),t.setDecoderState({pantile:!1}))}else{console.log("取消全局全屏");var o=B();o.then((function(e){console.log("取消全屏",e,t.jSPlugin),t.jSPlugin.jSPlugin.JS_Resize(t.jSPlugin.width,t.jSPlugin.height)}))}else if(console.log("执行全局全屏"),t.isMobile){var a=parseInt(getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))).height,10)-parseInt(getComputedStyle(document.getElementById(t.jSPlugin.id)).height,10);x(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))),setTimeout((function(){var e=document.documentElement.clientWidth,i=document.documentElement.clientHeight;document.getElementById("".concat(t.jSPlugin.id)).style["backface-visibility"]="hidden",t.jSPlugin.jSPlugin.JS_Resize(i,e-a,!0),t.jSPlugin.fullScreenWidth=i,t.jSPlugin.fullScreenHeight=e-a}),100)}else{var r=window.screen.width,s=window.screen.height,d=R(document.getElementById("".concat(t.jSPlugin.id)));d.then((function(e){t.jSPlugin.jSPlugin.JS_Resize(r,s),t.jSPlugin.fullScreenWidth=r,t.jSPlugin.fullScreenHeight=s}))["catch"]((function(e){console.log(e)})),t.jSPlugin.close3DZoom()}t.setDecoderState({expend:!i})};break;case"webExpend":a.title="网页全屏",a.id=e,a.domString='<span><svg id="'.concat(this.jSPlugin.id,'-webExpend-icon" class="theme-icon-item-icon" fill="').concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M3.1,7.6c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-1.2,1-2.3,2.2-2.3h1.8c0.3,0,0.5,0.2,0.5,0.5S6.8,4.1,6.6,4.1H4.8 c-0.7,0-1.2,0.6-1.2,1.3v1.8C3.6,7.4,3.3,7.6,3.1,7.6z" /><path d="M15.3,18.1h-1.8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h1.8c0.7,0,1.2-0.6,1.2-1.2v-1.8 c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v1.8C17.6,17.1,16.6,18.1,15.3,18.1z" /><circle class="st2" cx="10.2" cy="10.4" r="1.1"/></svg>'+'<svg class="theme-icon-item-icon" fill="'.concat(a.color,'" style="display:none;" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-6 -6 32 32">\n          <path class="st1" d="M5.4,8.1H3.5C3.2,8.1,3,7.9,3,7.6s0.2-0.5,0.5-0.5h1.9c0.8,0,1.4-0.6,1.4-1.4V3.8c0-0.3,0.2-0.5,0.5-0.5\n            s0.5,0.2,0.5,0.5v1.9C7.7,7,6.7,8.1,5.4,8.1z"/>\n          <path class="st1" d="M13.1,17.7c-0.3,0-0.5-0.2-0.5-0.5v-1.9c0-1.3,1.1-2.4,2.4-2.4h1.9c0.3,0,0.5,0.2,0.5,0.5s-0.2,0.5-0.5,0.5H15\n            c-0.8,0-1.4,0.6-1.4,1.4v1.9C13.6,17.4,13.4,17.7,13.1,17.7z"/>\n            <circle class="st2" cx="10.2" cy="10.4" r="1.1"/>\n          ')+"</svg></span>",a.onclick=function(){var e=t.decoderState.state,i=e.webExpend,n=e.expend;if(e.play,n)return console.log("正在全局全屏"),!1;if(t.jSPlugin.recTimer&&clearInterval(t.jSPlugin.recTimer),i){console.log("取消网页全屏");var o=B();o.then((function(e){t.jSPlugin.jSPlugin.JS_Resize(t.jSPlugin.width,t.jSPlugin.height),t.jSPlugin.Theme.Rec&&t.jSPlugin.Theme.Rec.recAutoSize()}))}else{console.log("执行网页全屏");var a=0,r=0,s=t;["fullscreenchange","webkitfullscreenchange","mozfullscreenchange"].forEach((function(e){window.addEventListener(e,(function(e){var t=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;return t?document.getElementById("".concat(s.jSPlugin.id,"-loading-item-0"))&&(document.getElementById("".concat(s.jSPlugin.id,"-loading-item-0")).style.height=window.screen.height-parseInt(window.getComputedStyle(document.getElementById("".concat(s.jSPlugin.id,"-headControl"))).height,10)+"px"):document.getElementById("".concat(s.jSPlugin.id,"-loading-item-0"))&&(document.getElementById("".concat(s.jSPlugin.id,"-loading-item-0")).style.height=s.jSPlugin.height+parseInt(window.getComputedStyle(document.getElementById("".concat(s.jSPlugin.id,"-headControl"))).height,10)+"px"),t}))}));var d=window.screen.width,l=window.screen.height,c=R(document.getElementById("".concat(t.jSPlugin.id,"-wrap")));c.then((function(e){document.getElementById("".concat(t.jSPlugin.id,"-canvas-container"))&&(a=parseInt(window.getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-canvas-container"))).height,10)),document.getElementById("".concat(t.jSPlugin.id,"-headControl"))&&(r=parseInt(window.getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-headControl"))).height,10)),t.jSPlugin.jSPlugin.JS_Resize(d,l-a-r),t.jSPlugin.Theme.Rec&&t.jSPlugin.Theme.Rec.recAutoSize()}))["catch"]((function(e){console.log(e)}))}t.setDecoderState({webExpend:!i})};break;case"hd":return Qe(this.jSPlugin.env.domain,this.jSPlugin.accessToken,this.jSPlugin.deviceSerial,this.jSPlugin.channelNo).then((function(i){var n=i;t.setDecoderState({hdList:n});var o=t.decoderState.state.hd;o=o.name?n.find((function(e){return e.name===o.name})):t.jSPlugin.url.indexOf("hd.live")>-1?n[0]:n[1],t.setDecoderState({hd:o});var r="".concat(t.jSPlugin.id,"-select-quality"),s="".concat(r,"-item");return a.title="画面清晰度",a.id=e,a.domString='<ul id="'.concat(t.jSPlugin.id,'-hdSelect" class="hd speed-select ').concat(t.isMobile?"mobile":"",'" style="display:none;">\n            ').concat(n.map((function(e){if(e.name&&void 0!=e.level)return'<li class="selectOption default '.concat(s,'" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;" name="option" data-type="').concat(e.level,'" id="').concat(r,"_").concat(e.level,'">').concat(e.name,"</li>")})).join(""),'\n            <li class="selectOption cancel" style="').concat(t.isMobile?"":"display:none;",'" name="option" id="').concat(t.jSPlugin.id,'-select-speed">取消</li>\n          </ul>\n          <span>\n            ').concat("object"===c(t.decoderState.state.hd)&&"function"===typeof t.decoderState.state.hd.icon?t.decoderState.state.hd.icon(t.jSPlugin.id,r,a.color,t.jSPlugin.width,tt):"object"===c(t.decoderState.state.hd)&&"string"===typeof t.decoderState.state.hd.name?'<div class="theme-icon-item-icon '.concat(r,'-btn" data-type="').concat(t.decoderState.state.hd.level,'" style="width: ').concat(t.jSPlugin.width>tt?48:32,'px">').concat(t.decoderState.state.hd.name,"</div>"):"",'\n            <span class=\'speed-select-mask\' style="display:none" id="').concat(t.jSPlugin.id,'-select-hd-mask"></span>\n          </span>'),a.onclick=function(e){var i=t.decoderState.state,o=i.hd,a=i.expend,s=i.recordvideo,d=i.play;if(d){var l=e.target.id,c=e.target.getAttribute("data-type");if(0===l.indexOf(r)){if(o.type+""!==c){var u=n.find((function(e){return e.level+""===c}));if(u&&(u.streamType!==o.streamType||u.level+""!==o.level+"")){t.jSPlugin.changeVideoLevel(u),t.setDecoderState({hd:u});var m=document.getElementById("".concat(t.jSPlugin.id,"-hdSelect-icon")),p=document.getElementById("".concat(t.jSPlugin.id,"-sdSelect-icon"));m&&(m.style.display="hd"===u.level?"block":"none"),p&&(p.style.display="sd"===u.level?"block":"none")}}t.resetMobileZoomStatus(),s&&t.setDecoderState({recordvideo:!1})}t.showHD=!t.showHD,document.getElementById("".concat(t.jSPlugin.id,"-hdSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).style.display="none"===document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).style.display?"block":"none",t.isMobile&&(document.getElementById("".concat(t.jSPlugin.id,"-select-hd-mask")).style.display="none"===document.getElementById("".concat(t.jSPlugin.id,"-select-hd-mask")).style.display?"block":"none")),t.isMobile&&a&&t.showHD?document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).className="hd speed-select mobile expend":document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).className=t.isMobile?"hd speed-select mobile":"speed-select"}},a}));case"speed":a.title="回放倍速",a.id=e,a.domString='<ul id="'.concat(this.jSPlugin.id,'-speedSelect" class="speed speed-select ').concat(this.isMobile?"mobile":"",'" style="display:none;">')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed4">4倍</li>')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed2">2倍</li>')+'<li class="selectOption active" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed1">1倍（正常播放）</li>')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed05">0.5倍</li>')+'<li class="selectOption cancel" style="'.concat(this.isMobile?"":"display:none;",'" name="option" id="').concat(this.jSPlugin.id,'-select-speed">取消</li>')+"</ul>"+'<span>\n          <div style="font-size: 12px;\n          vertical-align: bottom;\n          display: inline-flex;\n          padding: 0px 7px;\n          width: 48px;\n          line-height: 24px;\n          justify-content: center;\n          border: 1px solid '.concat(a.color,';\n          text-align: center;border-radius: 12.5px;"\n          id="').concat(this.jSPlugin.id,'-speed-text"\n          >').concat(1===this.nextRate?"倍速":"".concat(this.nextRate,"倍").replace("3","0.5"),"</div>\n                ")+'<span class=\'speed-select-mask\' style="display:none" id="'.concat(this.jSPlugin.id,'-select-mask"></span>')+"</span>",this.isMobile||(a.onmouseenter=function(e){var i=t.decoderState.state.play;if(!i)return!1;console.log("鼠标移入",e),t.setDecoderState({speed:!0}),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="block")},a.onmouseleave=function(e){var i=t.decoderState.state.play;if(!i)return!1;console.log("鼠标移出",e),t.setDecoderState({speed:!1}),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="none")}),a.onclick=function(e){var i=t.decoderState.state,n=i.speed,o=i.expend,a=i.play;if(!a)return!1;if(!n&&t.isMobile&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).className=o?"speed speed-select mobile expend":"speed speed-select mobile"),t.nextRate=1,e.target.id)switch(e.target.id){case"".concat(t.jSPlugin.id,"-select-speed1"):console.log("倍速1"),t.nextRate=1,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),t.changeRecSpeed(1),t.jSPlugin.speed=1,t.setDecoderState({speed:!n});break;case"".concat(t.jSPlugin.id,"-select-speed2"):console.log("倍速2"),t.nextRate=2,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),t.changeRecSpeed(2),t.jSPlugin.speed=2,t.setDecoderState({speed:!n});break;case"".concat(t.jSPlugin.id,"-select-speed4"):console.log("倍速4"),t.nextRate=4,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),t.changeRecSpeed(4),t.jSPlugin.speed=4,t.setDecoderState({speed:!n});break;case"".concat(t.jSPlugin.id,"-select-speed05"):console.log("倍速05"),t.nextRate=3,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),t.changeRecSpeed(.5),t.jSPlugin.speed=.5,t.setDecoderState({speed:!n});break;default:t.isMobile?t.setDecoderState({speed:!n}):t.setDecoderState({speed:!0});break}t.isMobile||e.target.id!=="".concat(t.jSPlugin.id,"-speed-text")?document.getElementById("".concat(t.jSPlugin.id,"-speedSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="none"===document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display?"block":"none"):document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="block"};break;case"deviceName":a.title="设备名称",a.id=e,a.domString="<span>设备名称</span>",a.onclick=function(){};break;case"deviceID":a.title="设备序列号",a.id=e,a.domString="<span>设备序列号</span>",a.onclick=function(){};break;case"cloudRec":a.title="云存储回放",a.id=e,a.domString='\n        <span>\n          <svg class="theme-icon-item-icon" fill="'.concat(a.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="-10 0 40 15">\n\t<path d="M9.5,13.1c-0.3,0-0.5-0.2-0.5-0.5V8.8c0-0.3,0.2-0.5,0.5-0.5S10,8.5,10,8.8v3.8C10,12.8,9.8,13.1,9.5,13.1z"/>\n\t<path d="M7.6,10.6c-0.1,0-0.3-0.1-0.4-0.2C7,10.2,7,9.9,7.3,9.7l1.9-1.7c0.2-0.2,0.5-0.2,0.7,0l1.8,1.7\n\t\tc0.2,0.2,0.2,0.5,0,0.7c-0.2,0.2-0.5,0.2-0.7,0L9.5,9.1l-1.6,1.4C7.8,10.6,7.7,10.6,7.6,10.6z"/>\n\t<path d="M13.2,15.7H5.6c-2.1-0.1-3.8-1.8-3.8-3.9c0-1.8,1.3-3.4,3-3.8c0.4-2.2,2.3-3.9,4.6-3.9c2.3,0,4.2,1.7,4.6,3.8\n\t\tc1.8,0.4,3.1,1.9,3.1,3.8C17.1,13.9,15.4,15.7,13.2,15.7z M5.6,14.7h7.6c1.6,0,2.9-1.3,2.9-2.9c0-1.5-1.1-2.7-2.6-2.9l-0.4,0l0-0.4\n\t\tc-0.2-1.9-1.7-3.3-3.6-3.3C7.5,5.1,6,6.6,5.8,8.5l0,0.4l-0.4,0c-1.4,0.2-2.5,1.4-2.5,2.9C2.8,13.3,4.1,14.6,5.6,14.7z"/>\n          </svg>\n        </span>\n        '),a.onclick=function(){console.log("点击云回放"),t.setDecoderState({type:"cloud.rec",cloudRec:!0,rec:!1}),t.jSPlugin.changePlayUrl({type:"cloud.rec"},(function(){console.log(t.jSPlugin);var e=E("begin",t.jSPlugin.url)||(new Date).Format("yyyyMMdd");t.Rec.renderRec("".concat(e.slice(0,4),"-").concat(e.slice(4,6),"-").concat(e.slice(6,8)));var i=t.decoderState.state.zoom;i&&(t.setDecoderState({zoom:!1}),t.jSPlugin.Zoom.stopZoom(),t.jSPlugin.close3DZoom())})),console.log(t.jSPlugin)};break;case"rec":a.title="本地存储",a.id=e,a.domString='\n        <span>\n        <svg class="theme-icon-item-icon" fill='.concat(a.color,' version="1.1" xmlns="http://www.w3.org/2000/svg"  width="').concat(this.jSPlugin.width>tt?48:32,'" height="').concat(this.jSPlugin.width>tt?48:32,'" viewBox="0 0 40 15">\n          <path d="M13,16.3H5.5c-1.1,0-2-0.9-2-2V3.8c0-1.1,0.9-2,2-2h5.4c0.5,0,1,0.2,1.4,0.6l2.1,2.1C14.8,4.8,15,5.3,15,5.9\n  v8.4C15,15.4,14.1,16.3,13,16.3z M5.5,2.8c-0.6,0-1,0.4-1,1v10.5c0,0.6,0.4,1,1,1H13c0.6,0,1-0.4,1-1V5.9c0-0.3-0.1-0.5-0.3-0.7\n  L11.6,3c-0.2-0.2-0.4-0.3-0.7-0.3H5.5z"/>\n<path d="M6.3,7.3C6,7.3,5.8,7,5.8,6.8V4.5C5.8,4.2,6,4,6.3,4s0.5,0.2,0.5,0.5v2.2C6.8,7,6.6,7.3,6.3,7.3z"/>\n<path d="M8.5,7.3C8.3,7.3,8,7,8,6.8V4.5C8,4.2,8.3,4,8.5,4S9,4.2,9,4.5v2.2C9,7,8.8,7.3,8.5,7.3z"/>\n<path d="M10.8,7.3c-0.3,0-0.5-0.2-0.5-0.5V4.5c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v2.2C11.3,7,11.1,7.3,10.8,7.3z"\n  />\n        </svg>\n      </span>\n        '),a.onclick=function(){console.log("点击本地回放"),t.setDecoderState({type:"rec",cloudRec:!1,rec:!0}),t.jSPlugin.changePlayUrl({type:"rec"},(function(){console.log("---------本地回放"),console.log(t.jSPlugin);var e=E("begin",t.jSPlugin.url)||(new Date).Format("yyyyMMdd");t.Rec.renderRec("".concat(e.slice(0,4),"-").concat(e.slice(4,6),"-").concat(e.slice(6,8)));var i=t.decoderState.state.zoom;i&&(t.setDecoderState({zoom:!1}),t.jSPlugin.Zoom.stopZoom(),t.jSPlugin.close3DZoom())})),console.log(t.jSPlugin)};break}return Promise.resolve(a)}},{key:"changeRecSpeed",value:function(e){var t=this,i=function(e){if(console.log("setLiActive",e),!document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")))return!1;document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[0].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[0].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[1].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[1].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[2].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[2].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[3].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[3].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[e].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[e].className.replace("default","active")},n="1";switch(e){case 1:i(2),n="倍速";break;case 2:i(1),n="".concat(e,"倍");break;case 4:i(0),n="".concat(e,"倍");break;case.5:i(3),n="".concat(e,"倍");break;default:i(2),n="".concat(e,"倍");break}document.getElementById("".concat(this.jSPlugin.id,"-speed-text"))&&(document.getElementById("".concat(this.jSPlugin.id,"-speed-text")).innerHTML=n)}},{key:"initThemeData",value:function(){var e=m(l().mark((function e(){var t,i,n,o,a,r,s,d,c,u,m,p,h,f,g,v,y,_,b,C=this;return l().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.themeData,i=t.header,n=t.footer,o=this.jSPlugin.id,this.header=Q.header,this.footer=Q.footer,this.isNeedRenderHeader=Z.findIndex(i.btnList,(function(e){return e.isrender>0}))>=0&&"miniRec"!=this.jSPlugin.id,this.isMobile&&(this.isNeedRenderHeader=Z.findIndex(i.btnList,(function(e){return e.isrender>0&&"deviceID"===e.iconId||e.isrender>0&&"deviceName"===e.iconId}))>=0&&"miniRec"!=this.jSPlugin.id),this.isNeedRenderFooter=Z.findIndex(n.btnList,(function(e){return e.isrender>0}))>=0&&"miniRec"!=this.jSPlugin.id,console.log("miniRec："+this.jSPlugin.themeId),this.isNeedRenderTimeLine=Z.findIndex(i.btnList,(function(e){return"cloudRec"===e.iconId&&1===e.isrender||"rec"===e.iconId&&1===e.isrender}))>=0&&!this.jSPlugin.disabledTimeLine&&"miniRec"!=this.jSPlugin.id,["date-switch-container-wrap","rec-type-container-wrap","mobile-rec-wrap","mobile-ez-ptz-container"].forEach((function(e,t){document.getElementById(e)&&document.getElementById(e).parentElement.removeChild(document.getElementById(e))})),this.isNeedRenderHeader?document.getElementById("".concat(this.jSPlugin.id,"-headControl"))?document.getElementById("".concat(this.jSPlugin.id,"-headControl")).innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' style='display:flex;width: calc(100% - 100px);'></div><div id='").concat(this.jSPlugin.id,"-headControl-right' style='display:flex'></div>"):(a=document.createElement("div"),a.setAttribute("id","".concat(this.jSPlugin.id,"-headControl")),a.setAttribute("class","header-controls"),a.innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' class=\"header-controls-left\" style='display:flex;width:calc(100% - 100px);overflow:hidden;'></div><div id='").concat(this.jSPlugin.id,"-headControl-right' class=\"header-controls-right\" style='display:flex;'></div>"),r={height:this.jSPlugin.width>tt?"48px":"32px","line-height":this.jSPlugin.width>tt?"48px":"32px",display:"flex","justify-content":"space-between",top:0,"z-index":1,background:"#000000",color:"#FFFFFF",width:"100%"},a.style=et(r),document.getElementById("".concat(o,"-wrap")).insertBefore(a,document.getElementById(o)),s=setInterval((function(){window.EZUIKit[C.jSPlugin.id].state.EZUIKitPlayer.init&&clearInterval(s)}),50)):document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&document.getElementById("".concat(this.jSPlugin.id,"-headControl")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-headControl"))),this.isNeedRenderFooter?document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))?document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop="-".concat(this.jSPlugin.width>tt?48:32,"px"),document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).innerHTML='<div id="'.concat(this.jSPlugin.id,'-audioControls"  class="footer-controls" style=\'display:flex;justify-content: space-between;height: ').concat(this.jSPlugin.width>tt?48:32,"px;width:100%;'><div id='").concat(this.jSPlugin.id,"-audioControls-left' class=\"footer-controls-left\" style='display:flex'></div><div id='").concat(this.jSPlugin.id,"-audioControls-right' class=\"footer-controls-right\" style='display:flex'></div></div>")):(d=document.createElement("div"),d.setAttribute("id","".concat(this.jSPlugin.id,"-ez-iframe-footer-container")),d.setAttribute("class","ez-iframe-footer-container"),c={"min-height":this.jSPlugin.width>tt?"48px":"32px","max-height":this.jSPlugin.width>tt?"96px":"80px",position:"relative","margin-top":this.jSPlugin.width>tt?"-48px":"-32px",display:"flex","flex-wrap":"wrap","justify-content":"space-between","z-index":999,top:0,color:"#FFFFFF",width:"100%"},d.style=et(c),d.innerHTML='<div id="'.concat(this.jSPlugin.id,'-audioControls" class="footer-controls" style=\'display:flex;height:').concat(this.jSPlugin.width>tt?48:32,"px;justify-content: space-between;width:100%;z-index:999;position: relative;'><div id='").concat(this.jSPlugin.id,"-audioControls-left' class=\"footer-controls-left\" style='display:flex;margin-lefacti'></div><div id='").concat(this.jSPlugin.id,"-audioControls-right' class=\"footer-controls-right\" style='display:flex'></div></div>"),P(d,document.getElementById(o))):document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))),!this.isNeedRenderHeader||!document.getElementById("".concat(this.jSPlugin.id,"-headControl"))){e.next=38;break}document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.background=i.backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=i.color,u=S(i.btnList),e.prev=16,u.s();case 18:if((m=u.n()).done){e.next=30;break}if(p=m.value,!p.isrender){e.next=28;break}return e.prev=21,e.next=24,this.renderHeader(p.iconId,p.part);case 24:e.next=28;break;case 26:e.prev=26,e.t0=e["catch"](21);case 28:e.next=18;break;case 30:e.next=35;break;case 32:e.prev=32,e.t1=e["catch"](16),u.e(e.t1);case 35:return e.prev=35,u.f(),e.finish(35);case 38:if(!this.isNeedRenderFooter||!document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))){e.next=64;break}document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=n.backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=n.color,h=S(n.btnList),e.prev=42,h.s();case 44:if((f=h.n()).done){e.next=56;break}if(g=f.value,!g.isrender){e.next=54;break}return e.prev=47,e.next=50,this.renderFooter(g.iconId,g.part);case 50:e.next=54;break;case 52:e.prev=52,e.t2=e["catch"](47);case 54:e.next=44;break;case 56:e.next=61;break;case 58:e.prev=58,e.t3=e["catch"](42),h.e(e.t3);case 61:return e.prev=61,h.f(),e.finish(61);case 64:console.log("this.isNeedRenderTimeLine:"+this.isNeedRenderTimeLine),this.isNeedRenderTimeLine&&(this.isMobile?(document.getElementById("".concat(this.jSPlugin.id,"-headControl-right"))&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl-right")).style.display="none"),this.Rec=new ae(this.jSPlugin,this.changeRecSpeed,this.resetMobileZoomStatus)):(this.Rec?(this.Rec.unSyncTimeLine(),this.Rec.recInit()):(this.jSPlugin.decoderState=this.decoderState,this.jSPlugin.setDecoderState=this.setDecoderState,this.Rec=new te(this.jSPlugin)),v=setInterval((function(){window.EZUIKit[C.jSPlugin.id].state.EZUIKitPlayer.init&&clearInterval(v)}),50))),y=Z.findIndex(this.themeData.footer.btnList,(function(e){return"pantile"===e.iconId&&1===e.isrender}))>=0&&!this.jSPlugin.disabledPTZ,y&&(this.isMobile&&(this.MobilePtz=new be(this.jSPlugin)),this.Ptz=new me(this.jSPlugin)),_=function(){var e=C.decoderState.state,t=e.expend,i=e.webExpend,n=e.zoom,o=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;o||(C.jSPlugin.jSPlugin.JS_Resize(C.jSPlugin.width,C.jSPlugin.height),t&&(C.setDecoderState({expend:!1}),n&&C.jSPlugin.use3DZoom&&C.jSPlugin.enable3DZoom()),i&&C.setDecoderState({webExpend:!1})),C.jSPlugin.Theme.Rec&&C.jSPlugin.Theme.Rec.recAutoSize()},["fullscreenchange","webkitfullscreenchange","mozfullscreenchange"].forEach((function(e){window.addEventListener(e,(function(e){return _("fullscreenchange",e)}))})),this.themeData.poster&&(this.jSPlugin.poster=this.themeData.poster,b=setInterval((function(){window.EZUIKit[C.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(b),C.jSPlugin.setPoster(C.themeData.poster))}),50)),this.inited=!0,this.getDeviceInfo(),this.renderThemeData();case 74:case"end":return e.stop()}}),e,this,[[16,32,35,38],[21,26],[42,58,61,64],[47,52]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"resetMobileZoomStatus",value:function(){if(this.isMobile){var e=document.getElementById("".concat(this.jSPlugin.id,"-zoom-container"));e&&e.style&&"none"!=e.style.display&&(console.log("结束电子放大"),e.style.display="none"),this.jSPlugin.Zoom.resetZoom()}}},{key:"getDeviceInfo",value:function(e){var t=this,i=function(i){200==i.code&&i.data&&(e&&e(i),document.getElementById("".concat(t.jSPlugin.id,"-deviceName-content"))&&(document.getElementById("".concat(t.jSPlugin.id,"-deviceName-content")).style.maxWidth="100%",document.getElementById("".concat(t.jSPlugin.id,"-deviceName-content")).style.overflow="hidden",document.getElementById("".concat(t.jSPlugin.id,"-deviceName-content")).style.textOverflow="ellipsis",document.getElementById("".concat(t.jSPlugin.id,"-deviceName-content")).style.whiteSpace="nowrap",document.getElementById("".concat(t.jSPlugin.id,"-deviceName-content")).innerHTML=i.data.deviceName),document.getElementById("".concat(t.jSPlugin.id,"-deviceID-content"))&&(document.getElementById("".concat(t.jSPlugin.id,"-deviceID-content")).style.maxWidth="100%",document.getElementById("".concat(t.jSPlugin.id,"-deviceID-content")).style.overflow="hidden",document.getElementById("".concat(t.jSPlugin.id,"-deviceID-content")).style.textOverflow="ellipsis",document.getElementById("".concat(t.jSPlugin.id,"-deviceID-content")).style.whiteSpace="nowrap",document.getElementById("".concat(t.jSPlugin.id,"-deviceID-content")).innerHTML=j(t.jSPlugin.url).deviceSerial))};M(this.jSPlugin.env.domain+"/api/lapp/device/info","POST",{accessToken:this.jSPlugin.accessToken,deviceSerial:j(this.jSPlugin.url).deviceSerial},"",i)}},{key:"editStart",value:function(e){var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-headControl"));i&&i.setAttribute("class","header-controls themeEditing"),t&&t.setAttribute("class","footer-controls themeEditing"),this.setDecoderState({isEditing:!0})}},{key:"editEnd",value:function(e){var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-headControl"));i&&i.setAttribute("class","header-controls"),t&&t.setAttribute("class","footer-controls"),this.setDecoderState({isEditing:!1})}},{key:"webExpend",value:function(){var e=this,t=this.decoderState.state;t.webExpend;var i=t.expend,n=t.play;if(!n)return!1;if(i)return console.log("正在全局全屏"),!1;console.log("执行网页全屏");var o=0,a=0,r=R(document.getElementById("".concat(this.jSPlugin.id,"-wrap")));r.then((function(t){console.log("全屏promise",window.screen.width),document.getElementById("".concat(e.jSPlugin.id,"-canvas-container"))&&(o=parseInt(window.getComputedStyle(document.getElementById("".concat(e.jSPlugin.id,"-canvas-container"))).height,10)),document.getElementById("".concat(e.jSPlugin.id,"-headControl"))&&(a=parseInt(window.getComputedStyle(document.getElementById("".concat(e.jSPlugin.id,"-headControl"))).height,10)),console.log("this.jSPlugin.JS_Resiz",o,a,document.body.clientWidth),e.jSPlugin.jSPlugin.JS_Resize(window.screen.width,window.screen.height-o-a)}))["catch"]((function(e){console.log(e)}))}},{key:"expend",value:function(){var e=this,t=this.decoderState.state,i=t.webExpend;t.expend;var n=t.play;if(t.pantile,!n)return!1;if(i)return console.log("正在网站全屏"),!1;if(console.log("执行全局全屏"),this.isMobile){var o=parseInt(getComputedStyle(document.getElementById("".concat(this.jSPlugin.id,"-wrap"))).height,10)-parseInt(getComputedStyle(document.getElementById(this.jSPlugin.id)).height,10);x(document.getElementById("".concat(this.jSPlugin.id,"-wrap"))),setTimeout((function(){var t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;document.getElementById("".concat(e.jSPlugin.id)).style["backface-visibility"]="hidden",e.jSPlugin.jSPlugin.JS_Resize(i,t-o)}),100)}else{var a=R(document.getElementById("".concat(this.jSPlugin.id)));a.then((function(t){e.jSPlugin.jSPlugin.JS_Resize(window.screen.width,window.screen.height)}))["catch"]((function(e){console.log(e)}))}}}]),e}(),nt=function(){function e(t,i){p(this,e),this.jSPlugin=t,this.isMobile=i,this.timer=null,this.initToastCustom()}return f(e,[{key:"initToastCustom",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-wrap-Toast-custom"))?document.getElementById("".concat(this.jSPlugin.id,"-wrap-Toast-custom")).style.display="none":this.randerToast()}},{key:"randerToast",value:function(){var e=this.jSPlugin.width,t=1;t=this.isMobile?e/375||1:e/1024||1;var i=document.getElementById("".concat(this.jSPlugin.id,"-wrap")),n=document.createElement("div");n.style="display:none;position:absolute;top:0;width: 100%;align-items: center;justify-content: center;",n.id="".concat(this.jSPlugin.id,"-wrap-Toast-custom"),this.isMobile?n.innerHTML='<div id="'.concat(this.jSPlugin.id,'-wrap-Toast-custom-content" \n            style="padding: ').concat(12*t,"px ").concat(20*t,"px;font-size: ").concat(16*t,"px;line-height:").concat(16*t,"px;border-radius: ").concat(8*t,"px;margin-top: ").concat(667*t*.53,'px;\n            background-color: rgba(0,0,0,0.8);color:rgba(255,255,255,0.90);box-sizing: border-box;z-index: 999;">\n            </div>\n            '):n.innerHTML='<div id="'.concat(this.jSPlugin.id,'-wrap-Toast-custom-content" \n            style="padding: ').concat(20*t,"px ").concat(32*t,"px;font-size: ").concat(24*t,"px;line-height:").concat(24*t,"px;border-radius: ").concat(12*t,"px;margin-top: ").concat(36*t,'px;\n            background-color: rgba(0,0,0,0.7);color:rgba(255,255,255,0.90);box-sizing: border-box;z-index: 999;">\n            </div>\n            '),i.insertBefore(n,document.getElementById(this.jSPlugin.id))}},{key:"initToastContent",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;console.log("content----------------",e),this.timer=null,document.getElementById("".concat(this.jSPlugin.id,"-wrap-Toast-custom"))?(document.getElementById("".concat(this.jSPlugin.id,"-wrap-Toast-custom")).style.display="flex",document.getElementById("".concat(this.jSPlugin.id,"-wrap-Toast-custom-content")).innerText=e||"",this.timer=setTimeout((function(){document.getElementById("".concat(t.jSPlugin.id,"-wrap"))&&document.getElementById("".concat(t.jSPlugin.id,"-wrap-Toast-custom"))&&document.getElementById("".concat(t.jSPlugin.id,"-wrap")).removeChild(document.getElementById("".concat(t.jSPlugin.id,"-wrap-Toast-custom")))}),i)):(this.randerToast(),this.initToastContent(e))}}]),e}(),ot=function(e,t,i){var n=function(e){console.log(e),t(e)},o=function(e){console.log(e),i(e)},a=new FormData;a.append("deviceSerial",j(e.url).deviceSerial),a.append("cmd","open"),e.accessToken;var r="".concat(e.env.domain,"/api/v3/device/acs/remote/door?accessToken=").concat(e.accessToken);fetch(r,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){console.log("get theme data",e),n(e)}))["catch"]((function(e){o(e)}))},at=function(e,t,i){var n=function(e){console.log(e),t(e)},o=function(e){console.log(e),i(e)},a={accessToken:e.accessToken,pageStart:0,pageSize:4,default:!0,voiceName:"轻应用语音文件"},r={"Content-Type":"application/x-www-form-urlencoded"},s="".concat(e.env.domain,"/api/lapp/voice/query");We(s,"POST",a,n,o,r)},rt=function(e,t,i,n){var o=function(e){console.log(e),i(e)},a=function(e){console.log(e),n(e)},r="".concat(e.env.domain,"/api/lapp/voice/send"),s=new FormData;s.append("deviceSerial",j(e.url).deviceSerial),s.append("accessToken",e.accessToken),s.append("channelNo",j(e.url).channelNo||1),s.append("fileUrl",t),fetch(r,{method:"POST",body:s}).then((function(e){return e.json()})).then((function(e){o(e)}))["catch"]((function(e){a(e)}))},st=function(){function e(t,i){p(this,e),this.jSPlugin=t,this.videoWidth=t.width,this.switchFooter=i,this.sendLoadingStats=!1,this.toastCustom=new nt(t,!1),this.quickReplyList=["你好，请将快递放在门口","你好，稍等","你好，请将快递放入小区快递柜","你好，请将外卖放在门口"],this.initQuickReply()}return f(e,[{key:"initQuickReply",value:function(){document.getElementById("pc-quickReply-back")||this.renderQuickReply(),document.getElementById("pc-quickReply-back-item-0")||this.getQuickReplyList()}},{key:"renderQuickReply",value:function(){var e=this,t=this.videoWidth/1024||1,i=document.createElement("div");i.style="width:100%;",i.innerHTML='<div style="width:100%;display:flex;flex-direction:row;align-items: center;">\n        <div id="pc-quickReply-back" style="display: flex;align-items: center;margin: 0 '.concat(8*t,"px 0 ").concat(16*t,'px;cursor: pointer;">\n            <div style="height: ').concat(32*t,'px;">\n                <svg width="').concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                    <title>返回</title>\n                    <defs>\n                        <filter id="filter-1">\n                            <feColorMatrix in="SourceGraphic" type="matrix" values="0 0 0 0 1.000000 0 0 0 0 1.000000 0 0 0 0 1.000000 0 0 0 1.000000 0"></feColorMatrix>\n                        </filter>\n                    </defs>\n                    <g id="控件" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <g id="快速回复loading" transform="translate(-16.000000, -497.000000)">\n                            <g id="返回" transform="translate(0.000000, 425.000000)" filter="url(#filter-1)">\n                                <g transform="translate(16.000000, 72.000000)">\n                                    <rect id="Rectangle" x="0" y="0" width="32" height="32"></rect>\n                                    <path d="M12.5,7.5 C13.2988404,7.5 13.9518304,8.12445998 13.9974537,8.91186361 L14,9 L14,21.5 L26.5,21.5 C27.2988404,21.5 27.9518304,22.12446 27.9974537,22.9118636 L28,23 C28,23.7988404 27.37554,24.4518304 26.5881364,24.4974537 L26.5,24.5 L12.5,24.5 C11.7011596,24.5 11.0481696,23.87554 11.0025463,23.0881364 L11,23 L11,9 C11,8.17157288 11.6715729,7.5 12.5,7.5 Z" id="Path" fill="#FFFFFF" fill-rule="nonzero" transform="translate(19.500000, 16.000000) rotate(45.000000) translate(-19.500000, -16.000000) "></path>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </div>\n            <span style="font-size: ').concat(24*t,'px;">返回</span>\n        </div>\n        <div id="pc-quickReply-content" style="display: block;width:calc(100% - ').concat(160*t,"px);margin: 0 ").concat(24*t,'px;"></div>\n        <div id="pc-quickReply-loading" style="display: none;width:calc(100% - ').concat(160*t,"px);margin: 0 ").concat(24*t,'px;"></div>\n        <div id="pc-quickReply-loaderror" style="display: none;width:calc(100% - ').concat(160*t,"px);margin: 0 ").concat(24*t,'px;"></div>\n    </div>'),document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReply")).appendChild(i),document.getElementById("pc-quickReply-back").onclick=function(){e.switchFooter("onBell")}}},{key:"matchQuickReplyBtn",value:function(){var e=this,t=this.videoWidth/1024||1,i=document.getElementById("pc-quickReply-content");this.quickReplyList&&this.quickReplyList.length>0&&this.quickReplyList.forEach((function(n,o){var a=document.createElement("div");a.id="pc-quickReply-back-item-".concat(o),a.style="margin: ".concat(8*t,"px 0 ").concat(8*t,"px ").concat(8*t,"px;cursor: pointer;\n            padding: 0 ").concat(20*t,"px;min-height: ").concat(64*t,"px;width:calc(50% - ").concat(16*t,"px);\n            display: inline-block;background: rgba(0,0,0,0.70);border-radius: 8px;text-align: center;\n            box-sizing: border-box;font-size:").concat(24*t,"px;color: rgba(255,255,255,0.90);"),a.innerHTML='<div id="pc-quickReply-back-item-box-'.concat(o,'">\n            <span id="pc-quickReply-name-').concat(o,'" style="line-height: ').concat(64*t,'px;">').concat(n.voiceName,"</span>\n            </div>"),a.onclick=function(){e.sendLoadingStats||(console.log("item:"+n),e.sendQuickReply(n,o))},i.appendChild(a)}))}},{key:"setBtnCheckLoading",value:function(e,t){var i=this.videoWidth/1024||1;if(t>-1){document.getElementById("pc-quickReply-back-item-".concat(t));var n=document.getElementById("pc-quickReply-back-item-box-".concat(t)),o=document.getElementById("pc-quickReply-name-".concat(t));if(1==e){var a=document.getElementById("pc-quickReply-icon-loading-".concat(t));a&&o&&n.removeChild(a)}else if(o){var r=document.createElement("span");r.id="pc-quickReply-icon-loading-".concat(t),r.style="vertical-align: middle;margin-right:".concat(16*i,"px;"),r.innerHTML='<svg width="'.concat(30*i,'" height="').concat(30*i,'" t="1567069979438" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#ffffff" p-id="2400"></path></svg>'),n.insertBefore(r,o)}}}},{key:"getQuickReplyList",value:function(){var e=this;console.log("getQuickReplyList"),this.madeLoadingDom(0);var t=function(t){if(t&&200==t.code){var i=t.data||[],n=[];t.data.forEach((function(e,t){n=e.voiceName.split("_"),i[t].voiceName=n[1]})),e.quickReplyList=i,setTimeout((function(){e.madeLoadingDom(2)}),500)}else e.madeLoadingDom(1)},i=function(t){console.log(t),e.madeLoadingDom(1)};at(this.jSPlugin,t,i)}},{key:"madeLoadingDom",value:function(e){var t=this,i=this.videoWidth/1024||1;if(0==e){if(document.getElementById("pc-quickReply-content").style.display="none",document.getElementById("pc-quickReply-loaderror").style.display="none",document.getElementById("pc-quickReply-loading").style.display="block",!document.getElementById("pc-quickReply-loading-box")){var n=document.createElement("div");n.id="pc-quickReply-loading-box",n.style="width: 100%;display: flex;align-items: center;justify-content: center;flex-direction: column;",n.innerHTML='<div class="" style="heigth:'.concat(40*i,'px">\n                <svg width="').concat(40*i,'" height="').concat(40*i,'" t="1567069979438" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#ffffff" p-id="2400"></path></svg>\n            </div>\n            <div style="font-size: ').concat(28*i,"px;margin-top:").concat(10*i,"px;line-height:").concat(36*i,'px;">加载中…</div>'),document.getElementById("pc-quickReply-loading").appendChild(n)}}else if(1==e){if(document.getElementById("pc-quickReply-content").style.display="none",document.getElementById("pc-quickReply-loading").style.display="none",document.getElementById("pc-quickReply-loaderror").style.display="block",!document.getElementById("pc-quickReply-loaderror-box")){var o=document.createElement("div");o.id="pc-quickReply-loaderror-box",o.style="width: 100%;display: flex;align-items: center;justify-content: center;flex-direction: column;",o.innerHTML='<div style="font-size: '.concat(28*i,'px;color: rgba(255,255,255,0.90);">快速回复加载失败</div>\n            <div id="pc-quickReply-loaderror-reload" style="font-size: ').concat(24*i,"px;margin-top:").concat(16*i,'px;color: rgba(100,143,252,0.90);cursor: pointer;">重新加载</div>'),document.getElementById("pc-quickReply-loaderror").appendChild(o),document.getElementById("pc-quickReply-loaderror-reload").onclick=function(){t.getQuickReplyList()}}}else document.getElementById("pc-quickReply-loading").style.display="none",document.getElementById("pc-quickReply-loaderror").style.display="none",document.getElementById("pc-quickReply-content").style.display="block",this.matchQuickReplyBtn()}},{key:"sendQuickReply",value:function(e,t){var i=this;this.sendLoadingStats=!0,this.setBtnCheckLoading(0,t);var n=function(e){i.sendLoadingStats=!1,i.setBtnCheckLoading(1,t),e&&200==e.code?i.toastCustom.initToastContent("快捷回复成功"):i.toastCustom.initToastContent("快捷回复失败，请重试"),i.switchFooter("onBell")},o=function(e){console.log(e),i.sendLoadingStats=!1,i.setBtnCheckLoading(1,t),i.toastCustom.initToastContent("快捷回复失败，请重试"),i.switchFooter("onBell")};rt(this.jSPlugin,e.fileUrl,n,o)}}]),e}(),dt=function(){function e(t,i){p(this,e),this.jSPlugin=t,this.videoWidth=t.width,this.switchFooter=i,this.toastCustom=new nt(t,!1),this.lockStatus=!1,this.initRemoteUnlock()}return f(e,[{key:"initRemoteUnlock",value:function(){document.getElementById("pc-remoteUnlock-back")?this.madeSlideEvent():this.renderRemoteUnlock()}},{key:"renderRemoteUnlock",value:function(){var e=this,t=this.videoWidth/1024||1,i=document.createElement("div");i.style="width:100%;",i.id="pc-remoteUnlock-box",i.innerHTML='<div style="width:100%;display:flex;flex-direction:row;align-items: center;">\n        <div id="pc-remoteUnlock-back" style="display: flex;align-items: center;margin: 0 '.concat(8*t,"px 0 ").concat(16*t,'px;cursor: pointer;">\n            <div style="height: ').concat(32*t,'px;">\n                <svg width="').concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                    <title>返回</title>\n                    <defs>\n                        <filter id="filter-1">\n                            <feColorMatrix in="SourceGraphic" type="matrix" values="0 0 0 0 1.000000 0 0 0 0 1.000000 0 0 0 0 1.000000 0 0 0 1.000000 0"></feColorMatrix>\n                        </filter>\n                    </defs>\n                    <g id="控件" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <g id="快速回复loading" transform="translate(-16.000000, -497.000000)">\n                            <g id="返回" transform="translate(0.000000, 425.000000)" filter="url(#filter-1)">\n                                <g transform="translate(16.000000, 72.000000)">\n                                    <rect id="Rectangle" x="0" y="0" width="32" height="32"></rect>\n                                    <path d="M12.5,7.5 C13.2988404,7.5 13.9518304,8.12445998 13.9974537,8.91186361 L14,9 L14,21.5 L26.5,21.5 C27.2988404,21.5 27.9518304,22.12446 27.9974537,22.9118636 L28,23 C28,23.7988404 27.37554,24.4518304 26.5881364,24.4974537 L26.5,24.5 L12.5,24.5 C11.7011596,24.5 11.0481696,23.87554 11.0025463,23.0881364 L11,23 L11,9 C11,8.17157288 11.6715729,7.5 12.5,7.5 Z" id="Path" fill="#FFFFFF" fill-rule="nonzero" transform="translate(19.500000, 16.000000) rotate(45.000000) translate(-19.500000, -16.000000) "></path>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </div>\n            <span style="font-size: ').concat(24*t,'px;user-select: none;">返回</span>\n        </div>\n        <div id="pc-remoteUnlock-content" style="display: block;width:calc(100% - ').concat(160*t,"px);margin: 0 ").concat(24*t,'px;"></div>\n    </div>'),document.getElementById("".concat(this.jSPlugin.id,"-audioControls-remoteUnlock")).appendChild(i),document.getElementById("pc-remoteUnlock-back").onclick=function(){e.goback()},this.renderRemoteUnlockSlide()}},{key:"renderRemoteUnlockSlide",value:function(){var e=this.videoWidth/1024||1,t=document.getElementById("pc-remoteUnlock-content"),i=document.createElement("div");i.id="pc-remoteUnlock-content-slide",i.style="width: 100%;display: flex;justify-content: center;cursor: pointer;",i.innerHTML='<div id="pc-remoteUnlock-slide-box" style="width: '.concat(400*e,"px;line-height: ").concat(80*e,"px;height: ").concat(80*e,"px;border: 1px solid rgba(255,255,255,1);border-radius: ").concat(40*e,'px;position: relative;text-align: center;">\n        <div id="pc-remoteUnlock-slide-bgColor" style="border-radius: ').concat(40*e,"px;width: ").concat(64*e,"px;height: ").concat(80*e,'px;position: absolute;left: 0;top: 0;"></div>\n        <div id="pc-remoteUnlock-slide-tips" style="height: ').concat(80*e,"px;line-height: ").concat(80*e,"px;font-size: ").concat(24*e,"px;border-radius: ").concat(40*e,'px;position: absolute;text-align: center;user-select: none;color: rgba(255,255,255,0.90);width: 100%;">右滑开锁</div>\n        <div id="pc-remoteUnlock-slide-ball" style="top: ').concat(8*e,"px;left: ").concat(8*e,"px;width: ").concat(64*e,"px;height: ").concat(64*e,'px;background: #598FFF;position: absolute;text-align: center;border-radius:50%;display: flex;align-items: center;justify-content: center;">\n            <svg id="slide-ball-start" style="display: inline;" width="').concat(36*e,'px" height="').concat(36*e,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <title></title>\n                <g id="icon/箭头向右" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <rect id="矩形" fill="#000000" fill-rule="nonzero" opacity="0" x="0" y="0" width="24" height="24"></rect>\n                    <path d="M14.2841136,6.3689007 L19.9432338,12.0287579 L14.2863796,17.6856122 L12.8580239,16.2572565 L16.114,12.9999007 L4.00000001,13 L4.00000001,11 L16.058,10.9999007 L12.8557579,7.79725638 L14.2841136,6.3689007 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                </g>\n            </svg>\n            <svg id="slide-ball-end"  style="display: none;" width="').concat(36*e,'" height="').concat(36*e,'" t="1567069979438" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#598FFF" p-id="2400"></path></svg>\n            \n        </div>\n    </div>'),t.appendChild(i),this.madeSlideEvent()}},{key:"getOffsetLeft",value:function(e){var t=0;do{t+=e.offsetLeft,e=e.parentNode}while(e.parentNode);return t}},{key:"madeSlideEvent",value:function(){var e=this.videoWidth/1024||1,t=document.getElementById("".concat(this.jSPlugin.id)),i=this.getOffsetLeft(t),n=document.getElementById("pc-remoteUnlock-slide-box"),o=document.getElementById("pc-remoteUnlock-slide-bgColor"),a=document.getElementById("pc-remoteUnlock-slide-tips"),r=document.getElementById("pc-remoteUnlock-slide-ball"),s=this;function d(){s.lockStatus||(s.lockStatus=!0,document.getElementById("slide-ball-start").style.display="none",document.getElementById("slide-ball-end").style.display="inline",o.style.width=n.clientWidth+"px",o.style.backgroundColor="#598FFF",n.style.border="0",r.style.backgroundColor="#ffffff",a.textContent="正在开锁",r.onmousedown=null,document.onmousemove=null,s.sendRemoteUnlockApi())}r.onmousedown=function(t){t=t||window.event;var a=t.offsetX;r.style.transition="",o.style.transition="",document.onmouseup=function(){console.log("--------------onmouseup"),s.lockStatus||(o.style.width="0px",r.style.left=8*e+"px",r.style.transition="left 0.6s linear",o.style.transition="width 0.6s linear"),document.onmouseup=null,document.onmousemove=null},document.onmousemove=function(t){t=t||window.event;console.log("videoDom",i);var o=t.pageX-n.offsetLeft-a-i,l=n.clientWidth-r.clientWidth-8*e;o<=0&&(o=0),o>=l&&(o=l),r.style.left=o+"px",o!=l||s.lockStatus||d()}}}},{key:"resetRemoteUnlockSlide",value:function(){var e=document.getElementById("pc-remoteUnlock-box"),t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-remoteUnlock"));e&&t&&t.removeChild(e)}},{key:"sendRemoteUnlockApi",value:function(){var e=this;console.log("下发远程开锁");var t=function(t){t&&200==t.code?e.toastCustom.initToastContent("开锁成功"):e.toastCustom.initToastContent("开锁失败，请重试"),e.goback()},i=function(t){console.log(t),e.toastCustom.initToastContent("开锁失败，请重试"),e.goback()};ot(this.jSPlugin,t,i)}},{key:"goback",value:function(){this.switchFooter("onCall"),this.resetRemoteUnlockSlide()}}]),e}(),lt={customConfig:{defaultMicro:0,defaultPlay:0,maxTalkTime:0,bellPoster:0,maxBellTime:0},header:{onBell:{color:"#2c2c2c",backgroundColor:"#00000000 linear-gradient(180deg, rgba(0,0,0,0.65) 0%, rgba(0,0,0,0.00) 100%)",activeColor:"#1890FF",autoFocus:0,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-0",iconId:"ringStatus",part:"left",defaultActive:0,isrender:1,color:"#ffffff",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-1",iconId:"deviceCategory",part:"left",defaultActive:0,isrender:1,color:"#ffffff",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"}]},onCall:{color:"#2c2c2c",backgroundColor:"#00000000",activeColor:"#1890FF",autoFocus:5,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-0",iconId:"callStatus",part:"left",defaultActive:0,isrender:1,color:"#ffffff",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-1",iconId:"deviceCategory",part:"left",defaultActive:0,isrender:1,color:"#ffffff",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"}]}},footer:{onBell:{color:"#ffffff",backgroundColor:"#00000000",activeColor:"#1890FF",autoFocus:5,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-0",iconId:"quickReply",part:"left",defaultActive:1,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-1",iconId:"rejection",part:"left",defaultActive:0,isrender:1,color:"#2C2C2C",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-2",iconId:"answer",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-3",iconId:"remoteUnlock",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"}]},onCall:{color:"#2c2c2c",backgroundColor:"#00000080",activeColor:"#1890FF",autoFocus:5,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-0",iconId:"mute",part:"left",defaultActive:1,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-1",iconId:"hangUp",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-2",iconId:"remoteUnlock",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"}]}}},ct={data:lt},ut=function(e){var t="";return Object.keys(e).map((function(i,n){t+="".concat(i,":").concat(e[i]).concat(n<Object.keys(e).length-1?";":"")})),t},mt=function(){function e(t,i,n,o){var a=this;p(this,e),g(this,"autoPlayRing",(function(){console.log("autoPlayRing");var e=document.getElementById("bellring-audio");e&&(e.muted=!1,e.src="https://resource.eziot.com/group2/M00/00/8F/CtwQFmPbWnOAGuT5AAHZihhCJEM230.mp3",e.paused&&e.play()),window.removeEventListener("click",a.autoPlayRing)})),g(this,"muteCommon",(function(e){var t=a.decoderState.state,i=t.talk,n=t.sound;i?(console.log("结束对讲"),a.setDecoderState({talk:!1,mute:!0},e.backgroundColor),a.jSPlugin.Talk.stopTalk(),n||a.jSPlugin.openSound(),a.setDecoderState({sound:!0})):(a.setDecoderState({talk:!1,mute:!0},e.backgroundColor),n||a.jSPlugin.openSound(),a.setDecoderState({sound:!0}))})),g(this,"switchCallStatus",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=a.themeData,n=i.header,o=i.footer,r=null;if("onCall"==e){console.log("接听"),a.bellStatus="onCall",a.switchFooter("onCall"),o[a.bellStatus].btnList.map((function(e,t){e.isrender&&a.renderFooter(e.iconId,e),"mute"==e.iconId&&(r=e)})),n[a.bellStatus].btnList.map((function(e,t){e.isrender&&a.renderHeader(e.iconId,e)}));var s=document.getElementById("".concat(a.jSPlugin.id,"-header-onBell"));s&&s.parentElement.removeChild(s),1==a.themeData.customConfig.bellPoster&&document.getElementById("bellring-icon")&&document.getElementById("".concat(a.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon")),0==a.themeData.customConfig.defaultMicro&&r?a.muteCommon(r):a.setDecoderState({mute:!1},r.backgroundColor),a.removeBellRing()}else console.log("响铃"),a.bellStatus="onBell",a.jSPlugin.Theme.changeTheme(a.themeData,t)})),this.jSPlugin=t,this.videoWidth=t.width,this.videoHeight=t.height,this.themeData=i,this.setDecoderState=n,this.decoderState=o,this.isNeedRenderHeader=!1,this.isNeedRenderFooter=!1,this.autoFocus=0,this.autoFocusTimer=null,this.bellStatus="onBell",this.recordTimer=null,this.nextRate=1,this.themeInited=!1,this.inited=!1,this.activeThemeStatus=!0,this.activeThemeStatusTxt="模板未激活",this.toastCustom=new nt(t,!1)}return f(e,[{key:"initBellRing",value:function(){var e=this,t=this.decoderState.state,i=t.play,n=t.isEditing;t.rejection;var o=this.videoWidth,a=o/1024;this.maxBellTime=1e3*this.themeData.customConfig.maxBellTime;var r=document.getElementById("bellring"),s=document.getElementById("bellring-audio");if(!r&&!s){if(this.jSPlugin.isNeedBellRing){var d=document.createElement("div");d.id="bellring",d.innerHTML='<div>\n          <audio id="bellring-audio" loop autoplay>\n            <source src="https://resource.eziot.com/group2/M00/00/8F/CtwQFmPbWnOAGuT5AAHZihhCJEM230.mp3" type="audio/mpeg">\n          </audio>\n          </div>',document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(d)}if(1!=this.themeData.customConfig.bellPoster||n)document.getElementById("bellring-icon")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon"));else{var l=(this.videoHeight-180*a)/2,c=document.createElement("div");c.id="bellring-icon",c.style="position: absolute;pointer-events: none;background: none;width: 100%;\n          position: absolute;top: ".concat(l,"px;display: flex;align-items: center;justify-content: center;"),c.innerHTML='<div style="width: '.concat(180*a,"px;height: ").concat(180*a,'px;display: flex;align-items: center;justify-content: center;border: 1px solid rgba(255,255,255,0.2);border-radius: 50%;">\n            <div style="width: ').concat(100*a,"px;height: ").concat(100*a,'px;display: flex;align-items: center;justify-content: center;border: 1px solid rgba(255,255,255,0.3);border-radius: 50%;">\n              <svg width="').concat(40*a,'px" height="').concat(40*a,'px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <title>icon/响铃</title>\n                  <g id="icon/响铃" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                      <polygon id="Path" points="0 0 40.0000002 0 40.0000002 40.0000002 0 40.0000002"></polygon>\n                      <path d="M20.0000001,4.25000002 C22.0363461,4.25000002 23.698175,5.84879552 23.8000507,7.8591997 L23.8050001,8.05500003 L23.805316,8.99953253 C27.1874196,9.97041766 29.6921839,13.0354462 29.80936,16.723731 L29.80936,16.723731 L29.8133335,16.9800001 L29.8133335,21.6416668 C29.8133335,22.3259481 30.0858837,22.9835569 30.5703302,23.4680033 L30.5703302,23.4680033 L31.6386635,24.5363367 C32.338953,25.2366262 32.760721,26.1675592 32.8273086,27.1785295 L32.8273086,27.1785295 L32.8350001,27.4233334 C32.8350001,29.577547 31.0892137,31.3233335 28.9350001,31.3233335 L28.9350001,31.3233335 L24.5666667,31.323 L24.5650266,31.3951531 C24.4527075,33.8194458 22.4520933,35.7500001 20.0000001,35.7500001 C17.5482065,35.7500001 15.5473098,33.8197367 15.4349743,31.3967059 L15.4326667,31.323 L11.0666667,31.3233335 C9.06159524,31.3233335 7.39851917,29.8069287 7.18810198,27.8229374 L7.17194359,27.6230185 L7.1666667,27.4233334 C7.1666667,26.3411154 7.59733134,25.3020086 8.36300328,24.5363367 L8.36300328,24.5363367 L9.43133662,23.4680033 C9.91578309,22.9835569 10.1883334,22.3259481 10.1883334,21.6416668 L10.1883334,21.6416668 L10.1883334,16.9800001 C10.1883334,13.1909619 12.7263704,9.99530436 16.1948593,8.99965364 L16.1950001,8.05500003 C16.1950001,5.95360729 17.8979654,4.25000002 20.0000001,4.25000002 Z M23.0656667,31.323 L16.9336667,31.323 L16.9352114,31.3619281 C17.0285826,32.9723844 18.3649772,34.2500001 20.0000001,34.2500001 C21.6352227,34.2500001 22.9714318,32.9721919 23.0647896,31.3604131 L23.0656667,31.323 Z M21.5116668,10.1783334 L18.4900001,10.1783334 C14.7336124,10.1783334 11.6883334,13.2231481 11.6883334,16.9800001 L11.6883334,16.9800001 L11.6883334,21.6416668 C11.6883334,22.7238848 11.2576687,23.7629916 10.4919968,24.5286635 L10.4919968,24.5286635 L9.42366346,25.5969969 C8.93921698,26.0814433 8.6666667,26.7390521 8.66637526,27.402427 L8.66637526,27.402427 L8.67048222,27.560237 C8.74130967,28.8268108 9.79171396,29.8233335 11.0666667,29.8233335 L11.0666667,29.8233335 L23.7906939,29.8222289 C23.8004164,29.8218553 23.8101862,29.8216668 23.8200001,29.8216668 L23.8486667,29.823 L28.9350001,29.8233335 C30.2055455,29.8233335 31.2450456,28.8367727 31.329826,27.609522 L31.3354106,27.4481422 L31.3293607,27.2529336 C31.2880301,26.6292837 31.0210852,26.0400787 30.5780034,25.5969969 L30.5780034,25.5969969 L29.50967,24.5286635 C28.7439981,23.7629916 28.3133335,22.7238848 28.3133335,21.6416668 L28.3133335,21.6416668 L28.3134279,16.9919039 L28.3098332,16.759466 C28.1934023,13.0970787 25.1864454,10.1783334 21.5116668,10.1783334 L21.5116668,10.1783334 Z M20.0000001,5.75000002 C18.7795808,5.75000002 17.7813801,6.69770708 17.7003155,7.89717688 L17.6950001,8.05500003 L17.6952875,8.7158769 C17.9568453,8.69103758 18.2219393,8.67833337 18.4900001,8.67833337 L18.4900001,8.67833337 L21.5116668,8.67833337 C21.7792577,8.67833337 22.0439466,8.69101238 22.3051575,8.71580951 L22.3050001,8.05500003 C22.3050001,6.7819079 21.273481,5.75000002 20.0000001,5.75000002 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                  </g>\n              </svg>\n            </div>\n          </div>'),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(c),i&&"onBell"==this.bellStatus&&this.jSPlugin.pause()}setTimeout((function(){var t=e.decoderState.state,i=t.isEditing,n=t.rejection;"onBell"!=e.bellStatus||n||(e.removeBellRing(),i||e.answerOvertime())}),this.maxBellTime)}}},{key:"removeBellRing",value:function(){document.getElementById("bellring")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring")),document.getElementById("bellring-icon")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon"))}},{key:"matchBtn",value:function(e,t){var i=this,n=this.themeData,o=n.header,a=n.footer,r=this.decoderState.state,s=r.mute,d=r.rejection,l={title:"",id:"",domString:"",color:"#FFFFFF",activeColor:"#FFFFFF",onclick:function(){},onmoveleft:function(){},onmoveright:function(){},onremove:function(){}},c=o[this.bellStatus].btnList.findIndex((function(t){return t.iconId===e}));-1===c?(l.color=a[this.bellStatus].color,l.backgroundColor=a[this.bellStatus].backgroundColor,l.activeColor=a[this.bellStatus].activeColor):(l.color=o[this.bellStatus].color,l.backgroundColor=o[this.bellStatus].backgroundColor,l.activeColor=o[this.bellStatus].activeColor);var u=this.videoWidth/6;this.videoWidth;var m=this.videoWidth/1024||1;switch(e){case"ringStatus":return l.title=this.activeThemeStatus?"有人按门铃":this.activeThemeStatusTxt,l.id=e,l.domString='<span id="header-onBell-ringStatus" style="color:'.concat(t.color||"#FFFFFF",";font-size: ").concat(32*m,'px;display: block;text-align: left;font-weight: 500;" >').concat(this.activeThemeStatus?"有人按门铃":this.activeThemeStatusTxt,"</span>"),l.onclick=function(){},l;case"deviceCategory":return l.title="设备名称",l.id=e,l.domString='<span id="header-onBell-deviceCategory" \n          style="\n          color:'.concat(t.color||"#FFFFFF",";\n          font-size: ").concat(24*m,"px;\n          padding-top: ").concat(16*m,'px;\n          display: block;\n          max-width: 100%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          text-align: left;\n          ">').concat(this.deviceInfoData&&this.deviceInfoData.deviceName||"设备名称","</span>"),l.onclick=function(){},l;case"callStatus":return l.title="通话中",l.id=e,l.domString='<span id="header-onCall-ringStatus" style="color:'.concat(t.color||"#FFFFFF",";font-size: ").concat(32*m,'px;display: block;text-align: left;" >通话中</span>'),l.onclick=function(){},l;case"deviceCategory":return l.title="设备名称",l.id=e,l.domString='<span id="header-onCall-deviceCategory"\n           style="color:'.concat(t.color||"#FFFFFF",";\n           font-size: ").concat(24*m,"px;\n           padding-top: ").concat(16*m,'px;\n           display: block;\n           max-width: 100%;\n           overflow: hidden;\n           text-overflow: ellipsis;\n           white-space: nowrap;\n           text-align: left;\n           ">').concat(this.deviceInfoData&&this.deviceInfoData.deviceName||"设备名称","</span>"),l.onclick=function(){},l;case"rejection":return l.title="拒绝",l.id=e,l.domString='<div style="width: '.concat(.7*u,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width:').concat(.5*u,"px;height: ").concat(.5*u,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.3*u,'px" height="').concat(.3*u,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>拒绝</title>\n                        <g id="icon/拒绝" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M16.0428281,19.9522968 C13.5228132,17.435123 11.1135994,14.5173605 12.2699084,13.3638925 C13.9205608,11.7132401 15.3581341,10.6961428 12.4346895,7.05675259 C9.50840386,3.41452132 7.55659974,6.21011849 5.95708632,7.80963191 C4.11324225,9.65631703 5.86049048,16.5345088 12.6591328,23.3359922 C19.4577751,30.1346345 26.3388079,31.8847238 28.1854931,30.0380386 C29.7850065,28.4385252 32.5806036,26.4895622 28.9412134,23.5632765 C25.3018232,20.6369909 24.2847259,22.0745642 22.6340735,23.7280576 C21.4777645,24.8786845 18.5628431,22.4694707 16.0428281,19.9522968 Z" id="路径" fill="#FFFFFF" fill-rule="nonzero" transform="translate(17.997936, 17.998157) rotate(135.000000) translate(-17.997936, -17.998157) "></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*u,'px;user-select: none;">拒绝</div>\n            </div>'),l.onclick=function(){var e=i.decoderState.state,t=e.play,n=e.isEditing,o=e.rejection;if(n||o)return!1;console.log("拒绝"),t&&i.jSPlugin.stop(),i.removeBellRing(),i.setDecoderState({play:!1,rejection:!0}),i.rejectionStatusDispose(),"function"===typeof i.jSPlugin.hangUpCallback&&i.jSPlugin.hangUpCallback("rejection")},l;case"quickReply":return l.title="快捷回复",l.id=e,l.domString='<div style="width: '.concat(.7*u,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width: ').concat(.5*u,"px;height: ").concat(.5*u,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.3*u,'px" height="').concat(.3*u,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>快捷回复</title>\n                        <g id="icon/web快捷回复" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M17.4723401,6.00464509 C24.1317208,5.8200623 29.613145,11.1601938 29.613145,17.806299 C29.613145,19.5506656 29.2343807,21.2437888 28.5133012,22.7904909 L28.638,22.51 L29.9802796,28.9334997 C30.0980856,29.4978889 29.6719785,30.0050773 29.131395,30.0271186 L29.0218792,30.0249315 L28.9025577,30.0074816 L22.488349,28.6446207 L22.3501503,28.7067675 C21.0679643,29.242563 19.6940914,29.5480927 18.2793303,29.6038407 L18.2793303,29.6038407 L17.8062986,29.6131454 C11.1610025,29.6131454 5.820073,24.1313212 6.00464384,17.4723718 C6.17540866,11.3038211 11.3038207,6.17540904 17.4723401,6.00464509 Z M17.8062986,16.2974446 C16.9707372,16.2974446 16.2926003,16.9755814 16.2926003,17.8111428 C16.2926003,18.6467043 16.9707372,19.3248411 17.8062986,19.3248411 C18.64186,19.3248411 19.3199969,18.6467043 19.3199969,17.8111428 C19.3199969,16.9755814 18.64186,16.2974446 17.8062986,16.2974446 Z M12.9624642,16.2974446 C12.1269027,16.2974446 11.4487659,16.9755814 11.4487659,17.8111428 C11.4487659,18.6467043 12.1269027,19.3248411 12.9624642,19.3248411 C13.7980256,19.3248411 14.4761624,18.6467043 14.4761624,17.8111428 C14.4761624,16.9755814 13.7980256,16.2974446 12.9624642,16.2974446 Z M22.650133,16.2974446 C21.8145716,16.2974446 21.1364348,16.9755814 21.1364348,17.8111428 C21.1364348,18.6467043 21.8145716,19.3248411 22.650133,19.3248411 C23.4856945,19.3248411 24.1638313,18.6467043 24.1638313,17.8111428 C24.1638313,16.9755814 23.4856945,16.2974446 22.650133,16.2974446 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*u,'px;user-select: none;">快捷回复</div>\n            </div>'),l.onclick=function(){var e=i.decoderState.state.rejection;if(e)return!1;console.log("快捷回复"),i.switchFooter("quickReply"),i.quickReplyEle=new st(i.jSPlugin,i.switchFooter)},l;case"answer":return l.title="接听",l.id=e,l.domString='<div style="width: '.concat(.7*u,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width: ').concat(.5*u,"px;height: ").concat(.5*u,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.3*u,'px" height="').concat(.3*u,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>接听</title>\n                        <g id="icon/接听" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M15.7728281,19.6822968 C13.2528132,17.165123 10.8435994,14.2473605 11.9999084,13.0938925 C13.6505608,11.4432401 15.0881341,10.4261428 12.1646895,6.78675259 C9.23840386,3.14452132 7.28659974,5.94011849 5.68708632,7.53963191 C3.84324225,9.38631703 5.59049048,16.2645088 12.3891328,23.0659922 C19.1877751,29.8646345 26.0688079,31.6147238 27.9154931,29.7680386 C29.5150065,28.1685252 32.3106036,26.2195622 28.6712134,23.2932765 C25.0318232,20.3669909 24.0147259,21.8045642 22.3640735,23.4580576 C21.2077645,24.6086845 18.2928431,22.1994707 15.7728281,19.6822968 Z" id="路径" fill="#FFFFFF" fill-rule="nonzero" transform="translate(17.727936, 17.728157) rotate(-360.000000) translate(-17.727936, -17.728157) "></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*u,'px;user-select: none;">接听</div>\n            </div>'),l.onclick=function(){var e=i.decoderState.state,n=e.play,r=e.isEditing,s=e.talk,d=e.sound,l=e.rejection;if(r||l)return!1;console.log("接听"),i.jSPlugin.pluginStatus.loadingClear(),n||(i.jSPlugin.pluginStatus.loadingStart(i.jSPlugin.id),i.jSPlugin.pluginStatus.loadingSetText({text:"视频加载中"}),i.jSPlugin.play(),i.setDecoderState({play:!n})),s||1!=i.themeData.customConfig.defaultMicro||(i.setDecoderState({talk:!0,mute:!1}),d&&i.jSPlugin.closeSound(),i.jSPlugin.Talk.startTalk()),i.setDecoderState({sound:!1}),i.bellStatus="onCall",i.switchFooter("onCall"),a[i.bellStatus].btnList.map((function(e,t){e.isrender&&i.renderFooter(e.iconId,e)})),o[i.bellStatus].btnList.map((function(e,t){e.isrender&&i.renderHeader(e.iconId,e)}));var c=document.getElementById("".concat(i.jSPlugin.id,"-header-onBell"));c&&c.parentElement.removeChild(c),1==i.themeData.customConfig.bellPoster&&(document.getElementById("bellring-icon")&&document.getElementById("".concat(i.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon")),i.jSPlugin.setPoster("")),0==i.themeData.customConfig.defaultMicro&&(i.muteCommon(t),i.jSPlugin.openSound(),i.setDecoderState({sound:!0})),i.removeBellRing(),i.maxTalkTime=1e3*i.themeData.customConfig.maxTalkTime*60;var u=i;setTimeout((function(){s&&(console.log("结束对讲"),u.setDecoderState({talk:!1}),u.jSPlugin.Talk.stopTalk()),n&&(u.jSPlugin.stop(),u.setDecoderState({play:!n})),i.rejectionStatusDispose(),i.remoteUnlockEle&&i.remoteUnlockEle.goback(),"function"===typeof i.jSPlugin.hangUpCallback&&i.jSPlugin.hangUpCallback("hangUp")}),i.maxTalkTime)},l;case"remoteUnlock":return l.title="远程开锁",l.id=e,l.domString='<div style="width: '.concat(.7*u,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width: ').concat(.5*u,"px;height: ").concat(.5*u,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.3*u,'px" height="').concat(.3*u,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>开锁</title>\n                        <g id="icon/开锁" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M18,4 C21.3137085,4 24,6.6862915 24,10 L24,10 L24,19.787 L29.5,19.7875 C30.0522847,19.7875 30.5,20.2352153 30.5,20.7875 C30.5,21.3397847 30.0522847,21.7875 29.5,21.7875 L24,21.787 L24,26 C24,29.2383969 21.4344251,31.8775718 18.2249383,31.9958615 L18,32 C14.6862915,32 12,29.3137085 12,26 L12,26 L12,10 C12,6.6862915 14.6862915,4 18,4 Z M18,6 C15.790861,6 14,7.790861 14,10 L14,10 L14,26 C14,28.209139 15.790861,30 18,30 C20.209139,30 22,28.209139 22,26 L22,26 L22,21.787 L18.5,21.7875 C17.9477153,21.7875 17.5,21.3397847 17.5,20.7875 C17.5,20.2352153 17.9477153,19.7875 18.5,19.7875 L22,19.787 L22,10 C22,7.85780461 20.3160315,6.10892112 18.1996403,6.00489531 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*u,'px;user-select: none;">远程开锁</div>\n            </div>'),l.onclick=function(){var e=i.decoderState.state,t=e.isEditing,n=e.rejection;if(t||"onBell"==i.bellStatus||n)return!1;console.log("远程开锁"),i.switchFooter("remoteUnlock"),i.remoteUnlockEle=new dt(i.jSPlugin,i.switchFooter)},l;case"mute":return l.title="静音",l.id=e,l.domString='<div style="width: '.concat(.7*u,'px;display: flex;flex-direction: column;align-items: center;">\n                <div id="').concat(this.jSPlugin.id,'-icon-mute" style="width: ').concat(.5*u,"px;height: ").concat(.5*u,"px;border-radius: 50%;border: 1px solid ").concat(d?"#CCCCCC":t.backgroundColor,";background: ").concat(d&&s?"#cccccc":"#ffffff",';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.3*u,'px" height="').concat(.3*u,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>静音</title>\n                        <g id="icon/静音" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path id="icon-mute-path" d="M29.2988305,7.56559704 C29.8540627,8.1086468 29.8980234,8.97727504 29.4240597,9.57172938 L29.3223594,9.6867869 L22.585,16.574 L22.5859243,26.0592702 C22.5859243,26.9500521 21.8638029,27.6721735 20.973021,27.6721735 C20.6007147,27.6721735 20.2398727,27.5433734 19.9517149,27.3076254 L15.583,23.733 L10.4341733,28.9987008 C9.85492024,29.5909486 8.9052312,29.6014828 8.31298346,29.0222298 C7.75775121,28.47918 7.71379057,27.6105518 8.18775419,27.0160974 L8.28945454,26.9010399 L27.1776406,7.58912597 C27.7568937,6.99687823 28.7065827,6.98634397 29.2988305,7.56559704 Z M22.2503608,7.16816759 C22.4679282,7.45036017 22.5859243,7.79665625 22.5859243,8.15298221 L22.585,9.899 L10.778,21.971 L9.47580645,21.9713498 C7.69424274,21.9713498 6.25,20.5271071 6.25,18.7455434 L6.25,15.65293 C6.25,13.8713663 7.69424274,12.4271235 9.47580645,12.4271235 L12.787,12.427 L19.9882064,6.87564241 C20.6936617,6.33174431 21.7064627,6.46271229 22.2503608,7.16816759 Z" id="形状结合" fill="').concat(s?"#ffffff":d?"#cccccc":t.backgroundColor,'"></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*u,'px;user-select: none;">静音</div>\n            </div>'),l.onclick=function(){var e=i.decoderState.state,n=e.talk,o=e.sound;e.play;var a=e.rejection;if(a)return!1;console.log("静音"),n?(console.log("结束对讲"),i.setDecoderState({talk:!1,mute:!0},t.backgroundColor),i.jSPlugin.Talk.stopTalk(),i.jSPlugin.openSound(),i.setDecoderState({sound:!0})):(console.log("开始对讲"),i.setDecoderState({talk:!0,mute:!1},t.backgroundColor),o&&(i.jSPlugin.closeSound(),i.setDecoderState({sound:!1})),i.jSPlugin.Talk.startTalk())},l;case"hangUp":return l.title="挂断",l.id=e,l.domString='<div style="width: '.concat(.7*u,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width:').concat(.5*u,"px;height: ").concat(.5*u,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.3*u,'px" height="').concat(.3*u,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>挂断</title>\n                        <g id="icon/挂断" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M16.0428281,19.9522968 C13.5228132,17.435123 11.1135994,14.5173605 12.2699084,13.3638925 C13.9205608,11.7132401 15.3581341,10.6961428 12.4346895,7.05675259 C9.50840386,3.41452132 7.55659974,6.21011849 5.95708632,7.80963191 C4.11324225,9.65631703 5.86049048,16.5345088 12.6591328,23.3359922 C19.4577751,30.1346345 26.3388079,31.8847238 28.1854931,30.0380386 C29.7850065,28.4385252 32.5806036,26.4895622 28.9412134,23.5632765 C25.3018232,20.6369909 24.2847259,22.0745642 22.6340735,23.7280576 C21.4777645,24.8786845 18.5628431,22.4694707 16.0428281,19.9522968 Z" id="路径" fill="#FFFFFF" fill-rule="nonzero" transform="translate(17.997936, 17.998157) rotate(135.000000) translate(-17.997936, -17.998157) "></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*u,'px;">挂断</div>\n            </div>'),l.onclick=function(){var e=i.decoderState.state,t=e.talk,n=e.play,o=e.sound,a=e.rejection;if(a)return!1;t&&(console.log("结束对讲"),i.setDecoderState({talk:!1}),i.jSPlugin.Talk.stopTalk()),n&&(i.jSPlugin.stop(),i.setDecoderState({play:!n})),o&&(i.jSPlugin.closeSound(),i.setDecoderState({sound:!1})),(n||t)&&(console.log("挂断"),i.removeBellRing(),i.rejectionStatusDispose(),"function"===typeof i.jSPlugin.hangUpCallback&&i.jSPlugin.hangUpCallback("hangUp"))},l;default:return l}}},{key:"answerOvertime",value:function(){this.toastCustom.initToastContent("应答超时");var e=this.decoderState.state.play;console.log("应答超时"),e&&this.jSPlugin.stop(),this.setDecoderState({play:!1,rejection:!0}),this.rejectionStatusDispose(),this.switchFooter("onBell"),"function"===typeof this.jSPlugin.hangUpCallback&&this.jSPlugin.hangUpCallback("rejection")}},{key:"rejectionStatusDispose",value:function(){var e=this,t=this.themeData.footer,i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),n=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")),o=document.getElementById("header-".concat(this.bellStatus,"-ringStatus"));"onBell"==this.bellStatus?(i.innerHTML="",i.style.color="#ffffff"):(n.innerHTML="",n.style.color="#ffffff"),console.log("rejectionStatusDispose"),this.setDecoderState({rejection:!0}),t[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderFooter(t.iconId,t)})),o.innerText="通话已结束",this.jSPlugin.pluginStatus.loadingClear(),this.jSPlugin.pluginStatus.loadingSetTextWithBtn({text:"通话已结束",color:"white",isMobile:!1,type:2})}},{key:"userNoDevice",value:function(){var e=this;this.removeBellRing(),this.setDecoderState({rejection:!0});var t=this.themeData.footer,i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),n=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"));"onBell"==this.bellStatus?(i.innerHTML="",i.style.color="#ffffff"):(n.innerHTML="",n.style.color="#ffffff"),console.log("userNoDevice"),this.setDecoderState({rejection:!0}),t[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderFooter(t.iconId,t)})),this.jSPlugin.pluginStatus.loadingClear(),this.jSPlugin.pluginStatus.loadingSetTextWithBtn({text:"该用户不拥有该设备",color:"white",isMobile:!1,type:2})}},{key:"renderHeader",value:function(e,t){var i=this,n=this.videoWidth/1024||1,o=this.matchBtn(e,t);if(document.getElementById("".concat(this.jSPlugin.id,"-header-").concat(this.bellStatus,"-content"))){var a=document.createElement("span");a.innerHTML="".concat(o.domString),document.getElementById("".concat(this.jSPlugin.id,"-header-").concat(this.bellStatus,"-content")).appendChild(a)}else{var r=document.createElement("div");r.id="".concat(this.jSPlugin.id,"-header-").concat(this.bellStatus),r.style="max-width:50%;position:relative;",r.innerHTML='<span id="'.concat(this.jSPlugin.id,"-header-").concat(this.bellStatus,'-content" style="display:inline-block;height:auto;padding-top: ').concat(32*n,'px;";>\n        ').concat(o.domString,"\n      </span>"),r.onclick=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onclick(e)},document.getElementById("".concat(this.jSPlugin.id,"-headControl")).childNodes[0].appendChild(r)}}},{key:"renderFooter",value:function(e,t){var i=this,n=this.decoderState.state.mute;if(console.log("-------------renderFooter"),"remoteUnlock"==e&&this.jSPlugin.capacity&&(!this.jSPlugin.capacity["support_unlock"]||0==this.jSPlugin.capacity["support_unlock"]))return!1;var o=this.matchBtn(e,t),a=this.videoWidth/6,r=document.createElement("div");r.className="theme-icon-item",this.jSPlugin.isWebConsole?r.style="padding:0 ".concat(.1*a,"px;"):r.style="padding:0 ".concat(.1*a,"px;cursor: pointer;"),r.innerHTML="".concat('<span id="'.concat(this.jSPlugin.id,"-").concat(o.id,'" style="position:relative;">')+'<div id="'.concat(this.jSPlugin.id,"-").concat(o.id,'-content" title="').concat(o.title,'" style="display: flex;align-items: center;position:relative;">')).concat(o.domString,"</div>")+"</span>",r.onclick=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onclick(e)},o.onmouseenter&&(r.onmouseenter=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onmouseenter(e)}),o.onmouseleave&&(r.onmouseleave=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onmouseleave(e)});var s=this.videoWidth/597,d=document.createElement("span");d.className="icon-move left",d.innerHTML='<span id="'.concat(this.jSPlugin.id,"-").concat(o.id,'-left" title="左移" style="display: inline-block;border-radius: 2px;overflow: hidden;position: absolute;top: calc(50% - ').concat(35*s,"px); width: ").concat(10*s,"px; height: ").concat(40*s,'px;cursor: pointer;">\n        <svg width="100%" height="100%" viewBox="0 0 10 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title></title>\n              <g id="呼叫模板-控制台" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="H5呼叫模板" transform="translate(-614.000000, -5024.000000)">\n                      <g id="编组-28" transform="translate(421.000000, 4484.000000)">\n                          <g id="编组-9" transform="translate(23.000000, 522.000000)">\n                              <g id="编组" transform="translate(170.000000, 0.000000)">\n                                  <g id="箭头左" transform="translate(0.000000, 18.000000)">\n                                      <rect id="矩形" fill="#595959" x="0" y="0" width="10" height="40" rx="2"></rect>\n                                      <g id="1.通用/2.Icon图标/Common/Fill/Left" transform="translate(1.000000, 15.000000)" fill="#FFFFFF">\n                                          <path d="M3.88411064,2.46093277 L7.81658983,7.1799078 C7.99337187,7.39204625 7.96470984,7.7073286 7.75257139,7.88411064 C7.66271389,7.95899189 7.54944745,8 7.43247919,8 L-0.432479194,8 C-0.708621569,8 -0.932479194,7.77614237 -0.932479194,7.5 C-0.932479194,7.38303175 -0.891471084,7.2697653 -0.816589833,7.1799078 L3.11588936,2.46093277 C3.2926714,2.24879432 3.60795375,2.22013229 3.8200922,2.39691433 C3.84332373,2.41627394 3.86475103,2.43770124 3.88411064,2.46093277 Z" id="三角形" transform="translate(3.500000, 5.000000) scale(-1, -1) rotate(-270.000000) translate(-3.500000, -5.000000) "></path>\n                                      </g>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </g>\n          </svg>\n        </span>'),d.onclick=function(){i.editIcon(o.id,"left","footer")},r.appendChild(d);var l=document.createElement("span");if(l.className="icon-move right",l.innerHTML='<span id="'.concat(this.jSPlugin.id,"-").concat(o.id,'-right" class="ezuikit-theme-icon" title="右移" style="display: inline-block;border-radius: 2px;overflow: hidden;position: absolute;top: calc(50% - ').concat(35*s,"px);left: ").concat(20*s+.5*a,"px; width: ").concat(10*s,"px; height: ").concat(40*s,'px;cursor: pointer;">\n        <svg width="100%" height="100%" viewBox="0 0 10 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title></title>\n              <g id="呼叫模板-控制台" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="H5呼叫模板" transform="translate(-684.000000, -5024.000000)">\n                      <g id="编组-28" transform="translate(421.000000, 4484.000000)">\n                          <g id="编组-9" transform="translate(23.000000, 522.000000)">\n                              <g id="编组" transform="translate(170.000000, 0.000000)">\n                                  <g id="箭头右" transform="translate(70.000000, 18.000000)">\n                                      <rect id="矩形" fill="#595959" x="0" y="0" width="10" height="40" rx="2"></rect>\n                                      <g id="1.通用/2.Icon图标/Common/Fill/Left" transform="translate(5.500000, 20.000000) scale(-1, 1) translate(-5.500000, -20.000000) translate(2.000000, 15.000000)" fill="#FFFFFF">\n                                          <path d="M3.88411064,2.46093277 L7.81658983,7.1799078 C7.99337187,7.39204625 7.96470984,7.7073286 7.75257139,7.88411064 C7.66271389,7.95899189 7.54944745,8 7.43247919,8 L-0.432479194,8 C-0.708621569,8 -0.932479194,7.77614237 -0.932479194,7.5 C-0.932479194,7.38303175 -0.891471084,7.2697653 -0.816589833,7.1799078 L3.11588936,2.46093277 C3.2926714,2.24879432 3.60795375,2.22013229 3.8200922,2.39691433 C3.84332373,2.41627394 3.86475103,2.43770124 3.88411064,2.46093277 Z" id="三角形" transform="translate(3.500000, 5.000000) scale(-1, -1) rotate(-270.000000) translate(-3.500000, -5.000000) "></path>\n                                      </g>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </g>\n          </svg>\n        </span>'),l.onclick=function(){i.editIcon(o.id,"right","footer")},r.appendChild(l),"answer"==e||"rejection"==e||"hangUp"==e);else{var c=document.createElement("span");c.className="icon-move close",c.innerHTML='<span id="'.concat(o.id,'-remove" class="ezuikit-theme-icon" title="移除" style="position: absolute;top: ').concat(-15*s-1,"px;left: ").concat(20*s+.5*a-4.5*s,'px;cursor: pointer;">\n            <svg width="').concat(18*s,'" height="').concat(18*s,'" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <title></title>\n                  <g id="呼叫模板-控制台" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                      <g id="H5呼叫模板" transform="translate(-680.000000, -5006.000000)">\n                          <g id="编组-28" transform="translate(421.000000, 4484.000000)">\n                              <g id="编组-9" transform="translate(23.000000, 522.000000)">\n                                  <g id="编组" transform="translate(170.000000, 0.000000)">\n                                      <g id="关闭1" transform="translate(66.000000, 0.000000)">\n                                          <rect id="矩形" fill-rule="nonzero" x="0" y="0" width="18" height="18"></rect>\n                                          <path d="M9,1.125 C4.65117188,1.125 1.125,4.65117188 1.125,9 C1.125,13.3488281 4.65117188,16.875 9,16.875 C13.3488281,16.875 16.875,13.3488281 16.875,9 C16.875,4.65117188 13.3488281,1.125 9,1.125 Z M11.9074219,11.9917969 L10.7472656,11.9865234 L9,9.90351562 L7.25449219,11.9847656 L6.09257813,11.9900391 C6.01523438,11.9900391 5.95195313,11.9285156 5.95195313,11.8494141 C5.95195313,11.8160156 5.96425781,11.784375 5.98535156,11.7580078 L8.27226563,9.03339844 L5.98535156,6.31054687 C5.96425781,6.28417969 5.95195313,6.25253906 5.95195313,6.21914062 C5.95195313,6.14179687 6.01523438,6.07851562 6.09257813,6.07851562 L7.25449219,6.08378906 L9,8.16679687 L10.7455078,6.08554688 L11.9056641,6.08027344 C11.9830078,6.08027344 12.0462891,6.14179687 12.0462891,6.22089844 C12.0462891,6.25429687 12.0339844,6.2859375 12.0128906,6.31230469 L9.72949219,9.03515625 L12.0146484,11.7597656 C12.0357422,11.7861328 12.0480469,11.8177734 12.0480469,11.8511719 C12.0480469,11.9285156 11.9847656,11.9917969 11.9074219,11.9917969 Z" id="形状" fill="#595959"></path>\n                                      </g>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n          </span>'),c.onclick=function(){i.editIcon(o.id,"delete","footer")},r.appendChild(c)}"onCall"==this.bellStatus?document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).appendChild(r):document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).appendChild(r),this.decoderState.state.isEditing&&"mute"==e&&"onCall"==this.bellStatus&&(0!=this.themeData.customConfig.defaultMicro||n?this.setDecoderState({mute:!1},t.backgroundColor):this.setDecoderState({mute:!0},t.backgroundColor))}},{key:"switchFooter",value:function(e){var t={};switch(this.themeData&&(t=this.themeData.footer),e){case"onBell":document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReply"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReply")).style.display="none"),document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"))?"none"==document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.display&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="flex"):document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="flex";break;case"onCall":document.getElementById("".concat(this.jSPlugin.id,"-audioControls-remoteUnlock")).style.display="none",document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="none",document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.display="flex",this.themeData&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.color=t[this.bellStatus].color);break;case"quickReply":document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReply")).style.display="flex",document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="none";break;case"remoteUnlock":document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.display="none",document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="none",document.getElementById("".concat(this.jSPlugin.id,"-audioControls-remoteUnlock")).style.display="flex";break}}},{key:"initThemeData",value:function(){var e=this;console.log("-------------initThemeData");var t=this.decoderState.state.isEditing,i=this.themeData,n=i.header,o=i.footer,a=this.jSPlugin.id,r=this.videoWidth,s=r/1024;if(this.isNeedRenderHeader=Z.findIndex(n[this.bellStatus].btnList,(function(e){return e.isrender>0}))>=0,this.isNeedRenderFooter=Z.findIndex(o[this.bellStatus].btnList,(function(e){return e.isrender>0}))>=0,this.isNeedRenderHeader)if(document.getElementById("".concat(this.jSPlugin.id,"-headControl")))document.getElementById("".concat(this.jSPlugin.id,"-headControl")).innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' style='display:flex;width: calc(100% - 100px);padding-left: 3%;'></div><div id='").concat(this.jSPlugin.id,"-headControl-right' style='display:flex'></div>");else{var d=document.createElement("div");d.setAttribute("id","".concat(this.jSPlugin.id,"-headControl")),d.setAttribute("class","header-controls"),d.innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' class=\"header-controls-left\" style='display:flex;width:calc(100% - 100px);overflow:hidden;padding-left: 3%;'></div><div id='").concat(this.jSPlugin.id,"-headControl-right' class=\"header-controls-right\" style='display:flex;'></div>"),console.log(this.jSPlugin.height);var l=.2*this.jSPlugin.height+"px",c={height:l,display:"flex","justify-content":"space-between",top:0,"z-index":999,color:"#FFFFFF",width:"100%",position:"relative","margin-bottom":"-"+l,"align-items":"center",background:"transparent linear-gradient(180deg, rgba(0,0,0,0.65) 0%, rgba(0,0,0,0.00) 100%)"};d.style=ut(c),document.getElementById("".concat(a,"-wrap")).insertBefore(d,document.getElementById(a));var u=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&clearInterval(u)}),50)}else document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&document.getElementById("".concat(this.jSPlugin.id,"-headControl")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-headControl")));var m=.3*this.jSPlugin.height;if(this.isNeedRenderFooter)if(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")))document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop="-".concat(m,"px"),"onCall"==this.bellStatus?document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).innerHTML='\n              <div id="'.concat(this.jSPlugin.id,'-audioControls"  class="footer-controls" style=\'display:none;justify-content: space-around;padding: 0 4%;width:100%;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-onCall" class="footer-controls" style=\'display:flex;justify-content: space-around;padding: 0 4%;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-quickReply" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-remoteUnlock" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              '):document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).innerHTML='\n              <div id="'.concat(this.jSPlugin.id,'-audioControls"  class="footer-controls" style=\'display:flex;justify-content: space-around;padding: 0 4%;width:100%;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-onCall" class="footer-controls" style=\'display:none;justify-content: space-around;padding: 0 4%;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-quickReply" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-remoteUnlock" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              '));else{var p=document.createElement("div");p.setAttribute("id","".concat(this.jSPlugin.id,"-ez-iframe-footer-container")),p.setAttribute("class","ez-iframe-footer-container");var h={"min-height":m+"px","max-height":m+"px",position:"relative","margin-top":"-"+m+"px",display:"flex","flex-wrap":"wrap","justify-content":"space-between","z-index":999,top:0,color:"#FFFFFF",width:"100%","align-items":"center","background-image":"linear-gradient(180deg, rgba(0,0,0,0.00) 0%, rgba(0,0,0,0.60) 100%)","font-size":24*s+"px"};p.style=ut(h),p.innerHTML='\n            <div id="'.concat(this.jSPlugin.id,'-audioControls" class="footer-controls" style=\'display:flex;justify-content: space-around;padding: 0 4%;width:100%;z-index:999;position: relative;\'></div>\n            <div id="').concat(this.jSPlugin.id,'-audioControls-onCall" class="footer-controls" style=\'display:none;justify-content: space-around;padding: 0 4%;width:100%;z-index:999;position: relative;\'></div>\n            <div id="').concat(this.jSPlugin.id,'-audioControls-quickReply" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n            <div id="').concat(this.jSPlugin.id,'-audioControls-remoteUnlock" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n            '),P(p,document.getElementById(a))}else document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")));if(this.isNeedRenderHeader&&document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.background=n[this.bellStatus].backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=n[this.bellStatus].color,n[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderHeader(t.iconId,t)}))),this.isNeedRenderFooter&&document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=o[this.bellStatus].backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=o[this.bellStatus].color,o[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderFooter(t.iconId,t)}))),1==this.themeData.customConfig.bellPoster&&!t){this.jSPlugin.poster="https://resource.eziot.com/group1/M00/00/B8/CtwQEmPbGh2AVJB-ABDcYtyw5gk899.svg";var f=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(f),e.jSPlugin.setPoster(e.jSPlugin.poster))}),50)}this.activeThemeStatus&&(this.initBellRing(),window.addEventListener("click",this.autoPlayRing)),this.inited=!0,this.getCallDeviceInfo()}},{key:"renderThemeData",value:function(){var e=this,t=this.decoderState.state.isEditing,i=this.themeData,n=i.header,o=i.footer;if(this.isNeedRenderHeader&&n&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.background=n[this.bellStatus].backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=n[this.bellStatus].color.replace("-diy",""),n[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.setDecoderState(g({},t.iconId,e.decoderState.state[t.iconId]))}))),this.isNeedRenderFooter&&o)document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=o[this.bellStatus].backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=o[this.bellStatus].color.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.color=o[this.bellStatus].color.replace("-diy",""),o[this.bellStatus].btnList.map((function(i,n){if(i.isrender&&e.setDecoderState(g({},i.iconId,e.decoderState.state[i.iconId])),0==n&&!e.themeInited&&e.activeThemeStatus)var o=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(o),1!=e.themeData.customConfig.bellPoster||t?e.jSPlugin.play():e.jSPlugin.pluginStatus.loadingClear(),e.themeInited=!0)}),50)})),-1!==this.jSPlugin.url.indexOf("hd.live")&&this.setDecoderState({hd:!0}),this.themeData.autoFocus>0&&(this.autoFocus=parseInt(this.themeData.autoFocus),this.startAutoFocus(),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).addEventListener("click",(function(){e.stopAutoFocus()}))),this.setDecoderState({cloudRec:"cloud.rec"===j(this.jSPlugin.url).type,rec:"rec"===j(this.jSPlugin.url).type,type:j(this.jSPlugin.url).type});else if(!this.themeInited&&this.activeThemeStatus)var a=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(a),e.themeData&&e.themeData.customConfig&&1==e.themeData.customConfig.bellPoster&&!t?e.jSPlugin.pluginStatus.loadingClear():e.jSPlugin.play(),e.themeInited=!0)}),50);var r=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(r),e.jSPlugin.reSize(e.jSPlugin.params.width,e.jSPlugin.params.height))}),50)}},{key:"setThemeData",value:function(e,t){this.themeData=e,"onCall"==t&&(this.bellStatus="onCall")}},{key:"startAutoFocus",value:function(){var e=this,t=this.autoFocus;this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.autoFocusTimer=setTimeout((function(){document.getElementById("".concat(e.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.opacity=0,document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.pointerEvents="none")}),1e3*t)}},{key:"stopAutoFocus",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.opacity=1,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.pointerEvents="all"),this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.startAutoFocus()}},{key:"editIcon",value:function(e,t,i){console.log("编辑组件",e,t,i);var n=this.themeData;console.log("themeData",this.themeData);var o=this.themeData[i][this.bellStatus].btnList,a=Z.findIndex(o,(function(t){return t.iconId===e})),r=o[a];switch(t){case"delete":o[a].isrender=0;break;case"right":for(var s=-1,d=a+1;d<o.length;d++)if(o[d].part===o[a].part&&1==o[d].isrender){s=d;break}-1!==s&&(o[a]=o[s],o[s]=r);break;case"left":for(var l=-1,c=a-1;c>=0;c--)if(o[c].part===o[a].part&&1==o[c].isrender){l=c;break}-1!==l&&(o[a]=o[l],o[l]=r);break}console.log("new btnList",o),n[i][this.bellStatus].btnList=o,this.jSPlugin.Theme.changeTheme(n)}},{key:"countTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this;if(!document.getElementById(this.jSPlugin.id+"time-area")){var n=document.createElement("div");n.id=this.jSPlugin.id+"time-area",n.className="time-area",n.innerHTML='<span class="dot"></span><span class="value">00:00</span>',document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).appendChild(n)}if(this.countTimer&&clearInterval(this.countTimer),"add"===e){var o=t;document.getElementById(i.jSPlugin.id+"time-area").style.display="flex",this.countTimer=setInterval((function(){++o,document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML=a(o)}),1e3)}else"destroy"===e&&(this.countTimer&&clearInterval(this.countTimer),this.countTimer=void 0,document.getElementById(i.jSPlugin.id+"time-area")&&(document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML="00:00",document.getElementById(i.jSPlugin.id+"time-area").style.display="none"));function a(e){var t=parseInt(e),i=0,n=0,o="00",a="00",r="00";return t>59&&(i=parseInt(t/60),t=parseInt(t%60),i>59&&(n=parseInt(i/60),i=parseInt(i%60))),o=parseInt(t)>9?parseInt(t):"0"+parseInt(t),a=parseInt(i)>9?parseInt(i):"0"+parseInt(i),r=parseInt(n)>9?parseInt(n):"0"+parseInt(n),n>0?r+":"+a+":"+o:i>0?a+":"+o:"00:"+o}}},{key:"editStart",value:function(e){console.log("----------editStart2");var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"));document.getElementById("".concat(this.jSPlugin.id,"-headControl")),t&&t.setAttribute("class","footer-controls themeEditing"),i&&i.setAttribute("class","footer-controls themeEditing"),this.setDecoderState({isEditing:!0})}},{key:"editEnd",value:function(e){console.log("----------editEnd2");var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-headControl")),n=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"));i&&i.setAttribute("class","header-controls"),t&&t.setAttribute("class","footer-controls"),n&&n.setAttribute("class","footer-controls")}},{key:"fetchThemeData",value:function(e){var t=this,i=function(e){0==e.meta.code&&e.data?(t.activeThemeStatus=!0,t.themeData=e.data,e.data.header&&(t.themeData.header=e.data.header,t.themeData.header[t.bellStatus].btnList=t.themeData.header[t.bellStatus].btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),e.data.footer&&(t.themeData.footer=e.data.footer,t.themeData.footer[t.bellStatus].btnList=t.themeData.footer[t.bellStatus].btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),t.jSPlugin.capacity?(t.initThemeData(),t.renderThemeData()):setTimeout((function(){t.initThemeData(),t.renderThemeData()}),300)):(t.activeThemeStatus=!1,t.jSPlugin.pluginStatus.loadingClear(),t.setDecoderState({rejection:!0}),"111021"==e.meta.code?(t.jSPlugin.pluginStatus.loadingSetText({text:"无效的模板id",color:"#fff"}),t.activeThemeStatusTxt="无效的模板id"):"111023"==e.meta.code?(t.jSPlugin.pluginStatus.loadingSetText({text:"您的试用特权已到期，需前往轻应用控制台购买后使用。",color:"#fff"}),t.activeThemeStatusTxt="试用特权已到期"):(t.jSPlugin.pluginStatus.loadingSetText({text:"模板未激活，请先在开放平台轻应用控制台购买模板",color:"#fff"}),t.activeThemeStatusTxt="模板未激活"),t.themeData=ct.data,t.initThemeData(),t.renderThemeData())},n=function(){t.renderThemeData()};Xe(this.jSPlugin,e,i,n)}},{key:"getCallDeviceInfo",value:function(){var e=this;this.videoWidth;var t=this,i=function(i){200==i.code&&i.data&&(console.log("---------getCallDeviceInfo"),e.deviceInfoData=i.data,i.data.isEncrypt&&setTimeout((function(){console.log("---------------------视频已加密"),t.jSPlugin.pluginStatus&&t.jSPlugin.pluginStatus.loadingClear(),t.jSPlugin.pluginStatus.loadingSetText({text:"视频已加密",color:"#fff"})}),50),document.getElementById("header-".concat(e.bellStatus,"-deviceCategory"))&&(document.getElementById("header-".concat(e.bellStatus,"-deviceCategory")).innerText=""+i.data.deviceName)),20018!=i.code||e.jSPlugin.isWebConsole||e.userNoDevice()};M(this.jSPlugin.env.domain+"/api/lapp/device/info","POST",{accessToken:this.jSPlugin.accessToken,deviceSerial:j(this.jSPlugin.url).deviceSerial},"",i)}},{key:"setHeaderText",value:function(e){var t=this.videoWidth/1024||1;document.getElementById("".concat(this.jSPlugin.id,"-deviceCategory-content"))&&(document.getElementById("".concat(this.jSPlugin.id,"-deviceCategory-content")).innerHTML='<span style="font-size: '.concat(32*t,'px;display: block">').concat(e,'</span><span style="font-size: ').concat(24*t,"px;padding-top: ").concat(16*t,'px;display: block;">').concat(this.deviceInfoData&&this.deviceInfoData.deviceName||"","</span>"))}}]),e}(),pt=function(){function e(t,i){p(this,e),this.jSPlugin=t,this.heightPop=i||366,this.initPopupCustom()}return f(e,[{key:"initPopupCustom",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-wrap-popup-custom"))?document.getElementById("".concat(this.jSPlugin.id,"-wrap-popup-custom")).style.display="flex":this.randerPopup()}},{key:"randerPopup",value:function(){var e=this,t=document.documentElement.clientWidth,i=t/375||1,n=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(n),n.innerHTML="@keyframes slideContentUp {0%   {bottom: -".concat(366*i,"px;}\n        25%  {bottom: -").concat(244*i,"px;}\n        50%  {bottom: -").concat(122*i,"px;}\n        100% {bottom:0;}} .open-popup{animation:slideContentUp 0.3s 1 linear; -webkit-animation: slideContentUp 0.3s 1 linear;}");var o=document.getElementById("".concat(this.jSPlugin.id,"-wrap")),a=document.createElement("div");a.style="display:flex;",a.id="".concat(this.jSPlugin.id,"-wrap-popup-custom"),a.innerHTML='<div id="'.concat(this.jSPlugin.id,'-wrap-popup-custom-mask" style="height:100%;width:100%;position:fixed;top:0;left:0;z-index:9998;background-color: rgba(0,0,0,0.75);overflow:hidden;">\n        </div>\n        <div id="').concat(this.jSPlugin.id,'-wrap-popup-board" class="open-popup" style="bottom:0;height: ').concat(this.heightPop*i,'px;position:fixed;left: 0; width: 100%;background-color:#ffffff;z-index: 9999;border-radius: 16px 16px 0px 0px;">\n            <div style="margin-top: ').concat(20*i,"px;padding: 0 ").concat(15*i,'px;width: 100%;display:flex;flex-direction: row;align-items: center;">\n                <div id="').concat(this.jSPlugin.id,'-popup-board-close">\n                    <svg width="').concat(24*i,'px" height="').concat(24*i,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>icon/close</title>\n                        <g id="icon/close" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <g id="common/Close/Dark">\n                                <rect id="Rectangle" x="0" y="0" width="24" height="24"></rect>\n                                <path d="M18.1871843,5.81281566 C18.4556698,6.08130112 18.4780436,6.50270075 18.2543057,6.7966719 L18.1871843,6.87347584 L13.0611458,12.0001458 L18.1871843,17.1265242 C18.4800776,17.4194174 18.4800776,17.8942911 18.1871843,18.1871843 C17.9186989,18.4556698 17.4972993,18.4780436 17.2033281,18.2543057 L17.1265242,18.1871843 L12.0001458,13.0611458 L6.87347584,18.1871843 C6.58058262,18.4800776 6.10570888,18.4800776 5.81281566,18.1871843 C5.54433021,17.9186989 5.52195643,17.4972993 5.7456943,17.2033281 L5.81281566,17.1265242 L10.9391458,12.0001458 L5.81281566,6.87347584 C5.51992245,6.58058262 5.51992245,6.10570888 5.81281566,5.81281566 C6.08130112,5.54433021 6.50270075,5.52195643 6.7966719,5.7456943 L6.87347584,5.81281566 L12.0001458,10.9391458 L17.1265242,5.81281566 C17.4194174,5.51992245 17.8942911,5.51992245 18.1871843,5.81281566 Z" id="形状结合" fill="#2C2C2C" fill-rule="nonzero"></path>\n                            </g>\n                        </g>\n                    </svg>\n                </div>\n                <div id="popup-board-title-content" style="width: ').concat(180*i,"px;font-size: ").concat(18*i,"px;margin-left: ").concat(59*i,'px;font-family: PingFangSC-Medium;color: #2C2C2C;font-weight: 500;text-align: center;"></div>\n            </div>\n            <div id="').concat(this.jSPlugin.id,'-popup-board-content" style="width:100%;padding: 0 ').concat(15*i,"px;height: ").concat((this.heightPop-48)*i,'px;box-sizing: border-box;display: flex;align-items: center;justify-content: center;flex-direction: column;"></div>\n        </div>\n        '),o.appendChild(a),document.getElementById("".concat(this.jSPlugin.id,"-wrap-popup-custom-mask")).onclick=function(){e.closePopupCustom()},document.getElementById("".concat(this.jSPlugin.id,"-popup-board-close")).onclick=function(){e.closePopupCustom()}}},{key:"closePopupCustom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};e();var t=document.getElementById("".concat(this.jSPlugin.id,"-wrap")),i=document.getElementById("".concat(this.jSPlugin.id,"-wrap-popup-custom"));t&&i&&t.removeChild(i)}},{key:"initPopupContent",value:function(e,t){document.getElementById("popup-board-title-content").innerText=e||"",t&&document.getElementById("".concat(this.jSPlugin.id,"-popup-board-content")).appendChild(t)}}]),e}(),ht=function(){function e(t,i,n){p(this,e),this.jSPlugin=t,this.videoWidth=n,this.switchFooter=i,this.toastCustom=new nt(t,!0),this.sendLoadingStats=!1,this.quickReplyList=["你好，请将快递放在门口","你好，稍等","你好，请将快递放入小区快递柜","你好，请将外卖放在门口"],this.popupCustom=new pt(t,366),document.getElementById("mobile-quickReply-list")||(this.popupCustom.initPopupContent("快捷回复",this.renderQuickReply()),this.initQuickReply())}return f(e,[{key:"initQuickReply",value:function(){document.getElementById("mobile-quickReply-list-item-0")||this.getQuickReplyList()}},{key:"renderQuickReply",value:function(){document.documentElement.clientWidth;var e=document.createElement("div");return e.style="width:100%;",e.id="mobile-quickReply-list",e.innerHTML='<div id="mobile-quickReply-content" style="display: block;width:100%;margin-bottom: 36px;"></div>\n    <div id="mobile-quickReply-loading" style="display: none;width:100%;"></div>\n    <div id="mobile-quickReply-loaderror" style="display: none;width:100%;"></div>',e}},{key:"matchQuickReplyBtn",value:function(){var e=this,t=this.videoWidth/375||1,i=document.getElementById("mobile-quickReply-content");this.quickReplyList&&this.quickReplyList.length>0&&this.quickReplyList.forEach((function(n,o){var a=document.createElement("div");a.id="mobile-quickReply-list-item-".concat(o),a.style="margin: ".concat(14*t,"px 0;\n            padding: ").concat(12*t,"px ").concat(15*t,"px;min-height: ").concat(50*t,"px;width:100%;\n            background: #ffffff;border-radius: ").concat(25*t,"px;display: flex;align-items: center;\n            box-sizing: border-box;font-size:").concat(16*t,"px;color: #2c2c2c;"),a.innerHTML='\n            <svg id="mobile-quickReply-icon-'.concat(o,'" width="').concat(24*t,'px" height="').concat(24*t,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                    <title>icon/快捷回复播放</title>\n                    <g id="icon/快捷回复播放" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <rect id="Rectangle" x="0" y="0" width="24" height="24"></rect>\n                        <path d="M18.9877488,4.36609064 C21.024173,6.11256041 22.2495,8.93566941 22.2495,12.0024 C22.2495,15.066006 21.0272636,17.8857191 18.9943957,19.6331539 C18.6802816,19.9031635 18.2067557,19.8674098 17.9367461,19.5532957 C17.6667365,19.2391816 17.7024902,18.7656557 18.0166043,18.4956461 C19.708691,17.0411437 20.7495,14.6399857 20.7495,12.0024 C20.7495,9.36223947 19.7060688,6.95821183 18.0112512,5.50470936 C17.6968304,5.23505702 17.6605383,4.76157212 17.9301906,4.44715124 C18.199843,4.13273036 18.6733279,4.09643829 18.9877488,4.36609064 Z M12.2442357,5.87579772 L12.2496,6.0179 L12.2496,17.9819 C12.2496,19.4241617 10.6173522,20.2281184 9.48072691,19.4058312 L9.36879527,19.318145 L5.5996,16.1243865 L3.4996,16.1249 C2.581479,16.1249 1.8284129,15.4182283 1.75540159,14.518493 L1.7496,14.3749 L1.7496,9.6249 C1.7496,8.70699712 2.45696726,7.95373471 3.35611134,7.88070323 L3.4996,7.8749 L5.5996,7.8743865 L9.36863059,4.68279453 C10.4692948,3.74976994 12.1377395,4.4768074 12.2442357,5.87579772 Z M10.3952894,5.79039368 L10.338321,5.82721597 L6.35932099,9.19721597 C6.33078024,9.2209397 6.30781291,9.23786997 6.28390041,9.25347262 L6.35932099,9.19721597 C6.32908972,9.22282023 6.29742069,9.24561685 6.26463127,9.26563212 C6.24087088,9.28012218 6.21634729,9.29327785 6.19105714,9.30506452 C6.18413632,9.30829747 6.1773583,9.31133066 6.1705483,9.31425704 C6.10964585,9.34044144 6.04445985,9.35881628 5.97637056,9.36805338 C5.95756973,9.37054904 5.94148484,9.37214804 5.92538001,9.37322799 L5.8746,9.3749 L3.4996,9.3749 C3.38149734,9.3749 3.28218291,9.45734262 3.25621762,9.56766695 L3.2496,9.6249 L3.2496,14.3749 C3.2496,14.4934644 3.33170357,14.592449 3.44222164,14.6183106 L3.4996,14.6249 L5.8746,14.6249 L5.92192315,14.6263483 C5.93923255,14.627429 5.95652113,14.629109 5.97375563,14.6313909 L5.8746,14.6249 C5.9789469,14.6249 6.0783167,14.6462095 6.168595,14.6847142 C6.18010037,14.6895946 6.19235048,14.695194 6.2044823,14.7011451 C6.22547728,14.7114805 6.24528995,14.7223727 6.26453263,14.7341072 C6.266314,14.735195 6.26795143,14.7362034 6.26958602,14.7372187 L6.28086895,14.7443598 C6.30587317,14.7605037 6.32985559,14.7780945 6.3526978,14.7970136 L6.35940473,14.802655 L10.3380567,18.1733603 C10.4825575,18.2956302 10.695338,18.2179271 10.7408386,18.0492187 L10.7496,17.9819 L10.7496,6.0179 C10.7496,5.82820058 10.5532313,5.71607381 10.3952894,5.79039368 Z M15.9361636,7.38657032 C17.3580982,8.28109203 18.2498,10.0509458 18.2498,12.0044 C18.2498,13.9607796 17.3563865,15.7307985 15.9326223,16.6154437 C15.5807928,16.8340503 15.1183629,16.7260519 14.8997563,16.3742223 C14.6811497,16.0223928 14.7891481,15.5599629 15.1409777,15.3413563 C16.1036696,14.7431949 16.7498,13.4630899 16.7498,12.0044 C16.7498,10.5466827 16.103548,9.26399865 15.1374364,8.65622968 C14.7868297,8.43566726 14.6814079,7.97264316 14.9019703,7.62203641 C15.1225327,7.27142966 15.5855568,7.1660079 15.9361636,7.38657032 Z" id="形状结合" fill="#2C2C2C" fill-rule="nonzero"></path>\n                    </g>\n                </svg>\n            <span id="mobile-quickReply-name-').concat(o,'" style="padding-left: 5px;">').concat(n.voiceName,"</span>"),a.onclick=function(){console.log("item:"+n),e.sendLoadingStats||(e.setBtnCheckStatus(o),e.sendQuickReply(n))},i.appendChild(a)}))}},{key:"setBtnCheckStatus",value:function(e){var t=this,i="";this.quickReplyList.forEach((function(n,o){i=document.getElementById("mobile-quickReply-list-item-".concat(o)),o==e?(i.style.background="#F4F6FC",i.style.color="#648FFC",t.setBtnCheckLoding(0,o)):(i.style.background="#ffffff",i.style.color="#2c2c2c")}))}},{key:"setBtnCheckLoding",value:function(e,t){console.log(t);var i=this.videoWidth/375||1;if(t>-1){var n=document.getElementById("mobile-quickReply-list-item-".concat(t)),o=document.getElementById("mobile-quickReply-name-".concat(t)),a=document.getElementById("mobile-quickReply-icon-".concat(t));if(1==e){var r=document.getElementById("mobile-quickReply-icon-loading-".concat(t));if(r&&o){var s=document.createElement("span");s.id="mobile-quickReply-icon-".concat(t),s.style="height:".concat(24*i,"px;"),s.innerHTML='\n                <svg width="'.concat(24*i,'px" height="').concat(24*i,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                    <title>icon/快捷回复播放</title>\n                    <g id="icon/快捷回复播放" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <rect id="Rectangle" x="0" y="0" width="24" height="24"></rect>\n                        <path d="M18.9877488,4.36609064 C21.024173,6.11256041 22.2495,8.93566941 22.2495,12.0024 C22.2495,15.066006 21.0272636,17.8857191 18.9943957,19.6331539 C18.6802816,19.9031635 18.2067557,19.8674098 17.9367461,19.5532957 C17.6667365,19.2391816 17.7024902,18.7656557 18.0166043,18.4956461 C19.708691,17.0411437 20.7495,14.6399857 20.7495,12.0024 C20.7495,9.36223947 19.7060688,6.95821183 18.0112512,5.50470936 C17.6968304,5.23505702 17.6605383,4.76157212 17.9301906,4.44715124 C18.199843,4.13273036 18.6733279,4.09643829 18.9877488,4.36609064 Z M12.2442357,5.87579772 L12.2496,6.0179 L12.2496,17.9819 C12.2496,19.4241617 10.6173522,20.2281184 9.48072691,19.4058312 L9.36879527,19.318145 L5.5996,16.1243865 L3.4996,16.1249 C2.581479,16.1249 1.8284129,15.4182283 1.75540159,14.518493 L1.7496,14.3749 L1.7496,9.6249 C1.7496,8.70699712 2.45696726,7.95373471 3.35611134,7.88070323 L3.4996,7.8749 L5.5996,7.8743865 L9.36863059,4.68279453 C10.4692948,3.74976994 12.1377395,4.4768074 12.2442357,5.87579772 Z M10.3952894,5.79039368 L10.338321,5.82721597 L6.35932099,9.19721597 C6.33078024,9.2209397 6.30781291,9.23786997 6.28390041,9.25347262 L6.35932099,9.19721597 C6.32908972,9.22282023 6.29742069,9.24561685 6.26463127,9.26563212 C6.24087088,9.28012218 6.21634729,9.29327785 6.19105714,9.30506452 C6.18413632,9.30829747 6.1773583,9.31133066 6.1705483,9.31425704 C6.10964585,9.34044144 6.04445985,9.35881628 5.97637056,9.36805338 C5.95756973,9.37054904 5.94148484,9.37214804 5.92538001,9.37322799 L5.8746,9.3749 L3.4996,9.3749 C3.38149734,9.3749 3.28218291,9.45734262 3.25621762,9.56766695 L3.2496,9.6249 L3.2496,14.3749 C3.2496,14.4934644 3.33170357,14.592449 3.44222164,14.6183106 L3.4996,14.6249 L5.8746,14.6249 L5.92192315,14.6263483 C5.93923255,14.627429 5.95652113,14.629109 5.97375563,14.6313909 L5.8746,14.6249 C5.9789469,14.6249 6.0783167,14.6462095 6.168595,14.6847142 C6.18010037,14.6895946 6.19235048,14.695194 6.2044823,14.7011451 C6.22547728,14.7114805 6.24528995,14.7223727 6.26453263,14.7341072 C6.266314,14.735195 6.26795143,14.7362034 6.26958602,14.7372187 L6.28086895,14.7443598 C6.30587317,14.7605037 6.32985559,14.7780945 6.3526978,14.7970136 L6.35940473,14.802655 L10.3380567,18.1733603 C10.4825575,18.2956302 10.695338,18.2179271 10.7408386,18.0492187 L10.7496,17.9819 L10.7496,6.0179 C10.7496,5.82820058 10.5532313,5.71607381 10.3952894,5.79039368 Z M15.9361636,7.38657032 C17.3580982,8.28109203 18.2498,10.0509458 18.2498,12.0044 C18.2498,13.9607796 17.3563865,15.7307985 15.9326223,16.6154437 C15.5807928,16.8340503 15.1183629,16.7260519 14.8997563,16.3742223 C14.6811497,16.0223928 14.7891481,15.5599629 15.1409777,15.3413563 C16.1036696,14.7431949 16.7498,13.4630899 16.7498,12.0044 C16.7498,10.5466827 16.103548,9.26399865 15.1374364,8.65622968 C14.7868297,8.43566726 14.6814079,7.97264316 14.9019703,7.62203641 C15.1225327,7.27142966 15.5855568,7.1660079 15.9361636,7.38657032 Z" id="形状结合" fill="#2C2C2C" fill-rule="nonzero"></path>\n                    </g>\n                </svg>\n                '),n.insertBefore(s,o)}}else if(a&&o){n.removeChild(a);var d=document.createElement("span");d.id="mobile-quickReply-icon-loading-".concat(t),d.style="height:".concat(20*i,"px;width: ").concat(24*i,"px;"),d.innerHTML='<svg width="'.concat(20*i,'" height="').concat(20*i,'" t="1567069979438" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#666666" p-id="2400"></path></svg>'),n.insertBefore(d,o)}}}},{key:"getQuickReplyList",value:function(){var e=this;console.log("getQuickReplyList"),this.madeLoadingDom(0);var t=function(t){if(t&&200==t.code){var i=t.data||[],n=[];t.data.forEach((function(e,t){n=e.voiceName.split("_"),i[t].voiceName=n[1]})),e.quickReplyList=i,setTimeout((function(){e.madeLoadingDom(2)}),500)}else e.madeLoadingDom(1)},i=function(t){console.log(t),e.madeLoadingDom(1)};at(this.jSPlugin,t,i)}},{key:"madeLoadingDom",value:function(e){var t=this,i=this.videoWidth/375||1;if(0==e){if(document.getElementById("mobile-quickReply-content").style.display="none",document.getElementById("mobile-quickReply-loaderror").style.display="none",document.getElementById("mobile-quickReply-loading").style.display="block",!document.getElementById("mobile-quickReply-loading-box")){var n=document.createElement("div");n.id="mobile-quickReply-loading-box",n.style="width: 100%;display: flex;align-items: center;justify-content: center;flex-direction: row;",n.innerHTML='<div class="" style="heigth:'.concat(20*i,'px">\n                <svg width="').concat(20*i,'" height="').concat(20*i,'" t="1567069979438" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#666666" p-id="2400"></path></svg>   \n            </div>\n            <div style="font-size: ').concat(16*i,"px;margin-left:",10,'px;color:#666666;">正在加载，请稍候</div>'),document.getElementById("mobile-quickReply-loading").appendChild(n)}}else if(1==e){if(document.getElementById("mobile-quickReply-content").style.display="none",document.getElementById("mobile-quickReply-loading").style.display="none",document.getElementById("mobile-quickReply-loaderror").style.display="block",!document.getElementById("mobile-quickReply-loaderror-box")){var o=document.createElement("div");o.id="mobile-quickReply-loaderror-box",o.style="width: 100%;display: flex;align-items: center;justify-content: center;flex-direction: column;",o.innerHTML='<div style="">\n                <img style="width:'.concat(186*i,"px;height:").concat(120*i,'px;" src="https://resource.eziot.com/group1/M00/00/B8/CtwQEmPZ34KAAStrAAA0pZ5cGTw167.png" />\n            </div>\n            <div style="font-size: ').concat(16*i,'px;color: #666666;">\n                <span>加载失败 </span>\n                <span id="mobile-quickReply-loaderror-reload" \n                style="color: #648FFC;-webkit-tap-highlight-color: transparent;">点击重试</span>\n            </div>'),document.getElementById("mobile-quickReply-loaderror").appendChild(o),document.getElementById("mobile-quickReply-loaderror-reload").onclick=function(){t.getQuickReplyList()}}}else document.getElementById("mobile-quickReply-loading").style.display="none",document.getElementById("mobile-quickReply-loaderror").style.display="none",document.getElementById("mobile-quickReply-content").style.display="block",this.matchQuickReplyBtn()}},{key:"sendQuickReply",value:function(e){var t=this;this.sendLoadingStats=!0;var i=function(e){t.sendLoadingStats=!1,e&&200==e.code?t.toastCustom.initToastContent("快捷回复成功"):t.toastCustom.initToastContent("快捷回复失败，请重试"),t.popupCustom.closePopupCustom()},n=function(e){console.log(e),t.sendLoadingStats=!1,t.toastCustom.initToastContent("快捷回复失败，请重试"),t.popupCustom.closePopupCustom()};rt(this.jSPlugin,e.fileUrl,i,n)}},{key:"closeQuickReplyEle",value:function(){this.popupCustom.closePopupCustom()}}]),e}(),ft=function(){function e(t,i,n){p(this,e),this.jSPlugin=t,this.videoWidth=n,this.switchFooter=i,this.toastCustom=new nt(t,!0),this.lockStatus=!1,this.popupCustom=new pt(t,265),this.popupCustom.initPopupContent("远程开锁",this.renderRemoteUnlock()),this.renderRemoteUnlockSlide()}return f(e,[{key:"initRemoteUnlock",value:function(){document.getElementById("mobile-remoteUnlock-content")?this.madeSlideEvent():this.renderRemoteUnlock()}},{key:"renderRemoteUnlock",value:function(){var e=this.videoWidth/1024||1,t=document.createElement("div");return t.style="width:100%;",t.id="mobile-remoteUnlock-box",t.innerHTML='<div style="width:100%;display:flex;flex-direction:row;align-items: center;">\n        <div id="mobile-remoteUnlock-content" style="display: block;width:calc(100% - '.concat(160*e,"px);margin: 0 ").concat(24*e,'px;"></div>\n    </div>'),t}},{key:"renderRemoteUnlockSlide",value:function(){var e=this.videoWidth/375||1,t=document.getElementById("mobile-remoteUnlock-content"),i=document.createElement("div");i.id="mobile-remoteUnlock-content-slide",i.style="width: 100%;display: flex;justify-content: center;padding: 0 ".concat(15*e,"px"),i.innerHTML='<div id="mobile-remoteUnlock-slide-box" style="width: 100%;line-height: '.concat(60*e,"px;height: ").concat(60*e,"px;border: 1px solid rgba(100,143,252,1);border-radius: ").concat(30*e,'px;position: relative;text-align: center;">\n        <div id="mobile-remoteUnlock-slide-bgColor" style="border-radius: ').concat(30*e,"px;width: ").concat(44*e,"px;height: ").concat(60*e,'px;position: absolute;left: 0;top: 0;"></div>\n        <div id="mobile-remoteUnlock-slide-tips" style="height: ').concat(60*e,"px;line-height: ").concat(60*e,"px;font-size: ").concat(14*e,"px;border-radius: ").concat(30*e,'px;position: absolute;text-align: center;user-select: none;color: #666666;width: 100%;">右滑开锁</div>\n        <div id="mobile-remoteUnlock-slide-ball" style="top: ').concat(8*e,"px;left: ").concat(8*e,"px;width: ").concat(44*e,"px;height: ").concat(44*e,'px;background: #598FFF;position: absolute;text-align: center;border-radius:50%;display:flex;align-items: center;justify-content: center;">\n            <svg id="slide-ball-start" style="display: inline;" width="').concat(24*e,'px" height="').concat(24*e,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <title>icon/箭头向右</title>\n                <g id="icon/箭头向右" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <rect id="矩形" fill="#000000" fill-rule="nonzero" opacity="0" x="0" y="0" width="24" height="24"></rect>\n                    <path d="M14.2841136,6.3689007 L19.9432338,12.0287579 L14.2863796,17.6856122 L12.8580239,16.2572565 L16.114,12.9999007 L4.00000001,13 L4.00000001,11 L16.058,10.9999007 L12.8557579,7.79725638 L14.2841136,6.3689007 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                </g>\n            </svg>\n            <svg id="slide-ball-end" style="display: none;" width="').concat(20*e,'" height="').concat(20*e,'" t="1567069979438" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#648ffc" p-id="2400"></path></svg>\n        </div>\n    </div>'),t.appendChild(i),this.madeSlideEvent()}},{key:"madeSlideEvent",value:function(){var e=this.videoWidth/375||1,t=document.getElementById("mobile-remoteUnlock-slide-box"),i=document.getElementById("mobile-remoteUnlock-slide-bgColor"),n=document.getElementById("mobile-remoteUnlock-slide-tips"),o=document.getElementById("mobile-remoteUnlock-slide-ball"),a=this;function r(){a.lockStatus=!0,document.getElementById("slide-ball-start").style.display="none",document.getElementById("slide-ball-end").style.display="inline",i.style.width=t.clientWidth+"px",i.style.backgroundColor="#598FFF",t.style.border="0",o.style.backgroundColor="#ffffff",n.textContent="正在开锁",n.style.color="#ffffff",o.ontouchstart=null,a.sendRemoteUnlockApi()}o.ontouchstart=function(n){console.log("ontouchstart");n=n||window.event;var s=n.touches[0].pageX;o.style.transition="",i.style.transition="",document.ontouchmove=function(i){i=i||window.event;var n=i.touches[0].pageX-t.offsetLeft-s,d=t.clientWidth-o.clientWidth-8*e;n<=0&&(n=0),n>=d&&(n=d),o.style.left=n+"px",n!=d||a.lockStatus||r()},document.ontouchend=function(){a.lockStatus||(i.style.width="0px",o.style.left=8*e+"px",o.style.transition="left 0.6s linear",i.style.transition="width 0.6s linear"),document.ontouchend=null,document.ontouchmove=null}}}},{key:"resetRemoteUnlockSlide",value:function(){var e=this.videoWidth/1024||1;this.lockStatus=!1;var t=document.getElementById("mobile-remoteUnlock-slide-box"),i=document.getElementById("mobile-remoteUnlock-slide-bgColor"),n=document.getElementById("mobile-remoteUnlock-slide-tips"),o=document.getElementById("mobile-remoteUnlock-slide-ball");i.style.width="0px",o.style.left=8*e+"px",n.textContent="右滑开锁",n.style.color="#666666",document.getElementById("slide-ball-start").style.display="inline",document.getElementById("slide-ball-end").style.display="none",i.style.backgroundColor="#FFFFFF",t.style.border="1px solid rgba(255,255,255,1)",o.style.backgroundColor="#598FFF"}},{key:"sendRemoteUnlockApi",value:function(){var e=this;console.log("下发远程开锁");var t=function(t){t&&200==t.code?e.toastCustom.initToastContent("开锁成功"):e.toastCustom.initToastContent("开锁失败，请重试"),e.popupCustom.closePopupCustom()},i=function(t){console.log(t),e.toastCustom.initToastContent("开锁失败，请重试"),e.popupCustom.closePopupCustom()};ot(this.jSPlugin,t,i)}},{key:"closeRemoteUnlock",value:function(){this.popupCustom.closePopupCustom()}}]),e}(),gt={customConfig:{defaultMicro:0,defaultPlay:0,maxTalkTime:0,bellPoster:0,maxBellTime:0},header:{onBell:{color:"#2c2c2c",backgroundColor:"#00000000 linear-gradient(180deg, rgba(0,0,0,0.65) 0%, rgba(0,0,0,0.00) 100%)",activeColor:"#1890FF",autoFocus:0,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-0",iconId:"ringStatus",part:"left",defaultActive:0,isrender:1,color:"#2c2c2c",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-1",iconId:"deviceCategory",part:"left",defaultActive:0,isrender:1,color:"#2c2c2c",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"}]},onCall:{color:"#2c2c2c",backgroundColor:"#00000000",activeColor:"#1890FF",autoFocus:5,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-0",iconId:"callStatus",part:"left",defaultActive:0,isrender:1,color:"#2c2c2c",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-header-1",iconId:"deviceCategory",part:"left",defaultActive:0,isrender:1,color:"#2c2c2c",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793"}]}},footer:{onBell:{color:"#2c2c2c",backgroundColor:"#00000000",activeColor:"#1890FF",autoFocus:5,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-0",iconId:"quickReply",part:"left",defaultActive:1,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-1",iconId:"rejection",part:"left",defaultActive:0,isrender:1,color:"#2C2C2C",themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-2",iconId:"answer",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-3",iconId:"remoteUnlock",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"}]},onCall:{color:"#2c2c2c",backgroundColor:"#00000080",activeColor:"#1890FF",autoFocus:5,btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-0",iconId:"mute",part:"left",defaultActive:1,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-1",iconId:"hangUp",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-4412dc7a9f7b471a9a3e9a8fb625c793-footer-2",iconId:"remoteUnlock",part:"left",defaultActive:0,isrender:1,themeId:"4412dc7a9f7b471a9a3e9a8fb625c793",backgroundColor:"#cccccc"}]}}},vt={data:gt},yt=function(e){var t="";return Object.keys(e).map((function(i,n){t+="".concat(i,":").concat(e[i]).concat(n<Object.keys(e).length-1?";":"")})),t},St=function(){function e(t,i,n,o){var a=this;p(this,e),g(this,"switchCallStatus",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=a.themeData,n=i.header,o=i.footer,r=null;if("onCall"==e){console.log("接听"),a.bellStatus="onCall",a.switchFooter("onCall"),o[a.bellStatus].btnList.map((function(e,t){e.isrender&&a.renderFooter(e.iconId,e),"mute"==e.iconId&&(r=e)})),n[a.bellStatus].btnList.map((function(e,t){e.isrender&&a.renderHeader(e.iconId,e)}));var s=document.getElementById("".concat(a.jSPlugin.id,"-header-onBell"));s&&s.parentElement.removeChild(s),1==a.themeData.customConfig.bellPoster&&document.getElementById("bellring-icon")&&document.getElementById("".concat(a.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon")),0==a.themeData.customConfig.defaultMicro&&r?a.muteCommon(r):a.setDecoderState({mute:!1},r.backgroundColor),a.removeBellRing(),a.miniRecCloseClick()}else console.log("响铃"),a.bellStatus="onBell",a.jSPlugin.Theme.changeTheme(a.themeData,t)})),g(this,"muteCommon",(function(e){var t=a.decoderState.state,i=t.talk,n=t.sound;i?(console.log("结束对讲"),a.setDecoderState({talk:!1,mute:!0},e.backgroundColor),a.jSPlugin.Talk.stopTalk(),n||a.jSPlugin.openSound(),a.setDecoderState({sound:!0})):(a.setDecoderState({talk:!1,mute:!0},e.backgroundColor),n||a.jSPlugin.openSound(),a.setDecoderState({sound:!0}))})),g(this,"autoPlayRing",(function(){console.log("autoPlayRing");var e=document.getElementById("bellring-audio");e&&(e.muted=!1,e.src="https://resource.eziot.com/group2/M00/00/8F/CtwQFmPbWnOAGuT5AAHZihhCJEM230.mp3",e.paused&&e.play());var t=a.checkIsAppleDevice()||!1;t?window.removeEventListener("touchstart",a.autoPlayRing):window.removeEventListener("click",a.autoPlayRing)})),this.jSPlugin=t,this.videoWidth=t.width,this.videoHeight=t.height,this.themeData=i,this.setDecoderState=n,this.decoderState=o,this.isNeedRenderHeader=!1,this.isNeedRenderFooter=!1,this.autoFocus=0,this.autoFocusTimer=null,this.bellStatus="onBell",this.recordTimer=null,this.nextRate=1,this.themeInited=!1,this.inited=!1,this.miniRecStatus="rec",this.activeThemeStatus=!0,this.activeThemeStatusTxt="模板未激活",this.miniRecNum=0,this.toastCustom=new nt(t,!0)}return f(e,[{key:"initBellRing",value:function(){var e=this,t=this.decoderState.state,i=t.play,n=t.isEditing,o=this.videoWidth,a=o/375;this.maxBellTime=1e3*this.themeData.customConfig.maxBellTime;var r=document.getElementById("bellring"),s=document.getElementById("bellring-audio");if(!r&&!s){if(this.jSPlugin.isNeedBellRing){var d=document.createElement("div");d.id="bellring",d.innerHTML='<div>\n          <audio id="bellring-audio" loop autoplay>\n            <source src="https://resource.eziot.com/group2/M00/00/8F/CtwQFmPbWnOAGuT5AAHZihhCJEM230.mp3" type="audio/mpeg">\n          </audio>\n          </div>',document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(d)}if(1!=this.themeData.customConfig.bellPoster||n)document.getElementById("bellring-icon")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon"));else{var l=1.8*o,c=6;document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&(c=document.getElementById("".concat(this.jSPlugin.id,"-headControl")).offsetHeight+.1*l+6);var u=c+(this.videoHeight-130*a)/2,m=document.createElement("div");m.id="bellring-icon",m.style="position: absolute;pointer-events: none;background: none;width: 100%;\n          position: absolute;top: ".concat(u,"px;display: flex;align-items: center;justify-content: center;"),m.innerHTML='<div style="width: '.concat(130*a,"px;height: ").concat(130*a,'px;display: flex;align-items: center;justify-content: center;border: 1px solid rgba(255,255,255,0.2);border-radius: 50%;">\n            <div style="width: ').concat(80*a,"px;height: ").concat(80*a,'px;display: flex;align-items: center;justify-content: center;border: 1px solid rgba(255,255,255,0.3);border-radius: 50%;">\n              <svg width="').concat(40*a,'px" height="').concat(40*a,'px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <title>icon/响铃</title>\n                  <g id="icon/响铃" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                      <polygon id="Path" points="0 0 40.0000002 0 40.0000002 40.0000002 0 40.0000002"></polygon>\n                      <path d="M20.0000001,4.25000002 C22.0363461,4.25000002 23.698175,5.84879552 23.8000507,7.8591997 L23.8050001,8.05500003 L23.805316,8.99953253 C27.1874196,9.97041766 29.6921839,13.0354462 29.80936,16.723731 L29.80936,16.723731 L29.8133335,16.9800001 L29.8133335,21.6416668 C29.8133335,22.3259481 30.0858837,22.9835569 30.5703302,23.4680033 L30.5703302,23.4680033 L31.6386635,24.5363367 C32.338953,25.2366262 32.760721,26.1675592 32.8273086,27.1785295 L32.8273086,27.1785295 L32.8350001,27.4233334 C32.8350001,29.577547 31.0892137,31.3233335 28.9350001,31.3233335 L28.9350001,31.3233335 L24.5666667,31.323 L24.5650266,31.3951531 C24.4527075,33.8194458 22.4520933,35.7500001 20.0000001,35.7500001 C17.5482065,35.7500001 15.5473098,33.8197367 15.4349743,31.3967059 L15.4326667,31.323 L11.0666667,31.3233335 C9.06159524,31.3233335 7.39851917,29.8069287 7.18810198,27.8229374 L7.17194359,27.6230185 L7.1666667,27.4233334 C7.1666667,26.3411154 7.59733134,25.3020086 8.36300328,24.5363367 L8.36300328,24.5363367 L9.43133662,23.4680033 C9.91578309,22.9835569 10.1883334,22.3259481 10.1883334,21.6416668 L10.1883334,21.6416668 L10.1883334,16.9800001 C10.1883334,13.1909619 12.7263704,9.99530436 16.1948593,8.99965364 L16.1950001,8.05500003 C16.1950001,5.95360729 17.8979654,4.25000002 20.0000001,4.25000002 Z M23.0656667,31.323 L16.9336667,31.323 L16.9352114,31.3619281 C17.0285826,32.9723844 18.3649772,34.2500001 20.0000001,34.2500001 C21.6352227,34.2500001 22.9714318,32.9721919 23.0647896,31.3604131 L23.0656667,31.323 Z M21.5116668,10.1783334 L18.4900001,10.1783334 C14.7336124,10.1783334 11.6883334,13.2231481 11.6883334,16.9800001 L11.6883334,16.9800001 L11.6883334,21.6416668 C11.6883334,22.7238848 11.2576687,23.7629916 10.4919968,24.5286635 L10.4919968,24.5286635 L9.42366346,25.5969969 C8.93921698,26.0814433 8.6666667,26.7390521 8.66637526,27.402427 L8.66637526,27.402427 L8.67048222,27.560237 C8.74130967,28.8268108 9.79171396,29.8233335 11.0666667,29.8233335 L11.0666667,29.8233335 L23.7906939,29.8222289 C23.8004164,29.8218553 23.8101862,29.8216668 23.8200001,29.8216668 L23.8486667,29.823 L28.9350001,29.8233335 C30.2055455,29.8233335 31.2450456,28.8367727 31.329826,27.609522 L31.3354106,27.4481422 L31.3293607,27.2529336 C31.2880301,26.6292837 31.0210852,26.0400787 30.5780034,25.5969969 L30.5780034,25.5969969 L29.50967,24.5286635 C28.7439981,23.7629916 28.3133335,22.7238848 28.3133335,21.6416668 L28.3133335,21.6416668 L28.3134279,16.9919039 L28.3098332,16.759466 C28.1934023,13.0970787 25.1864454,10.1783334 21.5116668,10.1783334 L21.5116668,10.1783334 Z M20.0000001,5.75000002 C18.7795808,5.75000002 17.7813801,6.69770708 17.7003155,7.89717688 L17.6950001,8.05500003 L17.6952875,8.7158769 C17.9568453,8.69103758 18.2219393,8.67833337 18.4900001,8.67833337 L18.4900001,8.67833337 L21.5116668,8.67833337 C21.7792577,8.67833337 22.0439466,8.69101238 22.3051575,8.71580951 L22.3050001,8.05500003 C22.3050001,6.7819079 21.273481,5.75000002 20.0000001,5.75000002 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                  </g>\n              </svg>\n            </div>\n          </div>'),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(m),i&&"onBell"==this.bellStatus&&this.jSPlugin.pause()}setTimeout((function(){var t=e.decoderState.state,i=t.isEditing,n=t.rejection;"onBell"!=e.bellStatus||n||(e.removeBellRing(),i||e.answerOvertime())}),this.maxBellTime)}}},{key:"removeBellRing",value:function(){document.getElementById("bellring")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring")),document.getElementById("bellring-icon")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon"))}},{key:"getMiniCallTimeUrl",value:function(){if(console.log("--------------getMiniCallTimeUrl"),-1!==this.jSPlugin.url.indexOf("hd.live")?this.recUrl=this.jSPlugin.url.replace("hd.live","rec"):this.recUrl=this.jSPlugin.url.replace("live","rec"),this.jSPlugin.callTime){var e=parseInt(this.jSPlugin.callTime),t=e+5e3,i=e-1e4,n=new Date(i).Format("yyyyMMddhhmmss"),o=new Date(t).Format("yyyyMMddhhmmss");this.recUrl="".concat(this.recUrl,"?begin=").concat(n,"&end=").concat(o),console.log("recurl="+this.recUrl)}}},{key:"initMiniRec",value:function(){var e=this,t=this,i=this.videoWidth,n=i/375,o=1.8*i,a=6;document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&(a=document.getElementById("".concat(this.jSPlugin.id,"-headControl")).offsetHeight+.1*o+6);var r=a+this.videoHeight+10*n;if(console.log(a),document.getElementById("miniRecbox"))document.getElementById("miniRecbox")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("miniRecbox")),document.getElementById("miniClose")&&document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("miniClose")),this.initMiniRec();else{var s=document.createElement("div");s.id="miniRecbox",s.style="-webkit-border-radius: 8px;border-radius: 8px;overflow: hidden;position: absolute;top: ".concat(r,"px;right: ").concat(9*n,"px;"),s.innerHTML='<div id="miniRec"></div>',document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(s),this.getMiniCallTimeUrl();var d={domain:"https://open.ys7.com"};this.miniRecPlayer=new Mt({id:"miniRec",width:160*n,height:90*n,template:"miniRec",url:this.recUrl,accessToken:this.jSPlugin.accessToken,handleError:function(i){console.log("小窗口handleError------------",i),i&&6701==i.retcode?(e.miniRecNum=e.miniRecNum+1,console.log("小窗口miniRecNum-----------------",e.miniRecNum),e.miniRecNum<5?t.miniRecPlayer.changePlayUrl({type:"miniRec"}):(console.log("小窗口------------------已播放5次，关闭小窗口"),t.miniRecCloseClick())):(console.log("小窗口------------------播放失败，关闭小窗口"),t.miniRecCloseClick())},env:this.jSPlugin.env||d});var l=document.createElement("div");l.id="miniClose",l.style="position: absolute;top: ".concat(r+8,"px;right: ").concat(16*n,"px;"),l.innerHTML='<div id="miniClose-btn" style="width: '.concat(24*n,"px;height: ").concat(24*n,'px;display: flex;align-items: center;justify-content: center;border-radius: 50%;background: rgba(0,0,0,0.1);">\n          <svg width="').concat(24*n,'px" height="').concat(24*n,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title>close</title>\n              <g id="icon/close" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="common/Close/Dark">\n                      <rect id="Rectangle" x="0" y="0" width="24" height="24"></rect>\n                      <path d="M18.1871843,5.81281566 C18.4556698,6.08130112 18.4780436,6.50270075 18.2543057,6.7966719 L18.1871843,6.87347584 L13.0611458,12.0001458 L18.1871843,17.1265242 C18.4800776,17.4194174 18.4800776,17.8942911 18.1871843,18.1871843 C17.9186989,18.4556698 17.4972993,18.4780436 17.2033281,18.2543057 L17.1265242,18.1871843 L12.0001458,13.0611458 L6.87347584,18.1871843 C6.58058262,18.4800776 6.10570888,18.4800776 5.81281566,18.1871843 C5.54433021,17.9186989 5.52195643,17.4972993 5.7456943,17.2033281 L5.81281566,17.1265242 L10.9391458,12.0001458 L5.81281566,6.87347584 C5.51992245,6.58058262 5.51992245,6.10570888 5.81281566,5.81281566 C6.08130112,5.54433021 6.50270075,5.52195643 6.7966719,5.7456943 L6.87347584,5.81281566 L12.0001458,10.9391458 L17.1265242,5.81281566 C17.4194174,5.51992245 17.8942911,5.51992245 18.1871843,5.81281566 Z" id="形状结合" fill="#fff" fill-rule="nonzero"></path>\n                  </g>\n              </g>\n          </svg>\n        </div>'),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(l),document.getElementById("miniClose-btn").onclick=function(){t.miniRecCloseClick()}}}},{key:"initMiniImageRec",value:function(){console.log("initMiniImageRec");var e=this.videoWidth,t=e/375,i=6;document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&(i=document.getElementById("".concat(this.jSPlugin.id,"-headControl")).offsetHeight+26);var n=i+this.videoHeight+10*t;if(document.getElementById("miniRecbox"))document.getElementById("miniRecbox").style.top=n+"px",document.getElementById("miniClose").style.top=n+8+"px";else{var o=document.createElement("div");o.id="miniRecbox",o.style="-webkit-border-radius: 8px;border-radius: 8px;overflow: hidden;position: absolute;\n        top: ".concat(n,"px;\n        right: ").concat(9*t,"px;\n        user-select: none;\n        "),o.innerHTML='<div id="miniRec" style="width: '.concat(160*t,"px;height: ").concat(90*t,'px;display: flex;align-items: center;justify-content: center;">\n          <embed id="miniRec-embed" style="z-index: 3;position: absolute;width: ').concat(160*t,"px;height: ").concat(90*t,'px;" type="image/svg+xml" src="https://resource.eziot.com/group1/M00/00/B8/CtwQEmPbGh2AVJB-ABDcYtyw5gk899.svg" />\n          <div style="color: #FFFFFF;font-size: 12px;z-index: 4;">示意小窗位置</div>\n        </div>'),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(o);var a=document.createElement("div");a.id="miniClose",a.style="z-index: 4;position: absolute;top: ".concat(n+8,"px;right: ").concat(16*t,"px;"),a.innerHTML='<div id="miniClose-btn" style="width: '.concat(24*t,"px;height: ").concat(24*t,'px;display: flex;align-items: center;justify-content: center;border-radius: 50%;">\n          <svg width="').concat(24*t,'px" height="').concat(24*t,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title>close</title>\n              <g id="icon/close" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="common/Close/Dark">\n                      <rect id="Rectangle" x="0" y="0" width="24" height="24"></rect>\n                      <path d="M18.1871843,5.81281566 C18.4556698,6.08130112 18.4780436,6.50270075 18.2543057,6.7966719 L18.1871843,6.87347584 L13.0611458,12.0001458 L18.1871843,17.1265242 C18.4800776,17.4194174 18.4800776,17.8942911 18.1871843,18.1871843 C17.9186989,18.4556698 17.4972993,18.4780436 17.2033281,18.2543057 L17.1265242,18.1871843 L12.0001458,13.0611458 L6.87347584,18.1871843 C6.58058262,18.4800776 6.10570888,18.4800776 5.81281566,18.1871843 C5.54433021,17.9186989 5.52195643,17.4972993 5.7456943,17.2033281 L5.81281566,17.1265242 L10.9391458,12.0001458 L5.81281566,6.87347584 C5.51992245,6.58058262 5.51992245,6.10570888 5.81281566,5.81281566 C6.08130112,5.54433021 6.50270075,5.52195643 6.7966719,5.7456943 L6.87347584,5.81281566 L12.0001458,10.9391458 L17.1265242,5.81281566 C17.4194174,5.51992245 17.8942911,5.51992245 18.1871843,5.81281566 Z" id="形状结合" fill="#fff" fill-rule="nonzero"></path>\n                  </g>\n              </g>\n          </svg>\n        </div>'),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).appendChild(a),document.getElementById("miniClose-btn").onclick=function(){}}}},{key:"miniRecCloseClick",value:function(){document.getElementById("miniRecbox")&&(console.log("---------------------miniRecCloseClick"),"rec"==this.miniRecStatus&&(this.miniRecPlayer&&this.miniRecPlayer.stop(),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("miniClose")),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).removeChild(document.getElementById("miniRecbox"))))}},{key:"miniRecSwitchClick",value:function(){console.log("---------------小窗口切换");var e=this.decoderState.state.isEditing,t=this.videoWidth,i=t/375,n=1.8*t,o=6;document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&(o=document.getElementById("".concat(this.jSPlugin.id,"-headControl")).offsetHeight+.1*n+6),console.log("headerHeight-------",o);var a=o+this.videoHeight+10*i;if(console.log("videoTop-------",a),"rec"==this.miniRecStatus){this.miniRecStatus="live",e?(document.getElementById("miniRec-embed").style.width=this.jSPlugin.width+"px",document.getElementById("miniRec-embed").style.height=this.jSPlugin.height+"px",document.getElementById("miniRec").style.width=this.jSPlugin.width+"px",document.getElementById("miniRec").style.height=this.jSPlugin.height+"px"):this.miniRecPlayer.reSize(this.jSPlugin.width,this.jSPlugin.height),this.jSPlugin.reSize(160*i,90*i);var r=this.videoHeight+10*i,s=.2*n-90*i-10*i;document.getElementById("".concat(this.jSPlugin.id,"-wrap")).style.width=this.videoWidth+"px",document.getElementById("".concat(this.jSPlugin.id)).style.marginTop=r+"px",document.getElementById("".concat(this.jSPlugin.id)).style.marginLeft=t-160*i-9+"px",document.getElementById("".concat(this.jSPlugin.id)).style.overflow="hidden",document.getElementById("".concat(this.jSPlugin.id)).style.borderRadius="8px",document.getElementById("miniRecbox").style.top=o+"px",document.getElementById("miniRecbox").style.left="0",document.getElementById("miniRecbox").style.right="0",document.getElementById("miniRecbox").style.borderRadius="0px",document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop=s+"px"}else console.log(this.jSPlugin.width),this.miniRecStatus="rec",e?(document.getElementById("miniRec-embed").style.width=160*i+"px",document.getElementById("miniRec-embed").style.height=90*i+"px",document.getElementById("miniRec").style.width=160*i+"px",document.getElementById("miniRec").style.height=90*i+"px"):this.miniRecPlayer.reSize(160*i,90*i),this.jSPlugin.reSize(this.videoWidth,this.videoHeight),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).style.width=this.videoWidth+NaN,document.getElementById("".concat(this.jSPlugin.id)).style.marginTop="0",document.getElementById("".concat(this.jSPlugin.id)).style.marginLeft="0",document.getElementById("".concat(this.jSPlugin.id)).style.overflow="hidden",document.getElementById("".concat(this.jSPlugin.id)).style.borderRadius="0px",document.getElementById("miniRecbox").style.top=a+"px",document.getElementById("miniRecbox").style.right="9px",document.getElementById("miniRecbox").style.left="auto",document.getElementById("miniRecbox").style.borderRadius="8px",document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop=.2*n+"px"}},{key:"matchBtn",value:function(e,t){var i=this,n=this.themeData,o=n.header,a=n.footer,r=this.decoderState.state,s=r.mute,d=r.rejection;document.documentElement.clientHeight;var l=this.videoWidth,c=l/375,u=this.videoWidth/375||1,m={title:"",id:"",domString:"",color:"#FFFFFF",activeColor:"#FFFFFF",onclick:function(){},onmoveleft:function(){},onmoveright:function(){},onremove:function(){}},p=o[this.bellStatus].btnList.findIndex((function(t){return t.iconId===e}));-1===p?(m.color=a[this.bellStatus].color,m.backgroundColor=a[this.bellStatus].backgroundColor,m.activeColor=a[this.bellStatus].activeColor):(m.color=o[this.bellStatus].color,m.backgroundColor=o[this.bellStatus].backgroundColor,m.activeColor=o[this.bellStatus].activeColor);var h=this.videoWidth/4;switch(e){case"ringStatus":return m.title=this.activeThemeStatus?"有人按门铃":this.activeThemeStatusTxt,m.id=e,m.domString='<span id="header-onBell-ringStatus" style="color:'.concat(t.color||"#2C2C2C",";font-size: ").concat(24*u,'px;display: block;font-weight: 600;" >').concat(this.activeThemeStatus?"有人按门铃":this.activeThemeStatusTxt,"</span>"),m.onclick=function(){},m;case"deviceCategory":return m.title="设备名称",m.id=e,m.domString='<span id="header-onBell-deviceCategory" \n          style="color:'.concat(t.color||"#2C2C2C",";\n          font-size: ").concat(14*u,"px;\n          padding-top: ").concat(5*u,'px;\n          display: block;\n          max-width: 100%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          ">').concat(this.deviceInfoData&&this.deviceInfoData.deviceName||"设备名称","</span>"),m.onclick=function(){},m;case"callStatus":return m.title="通话中",m.id=e,m.domString='<span id="header-onCall-ringStatus" style="color:'.concat(t.color||"#2C2C2C",";font-size: ").concat(24*u,'px;display: block;font-weight: 600;" >通话中</span>'),m.onclick=function(){},m;case"deviceCategory":return m.title="设备名称",m.id=e,m.domString='<span id="header-onCall-deviceCategory" \n          style="color:'.concat(t.color||"#2C2C2C",";\n          font-size: ").concat(14*u,"px;\n          padding-top: ").concat(5*u,'px;\n          display: block;\n          max-width: 100%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          ">').concat(this.deviceInfoData&&this.deviceInfoData.deviceName||"设备名称","</span>"),m.onclick=function(){},m;case"rejection":return m.title="拒绝",m.id=e,m.domString='<div style="width: '.concat(.66*h,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width:').concat(.66*h,"px;height: ").concat(.66*h,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.4*h,'px" height="').concat(.4*h,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>拒绝</title>\n                        <g id="icon/拒绝" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M16.0428281,19.9522968 C13.5228132,17.435123 11.1135994,14.5173605 12.2699084,13.3638925 C13.9205608,11.7132401 15.3581341,10.6961428 12.4346895,7.05675259 C9.50840386,3.41452132 7.55659974,6.21011849 5.95708632,7.80963191 C4.11324225,9.65631703 5.86049048,16.5345088 12.6591328,23.3359922 C19.4577751,30.1346345 26.3388079,31.8847238 28.1854931,30.0380386 C29.7850065,28.4385252 32.5806036,26.4895622 28.9412134,23.5632765 C25.3018232,20.6369909 24.2847259,22.0745642 22.6340735,23.7280576 C21.4777645,24.8786845 18.5628431,22.4694707 16.0428281,19.9522968 Z" id="路径" fill="#FFFFFF" fill-rule="nonzero" transform="translate(17.997936, 17.998157) rotate(135.000000) translate(-17.997936, -17.998157) "></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*h,'px;user-select: none;">拒绝</div>\n            </div>'),m.onclick=function(){var e=i,t=i.decoderState.state,n=t.play,o=t.isEditing,a=t.rejection;if(o||a)return!1;console.log("拒绝"),n&&i.jSPlugin.stop(),i.removeBellRing(),i.setDecoderState({play:!1,rejection:!0}),e.miniRecCloseClick(),i.rejectionStatusDispose(),"function"===typeof i.jSPlugin.hangUpCallback&&i.jSPlugin.hangUpCallback("rejection")},m;case"quickReply":return m.title="快捷回复",m.id=e,m.domString='<div id="'.concat(this.jSPlugin.id,'-btn-quickReply" style="width: ').concat(126*c,"px;height: ").concat(40*c,"px;color:").concat(d?"rgba(44,44,44,0.5)":m.color,';background: #F8F8F8;border-radius: 20px;display: flex;flex-direction: row;align-items: center;justify-content: center;-webkit-tap-highlight-color:transparent;">\n                <div>\n                  <svg width="').concat(24*c,'px" height="').concat(24*c,'px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                      <title>快捷回复</title>\n                      <g id="icon/H5快捷回复" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                          <rect id="Rectangle" x="0" y="0" width="24" height="24"></rect>\n                          <path d="M10.7238197,2.25008794 C16.2230834,2.09766093 20.7496,6.50749909 20.7496,11.9958 C20.7496,13.4362841 20.4368194,14.8344518 19.8413577,16.1117061 L19.9440524,15.8792521 L21.0527769,21.184554 C21.1496277,21.6485507 20.8013031,22.0657304 20.3577211,22.0873894 L20.2613374,22.0858497 L20.1628027,22.0714397 L14.866,20.946 L14.7518767,20.9973203 C13.6930577,21.439776 12.5585243,21.69208 11.3902258,21.7381162 L11.3902258,21.7381162 L10.9996,21.7458 C5.51196728,21.7458 1.10147008,17.2189531 1.25388722,11.7200456 C1.39490345,6.62610538 5.62990538,2.39110345 10.7238197,2.25008794 Z M11.0183931,3.74628651 L10.7653544,3.74951278 C6.46729462,3.86849655 2.87229655,7.46349462 2.75331206,11.7615803 C2.62431432,16.4155628 6.35610614,20.2458 10.9996,20.2458 C12.2165433,20.2458 13.3936843,19.9831552 14.4692454,19.4827855 C14.6166569,19.4142071 14.7823612,19.395387 14.9413973,19.4291603 L14.9413973,19.4291603 L19.349,20.365 L18.4274231,15.948046 C18.4026128,15.8291836 18.4071487,15.7066932 18.4398273,15.5909727 L18.4398273,15.5909727 L18.4818423,15.4778939 C18.9851908,14.3982208 19.2496,13.216279 19.2496,11.9958 C19.2496,7.35166383 15.4197191,3.62050444 10.7653544,3.74951278 Z M10.9996,10.7498 C11.6896,10.7498 12.2496,11.3098 12.2496,11.9998 C12.2496,12.6898 11.6896,13.2498 10.9996,13.2498 C10.3096,13.2498 9.7496,12.6898 9.7496,11.9998 C9.7496,11.3098 10.3096,10.7498 10.9996,10.7498 Z M6.9996,10.7498 C7.6896,10.7498 8.2496,11.3098 8.2496,11.9998 C8.2496,12.6898 7.6896,13.2498 6.9996,13.2498 C6.3096,13.2498 5.7496,12.6898 5.7496,11.9998 C5.7496,11.3098 6.3096,10.7498 6.9996,10.7498 Z M14.9996,10.7498 C15.6896,10.7498 16.2496,11.3098 16.2496,11.9998 C16.2496,12.6898 15.6896,13.2498 14.9996,13.2498 C14.3096,13.2498 13.7496,12.6898 13.7496,11.9998 C13.7496,11.3098 14.3096,10.7498 14.9996,10.7498 Z" id="形状结合" fill="').concat(d?"rgba(44,44,44,0.5)":"#2c2c2c",'" fill-rule="nonzero"></path>\n                      </g>\n                  </svg>\n                </div>\n                <div style="margin-left: 5px;user-select: none;font-size:14px">快捷回复<div>\n            </div>'),m.onclick=function(){var e=i.decoderState.state,t=e.isEditing,n=e.rejection;if(t||n)return!1;console.log("快捷回复"),i.switchFooter("quickReply"),i.quickReplyEle=new ht(i.jSPlugin,i.switchFooter,i.videoWidth)},m;case"answer":return m.title="接听",m.id=e,m.domString='<div style="width: '.concat(.66*h,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width: ').concat(.66*h,"px;height: ").concat(.66*h,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.4*h,'px" height="').concat(.4*h,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>接听</title>\n                        <g id="icon/接听" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M15.7728281,19.6822968 C13.2528132,17.165123 10.8435994,14.2473605 11.9999084,13.0938925 C13.6505608,11.4432401 15.0881341,10.4261428 12.1646895,6.78675259 C9.23840386,3.14452132 7.28659974,5.94011849 5.68708632,7.53963191 C3.84324225,9.38631703 5.59049048,16.2645088 12.3891328,23.0659922 C19.1877751,29.8646345 26.0688079,31.6147238 27.9154931,29.7680386 C29.5150065,28.1685252 32.3106036,26.2195622 28.6712134,23.2932765 C25.0318232,20.3669909 24.0147259,21.8045642 22.3640735,23.4580576 C21.2077645,24.6086845 18.2928431,22.1994707 15.7728281,19.6822968 Z" id="路径" fill="#FFFFFF" fill-rule="nonzero" transform="translate(17.727936, 17.728157) rotate(-360.000000) translate(-17.727936, -17.728157) "></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*h,'px;user-select: none;">接听</div>\n            </div>'),m.onclick=function(){var e=i.decoderState.state,n=e.play,r=e.isEditing,s=e.talk,d=e.sound,l=e.rejection;if(r||l)return!1;console.log("接听"),i.jSPlugin.pluginStatus.loadingClear(),i.bellStatus="onCall",i.switchFooter("onCall"),a[i.bellStatus].btnList.map((function(e,t){e.isrender&&i.renderFooter(e.iconId,e)})),o[i.bellStatus].btnList.map((function(e,t){e.isrender&&i.renderHeader(e.iconId,e)}));var c=document.getElementById("".concat(i.jSPlugin.id,"-header-onBell"));c&&c.parentElement.removeChild(c),1==i.themeData.customConfig.bellPoster&&(document.getElementById("bellring-icon")&&document.getElementById("".concat(i.jSPlugin.id,"-wrap")).removeChild(document.getElementById("bellring-icon")),i.jSPlugin.setPoster("")),i.removeBellRing(),i.miniRecCloseClick(),n||(i.jSPlugin.pluginStatus.loadingStart(i.jSPlugin.id),i.jSPlugin.pluginStatus.loadingSetText({text:"视频加载中"}),i.jSPlugin.play(),i.setDecoderState({play:!n})),s||1!=i.themeData.customConfig.defaultMicro||(i.setDecoderState({talk:!0,mute:!1}),d&&i.jSPlugin.closeSound(),i.jSPlugin.Talk.startTalk()),i.setDecoderState({sound:!1}),0==i.themeData.customConfig.defaultMicro&&(i.muteCommon(t),i.jSPlugin.openSound(),i.setDecoderState({sound:!0})),i.maxTalkTime=1e3*i.themeData.customConfig.maxTalkTime*60;var u=i;setTimeout((function(){s&&(console.log("结束对讲"),u.setDecoderState({talk:!1}),u.jSPlugin.Talk.stopTalk()),n&&(u.jSPlugin.stop(),u.setDecoderState({play:!n})),i.rejectionStatusDispose(),i.remoteUnlockEle&&i.remoteUnlockEle.closeRemoteUnlock(),"function"===typeof i.jSPlugin.hangUpCallback&&i.jSPlugin.hangUpCallback("hangUp")}),i.maxTalkTime)},m;case"remoteUnlock":return m.title="远程开锁",m.id=e,m.domString='<div style="width: '.concat(.66*h,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width: ').concat(.66*h,"px;height: ").concat(.66*h,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.4*h,'px" height="').concat(.4*h,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>开锁</title>\n                        <g id="icon/开锁" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M18,4 C21.3137085,4 24,6.6862915 24,10 L24,10 L24,19.787 L29.5,19.7875 C30.0522847,19.7875 30.5,20.2352153 30.5,20.7875 C30.5,21.3397847 30.0522847,21.7875 29.5,21.7875 L24,21.787 L24,26 C24,29.2383969 21.4344251,31.8775718 18.2249383,31.9958615 L18,32 C14.6862915,32 12,29.3137085 12,26 L12,26 L12,10 C12,6.6862915 14.6862915,4 18,4 Z M18,6 C15.790861,6 14,7.790861 14,10 L14,10 L14,26 C14,28.209139 15.790861,30 18,30 C20.209139,30 22,28.209139 22,26 L22,26 L22,21.787 L18.5,21.7875 C17.9477153,21.7875 17.5,21.3397847 17.5,20.7875 C17.5,20.2352153 17.9477153,19.7875 18.5,19.7875 L22,19.787 L22,10 C22,7.85780461 20.3160315,6.10892112 18.1996403,6.00489531 Z" id="形状结合" fill="#FFFFFF" fill-rule="nonzero"></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*h,'px;user-select: none;">远程开锁</div>\n            </div>'),m.onclick=function(){var e=i.decoderState.state,t=e.isEditing;e.play;var n=e.rejection;if(t||"onBell"==i.bellStatus||n)return!1;console.log("远程开锁"),i.switchFooter("remoteUnlock"),i.remoteUnlockEle=new ft(i.jSPlugin,i.switchFooter,i.videoWidth)},m;case"mute":return m.title="静音",m.id=e,m.domString='<div style="width: '.concat(.66*h,'px;display: flex;flex-direction: column;align-items: center;">\n                <div id="').concat(this.jSPlugin.id,'-icon-mute" style="width: ').concat(.66*h,"px;height: ").concat(.66*h,"px;border-radius: 50%;border: 1px solid ").concat(d?"#cccccc":t.backgroundColor,";background: ").concat(d&&s?"#cccccc":"#ffffff",';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.4*h,'px" height="').concat(.4*h,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>icon/静音</title>\n                        <g id="icon/静音" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path id="icon-mute-path" d="M29.2988305,7.56559704 C29.8540627,8.1086468 29.8980234,8.97727504 29.4240597,9.57172938 L29.3223594,9.6867869 L22.585,16.574 L22.5859243,26.0592702 C22.5859243,26.9500521 21.8638029,27.6721735 20.973021,27.6721735 C20.6007147,27.6721735 20.2398727,27.5433734 19.9517149,27.3076254 L15.583,23.733 L10.4341733,28.9987008 C9.85492024,29.5909486 8.9052312,29.6014828 8.31298346,29.0222298 C7.75775121,28.47918 7.71379057,27.6105518 8.18775419,27.0160974 L8.28945454,26.9010399 L27.1776406,7.58912597 C27.7568937,6.99687823 28.7065827,6.98634397 29.2988305,7.56559704 Z M22.2503608,7.16816759 C22.4679282,7.45036017 22.5859243,7.79665625 22.5859243,8.15298221 L22.585,9.899 L10.778,21.971 L9.47580645,21.9713498 C7.69424274,21.9713498 6.25,20.5271071 6.25,18.7455434 L6.25,15.65293 C6.25,13.8713663 7.69424274,12.4271235 9.47580645,12.4271235 L12.787,12.427 L19.9882064,6.87564241 C20.6936617,6.33174431 21.7064627,6.46271229 22.2503608,7.16816759 Z" id="形状结合" fill="').concat(s?"#ffffff":d?"#cccccc":t.backgroundColor,'"></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*h,'px;user-select: none;">静音</div>\n            </div>'),m.onclick=function(){var e=i.decoderState.state,n=e.talk,o=e.sound;e.play;var a=e.rejection;if(a)return!1;console.log("静音"),n?(console.log("结束对讲"),i.setDecoderState({talk:!1,mute:!0},t.backgroundColor),i.jSPlugin.Talk.stopTalk(),i.jSPlugin.openSound(),i.setDecoderState({sound:!0})):(console.log("开始对讲"),i.setDecoderState({talk:!0,mute:!1},t.backgroundColor),o&&(i.jSPlugin.closeSound(),i.setDecoderState({sound:!1})),i.jSPlugin.Talk.startTalk())},m;case"hangUp":return m.title="挂断",m.id=e,m.domString='<div style="width: '.concat(.66*h,'px;display: flex;flex-direction: column;align-items: center;">\n                <div style="width:').concat(.66*h,"px;height: ").concat(.66*h,"px;border-radius: 50%;background: ").concat(d?"#CCCCCC":t.backgroundColor,';display: flex;align-items: center;justify-content: center;" >\n                    <svg width="').concat(.4*h,'px" height="').concat(.4*h,'px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        <title>挂断</title>\n                        <g id="icon/挂断" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <rect id="Rectangle" x="0" y="0" width="36" height="36"></rect>\n                            <path d="M16.0428281,19.9522968 C13.5228132,17.435123 11.1135994,14.5173605 12.2699084,13.3638925 C13.9205608,11.7132401 15.3581341,10.6961428 12.4346895,7.05675259 C9.50840386,3.41452132 7.55659974,6.21011849 5.95708632,7.80963191 C4.11324225,9.65631703 5.86049048,16.5345088 12.6591328,23.3359922 C19.4577751,30.1346345 26.3388079,31.8847238 28.1854931,30.0380386 C29.7850065,28.4385252 32.5806036,26.4895622 28.9412134,23.5632765 C25.3018232,20.6369909 24.2847259,22.0745642 22.6340735,23.7280576 C21.4777645,24.8786845 18.5628431,22.4694707 16.0428281,19.9522968 Z" id="路径" fill="#FFFFFF" fill-rule="nonzero" transform="translate(17.997936, 17.998157) rotate(135.000000) translate(-17.997936, -17.998157) "></path>\n                        </g>\n                    </svg>\n                </div>\n                <div style="margin-top: ').concat(.1*h,'px;user-select: none;">挂断</div>\n            </div>'),m.onclick=function(){var e=i,t=i.decoderState.state,n=t.talk,o=t.play,a=t.rejection;if(a)return!1;n&&(console.log("结束对讲"),i.setDecoderState({talk:!1}),i.jSPlugin.Talk.stopTalk()),o&&(i.jSPlugin.stop(),i.setDecoderState({play:!o})),(o||n)&&(e.miniRecCloseClick(),console.log("挂断"),i.rejectionStatusDispose(),"function"===typeof i.jSPlugin.hangUpCallback&&i.jSPlugin.hangUpCallback("hangUp"))},m;default:return m}}},{key:"answerOvertime",value:function(){this.toastCustom.initToastContent("应答超时");var e=this.decoderState.state.play;console.log("应答超时"),e&&this.jSPlugin.stop(),this.setDecoderState({play:!1,rejection:!0}),this.miniRecCloseClick(),this.rejectionStatusDispose(),this.quickReplyEle&&this.quickReplyEle.closeQuickReplyEle(),"function"===typeof this.jSPlugin.hangUpCallback&&this.jSPlugin.hangUpCallback("rejection")}},{key:"rejectionStatusDispose",value:function(){var e=this,t=this.themeData.footer,i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),n=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")),o=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReplyBtn")),a=document.getElementById("header-".concat(this.bellStatus,"-ringStatus"));"onBell"==this.bellStatus?(i.innerHTML="",o.innerHTML="",i.style.color="#2C2C2C"):(n.innerHTML="",n.style.color="#2C2C2C"),console.log("rejectionStatusDispose"),this.setDecoderState({rejection:!0}),t[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderFooter(t.iconId,t)})),a.innerText="通话已结束",this.jSPlugin.pluginStatus.loadingClear(),this.jSPlugin.pluginStatus.loadingSetTextWithBtn({text:"通话已结束",color:"white",isMobile:!0,type:2})}},{key:"userNoDevice",value:function(){var e=this;this.removeBellRing(),this.setDecoderState({rejection:!0});var t=this.themeData.footer,i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),n=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")),o=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReplyBtn"));"onBell"==this.bellStatus?(i.innerHTML="",o.innerHTML="",i.style.color="#2C2C2C"):(n.innerHTML="",n.style.color="#2C2C2C"),console.log("userNoDevice"),this.setDecoderState({rejection:!0}),t[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderFooter(t.iconId,t)})),this.jSPlugin.pluginStatus.loadingClear(),this.jSPlugin.pluginStatus.loadingSetTextWithBtn({text:"该用户不拥有该设备",color:"white",isMobile:!0,type:2})}},{key:"renderHeader",value:function(e,t){var i=this,n=this.matchBtn(e,t);if(document.getElementById("".concat(this.jSPlugin.id,"-header-").concat(this.bellStatus,"-content"))){var o=document.createElement("span");o.innerHTML="".concat(n.domString),document.getElementById("".concat(this.jSPlugin.id,"-header-").concat(this.bellStatus,"-content")).appendChild(o)}else{var a=document.createElement("div");a.id="".concat(this.jSPlugin.id,"-header-").concat(this.bellStatus),a.style="max-width:50%;position:relative;",a.innerHTML='<span id="'.concat(this.jSPlugin.id,"-header-").concat(this.bellStatus,'-content" style="display:inline-block;height:auto;";>\n            ').concat(n.domString,"\n          </span>"),a.onclick=function(e){if(i.decoderState.state.isEditing)return!1;n.onclick(e)},document.getElementById("".concat(this.jSPlugin.id,"-headControl")).childNodes[0].appendChild(a)}}},{key:"renderFooter",value:function(e,t){var i=this,n=this.decoderState.state.mute;if("remoteUnlock"==e&&this.jSPlugin.capacity&&(!this.jSPlugin.capacity["support_unlock"]||0==this.jSPlugin.capacity["support_unlock"]))return!1;var o=this.matchBtn(e,t),a=this.videoWidth/4,r=document.createElement("div");if(r.className="theme-icon-item","quickReply"!==o.id&&(r.style="width:".concat(.66*a,"px;padding:0 ").concat(.12*a,"px;box-sizing: content-box;-webkit-tap-highlight-color:transparent;")),r.innerHTML="".concat('<span id="'.concat(this.jSPlugin.id,"-").concat(o.id,'" style="position:relative;">')+'<div id="'.concat(this.jSPlugin.id,"-").concat(o.id,'-content" title="').concat(o.title,'" style="display: flex;align-items: center;position:relative;">')).concat(o.domString,"</div>")+"</span>",r.onclick=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onclick(e)},o.onmouseenter&&(r.onmouseenter=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onmouseenter(e)}),o.onmouseleave&&(r.onmouseleave=function(e){if(i.decoderState.state.isEditing||!i.activeThemeStatus)return!1;o.onmouseleave(e)}),"quickReply"!=e){var s=document.createElement("span");s.className="icon-move left",s.innerHTML='<span id="'.concat(this.jSPlugin.id,"-").concat(o.id,'-left" title="左移" style="height: 40px;position: absolute;top: calc(50% - 33px);left: 1px;display: inline-block;border-radius: 2px;overflow: hidden;cursor: pointer;">\n          <svg width="10px" height="40px" viewBox="0 0 10 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title></title>\n              <g id="呼叫模板-控制台" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="H5呼叫模板" transform="translate(-614.000000, -5024.000000)">\n                      <g id="编组-28" transform="translate(421.000000, 4484.000000)">\n                          <g id="编组-9" transform="translate(23.000000, 522.000000)">\n                              <g id="编组" transform="translate(170.000000, 0.000000)">\n                                  <g id="箭头左" transform="translate(0.000000, 18.000000)">\n                                      <rect id="矩形" fill="#595959" x="0" y="0" width="10" height="40" rx="2"></rect>\n                                      <g id="1.通用/2.Icon图标/Common/Fill/Left" transform="translate(1.000000, 15.000000)" fill="#FFFFFF">\n                                          <path d="M3.88411064,2.46093277 L7.81658983,7.1799078 C7.99337187,7.39204625 7.96470984,7.7073286 7.75257139,7.88411064 C7.66271389,7.95899189 7.54944745,8 7.43247919,8 L-0.432479194,8 C-0.708621569,8 -0.932479194,7.77614237 -0.932479194,7.5 C-0.932479194,7.38303175 -0.891471084,7.2697653 -0.816589833,7.1799078 L3.11588936,2.46093277 C3.2926714,2.24879432 3.60795375,2.22013229 3.8200922,2.39691433 C3.84332373,2.41627394 3.86475103,2.43770124 3.88411064,2.46093277 Z" id="三角形" transform="translate(3.500000, 5.000000) scale(-1, -1) rotate(-270.000000) translate(-3.500000, -5.000000) "></path>\n                                      </g>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </g>\n          </svg>\n          </span>'),s.onclick=function(){i.editIcon(o.id,"left","footer")},r.appendChild(s);var d=document.createElement("span");d.className="icon-move right",d.innerHTML='<span id="'.concat(this.jSPlugin.id,"-").concat(o.id,'-right" class="ezuikit-theme-icon" title="右移" style="height: 40px;position: absolute;top: calc(50% - 33px);left: calc(100% - 11px);display: inline-block;border-radius: 2px;overflow: hidden;cursor: pointer;">\n          <svg width="10px" height="40px" viewBox="0 0 10 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n              <title></title>\n              <g id="呼叫模板-控制台" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                  <g id="H5呼叫模板" transform="translate(-684.000000, -5024.000000)">\n                      <g id="编组-28" transform="translate(421.000000, 4484.000000)">\n                          <g id="编组-9" transform="translate(23.000000, 522.000000)">\n                              <g id="编组" transform="translate(170.000000, 0.000000)">\n                                  <g id="箭头右" transform="translate(70.000000, 18.000000)">\n                                      <rect id="矩形" fill="#595959" x="0" y="0" width="10" height="40" rx="2"></rect>\n                                      <g id="1.通用/2.Icon图标/Common/Fill/Left" transform="translate(5.500000, 20.000000) scale(-1, 1) translate(-5.500000, -20.000000) translate(2.000000, 15.000000)" fill="#FFFFFF">\n                                          <path d="M3.88411064,2.46093277 L7.81658983,7.1799078 C7.99337187,7.39204625 7.96470984,7.7073286 7.75257139,7.88411064 C7.66271389,7.95899189 7.54944745,8 7.43247919,8 L-0.432479194,8 C-0.708621569,8 -0.932479194,7.77614237 -0.932479194,7.5 C-0.932479194,7.38303175 -0.891471084,7.2697653 -0.816589833,7.1799078 L3.11588936,2.46093277 C3.2926714,2.24879432 3.60795375,2.22013229 3.8200922,2.39691433 C3.84332373,2.41627394 3.86475103,2.43770124 3.88411064,2.46093277 Z" id="三角形" transform="translate(3.500000, 5.000000) scale(-1, -1) rotate(-270.000000) translate(-3.500000, -5.000000) "></path>\n                                      </g>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </g>\n          </svg>\n          </span>'),d.onclick=function(){i.editIcon(o.id,"right","footer")},r.appendChild(d)}if("answer"==e||"rejection"==e||"hangUp"==e);else{var l=document.createElement("span");l.className="icon-move close",l.innerHTML='<span id="'.concat(o.id,'-remove" class="ezuikit-theme-icon" title="移除" style="position: absolute;top: -6px;right: -2px;cursor: pointer;">\n            <svg width="16px" height="16px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <title></title>\n                <g id="呼叫模板-控制台" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <g id="H5呼叫模板" transform="translate(-680.000000, -5006.000000)">\n                        <g id="编组-28" transform="translate(421.000000, 4484.000000)">\n                            <g id="编组-9" transform="translate(23.000000, 522.000000)">\n                                <g id="编组" transform="translate(170.000000, 0.000000)">\n                                    <g id="关闭1" transform="translate(66.000000, 0.000000)">\n                                        <rect id="矩形" fill-rule="nonzero" x="0" y="0" width="18" height="18"></rect>\n                                        <path d="M9,1.125 C4.65117188,1.125 1.125,4.65117188 1.125,9 C1.125,13.3488281 4.65117188,16.875 9,16.875 C13.3488281,16.875 16.875,13.3488281 16.875,9 C16.875,4.65117188 13.3488281,1.125 9,1.125 Z M11.9074219,11.9917969 L10.7472656,11.9865234 L9,9.90351562 L7.25449219,11.9847656 L6.09257813,11.9900391 C6.01523438,11.9900391 5.95195313,11.9285156 5.95195313,11.8494141 C5.95195313,11.8160156 5.96425781,11.784375 5.98535156,11.7580078 L8.27226563,9.03339844 L5.98535156,6.31054687 C5.96425781,6.28417969 5.95195313,6.25253906 5.95195313,6.21914062 C5.95195313,6.14179687 6.01523438,6.07851562 6.09257813,6.07851562 L7.25449219,6.08378906 L9,8.16679687 L10.7455078,6.08554688 L11.9056641,6.08027344 C11.9830078,6.08027344 12.0462891,6.14179687 12.0462891,6.22089844 C12.0462891,6.25429687 12.0339844,6.2859375 12.0128906,6.31230469 L9.72949219,9.03515625 L12.0146484,11.7597656 C12.0357422,11.7861328 12.0480469,11.8177734 12.0480469,11.8511719 C12.0480469,11.9285156 11.9847656,11.9917969 11.9074219,11.9917969 Z" id="形状" fill="#595959"></path>\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </g>\n            </svg>\n          </span>'),l.onclick=function(){i.editIcon(o.id,"delete","footer")},r.appendChild(l)}"onCall"==this.bellStatus?document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).appendChild(r):(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).appendChild(r),"quickReply"===o.id&&document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReplyBtn")).appendChild(r)),this.decoderState.state.isEditing&&"mute"==e&&"onCall"==this.bellStatus&&(0!=this.themeData.customConfig.defaultMicro||n?this.setDecoderState({mute:!1},t.backgroundColor):this.setDecoderState({mute:!0},t.backgroundColor))}},{key:"switchFooter",value:function(e){var t=this.themeData.footer;switch(e){case"onBell":document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"))?"none"==document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.display&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="flex",document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReplyBtn")).style.display="flex",document.getElementById("".concat(this.jSPlugin.id,"-btn-quickReply")).style.display="flex"):(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="flex",document.getElementById("".concat(this.jSPlugin.id,"-audioControls-quickReplyBtn")).style.display="flex",document.getElementById("".concat(this.jSPlugin.id,"-btn-quickReply")).style.display="flex");break;case"onCall":document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.display="none",document.getElementById("".concat(this.jSPlugin.id,"-btn-quickReply")).style.display="none",document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.display="flex",this.themeData&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.color=t[this.bellStatus].color);break}}},{key:"initThemeData",value:function(){var e=this;console.log("-------------initThemeData");var t=this.themeData,i=t.header,n=t.footer,o=this.decoderState.state.isEditing,a=this.videoWidth,r=a/375,s=1.8*a,d=this.jSPlugin.id;if(this.isNeedRenderHeader=Z.findIndex(i[this.bellStatus].btnList,(function(e){return e.isrender>0}))>=0,this.isNeedRenderFooter=Z.findIndex(n[this.bellStatus].btnList,(function(e){return e.isrender>0}))>=0,this.isNeedRenderHeader)if(document.getElementById("".concat(this.jSPlugin.id,"-headControl")))document.getElementById("".concat(this.jSPlugin.id,"-headControl")).innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' style='display:flex;width:100%;overflow:hidden;justify-content: center;'></div>");else{var l,c=document.createElement("div");c.setAttribute("id","".concat(this.jSPlugin.id,"-headControl")),c.setAttribute("class","header-controls"),c.innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' class=\"header-controls-left\" style='display:flex;width:100%;overflow:hidden;justify-content: center;'></div>"),console.log(this.jSPlugin.height),this.jSPlugin.height;var u=(l={display:"flex","justify-content":"space-between",top:0,"z-index":999,color:"#FFFFFF",width:"100%",position:"relative","margin-bottom":.1*s+"px","align-items":"center","text-align":"center","font-size":"24ox"},g(l,"color","#2c2c2c"),g(l,"margin-top","6px"),l);c.style=yt(u),document.getElementById("".concat(d,"-wrap")).insertBefore(c,document.getElementById(d));var m=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&clearInterval(m)}),50)}else document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&document.getElementById("".concat(this.jSPlugin.id,"-headControl")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-headControl")));if(this.jSPlugin.height,this.isNeedRenderFooter)if(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")))document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop="".concat(.2*s,"px"),"onCall"==this.bellStatus?document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).innerHTML='\n              <div id="'.concat(this.jSPlugin.id,'-audioControls-quickReplyBtn" class="footer-controls" style=\'min-height: ').concat(40*r,"px;margin-bottom: ").concat(40*r,"px;display:flex;justify-content: center;width:100%;z-index:999;position: relative;'></div>\n              <div id=\"").concat(this.jSPlugin.id,'-audioControls" class="footer-controls" style=\'display:none;justify-content: space-around;padding: 0 8%;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-onCall" class="footer-controls" style=\'display:flex;justify-content: space-around;padding: 0 8%;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-quickReply" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-remoteUnlock" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              '):document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).innerHTML='\n              <div id="'.concat(this.jSPlugin.id,'-audioControls-quickReplyBtn" class="footer-controls" style=\'min-height: ').concat(40*r,"px;margin-bottom: ").concat(40*r,"px;display:flex;justify-content: center;width:100%;z-index:999;position: relative;'></div>\n              <div id=\"").concat(this.jSPlugin.id,'-audioControls" class="footer-controls" style=\'display:flex;justify-content: space-around;padding: 0 8%;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-onCall" class="footer-controls" style=\'display:none;justify-content: space-around;padding: 0 8%;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-quickReply" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              <div id="').concat(this.jSPlugin.id,'-audioControls-remoteUnlock" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n              '));else{var p=document.createElement("div");p.setAttribute("id","".concat(this.jSPlugin.id,"-ez-iframe-footer-container")),p.setAttribute("class","ez-iframe-footer-container");var h={position:"relative","margin-top":.2*s+"px",display:"flex","flex-wrap":"wrap","justify-content":"space-between","z-index":999,top:0,color:"#FFFFFF",width:"100%","align-items":"center","font-size":"12px"};p.style=yt(h),p.innerHTML='\n            <div id="'.concat(this.jSPlugin.id,'-audioControls-quickReplyBtn" class="footer-controls" style=\'min-height: ').concat(40*r,"px;margin-bottom: ").concat(40*r,"px;display:flex;justify-content: center;width:100%;z-index:999;position: relative;'></div>\n            <div id=\"").concat(this.jSPlugin.id,'-audioControls" class="footer-controls" style=\'display:flex;justify-content: space-around;padding: 0 8%;width:100%;z-index:999;position: relative;\'></div>\n            <div id="').concat(this.jSPlugin.id,'-audioControls-onCall" class="footer-controls" style=\'display:none;justify-content: space-around;padding: 0 8%;width:100%;z-index:999;position: relative;\'></div>\n            <div id="').concat(this.jSPlugin.id,'-audioControls-quickReply" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n            <div id="').concat(this.jSPlugin.id,'-audioControls-remoteUnlock" class="footer-controls" style=\'display:none;justify-content: center;width:100%;z-index:999;position: relative;\'></div>\n            '),P(p,document.getElementById(d))}else document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")));if(this.isNeedRenderHeader&&document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&i[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderHeader(t.iconId,t)})),this.isNeedRenderFooter&&document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=n[this.bellStatus].backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=n[this.bellStatus].color,n[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.renderFooter(t.iconId,t)}))),1!=this.themeData.customConfig.bellPoster||o)this.jSPlugin.setPoster("");else{this.jSPlugin.poster="https://resource.eziot.com/group1/M00/00/B8/CtwQEmPbGh2AVJB-ABDcYtyw5gk899.svg";var f=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(f),e.jSPlugin.setPoster(e.jSPlugin.poster))}),50)}if(this.activeThemeStatus){this.initBellRing();var v=this.checkIsAppleDevice()||!1;v?window.addEventListener("touchstart",this.autoPlayRing):window.addEventListener("click",this.autoPlayRing)}this.inited=!0,this.getCallDeviceInfo()}},{key:"checkIsAppleDevice",value:function(){var e=navigator.userAgent,t=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),i=e.indexOf("iPad")>-1,n=e.indexOf("iPhone")>-1||e.indexOf("Mac")>-1;return!!(t||i||n)}},{key:"renderThemeData",value:function(){var e=this,t=this.themeData,i=t.header,n=t.footer,o=this.decoderState.state.isEditing;if(this.isNeedRenderHeader&&i&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=i[this.bellStatus].color.replace("-diy",""),i[this.bellStatus].btnList.map((function(t,i){t.isrender&&e.setDecoderState(g({},t.iconId,e.decoderState.state[t.iconId]))}))),this.isNeedRenderFooter&&n)document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=n[this.bellStatus].backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=n[this.bellStatus].color.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")).style.color=n[this.bellStatus].color.replace("-diy",""),n[this.bellStatus].btnList.map((function(t,i){if(t.isrender&&e.setDecoderState(g({},t.iconId,e.decoderState.state[t.iconId])),console.log("-------------activeThemeStatus"),0==i&&!e.themeInited&&e.activeThemeStatus)var n=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(n),1!=e.themeData.customConfig.bellPoster||o?e.jSPlugin.play():e.jSPlugin.pluginStatus.loadingClear(),e.themeInited=!0)}),50)})),-1!==this.jSPlugin.url.indexOf("hd.live")&&this.setDecoderState({hd:!0}),this.themeData.autoFocus>0&&(this.autoFocus=parseInt(this.themeData.autoFocus),this.startAutoFocus(),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).addEventListener("click",(function(){e.stopAutoFocus()}))),this.setDecoderState({cloudRec:"cloud.rec"===j(this.jSPlugin.url).type,rec:"rec"===j(this.jSPlugin.url).type,type:j(this.jSPlugin.url).type});else if(!this.themeInited&&this.activeThemeStatus)var a=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(a),e.themeData&&e.themeData.customConfig&&1==e.themeData.customConfig.bellPoster&&!o?e.jSPlugin.pluginStatus.loadingClear():e.jSPlugin.play(),e.themeInited=!0)}),50);var r=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(r),e.jSPlugin.reSize(e.jSPlugin.params.width,e.jSPlugin.params.height))}),50);o||this.jSPlugin.isWebConsole?1==this.themeData.customConfig.miniWinRec?this.initMiniImageRec():this.miniRecCloseClick():setTimeout((function(){"onBell"==e.bellStatus&&e.jSPlugin.capacity&&1==e.jSPlugin.capacity["support_doorcall_playback"]&&(console.log("小窗口initMiniRec-------------设备能力集成功"),1==e.themeData.customConfig.miniWinRec&&(console.log("小窗口initMiniRec---------------画中画设置已开启"),(!e.deviceInfoData||e.deviceInfoData&&!e.deviceInfoData.isEncrypt)&&(console.log("小窗口initMiniRec---------------设备未加密"),e.miniRecNum=0,e.initMiniRec())))}),1e3)}},{key:"setThemeData",value:function(e,t){this.themeData=e,"onCall"==t&&(this.bellStatus="onCall")}},{key:"startAutoFocus",value:function(){var e=this,t=this.autoFocus;this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.autoFocusTimer=setTimeout((function(){document.getElementById("".concat(e.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.opacity=0,document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.pointerEvents="none")}),1e3*t)}},{key:"stopAutoFocus",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.opacity=1,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.pointerEvents="all"),this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.startAutoFocus()}},{key:"editIcon",value:function(e,t,i){console.log("编辑组件",e,t,i);var n=this.themeData;console.log("themeData",this.themeData);var o=this.themeData[i][this.bellStatus].btnList,a=Z.findIndex(o,(function(t){return t.iconId===e})),r=o[a];switch(t){case"delete":o[a].isrender=0;break;case"right":for(var s=-1,d=a+1;d<o.length;d++)if(o[d].part===o[a].part&&1==o[d].isrender){s=d;break}-1!==s&&(o[a]=o[s],o[s]=r);break;case"left":for(var l=-1,c=a-1;c>=0;c--)if(o[c].part===o[a].part&&1==o[c].isrender){l=c;break}-1!==l&&(o[a]=o[l],o[l]=r);break}console.log("new btnList",o),n[i][this.bellStatus].btnList=o,this.jSPlugin.Theme.changeTheme(n)}},{key:"countTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this;if(!document.getElementById(this.jSPlugin.id+"time-area")){var n=document.createElement("div");n.id=this.jSPlugin.id+"time-area",n.className="time-area",n.innerHTML='<span class="dot"></span><span class="value">00:00</span>',document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).appendChild(n)}if(this.countTimer&&clearInterval(this.countTimer),"add"===e){var o=t;document.getElementById(i.jSPlugin.id+"time-area").style.display="flex",this.countTimer=setInterval((function(){++o,document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML=a(o)}),1e3)}else"destroy"===e&&(this.countTimer&&clearInterval(this.countTimer),this.countTimer=void 0,document.getElementById(i.jSPlugin.id+"time-area")&&(document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML="00:00",document.getElementById(i.jSPlugin.id+"time-area").style.display="none"));function a(e){var t=parseInt(e),i=0,n=0,o="00",a="00",r="00";return t>59&&(i=parseInt(t/60),t=parseInt(t%60),i>59&&(n=parseInt(i/60),i=parseInt(i%60))),o=parseInt(t)>9?parseInt(t):"0"+parseInt(t),a=parseInt(i)>9?parseInt(i):"0"+parseInt(i),r=parseInt(n)>9?parseInt(n):"0"+parseInt(n),n>0?r+":"+a+":"+o:i>0?a+":"+o:"00:"+o}}},{key:"editStart",value:function(e){console.log("----------editStart1");var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"));document.getElementById("".concat(this.jSPlugin.id,"-headControl")),t&&t.setAttribute("class","footer-controls themeEditing"),i&&i.setAttribute("class","footer-controls themeEditing"),this.setDecoderState({isEditing:!0})}},{key:"editEnd",value:function(e){console.log("----------editEnd1");var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-headControl")),n=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall"));i&&i.setAttribute("class","header-controls"),t&&t.setAttribute("class","footer-controls"),n&&n.setAttribute("class","footer-controls")}},{key:"fetchThemeData",value:function(e){var t=this;switch(this.jSPlugin.themeId){case"pcLive":case"pcRec":case"mobileLive":case"mobileRec":case"miniRec":break;default:var i=function(e){0==e.meta.code&&e.data?(t.activeThemeStatus=!0,t.themeData=e.data,e.data.header&&(t.themeData.header=e.data.header,t.themeData.header[t.bellStatus].btnList=t.themeData.header[t.bellStatus].btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),e.data.footer&&(t.themeData.footer=e.data.footer,t.themeData.footer[t.bellStatus].btnList=t.themeData.footer[t.bellStatus].btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),t.jSPlugin.capacity?(t.initThemeData(),t.renderThemeData()):setTimeout((function(){t.initThemeData(),t.renderThemeData()}),300)):(t.activeThemeStatus=!1,t.jSPlugin.pluginStatus.loadingClear(),t.setDecoderState({rejection:!0}),"111021"==e.meta.code?(t.jSPlugin.pluginStatus.loadingSetText({text:"无效的模板id",color:"#fff",type:1}),t.activeThemeStatusTxt="无效的模板id"):"111023"==e.meta.code?(t.jSPlugin.pluginStatus.loadingSetText({text:"您的试用特权已到期，需前往轻应用控制台购买后使用。",color:"#fff",type:1}),t.activeThemeStatusTxt="试用特权已到期"):(t.jSPlugin.pluginStatus.loadingSetText({text:"模板未激活，请先在开放平台轻应用控制台购买模板",color:"#fff",type:1}),t.activeThemeStatusTxt="模板未激活"),t.themeData=vt.data,t.initThemeData(),t.renderThemeData())},n=function(){t.renderThemeData()};Xe(this.jSPlugin,e,i,n);break}}},{key:"getCallDeviceInfo",value:function(){var e=this;this.videoWidth;var t=function(t){200==t.code&&t.data&&(e.deviceInfoData=t.data,console.log("------------getDeviceInfo"),t.data.isEncrypt&&(console.log("小窗口miniRecCloseClick------------设备已加密"),e.miniRecCloseClick(),setTimeout((function(){e.jSPlugin.pluginStatus.loadingClear(),e.jSPlugin.pluginStatus.loadingSetText({text:"视频已加密",color:"#fff"})}),50)),document.getElementById("header-".concat(e.bellStatus,"-deviceCategory"))&&(document.getElementById("header-".concat(e.bellStatus,"-deviceCategory")).innerText=""+t.data.deviceName)),20018!=t.code||e.jSPlugin.isWebConsole||e.userNoDevice()};M(this.jSPlugin.env.domain+"/api/lapp/device/info","POST",{accessToken:this.jSPlugin.accessToken,deviceSerial:j(this.jSPlugin.url).deviceSerial},"",t)}},{key:"setHeaderText",value:function(e){console.log("setHeaderText");var t=this.videoWidth/375||1;document.getElementById("".concat(this.jSPlugin.id,"-deviceCategory-content"))&&(document.getElementById("".concat(this.jSPlugin.id,"-deviceCategory-content")).innerHTML='<span style="font-size: '.concat(24*t,'px;display: block">').concat(e,'</span><span style="font-size: ').concat(14*t,"px;padding-top: ").concat(5*t,'px;display: block;">').concat(this.deviceInfoData&&this.deviceInfoData.category||"","</span>"))}}]),e}(),_t=function(){function e(t){if(p(this,e),this.jSPlugin=t,this.videoWidth=t.width,this.autoFocus=0,this.autoFocusTimer=null,this.decoderState={state:{isEditing:!1,play:!1,sound:!1,recordvideo:!1,recordCount:"00:00",talk:!1,mute:!1,rejection:!1,cloudRec:"cloud.rec"===j(t.url).type,rec:"rec"===j(t.url).type,type:j(t.url).type}},console.log("matchEzopenUrl(jSPlugin.url)",j(t.url),this.decoderState.state),this.isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),"undefined"!==typeof t.isMobile&&(this.isMobile=t.isMobile),this.themeData={},"themeData"==this.jSPlugin.themeId&&(this.themeData=this.jSPlugin.params.themeData),this.jSPlugin.themeId)switch(this.isMobile?this.call=new St(this.jSPlugin,this.themeData,this.setDecoderState,this.decoderState):this.call=new mt(this.jSPlugin,this.themeData,this.setDecoderState,this.decoderState),this.jSPlugin.themeId){case"themeData":this.themeData=this.jSPlugin.params.themeData,this.call.initThemeData(),this.call.renderThemeData();break;default:this.call.fetchThemeData(this.jSPlugin.themeId);break}this.jSPlugin.Talk||(this.jSPlugin.Talk=new _e(this.jSPlugin)),w("".concat(this.jSPlugin.staticPath,"/speed/speed.css")),w("".concat(this.jSPlugin.staticPath,"/css/theme.css"))}return f(e,[{key:"changeTheme",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"onBell";if("string"===typeof e)switch(this.jSPlugin.themeId=e,this.jSPlugin.themeId){case"pcLive":case"mobileCall":case"webCall":this.call.initThemeData(),this.call.renderThemeData();break;default:this.call.fetchThemeData(e);break}else"object"===c(e)&&(this.themeData=e,this.call.setThemeData(e,i),this.call.initThemeData(),this.call.renderThemeData(),this.decoderState.state.isEditing&&t&&this.call.editStart());this.jSPlugin&&this.jSPlugin.handleThemeChange&&this.jSPlugin.handleThemeChange(e)}},{key:"setDecoderState",value:function(e,t){var i=this,n=this.themeData;n.header,n.footer,Object.keys(e).map((function(n){switch(n){case"mute":document.getElementById("".concat(i.jSPlugin.id,"-icon-mute"))&&(console.log("mute"),e[n]?(document.getElementById("".concat(i.jSPlugin.id,"-icon-mute")).style.background=t,document.getElementById("".concat(i.jSPlugin.id,"-icon-mute")).style.border=" 1px solid ".concat(t),document.getElementById("icon-mute-path").style.fill="#ffffff"):(document.getElementById("".concat(i.jSPlugin.id,"-icon-mute")).style.background="#ffffff",document.getElementById("".concat(i.jSPlugin.id,"-icon-mute")).style.border="1px solid ".concat(t),document.getElementById("icon-mute-path").style.fill=t));break}i.decoderState.state=Object.assign(i.decoderState.state,e)}))}},{key:"startAutoFocus",value:function(){var e=this,t=this.autoFocus;this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.autoFocusTimer=setTimeout((function(){document.getElementById("".concat(e.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.opacity=0,document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.pointerEvents="none")}),1e3*t)}},{key:"stopAutoFocus",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.opacity=1,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.pointerEvents="all"),this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.startAutoFocus()}},{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"editIcon",value:function(e,t,i){console.log("编辑组件",e,t,i);var n=this.themeData;console.log("themeData",this.themeData);var o=this.themeData[i].btnList,a=Z.findIndex(o,(function(t){return t.iconId===e})),r=o[a];switch(t){case"delete":if("rec"===e){if(-1===Z.findIndex(o,(function(e){return"cloudRec"===e.iconId&&1==e.isrender})))return this.jSPlugin.Message&&this.jSPlugin.Message["default"]("必须选中一种存储介质"),!1}else if("cloudRec"===e&&-1===Z.findIndex(o,(function(e){return"rec"===e.iconId&&1==e.isrender})))return this.jSPlugin.Message&&this.jSPlugin.Message["default"]("必须选中一种存储介质"),!1;o[a].isrender=0;break;case"right":for(var s=-1,d=a+1;d<o.length;d++)if(o[d].part===o[a].part&&1==o[d].isrender){s=d;break}-1!==s&&(o[a]=o[s],o[s]=r);break;case"left":for(var l=-1,c=a-1;c>=0;c--)if(o[c].part===o[a].part&&1==o[c].isrender){l=c;break}-1!==l&&(o[a]=o[l],o[l]=r);break}console.log("new btnList",o),n[i].btnList=o,this.changeTheme(n)}},{key:"countTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this;if(!document.getElementById(this.jSPlugin.id+"time-area")){var n=document.createElement("div");n.id=this.jSPlugin.id+"time-area",n.className="time-area",n.innerHTML='<span class="dot"></span><span class="value">00:00</span>',document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).appendChild(n)}if(this.countTimer&&clearInterval(this.countTimer),"add"===e){var o=t;document.getElementById(i.jSPlugin.id+"time-area").style.display="flex",this.countTimer=setInterval((function(){++o,document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML=a(o)}),1e3)}else"destroy"===e&&(this.countTimer&&clearInterval(this.countTimer),this.countTimer=void 0,document.getElementById(i.jSPlugin.id+"time-area")&&(document.getElementById(i.jSPlugin.id+"time-area").children[1].innerHTML="00:00",document.getElementById(i.jSPlugin.id+"time-area").style.display="none"));function a(e){var t=parseInt(e),i=0,n=0,o="00",a="00",r="00";return t>59&&(i=parseInt(t/60),t=parseInt(t%60),i>59&&(n=parseInt(i/60),i=parseInt(i%60))),o=parseInt(t)>9?parseInt(t):"0"+parseInt(t),a=parseInt(i)>9?parseInt(i):"0"+parseInt(i),r=parseInt(n)>9?parseInt(n):"0"+parseInt(n),n>0?r+":"+a+":"+o:i>0?a+":"+o:"00:"+o}}},{key:"editStart",value:function(e){var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-audioControls-onCall")),n=document.getElementById("".concat(this.jSPlugin.id,"-headControl"));n&&n.setAttribute("class","header-controls themeEditing"),t&&t.setAttribute("class","footer-controls themeEditing"),i&&i.setAttribute("class","footer-controls themeEditing"),this.setDecoderState({isEditing:!0})}},{key:"editEnd",value:function(e){var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),i=document.getElementById("".concat(this.jSPlugin.id,"-headControl"));i&&i.setAttribute("class","header-controls"),t&&t.setAttribute("class","footer-controls"),this.setDecoderState({isEditing:!1})}},{key:"setDisabled",value:function(e){}},{key:"getDeviceInfo",value:function(){var e=this,t=this.videoWidth/1024||1,i=function(i){200==i.code&&i.data&&(i.data.isEncrypt&&setTimeout((function(){e.jSPlugin.pluginStatus.loadingClear(),e.jSPlugin.pluginStatus.loadingSetText({text:"视频已加密",color:"#fff"})}),50),document.getElementById("".concat(e.jSPlugin.id,"-deviceCategory-content"))&&(document.getElementById("".concat(e.jSPlugin.id,"-deviceCategory-content")).style.maxWidth="100%",document.getElementById("".concat(e.jSPlugin.id,"-deviceCategory-content")).style.overflow="hidden",document.getElementById("".concat(e.jSPlugin.id,"-deviceCategory-content")).style.textOverflow="ellipsis",document.getElementById("".concat(e.jSPlugin.id,"-deviceCategory-content")).style.whiteSpace="nowrap",document.getElementById("".concat(e.jSPlugin.id,"-deviceCategory-content")).innerHTML='<span style="font-size: '.concat(32*t,'px;display: block">有人按门铃</span><span style="font-size: ').concat(24*t,"px;padding-top: ").concat(16*t,'px;display: block;">').concat(i.data.category,"</span>")))};M(this.jSPlugin.env.domain+"/api/lapp/device/info","POST",{accessToken:this.jSPlugin.accessToken,deviceSerial:j(this.jSPlugin.url).deviceSerial},"",i)}}]),e}();Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var bt=function(){function e(t,i){if(p(this,e),this.params=t,this.state={},this.jsPlugin=i,this.url="https://log.ys7.com/statistics.do?",t.env)switch(t.env){case"test12":this.url="https://test12dclog.ys7.com/statistics.do?";break;case"online":break;default:this.url=t.env;break}}return f(e,[{key:"uuid",value:function(){for(var e=[],t="0123456789abcdef",i=0;i<36;i++)e[i]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var n=e.join("");return n}},{key:"dclog",value:function(e){var t=this.url,i=Object.assign({},{systemName:"open_website_monitor"},{bn:"ezuikit-js"},e,{un:e.url},{st:(new Date).getTime(),h:window.location.pathname});Object.keys(i).forEach((function(e,n){var o=i[e];"string"===typeof i[e]&&(o=i[e].replace("%","%25")),"undefined"!==typeof i[e]&&(t+="".concat(0===n?"":"&").concat(e,"=").concat(encodeURIComponent(o)))}));var n=new Image;n.src=t}},{key:"localInfoLog",value:function(e){var t=this.url,i=window.location.protocol+"//"+window.location.host,n={systemName:"open_netstream_localinfo",Ver:"v6.0.0",PlatAddr:i,ExterVer:"v6.0.0",OpId:this.uuid(),CltType:102,AppId:"",playurl:encodeURIComponent(this.jsPlugin.url),StartTime:(new Date).Format("yyyy-MM-dd hh:mm:ss.S"),OS:navigator.platform};n=Object.assign(n,e),Object.keys(n).forEach((function(e,i){var o=n[e];"string"===typeof n[e]&&(o=n[e].replace("%","%25")),"undefined"!==typeof n[e]&&(t+="".concat(0===i?"":"&").concat(e,"=").concat(encodeURIComponent(o)))}));var o=new Image;o.src=t}},{key:"playLog",value:function(e){var t=this.url,i=t,n={systemName:"open_netstream_play_main",playurl:encodeURIComponent(this.jsPlugin.url),Time:(new Date).Format("yyyy-MM-dd hh:mm:ss.S"),Via:2,OpId:this.uuid()};n=Object.assign(n,e),Object.keys(n).forEach((function(e,t){var o=n[e];"string"===typeof n[e]&&(o=n[e].replace("%","%25")),"undefined"!==typeof n[e]&&(i+="".concat(0===t?"":"&").concat(e,"=").concat(encodeURIComponent(o)))}));var o=new Image;o.src=i}}]),e}();(function(e,t){"object"===c(i)&&"object"===c(i.exports)?i.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("EZUIPlayer requires a window with a document");return t(e)}:t(e)})("undefined"!==typeof window?window:void 0,(function(e,t){var i;function n(e,t){for(var i=document.getElementsByTagName("head")[0].getElementsByTagName("script"),n=!1,o=0;o<i.length;o++)i[o].getAttribute("src")==e&&(n=!0,t());if(!n){var a=document.createElement("script");a.setAttribute("src",e),a.onload=t,document.getElementsByTagName("head")[0].appendChild(a)}}function o(e,t){for(var i=document.getElementsByTagName("head")[0].getElementsByTagName("link"),n=!1,o=0;o<i.length;o++)i[o].getAttribute("href")==e&&(n=!0,t());if(!n){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href=e,a.onload=t,document.getElementsByTagName("head")[0].appendChild(a)}}function a(e,t,i,n,o,a){var r=e,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var e=JSON.parse(s.responseText);o(e)}},s.open(t,r,!0);var d=new FormData;for(var l in i)d.append(l,i[l]);s.send(d)}var r={EZUIKitPlayer:void 0,EZUIKitTalk:void 0,opt:{apiDomain:"https://open.ys7.com/api/lapp/live/talk/url",filePath:"https://open.ys7.com/assets/ezuikit_v2.6.4",accessToken:"",url:"",deviceSerial:"",channelNo:"",id:"",talkLink:"",rtcUrl:"",ttsUrl:"",stream:"",isReliesReady:!1,template:"simple",plugin:[],audio:1,autoplay:1,videoLoading:!1},state:(i={countTimer:void 0,recodeTime:0,recodeTimer:void 0},g(i,"recodeTime",0),g(i,"fetchDefaultList",!1),g(i,"page",0),g(i,"pageSize",5),i),handleTalkSuccess:function(){},handleTalkError:function(){}},s="https://open.ys7.com",d=s,l=function(t){var i=this;this.opt={id:t.id,apiDomain:s+"/api/lapp/live/talk/url",filePath:d+"/assets/ezuikit_v2.6.4",decoderVersion:"",accessToken:"",url:"",deviceSerial:"",channelNo:"",talkLink:"",rtcUrl:"",ttsUrl:"",stream:"",isReliesReady:!1,template:"simple",plugin:[],audio:1,autoplay:1,fullScreenStatus:0,bSupporDoubleClickFull:!0,videoLoading:!1},this.params=t,t.id&&(this.opt.id=t.id),t.accessToken&&(this.opt.accessToken=t.accessToken),"undefined"!==typeof t.audio&&(this.opt.audio=t.audio),"undefined"!==typeof t.decoderVersion&&(this.opt.decoderVersion=t.decoderVersion),"undefined"!==typeof t.env&&("undefined"!==typeof t.env.domain&&(s=t.env.domain,this.opt.apiDomain=s+"/api/lapp/live/talk/url"),"undefined"!==typeof t.env.filePathDomain&&(d=t.env.filePathDomain,this.opt.filePathDomain=t.env.filePathDomain)),t.url&&(this.opt.url=t.url,this.opt.deviceSerial=t.url.split("/")[3],this.opt.channelNo=t.url.split("/")[4].split(".")[0]),"undefined"!==typeof t.template&&(this.opt.template=t.template),t.plugin&&(this.opt.plugin=t.plugin),"undefined"!==typeof t.autoplay&&(this.opt.autoplay=t.autoplay?1:0),"undefined"!==typeof t.bSupporDoubleClickFull&&(this.opt.bSupporDoubleClickFull=t.bSupporDoubleClickFull),"undefined"!==typeof t.handleTalkSuccess&&(e.EZUIKit.handleTalkSuccess=t.handleTalkSuccess),"undefined"!==typeof t.handleTalkError&&(e.EZUIKit.handleTalkError=t.handleTalkError);var l=this.opt.id,u=document.getElementById(l);u.style.fontSize=0,u.style.overflowY="auto",u.style.position="relative";var m=document.createElement("iframe");function p(){switch(i.opt.template){case"simple":var e=s+"/ezopen/h5/iframe?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+t.accessToken+"&templete=0&id="+l+"&decoderVersion="+i.opt.decoderVersion,n="";return"undefined"!==typeof t.controls&&t.controls&&(console.log("typeof",c(t.controls)),n="play,voice,hd,fullScreen",t.controls.length>0&&(n=t.controls.join(","),e+="&controls="+n)),t.websocketParams&&(e+="&websocketParams="+JSON.stringify(t.websocketParams)),e;case"standard":return s+"/ezopen/h5/iframe?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+t.accessToken+"&templete=1&id="+l+"&decoderVersion="+i.opt.decoderVersion;case"security":return s+"/ezopen/h5/iframe_se?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+t.accessToken+"&templete=0&id="+l+"&decoderVersion="+i.opt.decoderVersion;case"theme":return e=s+"/jssdk/theme.html?url=".concat(t.url,"&accessToken=").concat(t.accessToken,"&id=").concat(l,"&isMobile=").concat(t.isMobile),"undefined"!==typeof t.isMobile&&(e+="&isMobile="+t.isMobile),"undefined"!==typeof t.autoplay&&(e+="&autoplay="+t.autoplay),"undefined"!==typeof t.domain&&"https://test12open.ys7.com"==t.domain&&(e+="&env=test12"),"undefined"!==typeof t.env&&"undefined"!==typeof t.env.domain&&"https://test12open.ys7.com"==t.env.domain&&(e+="&env=test12"),"undefined"!==typeof t.header&&(e+="&header="+t.header),e;default:return s+"/ezopen/h5/iframe?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+t.accessToken+"&templete=0&id="+l+"&decoderVersion="+i.opt.decoderVersion}}m.src=p();var h=document.getElementById(l).offsetHeight,f=document.getElementById(l).offsetWidth;t.height&&(h=parseInt(t.height),/\%$/.test(t.height)&&(f=document.getElementById(l).offsetWidth*(parseInt(t.height)/100))),t.width&&(f=parseInt(t.width),/\%$/.test(t.width)&&(f=document.getElementById(l).offsetWidth*(parseInt(t.width)/100))),m.width=f,m.height=h,m.id="EZUIKitPlayer-"+l,m.setAttribute("allowfullscreen",!0),m.setAttribute("allow","autoplay"),m.setAttribute("frameborder",0),u.appendChild(m);var g=i.opt.filePath+"/js/jquery.js",v="https://open.ys7.com/assets/layer/layer.js";n(g,(function(){n(v,(function(){if(y().headerContainer){var d=document.createElement("div");d.setAttribute("class","panel-top");var l=document.createElement("div");if(l.setAttribute("class","contros"),d.appendChild(l),u.insertBefore(d,m),y().capturePictureModule){var c=document.createElement("span");c.innerHTML='<span title="截图"><svg id="capturePicture" title="截图" t="1578882764585" class="icon" viewBox="0 0 1024 1024" version="1.1"  xmlns="http://www.w3.org/2000/svg" p-id="5958" width="24" height="24">  <path    d="M887.296 315.904h-153.6c-51.2 0-68.096-102.4-119.296-102.4H392.704c-34.304 0-51.2 102.4-102.4 102.4h-153.6c-29.696 0-51.2 21.504-51.2 51.2v439.296c0 25.6 21.504 47.104 51.2 47.104h751.104c29.696 0 51.2-21.504 51.2-51.2v-435.2c-0.512-30.208-21.504-51.2-51.712-51.2zM512 768c-115.2 0-204.8-89.6-204.8-200.704s89.6-200.704 204.8-200.704 204.8 89.6 204.8 200.704-93.696 200.704-204.8 200.704z m247.296-354.304c-12.8 0-25.6-12.8-25.6-25.6s12.8-25.6 25.6-25.6 25.6 12.8 25.6 25.6c0 17.408-12.8 25.6-25.6 25.6zM256 264.704c0-8.704-8.704-16.896-16.896-16.896h-51.2c-8.704 0-16.896 8.704-16.896 16.896V281.6H256v-16.896z m256 148.992c-85.504 0-153.6 68.096-153.6 153.6s68.096 153.6 153.6 153.6 153.6-68.096 153.6-153.6-68.096-153.6-153.6-153.6z"    fill="#ffffff" p-id="5959"></path></svg></span>',c.onclick=function(){i.capturePicture()},l.appendChild(c)}if(console.log("matchHeaderOpt().saveModule",y().saveModule),y().saveModule){var p=document.createElement("span");p.innerHTML='<span title="开始录像">  <svg id="startSave" t="1578882716693" class="icon" viewBox="0 0 1024 1024" version="1.1"    xmlns="http://www.w3.org/2000/svg" p-id="3782" width="24" height="24">    <path      d="M915.2 729.6l-128-76.8c-25.6-12.8-44.8-32-44.8-51.2V435.2c0-25.6 19.2-38.4 44.8-51.2l128-76.8c25.6-12.8 44.8 0 44.8 19.2V704c0 32-19.2 38.4-44.8 25.6z m-332.8 89.6H96c-51.2 0-89.6-38.4-89.6-89.6V332.8c0-51.2 38.4-89.6 89.6-89.6h486.4c51.2 0 89.6 38.4 89.6 89.6v396.8c0 51.2-38.4 89.6-89.6 89.6zM192 364.8c-32 6.4-57.6 32-64 64-12.8 57.6 38.4 115.2 96 102.4 32-6.4 57.6-32 64-70.4 12.8-57.6-38.4-108.8-96-96z m0 0"      p-id="3783" fill="#ffffff"></path>  </svg></span>',p.onclick=function(){i.startSave(),document.getElementById("startSave").setAttribute("class","icon hide"),document.getElementById("stopSave").setAttribute("class","icon")},l.appendChild(p);var h=document.createElement("span");h.innerHTML='<span title="结束录像"> <svg id="stopSave" t="1578882716693" class="icon hide" viewBox="0 0 1024 1024" version="1.1"   xmlns="http://www.w3.org/2000/svg" p-id="3782" width="24" height="24">   <path     d="M915.2 729.6l-128-76.8c-25.6-12.8-44.8-32-44.8-51.2V435.2c0-25.6 19.2-38.4 44.8-51.2l128-76.8c25.6-12.8 44.8 0 44.8 19.2V704c0 32-19.2 38.4-44.8 25.6z m-332.8 89.6H96c-51.2 0-89.6-38.4-89.6-89.6V332.8c0-51.2 38.4-89.6 89.6-89.6h486.4c51.2 0 89.6 38.4 89.6 89.6v396.8c0 51.2-38.4 89.6-89.6 89.6zM192 364.8c-32 6.4-57.6 32-64 64-12.8 57.6 38.4 115.2 96 102.4 32-6.4 57.6-32 64-70.4 12.8-57.6-38.4-108.8-96-96z m0 0"     p-id="3783" fill="red"></path> </svg> </span>',h.onclick=function(){i.stopSave(),document.getElementById("stopSave").setAttribute("class","icon hide"),document.getElementById("startSave").setAttribute("class","icon")},l.appendChild(h)}if(y().zoomModule){var f=document.createElement("span");f.innerHTML='<span title="开启电子放大">  <svg id="enableZoom" t="1578882639834" class="icon" viewBox="0 0 1000 1000" version="1.1"    xmlns="http://www.w3.org/2000/svg" p-id="2227" width="24" height="24">    <path      d="M830.6119 441.1089c0-193.7756-157.0939-350.8641-350.8775-350.8641S128.8559 247.3333 128.8559 441.1089 285.9508 791.972 479.7344 791.972 830.6119 634.8845 830.6119 441.1089zM483.2821 710.4863c-146.7975 0-265.8187-118.9953-265.8187-265.8088S336.4847 178.8697 483.2821 178.8697s265.8197 118.9953 265.8197 265.8078S630.0796 710.4863 483.2821 710.4863zM770.6031 653.5739l-72.6417 75.9485 141.6917 160.1814 82.0737-90.0739L770.6031 653.5739zM527.5849 267.4727h-88.60655762279428v132.90489048425167H306.0690340253259v88.60292721534799h132.90933675248866v132.9038911617923h88.60655762279428V488.9794719180395h132.90933675248866v-88.60292721534799H527.5849284006089V267.4726535408993z"      p-id="2228" fill="#ffffff"></path>  </svg></span>',f.onclick=function(){i.enableZoom(),document.getElementById("enableZoom").setAttribute("class","icon hide"),document.getElementById("closeZoom").setAttribute("class","icon")},l.appendChild(f);var g=document.createElement("span");g.innerHTML='<span title="关闭电子放大">  <svg id="closeZoom" t="1578882639834" class="icon hide" viewBox="0 0 1000 1000" version="1.1"    xmlns="http://www.w3.org/2000/svg" p-id="2227" width="24" height="24">    <path      d="M830.6119 441.1089c0-193.7756-157.0939-350.8641-350.8775-350.8641S128.8559 247.3333 128.8559 441.1089 285.9508 791.972 479.7344 791.972 830.6119 634.8845 830.6119 441.1089zM483.2821 710.4863c-146.7975 0-265.8187-118.9953-265.8187-265.8088S336.4847 178.8697 483.2821 178.8697s265.8197 118.9953 265.8197 265.8078S630.0796 710.4863 483.2821 710.4863zM770.6031 653.5739l-72.6417 75.9485 141.6917 160.1814 82.0737-90.0739L770.6031 653.5739zM527.5849 267.4727h-88.60655762279428v132.90489048425167H306.0690340253259v88.60292721534799h132.90933675248866v132.9038911617923h88.60655762279428V488.9794719180395h132.90933675248866v-88.60292721534799H527.5849284006089V267.4726535408993z"      p-id="2228" fill="red"></path>  </svg></span>',g.onclick=function(){i.closeZoom(),document.getElementById("closeZoom").setAttribute("class","icon hide"),document.getElementById("enableZoom").setAttribute("class","icon")},l.appendChild(g)}}function v(){var e={footerContainer:!1,talkModule:!1,broadcastModule:!1,hdModule:!1,fullScreenModule:!1},n=i.opt.template;switch(n){case"simple":if(t.footer&&t.footer instanceof Array){var o=t.footer;e={footerContainer:!0,talkModule:-1!==o.indexOf("talk"),broadcastModule:-1!==o.indexOf("broadcast"),hdModule:-1!==o.indexOf("hd"),fullScreenModule:-1!==o.indexOf("fullScreen")}}break;case"standard":if(t.footer&&t.footer instanceof Array){o=t.footer;e={footerContainer:!0,talkModule:-1!==o.indexOf("talk"),broadcastModule:-1!==o.indexOf("broadcast"),hdModule:-1!==o.indexOf("hd"),fullScreenModule:-1!==o.indexOf("fullScreen")}}break;case"security":break;case"voice":e={footerContainer:!0,talkModule:!0,broadcastModule:!0,hdModule:!0,fullScreenModule:!0};break}return e}function y(){var e={headerContainer:!1,capturePictureModule:!1,saveModule:!1,zoomModule:!1},n=i.opt.template;switch(n){case"simple":if(t.header&&t.header instanceof Array){var o=t.header;e={headerContainer:!0,capturePictureModule:-1!==o.indexOf("capturePicture"),saveModule:-1!==o.indexOf("save"),zoomModule:-1!==o.indexOf("zoom")}}break;case"standard":break;case"security":break;case"voice":e={headerContainer:!0,capturePictureModule:!0,saveModule:!0,zoomModule:!0};break}return e}if(v().footerContainer||-1!==i.opt.plugin.indexOf("talk")){var S=i.opt.filePath+"/npm/css/recoder.css",_=i.opt.filePath+"/npm/js/recoder.js",b=i.opt.filePath+"/recorder.js";if(o(S,(function(){})),n(_,(function(){n(b,(function(){}))})),-1!==i.opt.plugin.indexOf("talk")||v().talkModule){var C=function(t){if(console.log("data",t),200==t.code){var o=t.data;if(o){var a=o.rtcUrl;-1===a.indexOf("ws")&&(a=a.replace("https","wss").replace("rtcgw","rtcgw-ws")),i.opt.rtcUrl=a,i.opt.ttsUrl="tts://"+o.ttsUrl;var s="talk://"+i.opt.deviceSerial+":0:"+i.opt.channelNo+":cas.ys7.com:6500";if(i.opt.talkLink=i.opt.ttsUrl+"/"+s,i.opt.stream=o.stream,console.log("_this.opt",i.opt),!i.opt.isReliesReady){var d=i.opt.filePath+"/npm/js/adapeter.js",l=i.opt.filePath+"/npm/js/janus.js",c=i.opt.filePath+"/npm/js/tts.js";console.log("加载jquery.js"),n(d,(function(){console.log("加载adapeter.js"),n(l,(function(){console.log("加载janus.js"),n(c,(function(){console.log("加载tts.js"),i.opt.isReliesReady=!0}))}))}),(function(){return!!e.adapter}))}if(!document.getElementById("audioleft")){var u=document.createElement("div");u.style.display="none",u.id="audioleft",document.body.appendChild(u)}if(!document.getElementById("audioright")){var m=document.createElement("div");m.style.display="none",m.id="audioright",document.body.appendChild(m)}}}r.opt=i.opt,e.EZUIKit&&(e.EZUIKit.opt=i.opt)};a(i.opt.apiDomain,"POST",{accessToken:i.opt.accessToken,deviceSerial:i.opt.deviceSerial,channelNo:i.opt.channelNo},"",C)}if(v().footerContainer){var T=function(e,t){if(clearInterval(r.state.countTimer),"add"===e){var i=t;r.state.countTimer=setInterval((function(){++i,document.getElementById("time-area").innerHTML=n(i)}),1e3)}else if("sub"===e){i=t;r.state.countTimer=setInterval((function(){i>0?(i--,document.getElementById("time-area").innerHTML=n(i)):(clearInterval(r.state.countTimer),r.state.countTimer=void 0,console.log("倒计时结束，开启声音"))}),1e3)}else"destory"===e&&(clearInterval(r.state.countTimer),r.state.countTimer=void 0,document.getElementById("time-area").innerHTML="00:00");function n(e){var t=parseInt(e),i=0,n=0,o="00",a="00",r="00";return t>59&&(i=parseInt(t/60),t=parseInt(t%60),i>59&&(n=parseInt(i/60),i=parseInt(i%60))),o=parseInt(t)>9?parseInt(t):"0"+parseInt(t),a=parseInt(i)>9?parseInt(i):"0"+parseInt(i),r=parseInt(n)>9?parseInt(n):"0"+parseInt(n),n>0?r+":"+a+":"+o:i>0?a+":"+o:"00:"+o}},w=document.createElement("div");if(w.setAttribute("class","audio-controls"),u.appendChild(w),v().hdModule||v().fullScreenModule){var k=document.createElement("div");if(k.setAttribute("class","contros"),w.appendChild(k),v().hdModule){var E=document.createElement("span");E.setAttribute("id","video-hd"),E.innerHTML=-1===i.opt.url.indexOf(".hd")?"标清":"高清",E.onclick=function(){if(i.opt.videoLoading)return layer.msg("视频加载中，请稍后"),!1;var e=i.stop();i.opt.videoLoading=!0,e.then((function(e){i.opt.videoLoading=!1,-1===i.opt.url.indexOf(".hd")?(i.opt.url=i.opt.url.replace(".live",".hd.live"),E.innerHTML=-1===i.opt.url.indexOf(".hd")?"标清":"高清"):(i.opt.url=i.opt.url.replace(".hd.live",".live"),E.innerHTML=-1===i.opt.url.indexOf(".hd")?"标清":"高清"),i.play(i.opt.url)}))["catch"]((function(e){console.log("error",e)}))},k.appendChild(E)}if(v().fullScreenModule){var P=document.createElement("span");P.setAttribute("class","hide"),P.setAttribute("id","ezuikit-open-sound"),P.setAttribute("title","打开声音"),P.setAttribute("style","vertical-align: top;"),P.innerHTML='<svg t="1590476263239" class="icon" viewBox="0 0 1178 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2273" width="16" height="16"><path d="M665.6 51.2 665.6 51.2c-10.24-30.72-40.96-51.2-71.68-51.2-5.12 0-15.36 0-20.48 5.12l0 0L358.4 153.6 51.2 209.92l0 0C20.48 220.16 0 250.88 0 281.6 0 286.72 0 291.84 0 307.2l0 0 0 409.6 0 0c0 15.36 0 20.48 0 25.6 0 30.72 20.48 61.44 51.2 71.68l0 0L358.4 870.4l97.28 71.68 107.52 76.8 0 0c5.12 5.12 15.36 5.12 25.6 5.12 40.96 0 76.8-35.84 76.8-76.8 0-10.24 0-10.24 0-25.6l0 0L665.6 51.2zM563.2 870.4l-153.6-102.4-307.2-51.2L102.4 307.2l307.2-51.2 153.6-102.4L563.2 870.4z" p-id="2274" fill="#FF0000"></path><path d="M1049.6 537.6l112.64-112.64c20.48-20.48 20.48-56.32 0-76.8-20.48-20.48-56.32-20.48-76.8 0L972.8 460.8l-112.64-112.64c0 0 0 0 0 0-20.48-20.48-56.32-20.48-76.8 0 0 0 0 0 0 0-20.48 20.48-20.48 56.32 0 76.8l112.64 112.64-112.64 112.64c-20.48 20.48-20.48 56.32 0 76.8 20.48 20.48 56.32 20.48 76.8 0L972.8 614.4l112.64 112.64c20.48 20.48 56.32 20.48 76.8 0s20.48-56.32 0-76.8L1049.6 537.6z" p-id="2275" fill="#FF0000"></path></svg>',P.onclick=function(){i.openSound(0),P.setAttribute("class","hide"),I.setAttribute("class","")};var I=document.createElement("span");P.setAttribute("id","ezuikit-close-sound"),I.setAttribute("class","hide"),I.setAttribute("title","关闭声音"),I.setAttribute("style","vertical-align: top;"),I.innerHTML='<svg t="1590414410633" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20545" width="16" height="16"><path d="M840.533333 98.133333c-17.066667-17.066667-42.666667-17.066667-59.733333 0-17.066667 17.066667-17.066667 42.666667 0 59.733334C883.2 256 938.666667 392.533333 938.666667 533.333333c0 140.8-55.466667 277.333333-157.866667 375.466667-17.066667 17.066667-17.066667 42.666667 0 59.733333 8.533333 8.533333 21.333333 12.8 29.866667 12.8 8.533333 0 21.333333-4.266667 29.866666-12.8 115.2-110.933333 183.466667-268.8 183.466667-435.2 0-166.4-68.266667-324.266667-183.466667-435.2zM571.733333 12.8c-17.066667-8.533333-34.133333-4.266667-46.933333 8.533333L281.6 256H42.666667c-25.6 0-42.666667 17.066667-42.666667 42.666667v426.666666c0 25.6 17.066667 42.666667 42.666667 42.666667h238.933333l243.2 234.666667c8.533333 8.533333 17.066667 12.8 29.866667 12.8 4.266667 0 12.8 0 17.066666-4.266667 17.066667-8.533333 25.6-21.333333 25.6-38.4V51.2c0-17.066667-8.533333-34.133333-25.6-38.4zM512 870.4l-183.466667-179.2c-8.533333-4.266667-17.066667-8.533333-29.866666-8.533333H85.333333V341.333333h213.333334c12.8 0 21.333333-4.266667 29.866666-12.8L512 153.6v716.8z" p-id="20546" fill="#ffffff"></path><path d="M759.466667 349.866667c-12.8-21.333333-38.4-25.6-59.733334-8.533334-21.333333 12.8-25.6 38.4-8.533333 59.733334 21.333333 29.866667 34.133333 76.8 34.133333 123.733333 0 46.933333-12.8 93.866667-34.133333 123.733333-12.8 21.333333-8.533333 46.933333 8.533333 59.733334 8.533333 4.266667 17.066667 8.533333 25.6 8.533333 12.8 0 25.6-4.266667 34.133334-17.066667 34.133333-46.933333 51.2-106.666667 51.2-174.933333 0-68.266667-17.066667-128-51.2-174.933333z" p-id="20547" fill="#ffffff"></path></svg>',I.onclick=function(){i.closeSound(0),P.setAttribute("class",""),I.setAttribute("class","hide")},k.appendChild(P),k.appendChild(I)}if(1==i.opt.audio?I.setAttribute("class",""):(P.setAttribute("class",""),i.closeSound(0)),v().fullScreenModule){var x=document.createElement("span");x.setAttribute("title","全屏"),x.setAttribute("style","vertical-align: top;"),x.innerHTML='<svg id="fullScreen" t="1578020167938" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5035" width="16" height="16"> <path d="M348.373333 625.706667l-128 128-64 64v-128a33.28 33.28 0 0 0-35.413333-35.413334A33.493333 33.493333 0 0 0 85.333333 689.706667v213.333333A33.706667 33.706667 0 0 0 120.96 938.666667h213.333333a35.626667 35.626667 0 0 0 0-71.04h-128l64-64 128-128a35.2 35.2 0 0 0-49.92-49.92zM206.293333 156.373333h128a33.28 33.28 0 0 0 35.413334-35.413333A33.493333 33.493333 0 0 0 334.293333 85.333333H113.706667c-7.04 0-14.08 7.04-21.333334 14.293334a26.026667 26.026667 0 0 0-7.04 21.333333v213.333333a33.493333 33.493333 0 0 0 35.626667 35.413334 33.28 33.28 0 0 0 35.413333-35.413334v-128l192 192a35.2 35.2 0 0 0 49.92-49.92zM903.04 85.333333h-213.333333a33.493333 33.493333 0 0 0-35.413334 35.626667 33.28 33.28 0 0 0 35.413334 35.413333h128l-64 64-128 128a35.2 35.2 0 0 0 49.92 49.92l128-128 64-64v128a35.626667 35.626667 0 0 0 71.04 0v-213.333333A33.706667 33.706667 0 0 0 903.04 85.333333zM903.04 654.293333a33.28 33.28 0 0 0-35.413333 35.413334v128l-64-64-128-128a35.2 35.2 0 0 0-49.92 49.92l128 128 64 64h-128a35.626667 35.626667 0 0 0 0 71.04h213.333333A33.706667 33.706667 0 0 0 938.666667 903.04v-213.333333a33.493333 33.493333 0 0 0-35.626667-35.413334z" p-id="5036" fill="#ffffff"></path></svg>',x.onclick=function(){i.fullScreen()},k.appendChild(x)}}if(v().talkModule){var R=document.createElement("div"),A=document.createElement("div");R.setAttribute("class","ptp-talk off"),R.innerHTML='<span title="对讲"><svg t="1581930496966" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  p-id="1641" width="16" height="16">  <path    d="M715.648 647.872c-30.208-22.336-61.568 39.36-100.992 77.44-39.36 38.08-34.112 31.488-123.392-17.088S311.488 540.224 280 491.648C248.448 443.072 265.472 424.704 265.472 424.704s78.72-62.976 97.152-81.344c18.368-18.368 13.12-30.208 13.12-30.208l-128.64-190.144c-23.616-5.184-64.32 5.12-128.576 57.6C54.208 233.088 30.592 353.856 151.296 575.68c120.768 221.824 347.84 330.752 485.568 374.08 137.856 43.328 228.416-61.696 249.408-103.68 21.056-41.984 13.12-85.312 13.12-85.312S745.856 670.208 715.648 647.872z"    p-id="1642" fill="#ffffff"></path>  <path    d="M715.328 64C580.992 64 472.192 172.864 472.192 307.2s108.8 243.2 243.136 243.2 243.2-108.864 243.2-243.2S849.6 64 715.328 64zM715.328 461.056c-84.992 0-153.856-68.864-153.856-153.856s68.864-153.856 153.856-153.856 153.856 68.928 153.856 153.856S800.32 461.056 715.328 461.056z"    p-id="1643" fill="#ffffff"></path>  <path    d="M777.472 277.376c-18.176 0-32.96-14.784-32.96-33.024 0-8.448 3.136-16.064 8.32-21.888-11.52-5.12-24.128-8-37.568-8-51.2 0-92.672 41.472-92.672 92.736s41.472 92.736 92.672 92.736S808.064 358.4 808.064 307.2c0-13.696-3.072-26.688-8.384-38.4C793.728 274.112 786.048 277.376 777.472 277.376zM715.328 340.928c-18.624 0-33.664-15.104-33.664-33.728 0-18.624 15.04-33.728 33.664-33.728 18.688 0 33.728 15.104 33.728 33.728C749.056 325.824 734.016 340.928 715.328 340.928z"    p-id="1644" fill="#ffffff"></path> </svg> </span> <span>开启对讲</span>',R.onclick=function(){if(console.log("EZUIKit.state.countTimer",r.state.countTimer),r.state.countTimer)return e.layer.msg("语音设备正忙，请稍后重试"),!1;T("add",0),console.log("开始对讲，关闭声音"),i.closeSound(0),console.log(i.opt),i.startTalk(),this.setAttribute("class","ptp-talk off hide"),A.setAttribute("class","ptp-talk on")},A.setAttribute("class","ptp-talk on hide"),A.innerHTML='<span title="对讲"> <svg t="1581930496966" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1641" width="16" height="16">    <path      d="M715.648 647.872c-30.208-22.336-61.568 39.36-100.992 77.44-39.36 38.08-34.112 31.488-123.392-17.088S311.488 540.224 280 491.648C248.448 443.072 265.472 424.704 265.472 424.704s78.72-62.976 97.152-81.344c18.368-18.368 13.12-30.208 13.12-30.208l-128.64-190.144c-23.616-5.184-64.32 5.12-128.576 57.6C54.208 233.088 30.592 353.856 151.296 575.68c120.768 221.824 347.84 330.752 485.568 374.08 137.856 43.328 228.416-61.696 249.408-103.68 21.056-41.984 13.12-85.312 13.12-85.312S745.856 670.208 715.648 647.872z"      p-id="1642" fill="#ff0000"></path>    <path      d="M715.328 64C580.992 64 472.192 172.864 472.192 307.2s108.8 243.2 243.136 243.2 243.2-108.864 243.2-243.2S849.6 64 715.328 64zM715.328 461.056c-84.992 0-153.856-68.864-153.856-153.856s68.864-153.856 153.856-153.856 153.856 68.928 153.856 153.856S800.32 461.056 715.328 461.056z"      p-id="1643" fill="#ff0000"></path>    <path      d="M777.472 277.376c-18.176 0-32.96-14.784-32.96-33.024 0-8.448 3.136-16.064 8.32-21.888-11.52-5.12-24.128-8-37.568-8-51.2 0-92.672 41.472-92.672 92.736s41.472 92.736 92.672 92.736S808.064 358.4 808.064 307.2c0-13.696-3.072-26.688-8.384-38.4C793.728 274.112 786.048 277.376 777.472 277.376zM715.328 340.928c-18.624 0-33.664-15.104-33.664-33.728 0-18.624 15.04-33.728 33.664-33.728 18.688 0 33.728 15.104 33.728 33.728C749.056 325.824 734.016 340.928 715.328 340.928z"      p-id="1644" fill="#ff0000"></path>  </svg> </span><span>关闭对讲</span>',A.onclick=function(){console.log(i.opt),i.stopTalk(),T("destory",0),i.openSound(0),this.setAttribute("class","ptp-talk on hide"),R.setAttribute("class","ptp-talk off")},w.appendChild(R),w.appendChild(A)}if(v().broadcastModule){var D=function e(t){function n(i){console.log("data",i),200==i.code&&(B(i.data,5),r.state.page=i.page.page,0!=t||0!=i.data.length||r.state.fetchDefaultList||(r.state.fetchDefaultList=!0,e(0)))}a(s+"/api/lapp/voice/query","POST",{accessToken:i.opt.accessToken,pageStart:t,pageSize:r.state.pageSize,default:r.state.fetchDefaultList?"true":"false"},"",n)},B=function(e){if(console.log("renderVoliceList",e),e&&e.length>0){for(var t=0;t<e.length;t++){var i=document.createElement("li");i.innerHTML="<li class='voice-item' id='voice-item-"+t+"' data-time="+(e[t]["duration"]||20)+" data-url="+e[t]["fileUrl"]+">"+(e[t]["voiceName"].length>10?e[t]["voiceName"].substr(0,10)+"...":e[t]["voiceName"])+"</li>",document.getElementsByClassName("voice-list-ul")[0].append(i),i.onclick=function(e){console.log("点击元素",e.target,e.target.dataset.url);var t=e.target.dataset.url,i=e.target.dataset.time;j(t,i)}}e.length===r.state.pageSize?document.getElementById("voice-list-end").innerHTML="向下滚动加载更多":document.getElementById("voice-list-end").innerHTML="没有更多数据了"}},j=function(t,n){function o(t){console.log("data.data",t.data),200==t.code?T("sub",parseInt(n)):"10001"==t.code?e.layer.msg("未找到当前语音"):e.layer.msg(t.msg||"发送失败，请稍后再试")}console.log("播放语音",t,n),a(s+"/api/lapp/voice/send","POST",{accessToken:i.opt.accessToken,deviceSerial:i.opt.deviceSerial,channelNo:i.opt.channelNo,fileUrl:t},"",o)},L=document.createElement("div"),M=document.createElement("div");L.setAttribute("class","broadcast off"),M.setAttribute("class","broadcast on hide"),L.innerHTML=' <span title="语音播报">  <svg t="1583561695846" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1126" width="16" height="16">    <path      d="M513.82044445 964.38044445c-8.192 0-15.47377778-2.73066667-21.84533334-8.192 0 0-46.42133333-41.87022222-99.21422222-86.47111112-89.20177778-73.728-117.41866667-88.29155555-123.79022222-90.112H35.04355555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666V271.70133333c0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666666H246.21511111c7.28177778-2.73066667 37.31911111-15.47377778 137.44355556-91.02222222 58.25422222-43.69066667 111.04711111-86.47111111 111.04711111-86.47111112 5.46133333-4.55111111 12.74311111-7.28177778 20.02488889-7.28177778 4.55111111 0 10.01244445 0.91022222 14.56355555 3.6408889 10.92266667 5.46133333 18.20444445 17.29422222 18.20444445 30.03733333v837.40444444c0 12.74311111-7.28177778 25.48622222-19.11466667 30.94755556-5.46133333 1.82044445-10.01244445 2.73066667-14.56355555 2.73066667zM270.79111111 724.992c19.11466667 0 48.24177778 8.192 167.48088889 106.496 16.384 13.65333333 33.67822222 28.21688889 51.88266667 43.69066667l5.46133333 4.55111111V139.71911111l-5.46133333 3.64088889c-22.75555555 17.29422222-44.60088889 34.58844445-65.536 50.06222222C293.54666667 291.72622222 264.41955555 299.008 245.30488889 299.008H82.37511111c-20.02488889 0-21.84533333 12.74311111-21.84533333 26.39644445V694.04444445c0 23.66577778 6.37155555 30.03733333 28.21688889 30.03733333h180.224l1.82044444 0.91022222z m520.64711111 162.01955555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666 0-11.83288889 8.192-20.02488889 16.384-24.576 112.86755555-67.35644445 182.04444445-191.14666667 182.04444444-324.03911111 0-132.89244445-70.08711111-256.68266667-182.04444444-324.03911111-10.01244445-5.46133333-15.47377778-14.56355555-15.47377778-24.576 0-14.56355555 11.83288889-27.30666667 26.39644445-27.30666667 5.46133333 0 10.01244445 1.82044445 16.384 5.46133333 128.34133333 76.45866667 207.53066667 218.45333333 207.53066666 369.55022222 0 152.00711111-80.09955555 293.09155555-208.44088889 369.55022223-6.37155555 5.46133333-10.92266667 7.28177778-16.384 7.28177777z m-90.112-152.91733333c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666667 0-10.01244445 4.55111111-18.20444445 12.74311111-23.66577777 61.89511111-34.58844445 100.12444445-100.12444445 100.12444444-171.12177778 0-70.08711111-37.31911111-134.71288889-96.48355555-170.21155555-8.192-4.55111111-12.74311111-13.65333333-12.74311111-23.66577778 0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666667 4.55111111 0 11.83288889 2.73066667 15.47377778 4.55111111 74.63822222 44.60088889 121.96977778 127.43111111 121.96977778 215.72266667 0 90.112-48.24177778 173.85244445-125.61066667 218.45333333-1.82044445 0-9.10222222 4.55111111-15.47377778 4.55111111z"      fill="#ffffff" p-id="1127"></path>  </svg></span><span>语音播报</span>',L.onclick=function(){this.setAttribute("class","broadcast off hide"),M.setAttribute("class","broadcast on")},M.innerHTML='<div class="pop-hover">  <div class="pop-hover-content">    <div class="vioce-list" id="voice-list">      <ul class="voice-list-ul">      </ul>      <div id="voice-list-end"></div>    </div>    <div id="voice-custom" style="text-align: center;">自定义语音</div>  </div></div><span title="语音播报">  <svg t="1583561695846" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1126" width="16" height="16">    <path      d="M513.82044445 964.38044445c-8.192 0-15.47377778-2.73066667-21.84533334-8.192 0 0-46.42133333-41.87022222-99.21422222-86.47111112-89.20177778-73.728-117.41866667-88.29155555-123.79022222-90.112H35.04355555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666V271.70133333c0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666666H246.21511111c7.28177778-2.73066667 37.31911111-15.47377778 137.44355556-91.02222222 58.25422222-43.69066667 111.04711111-86.47111111 111.04711111-86.47111112 5.46133333-4.55111111 12.74311111-7.28177778 20.02488889-7.28177778 4.55111111 0 10.01244445 0.91022222 14.56355555 3.6408889 10.92266667 5.46133333 18.20444445 17.29422222 18.20444445 30.03733333v837.40444444c0 12.74311111-7.28177778 25.48622222-19.11466667 30.94755556-5.46133333 1.82044445-10.01244445 2.73066667-14.56355555 2.73066667zM270.79111111 724.992c19.11466667 0 48.24177778 8.192 167.48088889 106.496 16.384 13.65333333 33.67822222 28.21688889 51.88266667 43.69066667l5.46133333 4.55111111V139.71911111l-5.46133333 3.64088889c-22.75555555 17.29422222-44.60088889 34.58844445-65.536 50.06222222C293.54666667 291.72622222 264.41955555 299.008 245.30488889 299.008H82.37511111c-20.02488889 0-21.84533333 12.74311111-21.84533333 26.39644445V694.04444445c0 23.66577778 6.37155555 30.03733333 28.21688889 30.03733333h180.224l1.82044444 0.91022222z m520.64711111 162.01955555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666 0-11.83288889 8.192-20.02488889 16.384-24.576 112.86755555-67.35644445 182.04444445-191.14666667 182.04444444-324.03911111 0-132.89244445-70.08711111-256.68266667-182.04444444-324.03911111-10.01244445-5.46133333-15.47377778-14.56355555-15.47377778-24.576 0-14.56355555 11.83288889-27.30666667 26.39644445-27.30666667 5.46133333 0 10.01244445 1.82044445 16.384 5.46133333 128.34133333 76.45866667 207.53066667 218.45333333 207.53066666 369.55022222 0 152.00711111-80.09955555 293.09155555-208.44088889 369.55022223-6.37155555 5.46133333-10.92266667 7.28177778-16.384 7.28177777z m-90.112-152.91733333c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666667 0-10.01244445 4.55111111-18.20444445 12.74311111-23.66577777 61.89511111-34.58844445 100.12444445-100.12444445 100.12444444-171.12177778 0-70.08711111-37.31911111-134.71288889-96.48355555-170.21155555-8.192-4.55111111-12.74311111-13.65333333-12.74311111-23.66577778 0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666667 4.55111111 0 11.83288889 2.73066667 15.47377778 4.55111111 74.63822222 44.60088889 121.96977778 127.43111111 121.96977778 215.72266667 0 90.112-48.24177778 173.85244445-125.61066667 218.45333333-1.82044445 0-9.10222222 4.55111111-15.47377778 4.55111111z"      fill="#ff0000" p-id="1127"></path>  </svg></span><span>语音播报</span>',M.onclick=function(){this.setAttribute("class","broadcast on hide"),L.setAttribute("class","broadcast off")},w.appendChild(L),w.appendChild(M),document.getElementById("voice-custom").onclick=function(){console.log("显示自定义语音"),N.setAttribute("class","speak off")},D(0);var N=document.createElement("div"),F=document.createElement("div");N.setAttribute("class","speak off hide"),F.setAttribute("class","speak on hide"),N.setAttribute("id","startSpeak"),F.setAttribute("id","stopSpeak"),N.innerHTML='<span title="按住说话">  <svg t="1581994757678" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1639" width="16" height="16">    <path      d="M757.059829 393.846154v-52.512821h262.564103v52.512821H757.059829z m-420.102564 481.367521v96.273504h175.042735a8.752137 8.752137 0 0 1 8.752137 8.752137v35.008547a8.752137 8.752137 0 0 1-8.752137 8.752137H109.401709a8.752137 8.752137 0 0 1-8.752136-8.752137v-35.008547a8.752137 8.752137 0 0 1 8.752136-8.752137h175.042735v-96.273504C129.767932 875.213675 4.376068 749.821812 4.376068 595.145299V463.863248a26.25641 26.25641 0 1 1 52.512821 0v113.777778c0 140.174222 113.637744 253.811966 253.811966 253.811965s253.811966-113.637744 253.811966-253.811965V463.863248a26.25641 26.25641 0 1 1 52.51282 0v131.282051c0 154.676513-125.391863 280.068376-280.068376 280.068376z m-26.25641-96.273504c-111.178393 0-201.299145-90.120752-201.299146-201.299145V201.299145C109.401709 90.120752 199.522462 0 310.700855 0s201.299145 90.120752 201.299145 201.299145v376.341881c0 111.178393-90.120752 201.299145-201.299145 201.299145z m691.418803-280.068376H757.059829v-52.512821h245.059829v52.512821z m-17.504273 105.025641H757.059829v-52.512821h227.555556v52.512821z m-17.504274 105.025641H757.059829v-52.512821h210.051282v52.512821z m-8.752137 105.025641H757.059829v-52.512821h201.299145v52.512821z m-17.504273 105.025641H757.059829v-52.512821h183.794872v52.512821z m-26.25641 105.025641H757.059829v-52.512821h157.538462v52.512821z"      p-id="1640" fill="#ffffff"></path>  </svg></span><span>按住说话</span>',F.innerHTML='<span title="按住说话"><svg t="1581994757678" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  p-id="1639" width="16" height="16">  <path    d="M757.059829 393.846154v-52.512821h262.564103v52.512821H757.059829z m-420.102564 481.367521v96.273504h175.042735a8.752137 8.752137 0 0 1 8.752137 8.752137v35.008547a8.752137 8.752137 0 0 1-8.752137 8.752137H109.401709a8.752137 8.752137 0 0 1-8.752136-8.752137v-35.008547a8.752137 8.752137 0 0 1 8.752136-8.752137h175.042735v-96.273504C129.767932 875.213675 4.376068 749.821812 4.376068 595.145299V463.863248a26.25641 26.25641 0 1 1 52.512821 0v113.777778c0 140.174222 113.637744 253.811966 253.811966 253.811965s253.811966-113.637744 253.811966-253.811965V463.863248a26.25641 26.25641 0 1 1 52.51282 0v131.282051c0 154.676513-125.391863 280.068376-280.068376 280.068376z m-26.25641-96.273504c-111.178393 0-201.299145-90.120752-201.299146-201.299145V201.299145C109.401709 90.120752 199.522462 0 310.700855 0s201.299145 90.120752 201.299145 201.299145v376.341881c0 111.178393-90.120752 201.299145-201.299145 201.299145z m691.418803-280.068376H757.059829v-52.512821h245.059829v52.512821z m-17.504273 105.025641H757.059829v-52.512821h227.555556v52.512821z m-17.504274 105.025641H757.059829v-52.512821h210.051282v52.512821z m-8.752137 105.025641H757.059829v-52.512821h201.299145v52.512821z m-17.504273 105.025641H757.059829v-52.512821h183.794872v52.512821z m-26.25641 105.025641H757.059829v-52.512821h157.538462v52.512821z"    p-id="1640" fill="#ff0000"></path></svg></span><span>松开发送</span>',w.appendChild(N),w.appendChild(F),document.getElementById("voice-list").onscroll=function(e){var t=this.scrollHeight;console.log("sum",t,this.scrollTop,document.getElementById("voice-list").clientHeight),t<=this.scrollTop+this.clientHeight&&(console.log("拖动到底，执行加载",r.state.page),D(++r.state.page))};var z,O=document.createElement("div");O.setAttribute("class","time-area"),O.setAttribute("id","time-area"),O.innerHTML="00:00",w.appendChild(O),document.getElementById("startSpeak").onmousedown=function(){if(r.state.countTimer)return e.layer.msg("语音设备正忙，请稍后重试"),!1;var t;function n(i){var n=t.createMediaStreamSource(i);z=new e.Recorder(n)}function o(){z&&z.record()}function a(){console.log("run init");try{e.AudioContext=e.AudioContext||e.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia,e.URL=e.URL||e.webkitURL,t=new AudioContext,console.log("Audio context set up."),console.log("navigator.getUserMedia "+(navigator.getUserMedia?"available.":"not present!"))}catch(i){console.log("err",i),e.layer.msg("No web audio support in this browser!")}navigator.getUserMedia({audio:!0},n,(function(e){console.log("No live audio input: "+e)}))}console.log("按住说话"),N.setAttribute("class","speak off hide"),F.setAttribute("class","speak on"),a(),T("add",0),setTimeout((function(){r.state.recodeTime=0,o()}),1e3),r.state.recodeTimer&&clearInterval(r.state.recodeTimer),r.state.recodeTimer=setInterval((function(){r.state.recodeTime>=59?(i.stopTalk(),T("destory",0),this.setAttribute("class","ptp-talk on hide"),R.setAttribute("class","ptp-talk off"),e.layer.msg("不超过1分钟")):r.state.recodeTime=r.state.recodeTime+1}),1e3)},document.getElementById("stopSpeak").onmouseup=function(){function t(){if(T("destory",0),r.state.recodeTime<1)return e.layer.msg("说话时间过短"),clearInterval(r.state.recodeTimer),!1;clearInterval(r.state.recodeTimer),n()}function n(){try{z&&z.stop(),z&&z.exportWAV((function(t){if(console.log("wav_file",t),t.size<1e3)return e.layer.msg("录音失败，请重试"),r.state.recodeTime=0,!1;T("sub",r.state.recodeTime+2);var n=new FormData;function o(t){console.log("data.data",t.data),200==t.code?T("sub",r.state.recodeTime+2):"10001"==t.code?e.layer.msg("未找到当前语音"):e.layer.msg(t.msg||"发送失败，请稍后再试")}function d(e){console.log("err",e)}n.append("voiceFile",t),n.append("accessToken",i.opt.accessToken),n.append("deviceSerial",i.opt.deviceSerial),n.append("channelNo",i.opt.channelNo),a(s+"/api/lapp/voice/sendonce","POST",{voiceFile:t,accessToken:i.opt.accessToken,deviceSerial:i.opt.deviceSerial,channelNo:i.opt.channelNo},"",o,d)})),z&&z.clear()}catch(t){console.log(t)}}console.log("松开发送"),F.setAttribute("class","speak on hide"),t()}}}}}))}));i=this;function y(e){i.opt.fullScreenStatus=e?1:0,t.fullScreenChangeCallBack&&t.fullScreenChangeCallBack({data:e,id:i.opt.id})}e.addEventListener("message",(function(n){n.origin;var o=i.opt.id;if(n.data.type)switch(n.data.type){case"openSound":o==n.data.id&&t.openSoundCallBack&&t.openSoundCallBack(n.data);break;case"closeSound":o==n.data.id&&t.closeSoundCallBack&&t.closeSoundCallBack(n.data);break;case"capturePicture":o==n.data.id&&t.capturePictureCallBack&&t.capturePictureCallBack(n.data);break;case"startSave":o==n.data.id&&t.startSaveCallBack&&t.startSaveCallBack(n.data);break;case"stopSave":o==n.data.id&&t.stopSaveCallBack&&t.stopSaveCallBack(n.data);break;case"fullScreen":o==n.data.id&&t.fullScreenCallBack&&t.fullScreenCallBack(n.data);break;case"getOSDTime":o==n.data.id&&t.getOSDTimeCallBack&&t.getOSDTimeCallBack(n.data);break;case"handleSuccess":o==n.data.id&&t.handleSuccess&&t.handleSuccess(n.data);break;case"handleError":o==n.data.id&&t.handleError&&t.handleError(n.data);break;case"dblclick":o==n.data.id&&i.opt.bSupporDoubleClickFull&&(0===i.opt.fullScreenStatus?i.fullScreen():i.cancelFullScreen());break;case"startTalk":i.startTalk(),i.closeSound();break;case"stopTalk":i.stopTalk(),i.openSound();break;case"clickEventHandle":console.log("event.data",n.data),t.clickEventHandle&&t.clickEventHandle(n.data);break;case"removeEventHandle":t.removeEventHandle&&t.removeEventHandle(n.data);break;case"esc":t.clickEventHandle&&t.clickEventHandle(n.data);break;case"iframeFullScreen":if(o==n.data.id){var a=function(t){var i=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(i)i.call(t);else if("undefined"!==typeof e.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}};a(document.getElementById("EZUIKitPlayer-"+n.data.id))}break}})),"undefined"!==typeof document.fullScreen?document.addEventListener("fullscreenchange",(function(){var e=document.fullscreen||!1;y(e)})):"undefined"!==typeof document.webkitIsFullScreen?document.addEventListener("webkitfullscreenchange",(function(){var e=document.webkitIsFullScreen||!1;y(e)})):"undefined"!==typeof document.mozFullScreen&&document.addEventListener("mozfullscreenchange",(function(){var e=document.mozFullScreen||!1;y(e)}))};l.prototype.play=function(t){var i="EZUIKitPlayer-"+this.opt.id,n=document.getElementById(i).contentWindow;"object"===c(t)&&t.url&&(this.opt.url=t.url),"object"===c(t)&&t.accessToken&&(this.opt.accessToken=t.accessToken),"string"===typeof t&&(this.opt.url=t),n.postMessage({action:"play",accessToken:this.opt.accessToken,url:this.opt.url},s+"/ezopen/h5/iframe");var o=this;this.opt.videoLoading=!0;var a=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=o.opt.id;i==e.data.id&&"handleSuccess"===e.data.type&&(setTimeout((function(){o.opt.videoLoading=!1}),1e3),t(e.data))}))}));return a},l.prototype.stop=function(){var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage("stop",s+"/ezopen/h5/iframe");var n=this,o=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=n.opt.id;i==e.data.id&&"stop"===e.data.type&&t(e.data)}))}));return o},l.prototype.openSound=function(){var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage("openSound",s+"/ezopen/h5/iframe");var n=this,o=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=n.opt.id;i==e.data.id&&"openSound"===e.data.type&&t(e.data)}))}));return o},l.prototype.closeSound=function(){var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage("closeSound",s+"/ezopen/h5/iframe");var n=this,o=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=n.opt.id;i==e.data.id&&"closeSound"===e.data.type&&t(e.data)}))}));return o},l.prototype.startSave=function(t){var i="EZUIKitPlayer-"+this.opt.id,n=document.getElementById(i).contentWindow;n.postMessage({action:"startSave",fileName:t||"default"},s+"/ezopen/h5/iframe");var o=this,a=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=o.opt.id;i==e.data.id&&"startSave"===e.data.type&&t(e.data)}))}));return a},l.prototype.stopSave=function(){var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage("stopSave",s+"/ezopen/h5/iframe");var n=this,o=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=n.opt.id;i==e.data.id&&"stopSave"===e.data.type&&t(e.data)}))}));return o},l.prototype.fullScreen=function(){if(1===this.opt.fullScreenStatus)return!1;var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;if(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)){var n=document.documentElement.clientWidth,o=document.documentElement.clientHeight,a=document.body;a=document.getElementById(t);var r="";r+="width:"+o+"px;",r+="height:"+n+"px;",r+="-webkit-transform: rotate(90deg); transform: rotate(90deg);",r+="-webkit-transform-origin: "+n/2+"px "+n/2+"px;",r+="transform-origin: "+n/2+"px "+n/2+"px;",r+="position: fixed;top: 0;left: 0;z-index:10",a.style.cssText=r,setTimeout((function(){i.postMessage("autoResize",s+"/ezopen/h5/iframe")}),500)}else{var d=function(t){var i=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(i)i.call(t);else if("undefined"!==typeof e.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}};d(document.getElementById(t))}this.params.fullScreenCallBack&&this.params.fullScreenCallBack(this.opt.id),this.opt.fullScreenStatus=1},l.prototype.cancelFullScreen=function(){if(0===this.opt.fullScreenStatus)return!1;var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;if(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)){var i=document.getElementById(e).width,n=document.getElementById(e).height,o=document.body;o=document.getElementById(e);var a="";a+="width:"+i+"px;",a+="height:"+n+"px;",a+="-webkit-transform: none; transform: none;",a+="-webkit-transform-origin: 0 0;",a+="transform-origin: 0 0;",o.style.cssText=a,setTimeout((function(){t.postMessage("autoResize",s+"/ezopen/h5/iframe")}),500);var r=e+"cancel-full-screen",d=document.getElementById(r);d&&document.body.removeChild(d)}else document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen();this.params.cancelFullScreenCallBack&&this.params.cancelFullScreenCallBack(this.opt.id),this.opt.fullScreenStatus=0},l.prototype.capturePicture=function(t,i){var n="EZUIKitPlayer-"+this.opt.id,o=document.getElementById(n).contentWindow;o.postMessage({action:"capturePicture",fileName:t||"default",isUndownload:i},s+"/ezopen/h5/iframe");var a=this,r=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=a.opt.id;i==e.data.id&&"capturePicture"===e.data.type&&t(e.data)}))}));return r},l.prototype.enableZoom=function(){var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;t.postMessage("enableZoom",s+"/ezopen/h5/iframe")},l.prototype.closeZoom=function(){var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;t.postMessage("closeZoom",s+"/ezopen/h5/iframe")},l.prototype.getOSDTime=function(){var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage("getOSDTime",s+"/ezopen/h5/iframe");var n=this,o=new Promise((function(t,i){e.addEventListener("message",(function(e){var i=n.opt.id;i==e.data.id&&"getOSDTime"===e.data.type&&t(e.data)}))}));return o},l.prototype.autoResize=function(){var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;t.postMessage("autoResize",s+"/ezopen/h5/iframe")},l.prototype.reSize=function(e,t){var i="EZUIKitPlayer-"+this.opt.id,n=document.getElementById(i).contentWindow,o=document.getElementById(this.opt.id);o.style.width=e+"px",o.style.height=t+"px",document.getElementById(this.opt.id).style.width=e+"px",document.getElementById(this.opt.id).style.height=t+"px";var a=document.getElementById(i);a.setAttribute("width",e),a.setAttribute("height",t),a.style.width=e+"px",a.style.height=t+"px",setTimeout((function(){n.postMessage({action:"autoResize"},s+"/ezopen/h5/iframe")}),500)},l.prototype.startTalk=function(){console.log("执行开始对讲"),console.log(this.opt);var t=this;r.opt=this.opt,e.EZUIKit&&(e.EZUIKit.opt=this.opt);var i=function(i){if(200==i.code){var n=i.data;if(n){var o=n.rtcUrl;-1===o.indexOf("ws")&&(o=o.replace("https","wss").replace("rtcgw","rtcgw-ws")),t.opt.rtcUrl=o,t.opt.ttsUrl="tts://"+n.ttsUrl;var a="talk://"+t.opt.deviceSerial+":0:"+t.opt.channelNo+":cas.ys7.com:6500";t.opt.talkLink=t.opt.ttsUrl+"/"+a,t.opt.stream=n.stream,e.startTalk()}}};a(t.opt.apiDomain,"POST",{accessToken:t.opt.accessToken,deviceSerial:t.opt.deviceSerial,channelNo:t.opt.channelNo},"",i)},l.prototype.stopTalk=function(){console.log("执行结束对讲"),e.stopTalk()},l.prototype.edit=function(){var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;t.postMessage("edit",s+"/ezopen/h5/iframe")},l.prototype.btnReRender=function(e){var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage({action:"btnReRender",data:e},s+"/ezopen/h5/iframe")},l.prototype.changePlayUrl=function(e){e.deviceSerial&&(this.opt.deviceSerial=e.deviceSerial),e.channelNo&&(this.opt.channelNo=e.channelNo),e.accessToken&&(this.opt.accessToken=e.accessToken);var t="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(t).contentWindow;i.postMessage({action:"changePlayUrl",data:e},s+"/ezopen/h5/iframe")},l.prototype.fetchThemeData=function(){var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;t.postMessage({action:"fetchThemeData"},s+"/ezopen/h5/iframe")},l.prototype.setThemeData=function(e,t,i){var n="EZUIKitPlayer-"+this.opt.id,o=document.getElementById(n).contentWindow;o.postMessage({action:"setThemeData",data:{accessToken:e,header:t,footer:i}},s+"/ezopen/h5/iframe")},r.EZUIKitPlayer=l,e.EZUIKitV3=r;var u=r;return u}));var Ct=EZUIKitV3,Tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0,o=void 0,a=void 0,r=[];return function(){var d=wt(t),l=(new Date).getTime(),c=!n||l-n>d;n=l;for(var u=arguments.length,m=Array(u),p=0;p<u;p++)m[p]=arguments[p];if(c&&i.leading)return i.accumulate?Promise.resolve(e.call(this,[m])).then((function(e){return e[0]})):Promise.resolve(e.call.apply(e,[this].concat(m)));if(o?clearTimeout(a):o=kt(),r.push(m),a=setTimeout(s.bind(this),d),i.accumulate){var h=r.length-1;return o.promise.then((function(e){return e[h]}))}return o.promise};function s(){var t=o;clearTimeout(a),Promise.resolve(i.accumulate?e.call(this,r):e.apply(this,r[r.length-1])).then(t.resolve,t.reject),r=[],o=null}};function wt(e){return"function"===typeof e?e():e}function kt(){var e={};return e.promise=new Promise((function(t,i){e.resolve=t,e.reject=i})),e}(function(){var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var i="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e};function n(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof O&&O];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}var o,a=n(this);function r(e,t){if(t)e:{var n=a;e=e.split(".");for(var o=0;o<e.length-1;o++){var r=e[o];if(!(r in n))break e;n=n[r]}e=e[e.length-1],o=n[e],t=t(o),t!=o&&null!=t&&i(n,e,{configurable:!0,writable:!0,value:t})}}function s(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function d(e){var i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return i?i.call(e):{next:t(e)}}if(r("Symbol",(function(e){function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(o+(e||"")+"_"+a++,e)}function n(e,t){this.A=e,i(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.A};var o="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return t})),r("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var r=a[n[o]];"function"===typeof r&&"function"!=typeof r.prototype[e]&&i(r.prototype,e,{configurable:!0,writable:!0,value:function(){return s(t(this))}})}return e})),"function"==typeof Object.setPrototypeOf)o=Object.setPrototypeOf;else{var l;e:{var c={a:!0},u={};try{u.__proto__=c,l=u.a;break e}catch(N){}l=!1}o=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var m=o;function p(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function h(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function f(e,t){return e.h=3,{value:t}}function g(e){this.g=new p,this.G=e}function v(e,t){h(e.g);var i=e.g.j;return i?y(e,"return"in i?i["return"]:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),S(e))}function y(e,t,i,n){try{var o=t.call(e.g.j,i);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return e.g.m=!1,o;var a=o.value}catch(r){return e.g.j=null,e.g.s(r),S(e)}return e.g.j=null,n.call(e.g,a),S(e)}function S(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(i){e.g.v=void 0,e.g.s(i)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return v(e,t)},this[Symbol.iterator]=function(){return this}}function b(e,t){return t=new _(new g(t)),m&&e.prototype&&m(t,e.prototype),t}function C(e,t){e instanceof String&&(e+="");var i=0,n=!1,o={next:function(){if(!n&&i<e.length){var o=i++;return{value:t(o,e[o]),done:!1}}return n=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o}if(p.prototype.o=function(e){this.v=e},p.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},p.prototype.return=function(e){this.l={return:e},this.h=this.u},g.prototype.o=function(e){return h(this.g),this.g.j?y(this,this.g.j.next,e,this.g.o):(this.g.o(e),S(this))},g.prototype.s=function(e){return h(this.g),this.g.j?y(this,this.g.j["throw"],e,this.g.o):(this.g.s(e),S(this))},r("Array.prototype.entries",(function(e){return e||function(){return C(this,(function(e,t){return[e,t]}))}})),"undefined"!==typeof Blob&&("undefined"===typeof FormData||!FormData.prototype.keys)){var T=function(e,t){for(var i=0;i<e.length;i++)t(e[i])},w=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},k=function(e,t,i){return t instanceof Blob?(i=void 0!==i?String(i+""):"string"===typeof t.name?t.name:"blob",t.name===i&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],i)),[String(e),t]):[String(e),String(t)]},E=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},P="object"===typeof globalThis?globalThis:"object"===typeof window?window:"object"===typeof self?self:this,I=P.FormData,x=P.XMLHttpRequest&&P.XMLHttpRequest.prototype.send,R=P.Request&&P.fetch,A=P.navigator&&P.navigator.sendBeacon,D=P.Element&&P.Element.prototype,B=P.Symbol&&Symbol.toStringTag;B&&(Blob.prototype[B]||(Blob.prototype[B]="Blob"),"File"in P&&!File.prototype[B]&&(File.prototype[B]="File"));try{new File([],"")}catch(N){P.File=function(e,t,i){return e=new Blob(e,i||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(i&&void 0!==i.lastModified?new Date(i.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),B&&Object.defineProperty(e,B,{value:"File"}),e}}var j=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},L=function(e){this.i=[];var t=this;e&&T(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var i=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];T(i,(function(i){t.append(e.name,i)}))}else"select-multiple"===e.type||"select-one"===e.type?T(e.options,(function(i){!i.disabled&&i.selected&&t.append(e.name,i.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(i="textarea"===e.type?w(e.value):e.value,t.append(e.name,i))}))};if(e=L.prototype,e.append=function(e,t,i){E(arguments,2),this.i.push(k(e,t,i))},e.delete=function(e){E(arguments,1);var t=[];e=String(e),T(this.i,(function(i){i[0]!==e&&t.push(i)})),this.i=t},e.entries=function e(){var t,i=this;return b(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<i.i.length?e=f(e,i.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},e.forEach=function(e,t){E(arguments,1);for(var i=d(this),n=i.next();!n.done;n=i.next()){var o=d(n.value);n=o.next().value,o=o.next().value,e.call(t,o,n,this)}},e.get=function(e){E(arguments,1);var t=this.i;e=String(e);for(var i=0;i<t.length;i++)if(t[i][0]===e)return t[i][1];return null},e.getAll=function(e){E(arguments,1);var t=[];return e=String(e),T(this.i,(function(i){i[0]===e&&t.push(i[1])})),t},e.has=function(e){E(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},e.keys=function e(){var t,i,n,o,a,r=this;return b(e,(function(e){if(1==e.h&&(t=d(r),i=t.next()),3!=e.h)return i.done?void(e.h=0):(n=i.value,o=d(n),a=o.next().value,f(e,a));i=t.next(),e.h=2}))},e.set=function(e,t,i){E(arguments,2),e=String(e);var n=[],o=k(e,t,i),a=!0;T(this.i,(function(t){t[0]===e?a&&(a=!n.push(o)):n.push(t)})),a&&n.push(o),this.i=n},e.values=function e(){var t,i,n,o,a,r=this;return b(e,(function(e){if(1==e.h&&(t=d(r),i=t.next()),3!=e.h)return i.done?void(e.h=0):(n=i.value,o=d(n),o.next(),a=o.next().value,f(e,a));i=t.next(),e.h=2}))},L.prototype._asNative=function(){for(var e=new I,t=d(this),i=t.next();!i.done;i=t.next()){var n=d(i.value);i=n.next().value,n=n.next().value,e.append(i,n)}return e},L.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],i="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,n){return"string"==typeof e?t.push(i+j(w(n))+'"\r\n\r\n'+w(e)+"\r\n"):t.push(i+j(w(n))+'"; filename="'+j(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},L.prototype[Symbol.iterator]=function(){return this.entries()},L.prototype.toString=function(){return"[object FormData]"},D&&!D.matches&&(D.matches=D.matchesSelector||D.mozMatchesSelector||D.msMatchesSelector||D.oMatchesSelector||D.webkitMatchesSelector||function(e){e=(this.document||this.ownerDocument).querySelectorAll(e);for(var t=e.length;0<=--t&&e.item(t)!==this;);return-1<t}),B&&(L.prototype[B]="FormData"),x){var M=P.XMLHttpRequest.prototype.setRequestHeader;P.XMLHttpRequest.prototype.setRequestHeader=function(e,t){M.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},P.XMLHttpRequest.prototype.send=function(e){e instanceof L?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),x.call(this,e)):x.call(this,e)}}R&&(P.fetch=function(e,t){return t&&t.body&&t.body instanceof L&&(t.body=t.body._blob()),R.call(this,e,t)}),A&&(P.navigator.sendBeacon=function(e,t){return t instanceof L&&(t=t._asNative()),A.call(this,e,t)}),P.FormData=L}})();var Et=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function Pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var It=function(){var e=void 0;return function(t){return t&&(e=t),e}}();(function(){function e(){if(Pt(this,e),It())return It();if(void 0!==e.unique)return e.unique;e.unique=this,this.oAudioContext=null,this.currentVolume=80,this.bSetVolume=!1,this.gainNode=null,this.iWndNum=-1,this.mVolumes=new Map;var t=window.AudioContext||window.webkitAudioContext;this.oAudioContext=new t,this.writeString=function(e,t,i){for(var n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))},this.setBufferToDataview=function(e,t,i){for(var n=0;n<i.length;n++,t++)e.setUint8(t,i[n])},It(this)}Et(e,[{key:"Play",value:function(e,t,i){var n=new ArrayBuffer(44+t),o=new DataView(n),a=i.samplesPerSec,r=i.channels,s=i.bitsPerSample;this.writeString(o,0,"RIFF"),o.setUint32(4,32+2*t,!0),this.writeString(o,8,"WAVE"),this.writeString(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,r,!0),o.setUint32(24,a,!0),o.setUint32(28,2*a,!0),o.setUint16(32,r*s/8,!0),o.setUint16(34,s,!0),this.writeString(o,36,"data"),o.setUint32(40,t,!0),this.setBufferToDataview(o,44,e);var d=this;return this.oAudioContext.decodeAudioData(o.buffer,(function(e){var t=d.oAudioContext.createBufferSource();if(null==t)return-1;t.buffer=e,t.start(0),(null==d.gainNode||d.bSetVolume)&&(d.gainNode=d.oAudioContext.createGain(),d.bSetVolume=!1),d.gainNode.gain.value=d.currentVolume/100,d.gainNode.connect(d.oAudioContext.destination),t.connect(d.gainNode)}),(function(e){return console.log("decode error"),-1})),0}},{key:"Stop",value:function(){return null!=this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),!0}},{key:"SetVolume",value:function(e){return this.bSetVolume=!0,this.currentVolume=e,this.mVolumes.set(this.iWndNum,this.currentVolume),!0}},{key:"SetWndNum",value:function(e){this.iWndNum=e;var t=this.mVolumes.get(e);return void 0==t&&(t=80),this.currentVolume=t,!0}},{key:"GetVolume",value:function(){var e=this.mVolumes.get(this.iWndNum);return void 0==e&&(e=80),e}}]),window.AudioRenderer=e})();var xt=["attribute vec4 vertexPos;","attribute vec2 texturePos;","varying vec2 textureCoord;","void main()","{","gl_Position = vertexPos;","textureCoord = texturePos;","}"].join("\n"),Rt=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","const mat4 YUV2RGB = mat4","(","1.1643828125, 0, 1.59602734375, -.87078515625,","1.1643828125, -.39176171875, -.81296875, .52959375,","1.1643828125, 2.017234375, 0, -1.081390625,","0, 0, 0, 1",");","void main(void) {","highp float y = texture2D(ySampler,  textureCoord).r;","highp float u = texture2D(uSampler,  textureCoord).r;","highp float v = texture2D(vSampler,  textureCoord).r;","gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n");(function(e,t){window.SuperRender=t()})(0,(function(){function e(e){this.canvasElement=document.getElementById(e),this.initContextGL(),this.contextGL&&(this.YUVProgram=this.initProgram(xt,Rt),this.initBuffers(),this.initTextures())}return e.prototype.initContextGL=function(){var e=this.canvasElement,t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(i){t=null}t&&"function"===typeof t.getParameter||(t=null),this.contextGL=t,console.log("WebGL1.0")},e.prototype.initProgram=function(e,t){var i=this.contextGL,n=i.createShader(i.VERTEX_SHADER);i.shaderSource(n,e),i.compileShader(n),i.getShaderParameter(n,i.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+i.getShaderInfoLog(n));var o=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(o,t),i.compileShader(o),i.getShaderParameter(o,i.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+i.getShaderInfoLog(o));var a=i.createProgram();return i.attachShader(a,n),i.attachShader(a,o),i.linkProgram(a),i.getProgramParameter(a,i.LINK_STATUS)||console.log("Program failed to compile: "+i.getProgramInfoLog(a)),i.deleteShader(n),i.deleteShader(o),a},e.prototype.initBuffers=function(){var e=this.contextGL,t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.vertexPosBuffer=t,this.texturePosBuffer=i},e.prototype.initTexture=function(){var e=this.contextGL,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t},e.prototype.initTextures=function(){var e=this.contextGL,t=this.YUVProgram;e.useProgram(t);var i=this.initTexture(),n=e.getUniformLocation(t,"ySampler");e.uniform1i(n,0),this.yTextureRef=i;var o=this.initTexture(),a=e.getUniformLocation(t,"uSampler");e.uniform1i(a,1),this.uTextureRef=o;var r=this.initTexture(),s=e.getUniformLocation(t,"vSampler");e.uniform1i(s,2),this.vTextureRef=r,e.useProgram(null)},e.prototype.SR_DisplayFrameData=function(e,t,i,n,o){if(!(e<=0||t<=0)){var a=this.contextGL;if(null==i)return a.clearColor(0,0,0,0),void a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var r=this.canvasElement;this.nWindowWidth=r.width,this.nWindowHeight=r.height;var s=this.nWindowWidth,d=this.nWindowHeight;a.clearColor(.8,.8,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.viewport(0,0,s,d),this.updateFrameData(e,t,i,n,o);var l=this.YUVProgram;a.useProgram(l);var c=this.vertexPosBuffer;a.bindBuffer(a.ARRAY_BUFFER,c);var u=a.getAttribLocation(l,"vertexPos");a.enableVertexAttribArray(u),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,null);var m=this.texturePosBuffer;a.bindBuffer(a.ARRAY_BUFFER,m);var p=a.getAttribLocation(l,"texturePos");a.enableVertexAttribArray(p),a.vertexAttribPointer(p,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.drawArrays(a.TRIANGLE_STRIP,0,4),a.disableVertexAttribArray(u),a.disableVertexAttribArray(p),a.useProgram(null)}},e.prototype.updateFrameData=function(e,t,i,n,o){var a=this.contextGL,r=this.yTextureRef,s=this.uTextureRef,d=this.vTextureRef,l=i;if(e==n&&t==o){var c=e*t,u=l.subarray(0,c);a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,e,t,0,a.LUMINANCE,a.UNSIGNED_BYTE,u);var m=e/2*t/2,p=l.subarray(e*t,e*t+m);a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,d),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,e/2,t/2,0,a.LUMINANCE,a.UNSIGNED_BYTE,p);var h=m,f=l.subarray(e*t+e*t/4,e*t+e*t/4+h);a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,s),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,e/2,t/2,0,a.LUMINANCE,a.UNSIGNED_BYTE,f)}else{c=n*o,u=new Uint8Array(c);for(var g=0;g<o;g++)for(var v=l.subarray(g*e,g*e+n),y=0;y<n;y++)u[g*n+y]=v[y];a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,n,o,0,a.LUMINANCE,a.UNSIGNED_BYTE,u),u=null,v=null;for(m=n/2*o/2,p=new Uint8Array(m),g=0;g<o/2;g++){var S=l.subarray(e*t+g*e/2,e*t+g*e/2+n/2);for(y=0;y<n/2;y++)p[g*n/2+y]=S[y]}a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,d),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,n/2,o/2,0,a.LUMINANCE,a.UNSIGNED_BYTE,p),p=null,S=null;for(h=m,f=new Uint8Array(h),g=0;g<o/2;g++){var _=l.subarray(e*t*5/4+g*e/2,e*t*5/4+g*e/2+n/2);for(y=0;y<n/2;y++)f[g*n/2+y]=_[y]}a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,s),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,n/2,o/2,0,a.LUMINANCE,a.UNSIGNED_BYTE,f),f=null,_=null}},e.prototype.SR_SetDisplayRect=function(e){var t=this.contextGL,i=this.nWindowWidth,n=this.nWindowHeight,o=null;if(e&&i>0&&n>0){var a=e.left/i,r=e.top/n,s=e.right/i,d=e.bottom/n;o=new Float32Array([s,r,a,r,s,d,a,d])}else o=new Float32Array([1,0,0,0,1,1,0,1]);var l=this.texturePosBuffer;t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferSubData(t.ARRAY_BUFFER,0,o),t.bindBuffer(t.ARRAY_BUFFER,null)},e.prototype.SR_Destroy=function(){var e=this.contextGL,t=this.YUVProgram;e.deleteProgram(t);var i=this.vertexPosBuffer,n=this.texturePosBuffer;e.deleteBuffer(i),e.deleteBuffer(n);var o=this.yTextureRef,a=this.uTextureRef,r=this.vTextureRef;e.deleteTexture(o),e.deleteTexture(a),e.deleteTexture(r)},e}));var At="https://open.ys7.com",Dt="".concat(At,"/console/ezuikit_static/v66/v2"),Bt="".concat(At,"/console/ezuikit_static/v66/v1"),jt=function(e,t){var i=["theme","standard"],n=["pcLive","pcRec","mobileLive","mobileRec","noData","security","voice","simple","mobileCall","miniRec"];if("undefined"===typeof e)return t.themeData?{templateType:"themeData",templateId:"themeData"}:{templateType:"local",templateId:""};if("string"===typeof e){if(32===e.length)return{templateType:"remote",templateId:e};if(-1!==i.indexOf(e))return"simple"===e&&"undefined"===typeof t.header&&"undefined"===typeof t.footer?{templateType:"local",templateId:""}:{templateType:"iframe",templateId:e};if(-1!==n.indexOf(e))return{templateType:"local",templateId:e};if(t&&t.isCall)return{templateType:"invalid",templateId:e}}},Lt=function(){var e=window.navigator.userAgent.toLowerCase(),t={sa:/version.*safari/.test(e),ch:/chrome/.test(e),ff:/gecko/.test(e)&&!/webkit/.test(e)},i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(i)return!1;if(t.ch){var n=function(){for(var e=window.navigator.userAgent.split(" "),t="",i=0;i<e.length;i++)/chrome/i.test(e[i])&&(t=e[i]);return!!t&&Number(t.split("/")[1].split(".")[0])};return n()>91&&!!window.SharedArrayBuffer}return!1},Mt=function(){function e(t){var i=this;p(this,e),this.isStoping=!1;var n=t.autoplay,o=void 0===n||n;if((t.template||t.themeData)&&(o=!1),this.params=t,this.autoplay=o,window.EZUIKit[t.id]={state:{EZUIKitPlayer:{init:window.EZUIKit[t.id]&&window.EZUIKit[t.id].state&&window.EZUIKit[t.id].state.EZUIKitPlayer.init||!1,themeInit:window.EZUIKit[t.id]&&window.EZUIKit[t.id].state&&window.EZUIKit[t.id].state.EZUIKitPlayer.themeInit||!1,talkInit:window.EZUIKit[t.id]&&window.EZUIKit[t.id].state&&window.EZUIKit[t.id].state.EZUIKitPlayer.talkInit||!1}}},"iframe"===jt(this.params.template,t).templateType)return new Ct.EZUIKitPlayer(t);this.Monitor=new bt({env:"undefined"!==typeof t.disableMonitor&&t.disableMonitor?"test12":"online"},this),this.id=t.id,this.width=t.width,this.height=t.height,this.fullScreenWidth=0,this.fullScreenHeight=0,this.isCall=t.isCall||!1,this.isWebConsole=t.isWebConsole||!1,this.callTime=t.callTime||null,this.hangUpCallback=t.hangUpCallback||null,this.isNeedBellRing=!1!==t.isNeedBellRing,this.url=t.url,this.accessToken=t.accessToken,this.deviceSerial=j(t.url).deviceSerial,this.channelNo=j(t.url).channelNo,this.themeId=jt(t.template,t).templateId,this.sourceThemeId=jt(t.template,t).templateId,this.id=t.id,this.audio=!0,this.poster=t.poster,this.speed=1,this.disabledTimeLine=!1,this.disabledPTZ=!1,this.enableSharedArrayBufferGuide=!1,this.capacity=null,this.playTimer=null,this.env={domain:"https://open.ys7.com"};var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);this.isMobile=a,this.support3DZoom=!1,this.use3DZoom=!1,this.is3DZooming=!1,document.getElementById("".concat(this.id,"-wrap"))&&(document.getElementById("".concat(this.id,"-wrap")).innerHTML="",document.getElementById("".concat(this.id,"-wrap")).id=this.id),this.staticPath=Lt()?Dt:Bt,"string"===typeof t.staticPath&&(t.staticPath.startsWith("http")?this.staticPath=t.staticPath:this.staticPath=window.location.protocol+"//"+window.location.host+t.staticPath,Lt()?this.staticPath+="/v2":this.staticPath+="/v1"),"undefined"!==typeof t.audio&&(this.audio=t.audio),"undefined"!==typeof t.env&&(this.env=Object.assign(this.env,t.env)),"undefined"!==typeof t.isMobile&&(this.isMobile=t.isMobile),"undefined"!==typeof t.disabledTimeLine&&(this.disabledTimeLine=t.disabledTimeLine),"undefined"!==typeof t.disabledPTZ&&(this.disabledPTZ=t.disabledPTZ),"undefined"!==typeof t.enableSharedArrayBufferGuide&&(this.enableSharedArrayBufferGuide=t.enableSharedArrayBufferGuide);var r="".concat(this.staticPath,"/js/jsPluginV1-1.0.0.min.js"),s=function(){if(window.addPluginUrlIng=!0,i.getDeviceCapacity(),Lt())console.log("启用多线程解析视频"),r="".concat(i.staticPath,"/js/jsPluginV2-2.0.1.min.js");else{var e=function(){for(var e=navigator.userAgent.split(" "),t="",i=0;i<e.length;i++)/chrome/i.test(e[i])&&(t=e[i]);return!!t&&Number(t.split("/")[1].split(".")[0])};if(!a&&91<e&&i.enableSharedArrayBufferGuide){console.log("提示用户开启谷歌实验室特性");var n="".concat(i.id,"-wrap"),o=document.createElement("div"),s=document.createElement("span");s.innerHTML="您当前浏览器可以开启谷歌实验室多线程特性，获取更好播放体验，避免浏览器卡顿及崩溃,详见",o.appendChild(s);var d=document.createElement("a");d.href="https://open.ys7.com/help/384",d.setAttribute("target","_blank"),o.appendChild(d),d.innerHTML="开启说明",o.id="".concat(i.id,"-guide"),o.style="font-size:12px;color:red;",setTimeout((function(){document.getElementById(n)&&document.getElementById(n).insertBefore(o,document.getElementById(i.id))}),5e3)}}i.pluginStatus=new V(i,i.id),T(r,(function(){if(i.autoplay){i.initTime=(new Date).getTime(),i.Monitor.dclog({url:i.url,action:0,text:"startInit",isVersion2Available:Lt()?1:0}),i.Monitor.localInfoLog({Serial:j(i.url).deviceSerial,Channel:j(i.url).channelNo,Ver:Lt()?"v7.0.0":"v6.0.0",ExterVer:Lt()?"v7.0.0":"v6.0.0"}),console.log("初始化-");var e=i.initEZUIKitPlayer(t),n=i._getRealUrlPromise(t.accessToken,t.url);Promise.all([e,n]).then((function(e){e[1]?(i.playStartTime=(new Date).getTime(),i._pluginPlay(e[1],(function(){console.log("自动播放成功"),i.Monitor.dclog({url:i.url,action:202,d:(new Date).getTime()-i.initTime,text:"autoPlaySuccess"})}),(function(){console.log("自动播放失败"),i.Monitor.dclog({url:i.url,action:402,d:(new Date).getTime()-i.initTime,text:"autoPlayError"})}))):console.log("promise of one",e),window.EZUIKit[t.id].state.EZUIKitPlayer.init=!0,document.getElementById("".concat(t.id,"canvas_draw0"))&&(document.getElementById("".concat(t.id,"canvas_draw0")).style.border="none")}))["catch"]((function(e){console.log("err",e),i.Theme&&i.Theme.setDisabled(!0),i.pluginStatus.loadingClear(),i.pluginStatus.loadingSetText({text:e&&e.msg||"获取播放地址失败",color:"red"})}))}else{i.initTime=(new Date).getTime(),i.Monitor.dclog({url:i.url,action:0,text:"startInit",isVersion2Available:Lt()?1:0}),i.Monitor.localInfoLog({Serial:j(i.url).deviceSerial,Channel:j(i.url).channelNo,Ver:Lt()?"v7.0.0":"v6.0.0"});e=i.initEZUIKitPlayer(t);e.then((function(e){console.log("初始化成功",e),window.EZUIKit[t.id].state.EZUIKitPlayer.init=!0,document.getElementById("".concat(t.id,"canvas_draw0"))&&(document.getElementById("".concat(t.id,"canvas_draw0")).style.border="none"),i.initSuccessTime=(new Date).getTime(),i.Monitor.dclog({url:i.url,action:201,d:i.initSuccessTime-i.initTime,text:"initSuccess",isVersion2Available:Lt()?1:0})}))}}),(function(){return Lt()?!!window.JSPluginV2||!!window.addPluginUrled:!!window.JSPluginV1||!!window.addPluginUrled})),t.plugin&&-1!==t.plugin.indexOf("talk")&&(i.Talk=new _e(i),window.EZUIKit[t.id].state.EZUIKitPlayer.talkInit=!0)};if(window.addPluginUrlIng)var d=setInterval((function(){(window.JSPluginV1||window.JSPluginV2)&&(clearInterval(d),s())}),50);else s();this.play=Tt((function(e){return i._play(e)}),500,!0),this.resume=Tt((function(e){return i._resume(e)}),500,!0),this.changePlayUrl=Tt((function(e,t){return i._changePlayUrl(e,t)}),500),window.addEventListener("beforeunload",(function(){console.log("退出页面，停止视频流"),i.stop()}))}return f(e,[{key:"initEZUIKitPlayer",value:function(e){var t=this,i=e.id,n=e.width,o=void 0===n?600:n,a=e.height,r=void 0===a?400:a;if(!e.width||!e.height){var s=document.getElementById(i).getBoundingClientRect();!e.width&&s.width>0&&(o=s.width),!e.height&&s.height>0&&(r=s.height)}if(!document.getElementById("".concat(i,"-wrap"))){var d=document.createElement("div");d.id="".concat(i,"-wrap"),d.style="display:inline-block;width:".concat(o,"px;position:relative;vertical-align: bottom;"),document.getElementById(i).parentNode.insertBefore(d,document.getElementById(i)),document.getElementById(i).parentNode.removeChild(document.getElementById(i)),d.innerHTML="<div id=".concat(i,"></div>"),document.getElementById(i).style="display:inline-block;width:".concat(o,"px;height:").concat(r,"px;"),document.getElementById(i).style.verticalAlign="top"}this.themeId&&(console.log(this.themeId),1==e.isCall?this.Theme=new _t(this,e.id):this.Theme=new it(this,e.id),window.EZUIKit[e.id].state.EZUIKitPlayer.themeInit=!0,this.Monitor.dclog({url:this.url,action:2,text:this.themeId}),"function"===typeof this.params.handleThemeChange&&(this.handleThemeChange=this.params.handleThemeChange));var l=new H(this,i);this.Message=l;var c=function(n,a){var s;if(Lt()){s=new window.JSPluginV2({szId:i,iType:2,iWidth:o,iHeight:r,iMaxSplit:1,iCurrentSplit:1,szBasePath:"",staticPath:t.staticPath,oStyle:{border:"none",background:"#000000"}}),t.pluginStatus.loadingStart(i),t.isCall?t.pluginStatus.loadingSetText({text:"视频加载中"}):"miniRec"==t.themeId?t.pluginStatus.loadingSetText({text:""}):t.pluginStatus.loadingSetText({text:"初始化播放器完成"}),s.EventCallback={pluginErrorHandler:function(e,i,n){if(console.log(e,i,n),!(t.isCall&&t.Theme&&t.Theme.decoderState&&t.Theme.decoderState.state.rejection))if(1003===i)console.log("断流"),t.Theme&&t.Theme.setDecoderState({play:!1}),t.pluginStatus.setPlayStatus({play:!1}),s.bPlay||(t.pluginStatus.loadingClear(),t.isCall?t.pluginStatus.loadingSetTextWithBtn({text:"连接断开，请重试",color:"white",btnName:t.isMobile?"重试":"重新加载",isMobile:t.isMobile,type:1}):t.pluginStatus.loadingSetText({text:"连接断开，请重试",color:"red"})),"function"===typeof t.params.handleError&&t.params.handleError({msg:"连接断开，请重试",retcode:1003,id:t.params.id,type:"handleError"});else if(1!=n.errorCode){var o=t.errorHander.matchErrorInfo(n.errorCode),a="连接断开，请重试";o&&o.msg?a=o.msg:o&&o.description&&(a=o.description),t.Theme&&t.Theme.setDecoderState({play:!1}),t.pluginStatus.setPlayStatus({play:!1}),t.pluginStatus.loadingClear(),t.isCall?t.pluginStatus.loadingSetTextWithBtn({text:a,color:"white",btnName:t.isMobile?"重试":"重新加载",isMobile:t.isMobile}):t.pluginStatus.loadingSetText({text:a,color:"red"}),"function"===typeof t.params.handleError&&t.params.handleError({msg:a,retcode:n.errorCode,id:t.params.id,type:"handleError"})}else t.pluginStatus.loadingClear(),t.Theme&&t.Theme.setDisabled(!1)},openStreamCallback:function(){console.log("开启取流"),t.openStreamTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:224,d:t.openStreamTime-t.gotWsUrlTime,text:"openStream",isVersion2Available:Lt()?1:0})},getStreamHeaderCallback:function(){console.log("完成取流返回流头"),t.getStreamHeaderTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:225,d:t.getStreamHeaderTime-t.openStreamTime,text:"getStreamHeader",isVersion2Available:Lt()?1:0})},getVideoStreamCallback:function(){console.log("返回视频流(首次)"),t.getVideoStreamTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:226,d:t.getVideoStreamTime-t.getStreamHeaderTime,text:"getVideoStream",isVersion2Available:Lt()?1:0})},appearFirstFrameCallback:function(){console.log("出现首帧画面（播放成功）"),t.appearFirstFrameTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:227,d:t.appearFirstFrameTime-t.getStreamHeaderTime,text:"appearFirstFrame",isVersion2Available:Lt()?1:0})},averageStreamSuccessCallback:function(){console.log("平均成功取流的出流耗时"),t.averageStreamSuccessTime=t.initSuccessTime-t.initTime+(t.gotWsUrlTime-t.startGetWsUrlTime)+(t.appearFirstFrameTime-t.openStreamTime),t.Monitor.dclog({url:t.url,action:228,d:t.averageStreamSuccessTime,text:"averageStreamSuccess",isVersion2Available:Lt()?1:0})}},t.env={domain:"https://open.ys7.com"},"undefined"!==typeof e.env&&(t.env=Object.assign(t.env,e.env)),"undefined"!==typeof e.handleTalkSuccess&&(t.handleTalkSuccess=e.handleTalkSuccess),"undefined"!==typeof e.handleTalkError&&(t.handleTalkError=e.handleTalkError),t.errorHander=new J,t.jSPlugin=s;var d=setInterval((function(){window.JSPlayerModuleLoaded&&(clearInterval(d),"function"===typeof t.params.handleInitSuccess&&t.params.handleInitSuccess({retcode:0,id:t.params.id,type:"handleInitSuccess"}),n({meta:{retcode:200,msg:"初始化成功"}}),-1!=e.url.indexOf("rec")&&e.template&&e.template.length<32&&"simple"!=e.template&&t.Theme&&"miniRec"!=e.id&&t.Theme.changeTheme(t.isMobile?"mobileRec":"pcRec"))}),50)}else s=new window.JSPluginV1({szId:i,iType:2,iWidth:o,iHeight:r,iMaxSplit:1,iCurrentSplit:1,szBasePath:"",staticPath:t.staticPath,oStyle:{border:"none",background:"#000000"}}),t.pluginStatus.loadingStart(i),t.isCall?t.pluginStatus.loadingSetText({text:"视频加载中"}):"miniRec"==t.themeId?t.pluginStatus.loadingSetText({text:""}):t.pluginStatus.loadingSetText({text:"初始化播放器完成"}),s.EventCallback={openStreamCallback:function(){console.log("开启取流---v1"),t.openStreamTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:224,d:t.openStreamTime-t.gotWsUrlTime,text:"openStream",isVersion2Available:Lt()?1:0})},getStreamHeaderCallback:function(){console.log("完成取流返回流头"),t.getStreamHeaderTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:225,d:t.getStreamHeaderTime-t.openStreamTime,text:"getStreamHeader",isVersion2Available:Lt()?1:0})},getVideoStreamCallback:function(){console.log("返回视频流(首次)"),t.getVideoStreamTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:226,d:t.getVideoStreamTime-t.getStreamHeaderTime,text:"getVideoStream",isVersion2Available:Lt()?1:0}),t.isCall&&t.Theme&&t.Theme.decoderState&&t.Theme.decoderState.state.rejection&&(console.log("挂断/拒绝状态------------stop"),t.stop((function(){t.pluginStatus.loadingClear(),t.pluginStatus.loadingSetTextWithBtn({text:"通话已结束",color:"white",isMobile:t.isMobile,type:2})})))},appearFirstFrameCallback:function(){console.log("出现首帧画面（播放成功）"),t.appearFirstFrameTime=(new Date).getTime(),t.Monitor.dclog({url:t.url,action:227,d:t.appearFirstFrameTime-t.getStreamHeaderTime,text:"appearFirstFrame",isVersion2Available:Lt()?1:0})},averageStreamSuccessCallback:function(){console.log("平均成功取流的出流耗时"),t.averageStreamSuccessTime=t.initSuccessTime-t.initTime+(t.gotWsUrlTime-t.startGetWsUrlTime)+(t.appearFirstFrameTime-t.openStreamTime),t.Monitor.dclog({url:t.url,action:228,d:t.averageStreamSuccessTime,text:"averageStreamSuccess",isVersion2Available:Lt()?1:0})},loadEventHandler:function(){},zoomEventResponse:function(){},windowEventSelect:function(e){},pluginErrorHandler:function(e,i,n){if(console.log(e,i,n),console.log("---------------------pluginErrorHandler"),!(t.isCall&&t.Theme&&t.Theme.decoderState&&t.Theme.decoderState.state.rejection))if(1003===i)console.log("断流"),t.Theme&&t.Theme.setDecoderState({play:!1}),t.pluginStatus.setPlayStatus({play:!1}),s.bPlay||(t.pluginStatus.loadingClear(),t.isCall?t.pluginStatus.loadingSetTextWithBtn({text:"连接断开，请重试",color:"white",btnName:t.isMobile?"重试":"重新加载",isMobile:t.isMobile,type:1}):t.pluginStatus.loadingSetText({text:"连接断开，请重试",color:"red"})),"function"===typeof t.params.handleError&&t.params.handleError({msg:"连接断开，请重试",retcode:1003,id:t.params.id,type:"handleError"});else if(1!=n.errorCode){console.log("errorCode----------",n.errorCode);var o=t.errorHander.matchErrorInfo(n.errorCode),a="连接断开，请重试";o&&o.msg?a=o.msg:o&&o.description&&(a=o.description),t.Theme&&t.Theme.setDecoderState({play:!1}),t.pluginStatus.setPlayStatus({play:!1}),t.pluginStatus.loadingClear(),t.isCall?t.pluginStatus.loadingSetTextWithBtn({text:a,color:"white",btnName:t.isMobile?"重试":"重新加载",isMobile:t.isMobile}):t.pluginStatus.loadingSetText({text:a,color:"red"}),"function"===typeof t.params.handleError&&t.params.handleError({msg:a,retcode:n.errorCode,id:t.params.id,type:"handleError"})}else t.pluginStatus.loadingClear(),t.Theme&&t.Theme.setDisabled(!1)},windowEventOver:function(e){},windowEventOut:function(e){},windowEventUp:function(e){},windowFullCcreenChange:function(e){},firstFrameDisplay:function(e,t,i){console.log(t,i),s.JS_SetCanFullScreen(!1)},performanceLack:function(){},mouseEvent:function(e,t,i){}},t.env={domain:"https://open.ys7.com"},"undefined"!==typeof e.env&&(t.env=Object.assign(t.env,e.env)),"undefined"!==typeof e.handleTalkSuccess&&(t.handleTalkSuccess=e.handleTalkSuccess),"undefined"!==typeof e.handleTalkError&&(t.handleTalkError=e.handleTalkError),t.errorHander=new J,t.jSPlugin=s,"function"===typeof t.params.handleInitSuccess&&t.params.handleInitSuccess({retcode:0,id:t.params.id,type:"handleInitSuccess"}),n({meta:{retcode:200,msg:"初始化成功"}}),-1!=e.url.indexOf("rec")&&e.template&&e.template.length<32&&"simple"!=e.template&&t.Theme&&"miniRec"!=e.id&&t.Theme.changeTheme(t.isMobile?"mobileRec":"pcRec")},u=new Promise(c);return u}},{key:"_getRealUrlPromise",value:function(e,t){var i=this;console.log("获取播放地址 url => ".concat(t," ").concat(this.accessToken)),console.log("开始获取wsurl"),this.startGetWsUrlTime=(new Date).getTime(),this.Monitor.dclog({url:this.url,action:222,text:"startGetWsUrl",isVersion2Available:Lt()?1:0});var n=this.env.domain;this.env&&(n=this.env.domain);var o=function(o,s){var d="",l=n+"/api/lapp/live/url/ezopen",c=new FormData;c.append("ezopen",t),c.append("isFlv","false"),c.append("userAgent",window.navigator.userAgent),c.append("isHttp","false"),c.append("accessToken",e),fetch(l,{method:"POST",body:c}).then((function(e){return e.json()})).then((function(e){if(200==e.code||0==e.retcode){var l="",c="";e.ext&&e.ext.token?(d+=e.data,c=e.ext.token,l=e.data):e.data&&e.data.token&&(d+=e.data.url,c=e.data.token,l=e.data.url);var u=-1!==t.indexOf("live")?"live":"playback";d="live"===u?d+"&ssn="+c+"&auth=1&biz=4&cln=100":d+"&ssn="+c+"&auth=1&cln=100",console.log(d);var m=E("checkCode",d);if(m&&("undefined"!==typeof i.jSPlugin.decoderVersion&&"2.0"===i.jSPlugin.decoderVersion?i.validateCode=m:(console.log("设置密钥",m),i.validateCode=m,i.jSPlugin.JS_SetSecretKey(0,m))),-1!==d.indexOf("playback")){var p=E("begin",l)||E("begin",t),h=E("end",l)||E("end",t);if(p)d=d.replace("&begin="+E("begin",l),"&begin="+a(p,"000000")),E("begin",d)||(d+="&begin="+a(p,"000000"));else{var f=new Date;d=d+"&begin="+f.Format("yyyyMMdd")+"T000000Z"}if(h?(d=d.replace("&end="+E("end",l),"&end="+a(h,"235959")),E("end",d)||(d+="&end="+a(h,"235959"))):d=d+"&end="+a(E("begin",d).substr(0,8),"235959"),E("stream",l)||(d=d.replace("stream","&stream")),-1!==t.indexOf(".cloud")){var g=function(e){if(200==e.code){var t=[];if(e.data&&e.data.files&&e.data.files.length>0){var i=e.data.files,n=(new Date).getTime(),a=e.data.isAll;if(a){t=c(i);var r=JSON.stringify(t).replace("\\","");d+="&recSlice="+r.replace("\\","")+"&r="+Math.random(),o(d)}else{var l=function e(){function a(a){if(a.data&&a.data.files&&a.data.files.length>0)if(0==a.data.isAll)a.data.files&&(i=i.concat(a.data.files)),n=a.data.nextFileTime>0?a.data.nextFileTime:(new Date).getTime(),e();else{t=c(i);var r=JSON.stringify(t).replace("\\","");d+="&recSlice="+r.replace("\\","")+"&r="+Math.random(),o(d)}else{t=c(i);r=JSON.stringify(t).replace("\\","");d+="&recSlice="+r.replace("\\","")+"&r="+Math.random(),o(d)}}C.startTime=n,M(b,"POST",C,"",a)};l()}}else s({retcode:-1,msg:"未找到录像片段"})}else s({retcode:-1,msg:"未找到录像片段"});function c(e){var t=[];return e.forEach((function(e,i){0==t.length||e.downloadPath!==t[t.length-1].downloadPath?t.push({downloadPath:e.downloadPath,ownerId:e.ownerId,iStorageVersion:e.iStorageVersion,videoType:e.videoType,iPlaySpeed:0,startTime:e.startTime,endTime:e.endTime}):t[t.length-1].endTime=e.endTime})),t}},v=r(E("begin",d)),y=r(E("end",d)),S=E("serial",d),_=E("chn",d),b=n+"/api/lapp/video/by/time",C={accessToken:i.accessToken,recType:1,deviceSerial:S,channelNo:_,startTime:v,endTime:y,version:"2.0"};M(b,"POST",C,"",g)}else if(-1!==t.indexOf("alarmId")){var T=function(e){if(200==e.code){var t=[];if(e.data){t=n([e.data]);var i=JSON.stringify(t).replace("\\","");d+="&recSlice="+i.replace("\\",""),console.log("realUrl",d,e.data.recType),d=1==e.data.recType?d.replace("/playback","/cloudplayback"):d.replace("/cloudplayback","/playback"),o(d)}}function n(e){var t=[];return e.forEach((function(e,i){0==t.length||e.downloadPath!==t[t.length-1].downloadPath?t.push({downloadPath:e.downloadPath,ownerId:e.ownerId,iStorageVersion:e.iStorageVersion,videoType:e.videoType,iPlaySpeed:0,startTime:e.startTime,endTime:e.endTime}):t[t.length-1].endTime=e.endTime})),console.log("downloadPathArr",t),t}};console.log("进入alarmId回放");var w=E("alarmId",d);v=r(E("begin",d)),y=r(E("end",d)),S=E("serial",d),_=E("chn",d),b=n+"/api/lapp/video/by/id",C={accessToken:i.accessToken,deviceSerial:S,channelNo:_,alarmId:w};M(b,"POST",C,"",T)}else o(d)}else o(d)}else i.Theme&&(i.Theme.setDisabled(!0),i.Theme.setDecoderState({play:!1})),i.pluginStatus.setPlayStatus({play:!1}),i.pluginStatus.loadingClear(),i.pluginStatus.loadingSetText({text:e.msg,color:"red"}),"function"===typeof i.params.handleError&&i.params.handleError({retcode:e.code,msg:e.msg,id:i.params.id,type:"handleError"}),s(e)}))};return new Promise((function(e,t){return o(e,t)}));function a(e,t){var i=/^[0-9]{8}T[0-9]{6}Z$/;if(i.test(e))return e;if(/[0-9]{8,14}/.test(e)){var n=6-(14-e.length),o=t.length,a=e+t.substring(n,o);return a.slice(0,8)+"T"+a.slice(8)+"Z"}throw new Error("回放时间格式有误，请确认")}function r(e){var t=e.slice(0,4),i=e.slice(4,6),n=e.slice(6,8),o=e.slice(9,11),a=e.slice(11,13),r=e.slice(13,15),s=t+"-"+i+"-"+n+" "+o+":"+a+":"+r;return new Date(s.replace(/-/g,"/")).getTime()}}},{key:"_pluginPlay",value:function(e,t,i){var n=this;if(console.log("执行播放 _pluginPlay",e),!e)return!1;function o(e){var t=e.split("?")[0].replace("/live","").replace("/playback",""),i=(-1===e.indexOf("/live")?-1!==e.indexOf("cloudplayback")?"/cloudplayback?":"/playback?":"/live?")+e.split("?")[1];return-1!==i.indexOf("/playback")&&(i=i.replace("stream=2","stream=1")),{websocketConnectUrl:t,websocketStreamingParam:i}}var a=o(e).websocketConnectUrl;this.env&&this.env.wsUrl&&(a=this.env.wsUrl),this.gotWsUrlTime=(new Date).getTime(),this.Monitor.dclog({url:this.url,action:223,d:this.gotWsUrlTime-this.startGetWsUrlTime,text:"getWsUrlSuccess",isVersion2Available:Lt()?1:0});var r={playURL:o(e).websocketStreamingParam};console.log("播放前 stop 阶段 结束"),this.isStoping=!1;var s=Date.now();console.log("执行播放 ... this.jSPlugin.JS_Play at ",s),this.jSPlugin.JS_Play(a,r,0).then((function(){if(console.log("执行播放 ... this.jSPlugin.JS_Play 播放成功",a,r),console.log("执行播放耗时 ",Date.now()-s),n.isStoping)console.log("现在在播放前 stop 阶段，此次应为无效播放成功触发。不执行后续回调， 此次耗时无效");else{if(n.validateCode&&"undefined"!==typeof n.jSPlugin.decoderVersion&&"2.0"===n.jSPlugin.decoderVersion&&n.jSPlugin.JS_SetSecretKey(0,n.validateCode),n.pluginStatus.loadingClear(),n.pluginStatus.setPlayStatus({play:!0,loading:!1}),n.Theme){if(n.Theme.setDecoderState({play:!0}),!n.isCall)var e=Z.findIndex(n.Theme.themeData.footer.btnList,(function(e){return"sound"===e.iconId&&1===e.isrender&&1===e.defaultActive}))>-1;n.audio=e}n.audio&&setTimeout((function(){n.openSound()}),500),"function"===typeof n.params.handleSuccess&&n.params.handleSuccess({retcode:0,id:n.params.id,type:"handleSuccess"}),t(r),n.Monitor.dclog({url:n.url,action:211,d:(new Date).getTime()-n.playStartTime,text:"startPlaySuccess"}),n.Monitor.playLog({Enc:-1===n.url.indexOf("@")?0:1,PlTp:-1===n.url.indexOf("back")?1:2,Via:2,ErrCd:0,Cost:(new Date).getTime()-n.playStartTime,Serial:j(n.url).deviceSerial,Channel:j(n.url).channelNo,Ver:Lt()?"v7.0.0":"v6.0.0"})}}),(function(e){console.log("err",e);var t="播放失败，请检查设备及客户端网络",o=-1;if(n.jSPlugin.bPlay)return!1;if(e&&e.errorCode){var a=n.errorHander.matchErrorInfo(e.errorCode);n.Theme&&n.Theme.setDisabled(!0),t=a&&a.msg?a.msg:a&&a.description?a.description:"播放失败，请检查设备及客户端网络",o=e.errorCode}n.isCall?n.Theme&&n.Theme.decoderState&&n.Theme.decoderState.state.rejection||(n.pluginStatus.loadingClear(),n.pluginStatus.loadingSetTextWithBtn({text:t,color:"white",btnName:n.isMobile?"重试":"重新加载",isMobile:n.isMobile})):(n.pluginStatus.loadingClear(),n.pluginStatus.loadingSetText({text:t,color:"red"})),"function"===typeof n.params.handleError&&n.params.handleError({retcode:o,msg:t,id:n.params.id,type:"handleError"}),i(),n.Monitor.dclog({url:n.url,action:411,d:(new Date).getTime()-n.playStartTime,text:"startPlayError"}),n.Monitor.playLog({Enc:-1===n.url.indexOf("@")?0:1,PlTp:-1===n.url.indexOf("back")?1:2,Via:2,ErrCd:o,Cost:-1,Serial:j(n.url).deviceSerial,Channel:j(n.url).channelNo,Ver:Lt()?"v7.0.0":"v6.0.0"})}))}},{key:"_play",value:function(e){var t=this;console.log("执行播放 play options.url =>",e),this.pluginStatus.setPlayStatus({play:!1,loading:!0}),this.playStartTime=(new Date).getTime(),this.Monitor.dclog({url:this.url,action:1,d:(new Date).getTime()-this.initTime,text:"startPlay"}),e&&("string"===typeof e&&(this.url=e),"string"===typeof e.url&&(this.url=e.url),"string"===typeof e.accessToken&&(this.accessToken=e.accessToken),"string"===typeof j(this.url).deviceSerial&&(this.deviceSerial=j(this.url).deviceSerial),"string"===typeof j(this.url).channelNo&&(this.channelNo=j(this.url).channelNo),!this.Theme||"string"!==typeof e.url&&"string"!==typeof e.accessToken||this.Theme.getDeviceInfo((function(e){e.data.isEncrypt&&-1===t.url.indexOf("@")&&setTimeout((function(){t.pluginStatus.loadingClear(),t.pluginStatus.loadingSetText({text:"设备已加密",color:"red"})}),1500)})));var i=new Promise((function(e,i){console.log("执行 播放前 stop"),t.isStoping=!0,t.jSPlugin.JS_Stop(0).then((function(){console.log("播放前 stop 执行成功 this.url => ".concat(t.url," ").concat(t.accessToken)),t._getRealUrlPromise(t.accessToken,t.url).then((function(n){t._pluginPlay(n,(function(i){console.log("---------------------播放成功回调"),setTimeout((function(){t.pluginStatus.loadingClear(),t.isCall&&t.Theme&&t.Theme.decoderState&&t.Theme.decoderState.state.rejection&&(console.log("挂断/拒绝状态------------stop"),t.stop((function(){t.pluginStatus.loadingClear(),t.pluginStatus.loadingSetTextWithBtn({text:"通话已结束",color:"white",isMobile:t.isMobile,type:2})})))}),500),e(!0)}),(function(){return i(!1)}))}))["catch"]((function(e){var n=e.msg?e.msg:"播放失败，请检查设备及客户端网络";t.Theme&&t.Theme.setDisabled(!0),t.isCall?t.Theme&&t.Theme.decoderState&&t.Theme.decoderState.state.rejection?e&&20018==e.code?t.pluginStatus.loadingSetTextWithBtn({text:"该用户不拥有该设备",color:"white",isMobile:t.isMobile,type:2}):t.pluginStatus.loadingSetTextWithBtn({text:"通话已结束",color:"white",isMobile:t.isMobile,type:2}):e&&20018==e.code?(t.pluginStatus.loadingSetTextWithBtn({text:"该用户不拥有该设备",color:"white",isMobile:t.isMobile,type:2}),!t.isWebConsole&&t.Theme&&t.Theme.call&&t.Theme.call.userNoDevice()):t.pluginStatus.loadingSetTextWithBtn({text:n,color:"white",btnName:t.isMobile?"重试":"重新加载",isMobile:t.isMobile}):t.pluginStatus.loadingSetText({text:n,color:"red"}),"function"===typeof t.params.handleError&&t.params.handleError({retcode:e.oError?e.oError.errorCode:-1,msg:n,id:t.params.id,type:"handleError"}),i({retcode:e.oError?e.oError.errorCode:-1,msg:n,id:t.params.id,type:"handleError"})}))}))}));return i}},{key:"stop",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this.pluginStatus.setPlayStatus({loading:!0}),this.reSetTheme(),this.jSPlugin.JS_Stop(0).then((function(){console.log("停止成功"),e.pluginStatus.setPlayStatus({play:!1,loading:!1}),e.Theme&&e.Theme.setDecoderState({play:!1}),t()}))}},{key:"changeVideoLevel",value:function(e){var t=this.url,i=t;"number"===typeof e&&(i=1===e?t.replace(".live",".hd.live"):t.replace(".hd.live",".live"),this.jSPlugin.playURL=e?this.jSPlugin.playURL.replace("stream=2","stream=1"):this.jSPlugin.playURL.replace("stream=1","stream=2"),console.warn("changeVideoLevel","该方法将不在支持传入number类型的参数，建议使用对象类型的参数")),"object"===c(e)&&("number"===typeof e.streamType&&["sd","hd"].includes(e.level)&&(i="hd"===e.level?t.replace(".live",".hd.live"):t.replace(".hd.live",".live")),this.jSPlugin.playURL=1===e.streamType?this.jSPlugin.playURL.replace("stream=2","stream=1"):this.jSPlugin.playURL.replace("stream=1","stream=2")),this.url=i;var n=this.changePlayUrl({url:i},(function(){}),!1);return k(n)?n:new Promise((function(e){e(n)}))}},{key:"reSetTheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.Theme&&this.Theme.Ptz&&(this.Theme.setDecoderState({pantile:!1}),this.Theme.Ptz.hide()),this.Theme&&this.Theme.decoderState.state.recordvideo&&this.Theme.setDecoderState({recordvideo:!1}),e.indexOf("zoom")>-1&&(this.use3DZoom?(this.is3DZooming=!1,this.close3DZoom()):this.Zoom&&this.Zoom.currentScale>1&&this.Zoom.stopZoom(),this.Theme&&this.Theme.setDecoderState({zoom:!1})),this.Theme&&this.Theme.decoderState.state.talk&&(this.stopTalk(),this.Theme.setDecoderState({talk:!1})),this.Theme&&this.Theme.Rec&&!this.Theme.isMobile&&this.Theme.Rec.datepickerHide(),this.Theme&&this.Theme.Rec&&(this.Theme.changeRecSpeed(1),this.Theme.nextRate=1,this.speed=1,this.Theme.setDecoderState({speed:!1}))}},{key:"_changePlayUrl",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console.log("_changePlayUrl"),console.log(e),this.reSetTheme(["zoom"]),this.getDeviceCapacity({accessToken:e.accessToken||this.accessToken,deviceSerial:e.deviceSerial||this.deviceSerial});var o=this.url,a=s(o,e);e.accessToken&&(this.accessToken=e.accessToken,this.deviceSerial=e.deviceSerial,this.channelNo=e.channelNo),this.url=a,i(),this.pluginStatus.loadingStart(this.id),this.pluginStatus.loadingSetText({text:"加载中，请稍后"});var r=new Promise((function(i,o){var r={url:a};return e.accessToken&&(r["accessToken"]=e.accessToken),console.log("切换播放地址 参数 ",r),t.play(r).then((function(){console.log("切换播放地址 play 执行成功 ",t.url,t.accessToken),setTimeout((function(){t.Theme&&t.Theme.decoderState.state.webExpend&&t.Theme.webExpend(),t.Theme&&t.Theme.decoderState.state.expend&&t.Theme.expend()}),500),n&&(e.type?t.Theme&&("rec"==e.type||"cloud.rec"==e.type?t.Theme.changeTheme(t.isMobile?"mobileRec":"pcRec"):"miniRec"==e.type?t.Theme.changeTheme("miniRec"):t.Theme.changeTheme(t.isMobile?"mobileLive":"pcLive")):t.Theme&&(t.url.indexOf(".rec")>-1?t.Theme.changeTheme(t.isMobile?"mobileRec":"pcRec"):t.isCall?t.Theme.changeTheme(t.isMobile?"mobileCall":"webCall"):t.Theme.changeTheme(t.themeId))),e&&e.begin&&e.deviceSerial&&t.Theme&&t.Theme.Rec.setDatepickerDate(e.begin),t.Theme&&t.Theme.setDisabled(!1),i(a)}))["catch"]((function(e){o(a),e&&e.msg&&(t.Theme&&t.Theme.setDisabled(!0),t.pluginStatus.loadingClear(),t.pluginStatus.loadingSetText({text:e.msg,color:"red"}))}))}));function s(e,t){if(t.url)return t.url;console.log("--------------matchInitUrl",e);var i=e.split("/")[4].split(".")[e.split("/")[4].split(".").length-1].split("?")[0];"rec"===i&&-1!==e.indexOf(".cloud.rec")&&(i="cloud.rec"),t.type&&(i="miniRec"==t.type?"rec":t.type);var n=e.split("/")[3];t.deviceSerial&&(n=t.deviceSerial);var o=e.split("/")[4].split(".")[0];t.channelNo&&(o=t.channelNo);var a=2===e.split("/")[2].split("@").length?e.split("/")[2].split("@")[0]:"";"undefined"!==typeof t.validCode&&(a=t.validCode);var r="undefined"===typeof t.hd?-1!==e.indexOf(".hd"):t.hd,s="ezopen://".concat(a?"".concat(a,"@"):"","open.ys7.com/").concat(n,"/").concat(o).concat(r?".hd":"",".").concat(i);return"live"===i||(s="ezopen://".concat(a?"".concat(a,"@"):"","open.ys7.com/").concat(n,"/").concat(o,".").concat(i),t.begin&&t.end?s+="?begin=".concat(t.begin,"&end=").concat(t.end):t.begin?s+="?begin=".concat(t.begin):E("begin",e)&&E("end",e)?s+="?begin=".concat(E("begin",e),"&end=").concat(E("end",e)):E("begin",e)&&(s+="?begin=".concat(E("begin",e)))),s}return r}},{key:"getOSDTime",value:function(){var e=this,t=new Promise((function(t,i){e.jSPlugin.JS_GetOSDTime(0).then((function(i){t({code:0,retcode:0,data:i}),"function"===typeof e.params.getOSDTimeCallBack&&e.params.getOSDTimeCallBack({id:e.id,type:"getOSDTime",code:0,data:i})}))["catch"]((function(t){i({code:-1,retcode:-1,data:t}),"function"===typeof e.params.getOSDTimeCallBack&&e.params.getOSDTimeCallBack({id:e.id,type:"getOSDTime",code:-1,data:-1})}))}));return t}},{key:"capturePicture",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.jSPlugin.JS_CapturePicture(0,e,"JPEG",i,!!i);if(k(n))return new Promise((function(e,i){n.then((function(i){"function"===typeof t.params.capturePictureCallBack&&t.params.capturePictureCallBack({id:t.id,type:"capturePicture",code:0});var n={id:t.id,code:0,data:i.data,type:"handleCapturePicture"};"function"===typeof t.params.handleCapturePicture&&t.params.handleCapturePicture(n),e(n)}),(function(e){"function"===typeof t.params.capturePictureCallBack&&t.params.capturePictureCallBack({id:t.id,type:"capturePicture",code:-1});var n=Object.assign({id:t.id,type:"handleCapturePicture",code:-1},e);"function"===typeof t.params.handleCapturePicture&&t.params.handleCapturePicture(n),i(n)}))}))}},{key:"startSave",value:function(e){var t=this,i=this.jSPlugin.JS_StartSave(0,e);return k(i)?("function"===typeof this.params.startSaveCallBack&&i.then((function(){t.params.startSaveCallBack({id:t.id,type:"startSave",code:0})}))["catch"]((function(){t.params.startSaveCallBack({id:t.id,type:"startSave",code:-1})})),i):(this.Theme&&this.Theme.setDecoderState({recordvideo:!0}),new Promise((function(e){e(i)})))}},{key:"stopSave",value:function(){var e=this,t=this.jSPlugin.JS_StopSave(0);return k(t)?("function"===typeof this.params.startSaveCallBack&&t.then((function(){e.params.stopSaveCallBack({id:e.id,type:"stopSave",code:0})}))["catch"]((function(){e.params.stopSaveCallBack({id:e.id,type:"stopSave",code:-1})})),t):(this.Theme&&this.Theme.setDecoderState({recordvideo:!1}),new Promise((function(e){e(t)})))}},{key:"openSound",value:function(){var e=this.jSPlugin.JS_OpenSound(0);return console.log("打开声音",e),k(e)?e:(this.Theme&&this.Theme.setDecoderState({sound:!0}),"function"===typeof this.params.openSoundCallBack&&this.params.openSoundCallBack({id:this.id,type:"openSound",code:e}),new Promise((function(t){t(e)})))}},{key:"closeSound",value:function(){var e=this.jSPlugin.JS_CloseSound(0);return k(e)?e:(this.Theme&&this.Theme.setDecoderState({sound:!1}),"function"===typeof this.params.closeSoundCallBack&&this.params.closeSoundCallBack({id:this.id,type:"closeSound",code:e}),new Promise((function(t){t(e)})))}},{key:"enableZoom",value:function(){var e=this.jSPlugin.JS_EnableZoom(0);return k(e)?e:new Promise((function(t){t(e)}))}},{key:"closeZoom",value:function(){var e=this.jSPlugin.JS_DisableZoom(0);return k(e)?e:new Promise((function(t){t(e)}))}},{key:"enable3DZoom",value:function(){var e=this;if(!this.use3DZoom)return new Promise((function(e,t){t({code:-1,msg:"未启用3D定位功能"})}));function t(e,t){if(!e||!e.startPos||!e.endPos)return-1;var i=e.startPos[0],n=e.startPos[1],o=e.endPos[0],a=e.endPos[1];return t?o>i&&a<n?1:o<i&&a>n?0:-1:o>i&&a>n?1:o<i&&a<n?0:-1}function i(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;if(!e||!t||!i||!i.startPos||!i.endPos)return-1;var o=i.startPos[0],a=i.startPos[1],r=i.endPos[0],s=i.endPos[1],d=Math.abs(r-o),l=Math.abs(s-a),c=parseInt((o+r)/2),u=parseInt((a+s)/2),m=Math.round(e*t/(d*l));return console.log("最大缩放倍数：",n),console.log("计算缩放倍数：",e*t/(d*l)),console.log("下发缩放倍数：",m>n?n:m),{startPointX:parseInt(o/e*256),startPointY:parseInt(a/t*256),endPointX:parseInt(r/e*256),endPointY:parseInt(s/t*256),zoomRate:m>n?n:m,targetCenterX:c,targetCenterY:u,targetWidth:d,targetHeight:l}}if(this.is3DZooming)return new Promise((function(e,t){t({code:-1,msg:"3D定位已处于开启状态"})}));if(this.isMobile||(this.Zoom&&this.Zoom.stopZoom(),this.Theme&&this.Theme.setDecoderState({zoom:!1})),this.support3DZoom){this.is3DZooming=!0,this.Theme&&this.Theme.setDecoderState({zoom:!0}),document.getElementById("".concat(this.id,"-zoom-content"))&&(document.getElementById("".concat(this.id,"-zoom-content")).title="3D定位");var n=this.jSPlugin.JS_Enable3DZoom(0,(function(n){var o=e.Theme&&e.Theme.decoderState.state.expend&&e.isMobile?e.fullScreenWidth:e.width,a=e.Theme&&e.Theme.decoderState.state.expend&&e.isMobile?e.fullScreenHeight:e.height,r=t(n,e.Theme&&e.Theme.decoderState.state.expend);if(r>-1)try{var s=i(o,a,n,e.capacity&&e.capacity.support_zoomOut_maxTime?e.capacity.support_zoomOut_maxTime:5),d=e.env.domain+"/api/v3/das/device/3d/zoom?accessToken=".concat(e.accessToken,"&deviceSerial=").concat(j(e.url).deviceSerial,"&channelNo=").concat(j(e.url).channelNo,"&command=").concat(0==r?9:8,"&zoomTimes=").concat(s.zoomRate,"&startPointX=").concat(s.startPointX,"&startPointY=").concat(s.startPointY,"&endPointX=").concat(s.endPointX,"&endPointY=").concat(s.endPointY,"&length=").concat(parseInt(a),"&width=").concat(parseInt(o),"&midPointX=").concat(s.targetCenterX,"&midPointY=").concat(s.targetCenterY,"&lengthX=").concat(s.targetWidth,"&lengthY=").concat(s.targetHeight);fetch(d,{method:"POST"}).then((function(e){return e.json()})).then((function(t){200!=t.code&&e.pluginStatus.loadingSetText({text:t.msg,color:"red",delayClear:2e3})}))["catch"]((function(t){e.pluginStatus.loadingSetText({text:"3D定位失败，请重试",color:"red",delayClear:2e3})}))}catch(l){e.pluginStatus.loadingSetText({text:"3D定位失败，请重试",color:"red",delayClear:2e3})}}));return this.isMobile?this.Zoom=new Ge(this):this.Zoom=new Ve(this),k(n)?n:new Promise((function(e){e(n)}))}return this.is3DZooming=!1,document.getElementById("".concat(this.id,"-zoom-content"))&&(document.getElementById("".concat(this.id,"-zoom-content")).title="电子放大"),new Promise((function(e,t){t({code:-1,msg:"当前设备不支持3D定位功能"})}))}},{key:"close3DZoom",value:function(){if(!this.use3DZoom)return new Promise((function(e,t){t({code:-1,msg:"未启用3D定位功能"})}));if(this.is3DZooming){this.Theme&&this.Theme.setDecoderState({zoom:!1});var e=this.jSPlugin.JS_Disable3DZoom(0);return this.isMobile?this.Zoom=new Ge(this):this.Zoom=new Ve(this),this.is3DZooming=!1,k(e)?e:new Promise((function(t){t(e)}))}return new Promise((function(e,t){t({code:-1,msg:"3D定位已处于关闭状态"})}))}},{key:"changeZoomType",value:function(e){var t=this;if(e&&this.capacity&&!this.support3DZoom)return{code:-1,msg:"当前设备不支持开启3D定位功能"};this.is3DZooming?this.close3DZoom():this.Theme&&this.Theme.decoderState.state.zoom&&this.Zoom&&this.Zoom.stopZoom(),this.Theme&&this.Theme.setDecoderState({zoom:!1}),this.use3DZoom=e,this.isMobile?this.Zoom=new Ge(this):this.Zoom=new Ve(this),setTimeout((function(){e?document.getElementById("".concat(t.id,"-zoom-content"))&&(document.getElementById("".concat(t.id,"-zoom-content")).title="3D定位"):document.getElementById("".concat(t.id,"-zoom-content"))&&(document.getElementById("".concat(t.id,"-zoom-content")).title="电子放大"),t.isMobile&&e&&t.enable3DZoom()}),500)}},{key:"setPoster",value:function(e){Lt()?document.getElementById("".concat(this.id))&&(document.getElementById("".concat(this.id)).style.backgroundImage="url(".concat(e,")"),document.getElementById("".concat(this.id)).style.backgroundSize="100% 100%"):document.getElementById("".concat(this.id,"canvas0"))&&(document.getElementById("".concat(this.id,"canvas0")).style.backgroundImage="url(".concat(e,")"),document.getElementById("".concat(this.id,"canvas0")).style.backgroundSize="cover")}},{key:"reSize",value:function(e,t){var i=0,n=0;if(this.params.height=t,this.params.width=e,this.Theme&&this.Theme.isNeedRenderHeader&&document.getElementById("".concat(this.id,"-headControl"))&&(i=parseInt(document.getElementById("".concat(this.id,"-headControl")).style.height,10)),this.Theme&&this.Theme.isNeedRenderTimeLine&&!this.isMobile&&(n=48),t=t-i-n,this.width=e,this.height=t,document.getElementById("".concat(this.id,"-wrap")).style="width:".concat(e,"px;position:relative;display:inline-block;vertical-align: bottom;"),document.getElementById("".concat(this.id)).style.width=e+"px",document.getElementById("".concat(this.id)).style.height=t+"px",this.jSPlugin&&this.jSPlugin.bPlay)this.jSPlugin&&(this.jSPlugin.iHeight=t,this.jSPlugin.iWidth=e),this.jSPlugin.JS_Resize(e,t);else{document.getElementById("".concat(this.id,"-player"))&&(document.getElementById("".concat(this.id,"-player")).width=e,document.getElementById("".concat(this.id,"-player")).height=t,document.getElementById("".concat(this.id,"-player")).style.width=e+"px",document.getElementById("".concat(this.id,"-player")).style.height=t+"px");var o=1;if(document.getElementById("".concat(this.id,"canvas0"))){var a=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);a&&(o=2),document.getElementById("".concat(this.id,"canvas0")).style.width=e*o+"px",document.getElementById("".concat(this.id,"canvas0")).style.height=t*o+"px",document.getElementById("".concat(this.id,"canvas0")).width=e*o,document.getElementById("".concat(this.id,"canvas0")).height=t*o,document.getElementById("".concat(this.id,"canvas0")).parentNode.style.width=e*o+"px",document.getElementById("".concat(this.id,"canvas0")).parentNode.style.height=t*o+"px",document.getElementById("".concat(this.id,"canvas_draw0")).height=t*o}this.jSPlugin&&(this.jSPlugin.iHeight=t*o,this.jSPlugin.iWidth=e*o)}}},{key:"fast",value:function(e){var t=this,i=this.speed;if(e){var n=this.jSPlugin.JS_Speed(e);this.Theme&&(this.Theme.changeRecSpeed(e),this.Theme.nextRate=e)}else{if(1===i)i=2;else{if(2!==i)return console.log("当前已经是最大播放倍数"),"function"===typeof this.params.handleError&&this.params.handleError({msg:"播放速度最大为4倍速度",retcode:1003,id:this.id,type:"handleError"}),new Promise((function(e,n){t.speed=i,n({code:-1,data:{speed:i,result:"播放速度最大为4倍速度"}})}));i=4}n=this.jSPlugin.JS_Speed(i);this.Theme&&(this.Theme.changeRecSpeed(i),this.Theme.nextRate=i)}return new Promise((function(e){t.speed=i,e({code:0,data:{speed:i,result:n}})}))}},{key:"slow",value:function(){var e=this,t=this.speed;if(4===t)t=2;else{if(2!==t)return console.log("当前已经是最小播放倍数"),"function"===typeof this.params.handleError&&this.params.handleError({msg:"播放速度最小为1倍速度",retcode:1003,id:this.id,type:"handleError"}),new Promise((function(i,n){e.speed=t,n({code:-1,data:{speed:t,result:"播放速度最小为1倍速度"}})}));t=1}var i=this.jSPlugin.JS_Speed(t);return new Promise((function(n){e.speed=t,n({code:0,data:{speed:t,result:i}})}))}},{key:"seek",value:function(e,t){var i=this.url,n=(E("begin",i)||(new Date).Format("yyyyMMdd")).substr(0,8);if(t=o(n,"235959"),6===e.length)e=o(n,e);else{if(16!==e.length)return"function"===typeof this.params.handleError&&this.params.handleError({msg:"seek时间格式错误",retcode:-1,id:this.id,type:"handleError"}),!1;if(e.substr(0,8)!==n)return"function"===typeof this.params.handleError&&this.params.handleError({msg:"seek时间不能跨日期",retcode:-1,id:this.id,type:"handleError"}),!1}function o(e,t){var i=/^[0-9]{8}T[0-9]{6}Z$/;if(i.test(e))return e;if(/[0-9]{8,14}/.test(e)){var n=6-(14-e.length),o=t.length,a=e+t.substring(n,o);return a.slice(0,8)+"T"+a.slice(8)+"Z"}throw new Error("回放时间格式有误，请确认")}var a=this.jSPlugin.JS_Seek(0,e,t);return console.log("seekRT",a),k(a)?a:new Promise((function(e){e(a)}))}},{key:"fullScreen",value:function(){var e=this,t=R(document.getElementById("".concat(this.id)));t.then((function(t){console.log("全屏promise",window.screen.availWidth),e.jSPlugin.JS_Resize(window.screen.availWidth,window.screen.availHeight),"function"===typeof e.params.fullScreenCallBack&&e.params.fullScreenCallBack({id:e.id,type:"fullScreen",code:0})}));var i=function(){var t=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;t||e.jSPlugin.JS_Resize(e.width,e.height),"function"===typeof e.params.fullScreenChangeCallBack&&e.params.fullScreenChangeCallBack({id:e.id,type:"fullScreen",code:t})};["fullscreenchange","webkitfullscreenchange","mozfullscreenchange"].forEach((function(e){window.addEventListener(e,(function(e){return i()}))}))}},{key:"cancelFullScreen",value:function(){var e=this,t=B();t.then((function(t){console.log("取消全屏",t,e.jSPlugin),e.jSPlugin.JS_Resize(e.width,e.height)}))}},{key:"startTalk",value:function(){this.Talk.startTalk()}},{key:"stopTalk",value:function(){this.Talk.stopTalk()}},{key:"destroy",value:function(){var e=this.jSPlugin.JS_DestroyWorker(0);return this.Theme&&(this.Theme=null,window.EZUIKit[this.params.id].state.EZUIKitPlayer.themeInit=!1),k(e)?e:new Promise((function(t){t(e)}))}},{key:"getDeviceCapacity",value:function(e){var t=this,i=this.env.domain;this.capacity=null,this.env&&(i=this.env.domain);var n=i+"/api/lapp/device/capacity",o=function(e){if(t.support3DZoom=!1,document.getElementById("".concat(t.id,"-zoom-content"))&&(document.getElementById("".concat(t.id,"-zoom-content")).title="电子放大"),200==e.code&&e.data){if(t.capacity=e.data,t.isMobile&&t.isCall&&(!t.capacity["support_doorcall_playback"]||1!=t.capacity["support_doorcall_playback"])){if(console.log("小窗口initMiniRec-------------设备能力集失败"),t.isWebConsole)return;setTimeout((function(){document.getElementById("".concat(t.jSPlugin.id,"-wrap"))&&document.getElementById("miniRecbox")&&(document.getElementById("".concat(t.jSPlugin.id,"-wrap")).removeChild(document.getElementById("miniClose")),document.getElementById("".concat(t.jSPlugin.id,"-wrap")).removeChild(document.getElementById("miniRecbox")))}),1500)}t.capacity&&"1"==t.capacity.support_3d_position&&t.url.indexOf(".live")>-1&&(t.support3DZoom=!0,t.params.use3DZoom&&(t.use3DZoom=!0,document.getElementById("".concat(t.id,"-zoom-content"))&&(document.getElementById("".concat(t.id,"-zoom-content")).title="3D定位")))}},a=e||{accessToken:this.accessToken,deviceSerial:j(this.url).deviceSerial};M(n,"POST",a,"",o)}},{key:"pause",value:function(e){var t=this;return new Promise((function(i,n){t.jSPlugin.JS_CloseSound(0),t.jSPlugin.JS_Pause(0,e).then((function(e){t.Theme&&t.Theme.setDecoderState({play:!1}),i()}))["catch"]((function(e){console.log(e),n(e)}))}))}},{key:"_resume",value:function(e){var t=this;return new Promise((function(i,n){t.pluginStatus.setPlayStatus({play:!1,loading:!0}),t.validateCode&&""!=t.validateCode&&t.jSPlugin.JS_SetSecretKey(0,t.validateCode),t.jSPlugin.JS_Resume(e).then((function(e){if(setTimeout((function(){-1!==t.url.indexOf(".rec")&&1!=t.speed&&t.jSPlugin.JS_Speed(t.speed)}),500),t.Theme){t.Theme.setDecoderState({play:!0}),t.fast(t.speed);var n=t.Theme.decoderState.state.sound;n&&setTimeout((function(){t.openSound()}),500)}i(e)}))["catch"]((function(e){console.log("resume err",e),n(e)}))}))}},{key:"getDefinitionList",value:function(){return this.Theme?this.Theme.decoderState.state.hdList:[]}},{key:"getDefinition",value:function(){return!!this.Theme&&this.Theme.decoderState.state.hd}},{key:"setDefinition",value:function(e){var t=this.getDefinitionList().find((function(t){return"string"===typeof e?t.level===e:"object"===c(e)?t.level===e.level:void 0}));t?(this.changeVideoLevel(t),this.Theme&&(this.Theme.setDecoderState({hd:t}),this.Theme.resetMobileZoomStatus()),this.Theme&&this.Theme.decoderState.state.recordvideo&&this.Theme.setDecoderState({recordvideo:!1})):console.log("请输入正确的清晰度")}},{key:"getPtzStatus",value:function(){if(this.Theme)return console.log("当前是否开启云台：",this.Theme.Ptz.showPtz),this.Theme.Ptz.showPtz}},{key:"openPtz",value:function(){return this.Theme?this.isMobile&&this.Theme&&!this.Theme.decoderState.state.expend?(console.log("移动端，非全屏状态不展示云台"),!1):(console.log("显示云台"),this.Theme.setDecoderState({pantile:!0}),void this.Theme.Ptz.show()):{code:-1,msg:"未加载Theme模块，无法操作云台"}}},{key:"closePtz",value:function(){if(!this.Theme)return{code:-1,msg:"未加载Theme模块，无法操作云台"};console.log("隐藏云台"),this.Theme.setDecoderState({pantile:!1}),this.Theme.Ptz.hide()}},{key:"isBrowserFullscreen",value:function(){if(this.Theme)return console.log("当前是否为浏览器全屏状态：",this.Theme.decoderState.state.webExpend),this.Theme.decoderState.state.webExpend}},{key:"browserFullscreen",value:function(){this.Theme&&(this.Theme.webExpend(),this.Theme.setDecoderState({webExpend:!0}))}},{key:"exitBrowserFullscreen",value:function(e,t){var i=this,n=B();n.then((function(n){i.jSPlugin.JS_Resize(e||i.width,t||i.height),i.Theme&&(i.Theme.Rec&&i.Theme.Rec.recAutoSize(),i.Theme.setDecoderState({webExpend:!1}))}))}},{key:"getPlayRate",value:function(){return console.log("当前播放速度：",this.speed),this.speed}},{key:"setMiooroFlip",value:function(e){return"number"!==typeof e?Promise.reject({code:-1,msg:"翻转参数类型错误"}):Ye(this.env.domain,this.accessToken,this.deviceSerial,this.channelNo,e)}}]),e}(),Nt=null;function Ft(e,t,i,n){return new WebControl({szPluginContainer:e,iServicePortStart:14510,iServicePortEnd:14519,cbConnectSuccess:t,cbConnectError:i,cbConnectClose:n})}function zt(){null!=Nt&&(Nt.JS_DestroyWnd().then((function(){console.log("JS_DestroyWnd")}),(function(){})),Nt.JS_StopService("window").then((function(){Nt.JS_Disconnect().then((function(){console.log("JS_Disconnect")}),(function(){}))})))}function Ot(e){e.responseMsg.eventName,console.log(e.responseMsg)}function Ut(){Nt.JS_SetWindowControlCallback({cbIntegrationCallBack:Ot}),Nt.JS_StartService("window",{dllPath:"./chain/cloudTransform.dll"}).then((function(){Nt.JS_CreateWnd("playWnd",900,500).then((function(){console.log("JS_CreateWnd success")}))}))}function Zt(){console.log("cbConnectError"),Nt=null,console.error("确认本地进程是否已安装并开启成功！")}function Vt(e){console.log("cbConnectClose"),Nt=null}window.onscroll=function(){null!=Nt&&Nt.JS_Resize(900,500)},window.onresize=function(){null!=Nt&&Nt.JS_Resize(900,500)},window.onunload=function(){try{Nt.JS_HideWnd(),zt()}catch(e){console.error(e)}},window.onpagehide=function(){try{Nt.JS_HideWnd()}catch(e){console.error(e)}};var Ht=function(){function e(t){var i=this;p(this,e),g(this,"changeModel",(function(e,t){var n=i;i.switchVideo=parseInt(e),Nt&&Nt.JS_RequestInterface({funcName:"ChangeModel",arguments:encodeURI(JSON.stringify({model:e}))}).then((function(i){0==e?n.play({deviceSerial:t.deviceSerial,channelNo:t.channelNo,validateCode:t.validateCode}):n.play({deviceSerial:t.deviceSerial,channelNo:t.channelNo,validateCode:t.validateCode,startTime:t.startTime,endTime:t.endTime})}))})),g(this,"init",(function(e){var t,n=i;if(e.appKey&&e.accessToken){"undefined"!==typeof e.appKey&&(i.appKey=e.appKey),"undefined"!==typeof e.accessToken&&(i.accessToken=e.accessToken),"undefined"!==typeof e.platformId&&(i.platformId=e.platformId);var o=(t={layout:+n.layout,userName:"",waterMark:""},g(t,"waterMark","1"),g(t,"iWndType",0),g(t,"intelligenceEnable",1),g(t,"isRecord",1),g(t,"isSetPos",1),g(t,"motionDetectEnable",0),g(t,"playBackAlarmOverlyingEnable",0),g(t,"response",{code:0,message:null,data:{appKey:e.appKey,ezvizToken:e.accessToken,videoLevel:0,logLevel:3,showMainTool:1,showSubTool:1,waterMark:"1",userName:"openteam",platformId:e.platformId}}),t);console.log("初始化入参",o),Nt.JS_RequestInterface({funcName:"Init",arguments:encodeURI(JSON.stringify(o))}).then((function(e){console.log(e.responseMsg),n.showTips(!0,"视频初始化成功！")}))}else n.showTips(!1,"请输入appkey和token")})),g(this,"play",(function(e){var t=i;if(e.deviceSerial&&e.channelNo){"undefined"!==typeof e.deviceSerial&&(i.deviceSerial=e.deviceSerial),"undefined"!==typeof e.channelNo&&(i.channelNo=e.channelNo),"undefined"!==typeof e.startTime&&e.startTime&&(i.startTime=e.startTime+" 00:00:00"),"undefined"!==typeof e.endTime&&e.endTime&&(i.endTime=e.endTime+" 23:59:59"),"undefined"!==typeof e.validateCode&&e.validateCode&&(i.validateCode=e.validateCode);var n={response:{code:0,message:null,data:{deviceSerial:e.deviceSerial,channelCode:e.channelNo,channelNo:+e.channelNo,codeIsEncrypt:0,validateCode:e.validateCode,deviceClass:t.deviceClass,deviceType:"10222",channelId:"2222222222",channelName:"channelNameTest",storeName:"storeName",storeId:"storeid",startTime:i.startTime,endTime:i.endTime}}};"1"===t.deviceClass?(n.response.data.channelCode=t.channelNo,n.response.data.platformId=t.platformId):n.response.data.channelNo=+t.channelNo,1===i.switchVideo&&(i.startTime&&(n.response.data.startTime=i.startTime),i.endTime&&(n.response.data.endTime=i.endTime)),console.log("预览/回放入参",n),Nt.JS_RequestInterface({funcName:0===i.switchVideo?"StartPreview":"StartPlayback",arguments:encodeURI(JSON.stringify(n))}).then((function(e){console.log(e.responseMsg),t.showTips(!0,"预览/回放成功！")}))["catch"]((function(e){console.log("开始播放：",e)}))}})),g(this,"showCBInfo",(function(e){i.callbackMessage=i.callbackMessage+JSON.stringify(e)+"\n\n",console.log(i.callbackMessage)})),g(this,"showTips",(function(e,t){})),g(this,"hideVideo",(function(){Nt.JS_HideWnd()})),g(this,"showVideo",(function(){Nt.JS_ShowWnd()})),g(this,"GetLayout",(function(){var e=null;Nt.JS_RequestInterface({funcName:"GetLayout",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:e}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"capturePicture",(function(e){var t=null;Nt.JS_RequestInterface({funcName:"CaptureJPGEx",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:t}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"stop",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;Nt.JS_RequestInterface({funcName:"StopPlay",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:parseInt(e)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"setLayout",(function(e){var t=parseInt(e);isNaN(t)||0==t||t>=13?console.log("不支持实际布局大于16的窗口数"):(i.layout=t,Nt.JS_RequestInterface({funcName:"SetLayout",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{layout:t}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)})))})),g(this,"setSoundVolumn",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1?arguments[1]:void 0;Nt.JS_RequestInterface({funcName:"SoundVolumn",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:parseInt(e),volumn:parseInt(t)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"testMute",(function(){var e=parseInt(prompt("请输入窗口ID"));Nt.JS_RequestInterface({funcName:"MuteOnOff",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:e}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"testSelectWnd",(function(){var e=parseInt(prompt("请输入窗口ID"));Nt.JS_RequestInterface({funcName:"SelectPlayWnd",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:e}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"setVideoLevel",(function(e,t){Nt.JS_RequestInterface({funcName:"SetVideoLevel",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:1==i.switchVideo?0:parseInt(e),level:parseInt(t,10)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"startTalk",(function(e){Nt.JS_RequestInterface({funcName:"StartTalk",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:parseInt(e)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"stopTalk",(function(e){Nt.JS_RequestInterface({funcName:"StopTalk",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:parseInt(e)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"startSave",(function(e){Nt.JS_RequestInterface({funcName:"StartRecord",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:parseInt(e)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),g(this,"stopSave",(function(e){Nt.JS_RequestInterface({funcName:"StopRecord",arguments:encodeURI(JSON.stringify({response:{code:0,message:null,data:{wndId:parseInt(e)}}}))}).then((function(e){console.log(JSON.stringify(e.responseMsg)),console.log(e.responseMsg)}))})),this.appKey="b9a3ad6e8026410095d8252169fa430a",this.accessToken="at.2vtum8873rrcwbrv431qb6pn94dkbv23-8dw2twn355-1u3x014-wrthellzk",this.deviceSerial="C33368372",this.channelNo="1",this.validateCode="",this.deviceClass="0",this.platformId="",this.startTime="",this.endTime="",this.layout=2,this.switchVideo=0,this.tips="调用成功",this.successTip=!1,this.tipsShow=!1,Nt=Ft("playWnd",Ut,Zt,Vt)}return f(e,[{key:"alarmMsg",value:function(){var e={request:{body:{alarmTypes:[10800,0,0,0,0],channelId:"066dde0465dd4abaab6afe355baf9d0b",endTime:"1621007999000",startTime:"1620921600000"},callBack:"GetAlarmMsgOrders",majorKey:"",method:"POST",storeId:"",url:"/videoplugin/message/getMessageByTypes"},response:{code:0,message:null,data:[{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620921217e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620920678e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620920586e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620919513e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620919483e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620919333e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620918913e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620918616e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620918305e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620917858e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620917658e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620917244e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620917064e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620916994e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620916668e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620916571e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620916529e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620916343e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620916081e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620915825e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620915676e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620915531e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620915394e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620915197e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620914971e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620914644e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620914533e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620914457e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620914376e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620914284e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620913973e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620913431e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620912834e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620912771e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620912354e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620912275e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620912093e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620912024e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162091189e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620911839e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620911807e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162091176e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620911682e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162091127e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620911184e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910982e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910931e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910851e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910781e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910727e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910677e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910647e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910588e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910544e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910484e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162091041e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162091035e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910278e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910217e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620910124e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909976e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909939e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909847e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909817e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909736e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909664e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909605e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909575e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909346e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909247e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909216e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909149e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090912e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620909028e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908999e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908969e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908909e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090888e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908835e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090875e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090872e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908652e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908612e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908582e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908552e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908456e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908426e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908299e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620908268e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090805e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620907918e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620907758e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620907625e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620907386e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620907292e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620907127e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906864e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906828e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906797e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906747e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906717e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906632e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906501e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906412e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906368e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906329e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906142e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906112e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620906013e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905946e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905823e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905697e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905622e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905571e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905541e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905511e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905481e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905442e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905412e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905382e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905352e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905322e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905262e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620905196e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090515e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904994e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904931e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904813e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090473e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:16209047e5},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904618e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904286e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904173e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904143e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904112e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904053e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620904023e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903854e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903789e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903723e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903643e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903612e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903573e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903505e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903383e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903329e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903299e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903268e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:16209032e5},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620903149e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090312e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902977e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090286e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090277e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902639e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902609e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902517e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902373e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090232e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902253e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902198e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620902132e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090194e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090185e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901789e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901746e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901685e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901638e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090152e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901489e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901424e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901271e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901233e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620901157e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900915e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900834e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900774e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900744e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090065e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162090044e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900409e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900175e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900134e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900069e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620900016e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899976e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899908e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899879e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899826e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899756e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899599e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899559e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899467e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899406e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899265e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620899211e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089914e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089911e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089905e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898991e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898926e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898834e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898785e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898746e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898697e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898666e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898507e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898293e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898248e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898218e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898157e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620898088e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089802e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089796e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089785e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897807e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897771e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897719e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089769e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089763e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:16208976e5},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089757e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089754e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897475e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897412e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897369e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897339e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897279e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897237e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897207e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897172e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897142e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897112e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620897024e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896985e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896874e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896843e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896814e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896783e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896736e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896621e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896478e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896447e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896358e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896307e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896277e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896247e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620896214e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089604e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895953e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895921e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895868e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089577e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895704e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089559e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895559e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089548e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895442e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895377e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895347e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895293e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895171e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895136e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620895017e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894926e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894896e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894864e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894834e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894738e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894599e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894539e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894426e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894359e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894297e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894213e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894183e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620894051e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893964e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893934e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893843e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893754e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893676e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893606e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089353e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893452e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893423e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893357e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893288e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893143e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893051e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620893006e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892904e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892824e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892764e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892541e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892479e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892412e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892311e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892281e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892209e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620892063e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891991e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891931e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089187e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089181e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891708e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891655e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891585e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891531e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891501e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891401e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891297e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891257e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891216e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891178e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891128e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620891033e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890973e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162089094e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890879e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890794e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890714e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890616e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890586e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890469e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890414e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890346e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890288e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890179e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890108e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890041e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620890011e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889937e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889719e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889635e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889481e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889451e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889317e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889227e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889139e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620889034e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888973e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888902e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888837e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888767e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888737e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888706e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888633e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888571e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888413e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888353e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888323e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888249e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888162e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620888e6},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887859e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887776e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887734e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887692e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887619e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887501e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887355e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162088732e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887289e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887126e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887066e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620887034e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162088697e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886884e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886804e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886728e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886609e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886538e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886478e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886396e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886334e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886246e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886111e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620886011e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885956e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885894e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885696e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885514e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885484e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885414e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885383e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885341e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885306e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885276e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885216e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885186e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885114e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885037e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620885006e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620884975e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620884945e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620884911e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620884851e3},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:162088478e4},{alarmType:10800,alarmName:"移动侦测报警",alarmTime:1620884696e3}],success:!0}};console.log(e),Nt.JS_RequestInterface({funcName:"TransFunctionResult",arguments:encodeURI(JSON.stringify(e))})}}]),e}();Wt.sessions={},Wt.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||Wt.extension.isInstalled()}return!0};var Gt={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var i=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var n=new Error("NavigatorUserMediaError");n.name="You cancelled the request for permission, giving up...",i(n)}else i(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function Wt(e,t){if(void 0===Wt.initDone)return e.error("Library not initialized"),{};if(!Wt.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(Wt.log("Library initialized: "+Wt.initDone),e=e||{},e.success="function"==typeof e.success?e.success:Wt.noop,e.error="function"==typeof e.error?e.error:Wt.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:Wt.noop,null===e.server||void 0===e.server)return e.error("Invalid server url"),{};var i=!1,n=null,o={},a=null,r=null,s=0,d=e.server;Wt.isArray(d)?(Wt.log("Multiple servers provided ("+d.length+"), will use the first that works"),d=null,r=e.server,Wt.debug(r)):0===d.indexOf("ws")?(i=!0,Wt.log("Using WebSockets to contact Janus: "+d)):(i=!1,Wt.log("Using REST API to contact Janus: "+d));var l=e.iceServers;void 0!==l&&null!==l||(l=[{urls:"stun:stun.l.google.com:19302"}]);var u=e.iceTransportPolicy,m=e.bundlePolicy,p=e.ipv6;void 0!==p&&null!==p||(p=!1);var h=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(h=!0===e.withCredentials);var f=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(f=e.max_poll_events),f<1&&(f=1);var g=null;void 0!==e.token&&null!==e.token&&(g=e.token);var v=null;void 0!==e.apisecret&&null!==e.apisecret&&(v=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var y=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(y=e.keepAlivePeriod),isNaN(y)&&(y=25e3);var S=6e4;function _(e){var t={high:9e5,medium:3e5,low:1e5};return void 0!==e&&null!==e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(S=e.longPollTimeout),isNaN(S)&&(S=6e4);var b=!1,C=null,T={},w=this,k=0,E={};function P(){if(null!=C)if(Wt.debug("Long poll..."),b){var t=d+"/"+C+"?rid="+(new Date).getTime();void 0!==f&&null!==f&&(t=t+"&maxev="+f),null!==g&&void 0!==g&&(t=t+"&token="+encodeURIComponent(g)),null!==v&&void 0!==v&&(t=t+"&apisecret="+encodeURIComponent(v)),Wt.httpAPICall(t,{verb:"GET",withCredentials:h,success:I,timeout:S,error:function(t,i){if(Wt.error(t+":",i),k++,k>3)return b=!1,void e.error("Lost connection to the server (is it down?)");P()}})}else Wt.warn("Is the server down? (connected=false)")}function I(e,t){if(k=0,i||void 0===C||null===C||!0===t||P(),i||!Wt.isArray(e))if("keepalive"!==e["rtcgw"])if("ack"!==e["rtcgw"])if("success"!==e["rtcgw"])if("trickle"===e["rtcgw"]){var o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");var a=T[o];if(void 0===a||null===a)return void Wt.debug("This handle is not attached to this session");var r=e["candidate"];Wt.debug("Got a trickled candidate on session "+C),Wt.debug(r);var s=a.webrtcStuff;s.pc&&s.remoteSdp?(Wt.debug("Adding remote candidate:",r),r&&!0!==r.completed?s.pc.addIceCandidate(r):s.pc.addIceCandidate(Wt.endOfCandidates)):(Wt.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),s.candidates||(s.candidates=[]),s.candidates.push(r),Wt.debug(s.candidates))}else{if("webrtcup"===e["rtcgw"]){Wt.debug("Got a webrtcup event on session "+C),Wt.debug(e);o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");a=T[o];return void 0===a||null===a?void Wt.debug("This handle is not attached to this session"):void a.webrtcState(!0)}if("hangup"===e["rtcgw"]){Wt.debug("Got a hangup event on session "+C),Wt.debug(e);o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");a=T[o];if(void 0===a||null===a)return void Wt.debug("This handle is not attached to this session");a.webrtcState(!1,e["reason"]),a.hangup()}else if("detached"===e["rtcgw"]){Wt.debug("Got a detached event on session "+C),Wt.debug(e);o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");a=T[o];if(void 0===a||null===a)return;a.detached=!0,a.ondetached(),a.detach()}else if("media"===e["rtcgw"]){Wt.debug("Got a media event on session "+C),Wt.debug(e);o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");a=T[o];if(void 0===a||null===a)return void Wt.debug("This handle is not attached to this session");a.mediaState(e["type"],e["receiving"])}else if("slowlink"===e["rtcgw"]){Wt.debug("Got a slowlink event on session "+C),Wt.debug(e),console.log("json的所有信息打印-----------------------------------------------",e);o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");a=T[o];if(void 0===a||null===a)return void Wt.debug("This handle is not attached to this session");a.slowLink(e["uplink"],e["lost"])}else{if("error"===e["rtcgw"]){Wt.error("Ooops: "+e["error"].code+" "+e["error"].reason),Wt.debug(e);m=e["transaction"];if(null!==m&&void 0!==m){p=E[m];null!==p&&void 0!==p&&p(e),delete E[m]}return}if("event"===e["rtcgw"]){Wt.debug("Got a plugin event on session "+C),Wt.debug(e);o=e["sender"];if(void 0===o||null===o)return void Wt.warn("Missing sender...");var d=e["plugindata"];if(void 0===d||null===d)return void Wt.warn("Missing plugindata...");Wt.debug("  -- Event is coming from "+o+" ("+d["plugin"]+")");var l=d["data"];Wt.debug(l);a=T[o];if(void 0===a||null===a)return void Wt.warn("This handle is not attached to this session");var c=e["jsep"];void 0!==c&&null!==c&&(Wt.debug("Handling SDP as well..."),Wt.debug(c));var u=a.onmessage;null!==u&&void 0!==u?(Wt.debug("Notifying application..."),u(l,c)):Wt.debug("No provided notification callback")}else{if("timeout"===e["rtcgw"])return Wt.error("Timeout on session "+C),Wt.debug(e),void(i&&n.close(3504,"Gateway timeout"));Wt.warn("Unknown message/event  '"+e["rtcgw"]+"' on session "+C),Wt.debug(e)}}}else{Wt.debug("Got a success on session "+C),Wt.debug(e);var m=e["transaction"];if(null!==m&&void 0!==m){var p=E[m];null!==p&&void 0!==p&&p(e),delete E[m]}}else{Wt.debug("Got an ack on session "+C),Wt.debug(e);var m=e["transaction"];if(null!==m&&void 0!==m){var p=E[m];null!==p&&void 0!==p&&p(e),delete E[m]}}else Wt.vdebug("Got a keepalive on session "+C);else for(var h=0;h<e.length;h++)I(e[h],!0)}function x(){if(null!==d&&i&&b){a=setTimeout(x,y);var e={rtcgw:"keepalive",session_id:C,transaction:Wt.randomString(12)};null!==g&&void 0!==g&&(e["token"]=g),null!==v&&void 0!==v&&(e["apisecret"]=v),n.send(JSON.stringify(e))}}function R(e){var l=Wt.randomString(12),c={rtcgw:"create",transaction:l,token:"testtoken"};if(c=Object.assign({},c,t),e["reconnect"]&&(b=!1,c["rtcgw"]="claim",c["session_id"]=C,n&&(n.onopen=null,n.onerror=null,n.onclose=null,a&&(clearTimeout(a),a=null))),null!==g&&void 0!==g&&(c["token"]=g),null!==v&&void 0!==v&&(c["apisecret"]=v),null===d&&Wt.isArray(r)&&(d=r[s],0===d.indexOf("ws")?(i=!0,Wt.log("Server #"+(s+1)+": trying WebSockets to contact Janus ("+d+")")):(i=!1,Wt.log("Server #"+(s+1)+": trying REST API to contact Janus ("+d+")"))),i)for(var u in n=Wt.newWebSocket(d,"rtcgw-protocol"),o={error:function(){if(Wt.error("Error connecting to the Janus WebSockets server... "+d),Wt.isArray(r)&&!e["reconnect"])return s++,s==r.length?void e.error("Error connecting to any of the provided Janus servers: Is the server down?"):(d=null,void setTimeout((function(){R(e)}),200));e.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){E[l]=function(t){if(Wt.debug(t),"success"!==t["rtcgw"])return Wt.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error(t["error"].reason);a=setTimeout(x,y),b=!0,C=t["session_id"]?t["session_id"]:t.data["id"],e["reconnect"]?Wt.log("Claimed session: "+C):Wt.log("Created session: "+C),Wt.sessions[C]=w,e.success(C)},n.send(JSON.stringify(c))},message:function(e){I(JSON.parse(e.data))}},o)n.addEventListener(u,o[u]);else Wt.httpAPICall(d,{verb:"POST",withCredentials:h,body:c,success:function(t){if(Wt.debug(t),"success"!==t["rtcgw"])return Wt.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error(t["error"].reason);b=!0,C=t["session_id"]?t["session_id"]:t.data["id"],e["reconnect"]?Wt.log("Claimed session: "+C):Wt.log("Created session: "+C),Wt.sessions[C]=w,P(),e.success()},error:function(t,i){if(Wt.error(t+":",i),Wt.isArray(r)&&!e["reconnect"])return s++,s==r.length?void e.error("Error connecting to any of the provided Janus servers: Is the server down?"):(d=null,void setTimeout((function(){R(e)}),200));""===i?e.error(t+": Is the server down?"):e.error(t+": "+i)}})}function A(t){t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop;var r=!0;void 0!==t.asyncRequest&&null!==t.asyncRequest&&(r=!0===t.asyncRequest);var s=!0;void 0!==t.notifyDestroyed&&null!==t.notifyDestroyed&&(s=!0===t.notifyDestroyed);var l=!1;if(void 0!==t.cleanupHandles&&null!==t.cleanupHandles&&(l=!0===t.cleanupHandles),Wt.log("Destroying session "+C+" (async="+r+")"),!b)return Wt.warn("Is the server down? (connected=false)"),void t.success();if(void 0===C||null===C)return Wt.warn("No session to destroy"),t.success(),void(s&&e.destroyed());if(l)for(var c in T)F(c,{noRequest:!0});var u={rtcgw:"destroy",transaction:Wt.randomString(12)};if(null!==g&&void 0!==g&&(u["token"]=g),null!==v&&void 0!==v&&(u["apisecret"]=v),i){u["session_id"]=C;var m=function(){for(var e in o)n.removeEventListener(e,o[e]);n.removeEventListener("message",p),n.removeEventListener("error",f),a&&clearTimeout(a),n.close()},p=function(i){var n=JSON.parse(i.data);n.session_id==u.session_id&&n.transaction==u.transaction&&(m(),t.success(),s&&e.destroyed())},f=function(i){m(),t.error("Failed to destroy the server: Is the server down?"),s&&e.destroyed()};return n.addEventListener("message",p),n.addEventListener("error",f),void n.send(JSON.stringify(u))}Wt.httpAPICall(d+"/"+C,{verb:"POST",async:r,withCredentials:h,body:u,success:function(i){Wt.log("Destroyed session:"),Wt.debug(i),C=null,b=!1,"success"!==i["rtcgw"]&&Wt.error("Ooops: "+i["error"].code+" "+i["error"].reason),t.success(),s&&e.destroyed()},error:function(i,n){Wt.error(i+":",n),C=null,b=!1,t.success(),s&&e.destroyed(),pluginHandlesp}})}function D(e){if(e=e||{},e.success="function"==typeof e.success?e.success:Wt.noop,e.error="function"==typeof e.error?e.error:Wt.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:Wt.noop,e.iceState="function"==typeof e.iceState?e.iceState:Wt.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:Wt.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:Wt.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:Wt.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:Wt.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:Wt.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:Wt.noop,e.ondata="function"==typeof e.ondata?e.ondata:Wt.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:Wt.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:Wt.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:Wt.noop,!b)return Wt.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var t=e.plugin;if(void 0===t||null===t)return Wt.error("Invalid plugin"),void e.error("Invalid plugin");var o=e.opaqueId,a=e.token?e.token:g,r=Wt.randomString(12),s={rtcgw:"attach",plugin:t,opaque_id:o,transaction:r};if(null!==a&&void 0!==a&&(s["token"]=a),null!==v&&void 0!==v&&(s["apisecret"]=v),i)return E[r]=function(i){if(Wt.debug(i),"success"!==i["rtcgw"])return Wt.error("Ooops: "+i["error"].code+" "+i["error"].reason),void e.error("Ooops: "+i["error"].code+" "+i["error"].reason);var n=i.data["id"];Wt.log("Created handle: "+n);var o={session:w,plugin:t,id:n,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return t},getVolume:function(){return G(n,!0)},getRemoteVolume:function(){return G(n,!0)},getLocalVolume:function(){return G(n,!1)},isAudioMuted:function(){return W(n,!1)},muteAudio:function(){return q(n,!1,!0)},unmuteAudio:function(){return q(n,!1,!1)},isVideoMuted:function(){return W(n,!0)},muteVideo:function(){return q(n,!0,!0)},unmuteVideo:function(){return q(n,!0,!1)},getBitrate:function(){return J(n)},getNetworkQuality:function(e){K(n,e)},send:function(e){B(n,e)},data:function(e){M(n,e)},dtmf:function(e){N(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){O(n,!0,e)},createAnswer:function(e){O(n,!1,e)},handleRemoteJsep:function(e){U(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){X(n,!0===e)},detach:function(e){F(n,e)}};T[n]=o,e.success(o)},s["session_id"]=C,void n.send(JSON.stringify(s));Wt.httpAPICall(d+"/"+C,{verb:"POST",withCredentials:h,body:s,success:function(i){if(Wt.debug(i),"success"!==i["rtcgw"])return Wt.error("Ooops: "+i["error"].code+" "+i["error"].reason),void e.error("Ooops: "+i["error"].code+" "+i["error"].reason);var n=i.data["id"];Wt.log("Created handle: "+n);var o={session:w,plugin:t,id:n,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return t},getVolume:function(){return G(n,!0)},getRemoteVolume:function(){return G(n,!0)},getLocalVolume:function(){return G(n,!1)},isAudioMuted:function(){return W(n,!1)},muteAudio:function(){return q(n,!1,!0)},unmuteAudio:function(){return q(n,!1,!1)},isVideoMuted:function(){return W(n,!0)},muteVideo:function(){return q(n,!0,!0)},unmuteVideo:function(){return q(n,!0,!1)},getBitrate:function(){return J(n)},getNetworkQuality:function(e){K(n,e)},send:function(e){B(n,e)},data:function(e){M(n,e)},dtmf:function(e){N(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){O(n,!0,e)},createAnswer:function(e){O(n,!1,e)},handleRemoteJsep:function(e){U(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){X(n,!0===e)},detach:function(e){F(n,e)}};T[n]=o,e.success(o)},error:function(e,t){Wt.error(e+":",t)}})}function B(e,t){if(t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop,t.error="function"==typeof t.error?t.error:Wt.noop,!b)return Wt.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var o=T[e];if(null===o||void 0===o||null===o.webrtcStuff||void 0===o.webrtcStuff)return Wt.warn("Invalid handle"),void t.error("Invalid handle");var a=t.message,r=t.jsep,s=Wt.randomString(12),l={rtcgw:"message",body:a,transaction:s};if(null!==o.token&&void 0!==o.token&&(l["token"]=o.token),null!==v&&void 0!==v&&(l["apisecret"]=v),null!==r&&void 0!==r&&(l.jsep=r),Wt.debug("Sending message to plugin (handle="+e+"):"),Wt.debug(l),i)return l["session_id"]=C,l["handle_id"]=e,E[s]=function(e){if(Wt.debug("Message sent!"),Wt.debug(e),"success"===e["rtcgw"]){var i=e["plugindata"];if(void 0===i||null===i)return Wt.warn("Request succeeded, but missing plugindata..."),void t.success();Wt.log("Synchronous transaction successful ("+i["plugin"]+")");var n=i["data"];return Wt.debug(n),void t.success(n)}"ack"===e["rtcgw"]?t.success():void 0!==e["error"]&&null!==e["error"]?(Wt.error("Ooops: "+e["error"].code+" "+e["error"].reason),t.error(e["error"].code+" "+e["error"].reason)):(Wt.error("Unknown error"),t.error("Unknown error"))},void n.send(JSON.stringify(l));Wt.httpAPICall(d+"/"+C+"/"+e,{verb:"POST",withCredentials:h,body:l,success:function(e){if(Wt.debug("Message sent!"),Wt.debug(e),"success"===e["rtcgw"]){var i=e["plugindata"];if(void 0===i||null===i)return Wt.warn("Request succeeded, but missing plugindata..."),void t.success();Wt.log("Synchronous transaction successful ("+i["plugin"]+")");var n=i["data"];return Wt.debug(n),void t.success(n)}"ack"===e["rtcgw"]?t.success():void 0!==e["error"]&&null!==e["error"]?(Wt.error("Ooops: "+e["error"].code+" "+e["error"].reason),t.error(e["error"].code+" "+e["error"].reason)):(Wt.error("Unknown error"),t.error("Unknown error"))},error:function(e,i){Wt.error(e+":",i),t.error(e+": "+i)}})}function j(e,t){if(b){var o=T[e];if(null!==o&&void 0!==o&&null!==o.webrtcStuff&&void 0!==o.webrtcStuff){var a={rtcgw:"trickle",candidate:t,transaction:Wt.randomString(12)};if(null!==o.token&&void 0!==o.token&&(a["token"]=o.token),null!==v&&void 0!==v&&(a["apisecret"]=v),Wt.vdebug("Sending trickle candidate (handle="+e+"):"),Wt.vdebug(a),i)return a["session_id"]=C,a["handle_id"]=e,void n.send(JSON.stringify(a));Wt.httpAPICall(d+"/"+C+"/"+e,{verb:"POST",withCredentials:h,body:a,success:function(e){Wt.vdebug("Candidate sent!"),Wt.vdebug(e),"ack"===e["rtcgw"]||Wt.error("Ooops: "+e["error"].code+" "+e["error"].reason)},error:function(e,t){Wt.error(e+":",t)}})}else Wt.warn("Invalid handle")}else Wt.warn("Is the server down? (connected=false)")}function L(e,t,i,n){var o=T[e];if(null!==o&&void 0!==o&&null!==o.webrtcStuff&&void 0!==o.webrtcStuff){var a=o.webrtcStuff,r=function(e){Wt.log("Received message on data channel:",e);var t=e.target.label;o.ondata(e.data,t)},s=function(e){Wt.log("Received state change on data channel:",e);var t=e.target.label,i=a.dataChannel[t]?a.dataChannel[t].readyState:"null";if(Wt.log("State change on <"+t+"> data channel: "+i),"open"===i){if(a.dataChannel[t].pending&&a.dataChannel[t].pending.length>0){for(var n in Wt.log("Sending pending messages on <"+t+">:",a.dataChannel[t].pending.length),a.dataChannel[t].pending){var r=a.dataChannel[t].pending[n];Wt.log("Sending string on data channel <"+t+">: "+r),a.dataChannel[t].send(r)}a.dataChannel[t].pending=[]}o.ondataopen(t)}},d=function(e){Wt.error("Got error on data channel:",e)};a.dataChannel[t]=i||a.pc.createDataChannel(t,{ordered:!1}),a.dataChannel[t].onmessage=r,a.dataChannel[t].onopen=s,a.dataChannel[t].onclose=s,a.dataChannel[t].onerror=d,a.dataChannel[t].pending=[],n&&a.dataChannel[t].pending.push(n)}else Wt.warn("Invalid handle")}function M(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop,t.error="function"==typeof t.error?t.error:Wt.noop;var i=T[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return Wt.warn("Invalid handle"),void t.error("Invalid handle");var n=i.webrtcStuff,o=t.text;if(null===o||void 0===o)return Wt.warn("Invalid text"),void t.error("Invalid text");var a=t.label?t.label:Wt.dataChanDefaultLabel;return n.dataChannel[a]?"open"!==n.dataChannel[a].readyState?(n.dataChannel[a].pending.push(o),void t.success()):(Wt.log("Sending string on data channel <"+a+">: "+o),n.dataChannel[a].send(o),void t.success()):(L(e,a,!1,o),void t.success())}function N(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop,t.error="function"==typeof t.error?t.error:Wt.noop;var i=T[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return Wt.warn("Invalid handle"),void t.error("Invalid handle");var n=i.webrtcStuff;if(null===n.dtmfSender||void 0===n.dtmfSender){if(void 0!==n.pc&&null!==n.pc){var o=n.pc.getSenders(),a=o.find((function(e){return e.track&&"audio"===e.track.kind}));if(!a)return Wt.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");n.dtmfSender=a.dtmf,n.dtmfSender&&(Wt.log("Created DTMF Sender"),n.dtmfSender.ontonechange=function(e){Wt.debug("Sent DTMF tone: "+e.tone)})}if(null===n.dtmfSender||void 0===n.dtmfSender)return Wt.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var r=t.dtmf;if(null===r||void 0===r)return Wt.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var s=r.tones;if(null===s||void 0===s)return Wt.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var d=r.duration;null!==d&&void 0!==d||(d=500);var l=r.gap;null!==l&&void 0!==l||(l=50),Wt.debug("Sending DTMF string "+s+" (duration "+d+"ms, gap "+l+"ms)"),n.dtmfSender.insertDTMF(s,d,l),t.success()}function F(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop,t.error="function"==typeof t.error?t.error:Wt.noop;var o=!0;void 0!==t.asyncRequest&&null!==t.asyncRequest&&(o=!0===t.asyncRequest);var a=!0;void 0!==t.noRequest&&null!==t.noRequest&&(a=!0===t.noRequest),Wt.log("Destroying handle "+e+" (async="+o+")"),X(e);var r=T[e];if(null===r||void 0===r||r.detached)return delete T[e],void t.success();if(a)return delete T[e],void t.success();if(!b)return Wt.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var s={rtcgw:"detach",transaction:Wt.randomString(12)};if(null!==r.token&&void 0!==r.token&&(s["token"]=r.token),null!==v&&void 0!==v&&(s["apisecret"]=v),i)return s["session_id"]=C,s["handle_id"]=e,n.send(JSON.stringify(s)),delete T[e],void t.success();Wt.httpAPICall(d+"/"+C+"/"+e,{verb:"POST",async:o,withCredentials:h,body:s,success:function(i){Wt.log("Destroyed handle:"),Wt.debug(i),"success"!==i["rtcgw"]&&Wt.error("Ooops: "+i["error"].code+" "+i["error"].reason),delete T[e],t.success()},error:function(i,n){Wt.error(i+":",n),delete T[e],t.success()}})}function z(e,t,i,n,o){var a=T[e];if(null===a||void 0===a||null===a.webrtcStuff||void 0===a.webrtcStuff)return Wt.warn("Invalid handle"),void n.error("Invalid handle");var r=a.webrtcStuff;Wt.debug("streamsDone:",o),o&&(Wt.debug("  -- Audio tracks:",o.getAudioTracks()),Wt.debug("  -- Video tracks:",o.getVideoTracks()));var s=!1;if(r.myStream&&i.update&&!r.streamExternal){if((!i.update&&Q(i)||i.update&&(i.addAudio||i.replaceAudio))&&o.getAudioTracks()&&o.getAudioTracks().length)if(r.myStream.addTrack(o.getAudioTracks()[0]),Wt.unifiedPlan){Wt.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",o.getAudioTracks()[0]);var d=null,h=r.pc.getTransceivers();if(h&&h.length>0)for(var f in h){var g=h[f];if(g.sender&&g.sender.track&&"audio"===g.sender.track.kind||g.receiver&&g.receiver.track&&"audio"===g.receiver.track.kind){d=g;break}}d&&d.sender?d.sender.replaceTrack(o.getAudioTracks()[0]):r.pc.addTrack(o.getAudioTracks()[0],o)}else Wt.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",o.getAudioTracks()[0]),r.pc.addTrack(o.getAudioTracks()[0],o);if((!i.update&&ie(i)||i.update&&(i.addVideo||i.replaceVideo))&&o.getVideoTracks()&&o.getVideoTracks().length)if(r.myStream.addTrack(o.getVideoTracks()[0]),Wt.unifiedPlan){Wt.log((i.replaceVideo?"Replacing":"Adding")+" video track:",o.getVideoTracks()[0]);var v=null;h=r.pc.getTransceivers();if(h&&h.length>0)for(var f in h){g=h[f];if(g.sender&&g.sender.track&&"video"===g.sender.track.kind||g.receiver&&g.receiver.track&&"video"===g.receiver.track.kind){v=g;break}}v&&v.sender?v.sender.replaceTrack(o.getVideoTracks()[0]):r.pc.addTrack(o.getVideoTracks()[0],o)}else Wt.log((i.replaceVideo?"Replacing":"Adding")+" video track:",o.getVideoTracks()[0]),r.pc.addTrack(o.getVideoTracks()[0],o)}else r.myStream=o,s=!0;if(!r.pc){var y={iceServers:l,iceTransportPolicy:u,bundlePolicy:m};"chrome"===Wt.webRTCAdapter.browserDetails.browser&&(y["sdpSemantics"]=Wt.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var S={optional:[{DtlsSrtpKeyAgreement:!0}]};if(!0===p&&S.optional.push({googIPv6:!0}),n.rtcConstraints&&"object"===c(n.rtcConstraints))for(var f in Wt.debug("Adding custom PeerConnection constraints:",n.rtcConstraints),n.rtcConstraints)S.optional.push(n.rtcConstraints[f]);"edge"===Wt.webRTCAdapter.browserDetails.browser&&(y.bundlePolicy="max-bundle"),Wt.log("Creating PeerConnection"),Wt.debug(S),r.pc=new RTCPeerConnection(y,S),Wt.debug(r.pc),r.pc.getStats&&(r.volume={},r.bitrate.value="0 kbits/sec"),Wt.log("Preparing local SDP and gathering candidates (trickle="+r.trickle+")"),r.pc.oniceconnectionstatechange=function(e){r.pc&&a.iceState(r.pc.iceConnectionState)},r.pc.onicecandidate=function(t){if(null==t.candidate||"edge"===Wt.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)Wt.log("End of candidates."),r.iceDone=!0,!0===r.trickle?j(e,{completed:!0}):H(e,n);else{var i={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===r.trickle&&j(e,i)}},r.pc.ontrack=function(e){Wt.log("Handling Remote Track"),Wt.debug(e),e.streams&&(r.remoteStream=e.streams[0],a.onremotestream(r.remoteStream),e.track.onended||(Wt.log("Adding onended callback to track:",e.track),e.track.onended=function(e){Wt.log("Remote track muted/removed:",e),r.remoteStream&&(r.remoteStream.removeTrack(e.target),a.onremotestream(r.remoteStream))},e.track.onmute=e.track.onended,e.track.onunmute=function(e){Wt.log("Remote track flowing again:",e);try{r.remoteStream.addTrack(e.target),a.onremotestream(r.remoteStream)}catch(t){Wt.error(t)}}))}}if(s&&null!==o&&void 0!==o)if(Wt.log("Adding local stream"),console.log("callbacks",n),"screen"==n.media.video){var b=!0===n.simulcast2;o.getTracks().forEach((function(e){if(Wt.log("Adding local track:",e),e.applyConstraints({frameRate:5}),b)if("audio"===e.kind)r.pc.addTrack(e,o);else{Wt.log("Enabling rid-based simulcasting:",e);var t=_(n.simulcastMaxBitrates);r.pc.addTransceiver(e,{direction:"sendrecv",streams:[o],sendEncodings:[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]})}else r.pc.addTrack(e,o)}))}else{b=!0===n.simulcast2;var C=o.getTracks(),w=C[0];if(w){var k=w.getSettings();console.log("videoTrack",w),console.log("videosettings",k)}var E=o.getAudioTracks(),P=E[0];if(P){var I=P.getSettings();console.log("audiosettings",I)}C.forEach((function(e){if(e.applyConstraints({frameRate:{max:n.frameRate}}),Wt.log("Adding local track:",e),b){r.pc.addTrack(e,o);var t=null,i=r.pc.getSenders();for(var a in i){var s=i[a];s&&s.track&&"video"===s.track.kind&&(t=s)}var d=null;t&&(d=t.getParameters()),d&&d.encodings&&(d.encodings[0].maxBitrate=1e5,t.setParameters(d).then((function(e){console.log("Successed to set parameters!",d)}))["catch"]((function(e){console.log("err",e),console.error(e)})))}else if("audio"===e.kind)r.pc.addTrack(e,o);else{Wt.log("Enabling rid-based simulcasting:",e);var l=n.bitrate||1e5;r.pc.addTransceiver(e,{direction:"sendrecv",streams:[o],sendEncodings:[{rid:"h",active:!0,maxBitrate:l}]})}}))}re(i)&&!r.dataChannel[Wt.dataChanDefaultLabel]&&(Wt.log("Creating data channel"),L(e,Wt.dataChanDefaultLabel,!1),r.pc.ondatachannel=function(t){Wt.log("Data channel created by Janus:",t),L(e,t.channel.label,t.channel)}),r.myStream&&a.onlocalstream(r.myStream),null===t||void 0===t?Z(e,i,n):r.pc.setRemoteDescription(t).then((function(){if(Wt.log("Remote description accepted!"),r.remoteSdp=t.sdp,r.candidates&&r.candidates.length>0){for(var o=0;o<r.candidates.length;o++){var a=r.candidates[o];Wt.debug("Adding remote candidate:",a),a&&!0!==a.completed?r.pc.addIceCandidate(a):r.pc.addIceCandidate(Wt.endOfCandidates)}r.candidates=[]}V(e,i,n)}),n.error)}function O(e,t,i){i=i||{},i.success="function"==typeof i.success?i.success:Wt.noop,i.error="function"==typeof i.error?i.error:$;var n=i.jsep;if(t&&n)return Wt.error("Provided a JSEP to a createOffer"),void i.error("Provided a JSEP to a createOffer");if(!t&&(!n||!n.type||!n.sdp))return Wt.error("A valid JSEP is required for createAnswer"),void i.error("A valid JSEP is required for createAnswer");i.media=i.media||{audio:!0,video:!0};var o=i.media,a=T[e];if(null===a||void 0===a||null===a.webrtcStuff||void 0===a.webrtcStuff)return Wt.warn("Invalid handle"),void i.error("Invalid handle");var r=a.webrtcStuff;if(r.trickle=se(i.trickle),void 0===r.pc||null===r.pc)o.update=!1,o.keepAudio=!1,o.keepVideo=!1;else if(void 0!==r.pc&&null!==r.pc){if(Wt.log("Updating existing media session"),o.update=!0,null!==i.stream&&void 0!==i.stream)i.stream!==r.myStream&&Wt.log("Renegotiation involves a new external stream");else{if(o.addAudio){if(o.keepAudio=!1,o.replaceAudio=!1,o.removeAudio=!1,o.audioSend=!0,r.myStream&&r.myStream.getAudioTracks()&&r.myStream.getAudioTracks().length)return Wt.error("Can't add audio stream, there already is one"),void i.error("Can't add audio stream, there already is one")}else o.removeAudio?(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!1,o.audioSend=!1):o.replaceAudio&&(o.keepAudio=!1,o.addAudio=!1,o.removeAudio=!1,o.audioSend=!0);if(null===r.myStream||void 0===r.myStream?(o.replaceAudio&&(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!0,o.audioSend=!0),Q(o)&&(o.keepAudio=!1,o.addAudio=!0)):null===r.myStream.getAudioTracks()||void 0===r.myStream.getAudioTracks()||0===r.myStream.getAudioTracks().length?(o.replaceAudio&&(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!0,o.audioSend=!0),Q(o)&&(o.keepVideo=!1,o.addAudio=!0)):!Q(o)||o.removeAudio||o.replaceAudio||(o.keepAudio=!0),o.addVideo){if(o.keepVideo=!1,o.replaceVideo=!1,o.removeVideo=!1,o.videoSend=!0,r.myStream&&r.myStream.getVideoTracks()&&r.myStream.getVideoTracks().length)return Wt.error("Can't add video stream, there already is one"),void i.error("Can't add video stream, there already is one")}else o.removeVideo?(o.keepVideo=!1,o.replaceVideo=!1,o.addVideo=!1,o.videoSend=!1):o.replaceVideo&&(o.keepVideo=!1,o.addVideo=!1,o.removeVideo=!1,o.videoSend=!0);null===r.myStream||void 0===r.myStream||null===r.myStream.getVideoTracks()||void 0===r.myStream.getVideoTracks()||0===r.myStream.getVideoTracks().length?(o.replaceVideo&&(o.keepVideo=!1,o.replaceVideo=!1,o.addVideo=!0,o.videoSend=!0),ie(o)&&(o.keepVideo=!1,o.addVideo=!0)):!ie(o)||o.removeVideo||o.replaceVideo||(o.keepVideo=!0),o.addData&&(o.data=!0)}if(Q(o)&&o.keepAudio&&ie(o)&&o.keepVideo)return a.consentDialog(!1),void z(e,n,o,i,r.myStream)}if(o.update&&!r.streamExternal){if(o.removeAudio||o.replaceAudio){if(r.myStream&&r.myStream.getAudioTracks()&&r.myStream.getAudioTracks().length){var s=r.myStream.getAudioTracks()[0];Wt.log("Removing audio track:",s),r.myStream.removeTrack(s);try{s.stop()}catch(x){}}if(r.pc.getSenders()&&r.pc.getSenders().length){var d=!0;if(o.replaceAudio&&Wt.unifiedPlan&&(d=!1),d)for(var l in r.pc.getSenders()){s=r.pc.getSenders()[l];s&&s.track&&"audio"===s.track.kind&&(Wt.log("Removing audio sender:",s),r.pc.removeTrack(s))}}}if(o.removeVideo||o.replaceVideo){if(r.myStream&&r.myStream.getVideoTracks()&&r.myStream.getVideoTracks().length){s=r.myStream.getVideoTracks()[0];Wt.log("Removing video track:",s),r.myStream.removeTrack(s);try{s.stop()}catch(x){}}if(r.pc.getSenders()&&r.pc.getSenders().length){var u=!0;if(o.replaceVideo&&Wt.unifiedPlan&&(u=!1),u)for(var l in r.pc.getSenders()){s=r.pc.getSenders()[l];s&&s.track&&"video"===s.track.kind&&(Wt.log("Removing video sender:",s),r.pc.removeTrack(s))}}}}if(null!==i.stream&&void 0!==i.stream){var m=i.stream;if(Wt.log("MediaStream provided by the application"),Wt.debug(m),o.update&&r.myStream&&r.myStream!==i.stream&&!r.streamExternal){try{var p=r.myStream.getTracks();for(var h in p){var f=p[h];Wt.log(f),null!==f&&void 0!==f&&f.stop()}}catch(x){}r.myStream=null}return r.streamExternal=!0,a.consentDialog(!1),void z(e,n,o,i,m)}if(Q(o)||ie(o)){if(!Wt.isGetUserMediaAvailable())return void i.error("getUserMedia not available");var g={mandatory:{},optional:[]};a.consentDialog(!0);var v=Q(o);!0===v&&void 0!=o&&null!=o&&"object"===c(o.audio)&&(v=o.audio);var y=ie(o);if(!0===y&&void 0!=o&&null!=o){var S=!0===i.simulcast,_=!0===i.simulcast2;if(!S&&!_||n||void 0!==o.video&&!1!==o.video||(o.video="hires"),o.video&&"screen"!=o.video&&"window"!=o.video)if("object"===c(o.video))y=o.video;else{var b=0,C=0;"lowres"===o.video?(C=240,b=320):"lowres-16:9"===o.video?(C=180,b=320):"hires"===o.video||"hires-16:9"===o.video||"hdres"===o.video?(C=720,b=1280):"fhdres"===o.video?(C=1080,b=1920):"4kres"===o.video?(C=2160,b=3840):"stdres"===o.video?(C=480,b=640):"stdres-16:9"===o.video?(C=360,b=640):(Wt.log("Default video setting is stdres 4:3"),C=480,b=640),Wt.log("Adding media constraint:",o.video),y={height:{ideal:C},width:{ideal:b}},Wt.log("Adding video constraint:",y)}else if("screen"===o.video||"window"===o.video){var w=function(t,r){a.consentDialog(!1),t?i.error(t):z(e,n,o,i,r)},k=function(e,t,i){Wt.log("Adding media constraint (screen capture)"),Wt.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){i?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(i){e.addTrack(i.getAudioTracks()[0]),t(null,e)})):t(null,e)}))["catch"]((function(e){a.consentDialog(!1),t(e)}))};if(o.screenshareFrameRate||(o.screenshareFrameRate=3),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return void navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(t){a.consentDialog(!1),Q(o)&&!o.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(a){t.addTrack(a.getAudioTracks()[0]),z(e,n,o,i,t)})):z(e,n,o,i,t)}),(function(e){a.consentDialog(!1),i.error(e)}));if("chrome"===Wt.webRTCAdapter.browserDetails.browser){var E=Wt.webRTCAdapter.browserDetails.version,P=33;window.navigator.userAgent.match("Linux")&&(P=35),E>=26&&E<=P?(g={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:o.screenshareFrameRate,maxFrameRate:o.screenshareFrameRate,chromeMediaSource:"screen"}},audio:Q(o)&&!o.keepAudio},k(g,w)):Wt.extension.getScreen((function(e,t){if(e)return a.consentDialog(!1),i.error(e);g={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:o.screenshareFrameRate,maxFrameRate:o.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},g.video.mandatory.chromeMediaSourceId=t,k(g,w,Q(o)&&!o.keepAudio)}))}else if("firefox"===Wt.webRTCAdapter.browserDetails.browser){if(!(Wt.webRTCAdapter.browserDetails.version>=33)){var I=new Error("NavigatorUserMediaError");return I.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",a.consentDialog(!1),void i.error(I)}g={video:{mozMediaSource:o.video,mediaSource:o.video},audio:Q(o)&&!o.keepAudio},k(g,(function(e,t){if(w(e,t),!e)var i=t.currentTime,n=window.setInterval((function(){t||window.clearInterval(n),t.currentTime==i&&(window.clearInterval(n),t.onended&&t.onended()),i=t.currentTime}),500)}))}return}}null!==o&&void 0!==o&&"screen"===o.video||navigator.mediaDevices.enumerateDevices().then((function(t){var r=t.some((function(e){return"audioinput"===e.kind})),s=ae(o)||t.some((function(e){return"videoinput"===e.kind})),d=Q(o),l=ie(o),c=ee(o),u=ne(o);if(d||l||c||u){var p=!!d&&r,h=!!l&&s;if(!p&&!h)return a.consentDialog(!1),i.error("No capture device found"),!1;if(!p&&c)return a.consentDialog(!1),i.error("Audio capture is required, but no capture device found"),!1;if(!h&&u)return a.consentDialog(!1),i.error("Video capture is required, but no capture device found"),!1}var f={audio:!(!r||o.keepAudio)&&v,video:!(!s||o.keepVideo)&&y};o.encodings&&(f=o.encodings),Wt.debug("getUserMedia constraints",f),f.audio||f.video?(console.log("gumConstraints_________",f,o.encodings),navigator.mediaDevices.getUserMedia(o.encodings?o.encodings:f).then((function(t){a.consentDialog(!1),z(e,n,o,i,t)}))["catch"]((function(e){a.consentDialog(!1),i.error({code:e.code,name:e.name,message:e.message})}))):(a.consentDialog(!1),z(e,n,o,i,m))}))["catch"]((function(e){a.consentDialog(!1),i.error("enumerateDevices error",e)}))}else z(e,n,o,i)}function U(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop,t.error="function"==typeof t.error?t.error:$;var i=t.jsep,n=T[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return Wt.warn("Invalid handle"),void t.error("Invalid handle");var o=n.webrtcStuff;if(void 0!==i&&null!==i){if(null===o.pc)return Wt.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");o.pc.setRemoteDescription(i).then((function(){if(Wt.log("Remote description accepted!"),o.remoteSdp=i.sdp,o.candidates&&o.candidates.length>0){for(var e=0;e<o.candidates.length;e++){var n=o.candidates[e];Wt.debug("Adding remote candidate:",n),n&&!0!==n.completed?o.pc.addIceCandidate(n):o.pc.addIceCandidate(Wt.endOfCandidates)}o.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function Z(e,t,i){i=i||{},i.success="function"==typeof i.success?i.success:Wt.noop,i.error="function"==typeof i.error?i.error:Wt.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:Wt.noop;var n=T[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return Wt.warn("Invalid handle"),void i.error("Invalid handle");var o=n.webrtcStuff,a=!0===i.simulcast;a?Wt.log("Creating offer (iceDone="+o.iceDone+", simulcast="+a+")"):Wt.log("Creating offer (iceDone="+o.iceDone+")");var r={};if(Wt.unifiedPlan){var s=null,d=null,l=o.pc.getTransceivers();if(l&&l.length>0)for(var c in l){var u=l[c];u.sender&&u.sender.track&&"audio"===u.sender.track.kind||u.receiver&&u.receiver.track&&"audio"===u.receiver.track.kind?s||(s=u):(u.sender&&u.sender.track&&"video"===u.sender.track.kind||u.receiver&&u.receiver.track&&"video"===u.receiver.track.kind)&&(d||(d=u))}var m=Q(t),p=te(t);m||p?m&&p?s&&(s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",Wt.log("Setting audio transceiver to sendrecv:",s)):m&&!p?s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",Wt.log("Setting audio transceiver to sendonly:",s)):!m&&p&&(s?(s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",Wt.log("Setting audio transceiver to recvonly:",s)):(s=o.pc.addTransceiver("audio",{direction:"recvonly"}),Wt.log("Adding recvonly audio transceiver:",s))):t.removeAudio&&s&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive",Wt.log("Setting audio transceiver to inactive:",s));var h=ie(t),f=oe(t);h||f?h&&f?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",Wt.log("Setting video transceiver to sendrecv:",d)):h&&!f?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",Wt.log("Setting video transceiver to sendonly:",d)):!h&&f&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",Wt.log("Setting video transceiver to recvonly:",d)):(d=o.pc.addTransceiver("video",{direction:"recvonly"}),Wt.log("Adding recvonly video transceiver:",d))):t.removeVideo&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",Wt.log("Setting video transceiver to inactive:",d))}else r["offerToReceiveAudio"]=te(t),r["offerToReceiveVideo"]=oe(t);var g=!0===i.iceRestart;g&&(r["iceRestart"]=!0),Wt.debug(r);var v=ie(t);if(v&&a&&"firefox"===Wt.webRTCAdapter.browserDetails.browser){Wt.log("Enabling Simulcasting for Firefox (RID)");var y=o.pc.getSenders().find((function(e){return"video"==e.track.kind}));if(y){var S=y.getParameters();S||(S={});var b=_(i.simulcastMaxBitrates);S.encodings=[{rid:"h",active:!0,maxBitrate:b.high},{rid:"m",active:!0,maxBitrate:b.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:b.low,scaleResolutionDownBy:4}],y.setParameters(S)}}o.pc.createOffer(r).then((function(e){Wt.debug(e);var t={type:e.type,sdp:e.sdp};i.customizeSdp(t),e.sdp=t.sdp,Wt.log("Setting local description"),v&&a&&("chrome"===Wt.webRTCAdapter.browserDetails.browser||"safari"===Wt.webRTCAdapter.browserDetails.browser?(Wt.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=Y(e.sdp)):"firefox"!==Wt.webRTCAdapter.browserDetails.browser&&Wt.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp=e.sdp,o.pc.setLocalDescription(e)["catch"](i.error),o.mediaConstraints=r,o.iceDone||o.trickle?(Wt.log("Offer ready"),Wt.debug(i),i.success(e)):Wt.log("Waiting for all candidates...")}),i.error)}function V(e,t,i){i=i||{},i.success="function"==typeof i.success?i.success:Wt.noop,i.error="function"==typeof i.error?i.error:Wt.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:Wt.noop;var n=T[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return Wt.warn("Invalid handle"),void i.error("Invalid handle");var o=n.webrtcStuff,a=!0===i.simulcast;a?Wt.log("Creating answer (iceDone="+o.iceDone+", simulcast="+a+")"):Wt.log("Creating answer (iceDone="+o.iceDone+")");var r=null;if(Wt.unifiedPlan){r={};var s=null,d=null,l=o.pc.getTransceivers();if(l&&l.length>0)for(var c in l){var u=l[c];u.sender&&u.sender.track&&"audio"===u.sender.track.kind||u.receiver&&u.receiver.track&&"audio"===u.receiver.track.kind?s||(s=u):(u.sender&&u.sender.track&&"video"===u.sender.track.kind||u.receiver&&u.receiver.track&&"video"===u.receiver.track.kind)&&(d||(d=u))}var m=Q(t),p=te(t);if(m||p){if(m&&p){if(s)try{s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",Wt.log("Setting audio transceiver to sendrecv:",s)}catch(b){Wt.error(b)}}else if(m&&!p)try{s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",Wt.log("Setting audio transceiver to sendonly:",s))}catch(b){Wt.error(b)}else if(!m&&p)if(s)try{s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",Wt.log("Setting audio transceiver to recvonly:",s)}catch(b){Wt.error(b)}else s=o.pc.addTransceiver("audio",{direction:"recvonly"}),Wt.log("Adding recvonly audio transceiver:",s)}else if(t.removeAudio&&s)try{s.setDirection?s.setDirection("inactive"):s.direction="inactive",Wt.log("Setting audio transceiver to inactive:",s)}catch(b){Wt.error(b)}var h=ie(t),f=oe(t);if(h||f){if(h&&f){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",Wt.log("Setting video transceiver to sendrecv:",d)}catch(b){Wt.error(b)}}else if(h&&!f){if(d)try{d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",Wt.log("Setting video transceiver to sendonly:",d)}catch(b){Wt.error(b)}}else if(!h&&f)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",Wt.log("Setting video transceiver to recvonly:",d)}catch(b){Wt.error(b)}else d=o.pc.addTransceiver("video",{direction:"recvonly"}),Wt.log("Adding recvonly video transceiver:",d)}else if(t.removeVideo&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",Wt.log("Setting video transceiver to inactive:",d)}catch(b){Wt.error(b)}}else r="firefox"==Wt.webRTCAdapter.browserDetails.browser||"edge"==Wt.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:te(t),offerToReceiveVideo:oe(t)}:{mandatory:{OfferToReceiveAudio:te(t),OfferToReceiveVideo:oe(t)}};Wt.debug(r);var g=ie(t);if(g&&a&&"firefox"===Wt.webRTCAdapter.browserDetails.browser){Wt.log("Enabling Simulcasting for Firefox (RID)");var v=o.pc.getSenders()[1];Wt.log(v);var y=v.getParameters();Wt.log(y);var S=_(i.simulcastMaxBitrates);v.setParameters({encodings:[{rid:"high",active:!0,priority:"high",maxBitrate:S.high},{rid:"medium",active:!0,priority:"medium",maxBitrate:S.medium},{rid:"low",active:!0,priority:"low",maxBitrate:S.low}]})}o.pc.createAnswer(r).then((function(e){Wt.debug(e);var t={type:e.type,sdp:e.sdp};i.customizeSdp(t),e.sdp=t.sdp,Wt.log("Setting local description"),g&&a&&("chrome"===Wt.webRTCAdapter.browserDetails.browser?Wt.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==Wt.webRTCAdapter.browserDetails.browser&&Wt.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp=e.sdp,o.pc.setLocalDescription(e)["catch"](i.error),o.mediaConstraints=r,o.iceDone||o.trickle?i.success(e):Wt.log("Waiting for all candidates...")}),i.error)}function H(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Wt.noop,t.error="function"==typeof t.error?t.error:Wt.noop;var i=T[e];if(null!==i&&void 0!==i&&null!==i.webrtcStuff&&void 0!==i.webrtcStuff){var n=i.webrtcStuff;Wt.log("Sending offer/answer SDP..."),null!==n.mySdp&&void 0!==n.mySdp?(n.mySdp={type:n.pc.localDescription.type,sdp:n.pc.localDescription.sdp},!1===n.trickle&&(n.mySdp["trickle"]=!1),Wt.debug(t),n.sdpSent=!0,t.success(n.mySdp)):Wt.warn("Local SDP instance is invalid, not sending anything...")}else Wt.warn("Invalid handle, not sending anything")}function G(e,t){var i=T[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return Wt.warn("Invalid handle"),0;var n=t?"remote":"local",o=i.webrtcStuff;return o.volume[n]||(o.volume[n]={value:0}),o.pc.getStats&&"chrome"===Wt.webRTCAdapter.browserDetails.browser?!t||null!==o.remoteStream&&void 0!==o.remoteStream?t||null!==o.myStream&&void 0!==o.myStream?null===o.volume[n].timer||void 0===o.volume[n].timer?(Wt.log("Starting "+n+" volume monitor"),o.volume[n].timer=setInterval((function(){o.pc.getStats((function(e){for(var i=e.result(),a=0;a<i.length;a++){var r=i[a];"ssrc"==r.type&&(t&&r.stat("audioOutputLevel")?o.volume[n].value=parseInt(r.stat("audioOutputLevel")):!t&&r.stat("audioInputLevel")&&(o.volume[n].value=parseInt(r.stat("audioInputLevel"))))}}))}),200),0):o.volume[n].value:(Wt.warn("Local stream unavailable"),0):(Wt.warn("Remote stream unavailable"),0):(Wt.warn("Getting the "+n+" volume unsupported by browser"),0)}function W(e,t){var i=T[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return Wt.warn("Invalid handle"),!0;var n=i.webrtcStuff;return null===n.pc||void 0===n.pc?(Wt.warn("Invalid PeerConnection"),!0):void 0===n.myStream||null===n.myStream?(Wt.warn("Invalid local MediaStream"),!0):t?null===n.myStream.getVideoTracks()||void 0===n.myStream.getVideoTracks()||0===n.myStream.getVideoTracks().length?(Wt.warn("No video track"),!0):!n.myStream.getVideoTracks()[0].enabled:null===n.myStream.getAudioTracks()||void 0===n.myStream.getAudioTracks()||0===n.myStream.getAudioTracks().length?(Wt.warn("No audio track"),!0):!n.myStream.getAudioTracks()[0].enabled}function q(e,t,i){var n=T[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return Wt.warn("Invalid handle"),!1;var o=n.webrtcStuff;return null===o.pc||void 0===o.pc?(Wt.warn("Invalid PeerConnection"),!1):void 0===o.myStream||null===o.myStream?(Wt.warn("Invalid local MediaStream"),!1):t?null===o.myStream.getVideoTracks()||void 0===o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length?(Wt.warn("No video track"),!1):(o.myStream.getVideoTracks()[0].enabled=!i,!0):null===o.myStream.getAudioTracks()||void 0===o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length?(Wt.warn("No audio track"),!1):(o.myStream.getAudioTracks()[0].enabled=!i,!0)}function K(e,t){var i=T[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return Wt.warn("Invalid handle"),"Invalid handle";var n=i.webrtcStuff;return null===n.pc||void 0===n.pc?"Invalid PeerConnection":n.pc.getStats?void n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var i=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?i=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(i=!0),i)if(t&&t(e),n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var o=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"==Wt.webRTCAdapter.browserDetails.browser&&(o/=1e3);var a=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/o);"safari"===Wt.webRTCAdapter.browserDetails.browser&&(a=parseInt(a/1e3)),n.bitrate.value=a+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))})):(Wt.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser")}function J(e){var t=T[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return Wt.warn("Invalid handle"),"Invalid handle";var i=t.webrtcStuff;return null===i.pc||void 0===i.pc?"Invalid PeerConnection":i.pc.getStats?null===i.bitrate.timer||void 0===i.bitrate.timer?(Wt.log("Starting bitrate timer (via getStats)"),i.bitrate.timer=setInterval((function(){i.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(i.bitrate.bsnow=e.bytesReceived,i.bitrate.tsnow=e.timestamp,null===i.bitrate.bsbefore||null===i.bitrate.tsbefore)i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow;else{var n=i.bitrate.tsnow-i.bitrate.tsbefore;"safari"==Wt.webRTCAdapter.browserDetails.browser&&(n/=1e3);var o=Math.round(8*(i.bitrate.bsnow-i.bitrate.bsbefore)/n);"safari"===Wt.webRTCAdapter.browserDetails.browser&&(o=parseInt(o/1e3)),i.bitrate.value=o+" kbits/sec",i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):i.bitrate.value:(Wt.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser")}function $(e){Wt.error("WebRTC error:",e)}function X(e,t){Wt.log("Cleaning WebRTC stuff");var o=T[e];if(null!==o&&void 0!==o){var a=o.webrtcStuff;if(null!==a&&void 0!==a){if(!0===t){var r={rtcgw:"hangup",transaction:Wt.randomString(12)};null!==o.token&&void 0!==o.token&&(r["token"]=o.token),null!==v&&void 0!==v&&(r["apisecret"]=v),Wt.debug("Sending hangup request (handle="+e+"):"),Wt.debug(r),i?(r["session_id"]=C,r["handle_id"]=e,n.send(JSON.stringify(r))):Wt.httpAPICall(d+"/"+C+"/"+e,{verb:"POST",withCredentials:h,body:r})}a.remoteStream=null,a.volume&&(a.volume["local"]&&a.volume["local"].timer&&clearInterval(a.volume["local"].timer),a.volume["remote"]&&a.volume["remote"].timer&&clearInterval(a.volume["remote"].timer)),a.volume={},a.bitrate.timer&&clearInterval(a.bitrate.timer),a.bitrate.timer=null,a.bitrate.bsnow=null,a.bitrate.bsbefore=null,a.bitrate.tsnow=null,a.bitrate.tsbefore=null,a.bitrate.value=null;try{if(!a.streamExternal&&null!==a.myStream&&void 0!==a.myStream){Wt.log("Stopping local stream tracks");var s=a.myStream.getTracks();for(var l in s){var c=s[l];Wt.log(c),null!==c&&void 0!==c&&c.stop()}}}catch(u){}a.streamExternal=!1,a.myStream=null;try{a.pc.close()}catch(u){}a.pc=null,a.candidates=null,a.mySdp=null,a.remoteSdp=null,a.iceDone=!1,a.dataChannel={},a.dtmfSender=null}o.oncleanup()}}function Y(e){for(var t=e.split("\r\n"),i=!1,n=[-1],o=[-1],a=null,r=null,s=null,d=null,l=-1,c=0;c<t.length;c++){var u=t[c].match(/m=(\w+) */);if(u){var m=u[1];if("video"===m){if(!(n[0]<0)){l=c;break}i=!0}else if(n[0]>-1){l=c;break}}else if(i){var p=t[c].match(/a=ssrc-group:FID (\d+) (\d+)/);if(p)n[0]=p[1],o[0]=p[2],t.splice(c,1),c--;else{if(n[0]){var h=t[c].match("a=ssrc:"+n[0]+" cname:(.+)");if(h&&(a=h[1]),h=t[c].match("a=ssrc:"+n[0]+" msid:(.+)"),h&&(r=h[1]),h=t[c].match("a=ssrc:"+n[0]+" mslabel:(.+)"),h&&(s=h[1]),h=t[c].match("a=ssrc:"+n[0]+" label:(.+)"),h&&(d=h[1]),0===t[c].indexOf("a=ssrc:"+o[0])){t.splice(c,1),c--;continue}if(0===t[c].indexOf("a=ssrc:"+n[0])){t.splice(c,1),c--;continue}}0!=t[c].length||(t.splice(c,1),c--)}}}if(n[0]<0){l=-1,i=!1;for(c=0;c<t.length;c++){u=t[c].match(/m=(\w+) */);if(u){m=u[1];if("video"===m){if(!(n[0]<0)){l=c;break}i=!0}else if(n[0]>-1){l=c;break}}else if(i){if(n[0]<0){var f=t[c].match(/a=ssrc:(\d+)/);if(f){n[0]=f[1],t.splice(c,1),c--;continue}}else{h=t[c].match("a=ssrc:"+n[0]+" cname:(.+)");if(h&&(a=h[1]),h=t[c].match("a=ssrc:"+n[0]+" msid:(.+)"),h&&(r=h[1]),h=t[c].match("a=ssrc:"+n[0]+" mslabel:(.+)"),h&&(s=h[1]),h=t[c].match("a=ssrc:"+n[0]+" label:(.+)"),h&&(d=h[1]),0===t[c].indexOf("a=ssrc:"+o[0])){t.splice(c,1),c--;continue}if(0===t[c].indexOf("a=ssrc:"+n[0])){t.splice(c,1),c--;continue}}0!=t[c].length||(t.splice(c,1),c--)}}}if(n[0]<0)return Wt.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length),n[1]=Math.floor(4294967295*Math.random()),n[2]=Math.floor(4294967295*Math.random()),o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random());for(c=0;c<n.length;c++)a&&(t.splice(l,0,"a=ssrc:"+n[c]+" cname:"+a),l++),r&&(t.splice(l,0,"a=ssrc:"+n[c]+" msid:"+r),l++),s&&(t.splice(l,0,"a=ssrc:"+n[c]+" mslabel:"+s),l++),d&&(t.splice(l,0,"a=ssrc:"+n[c]+" label:"+d),l++),a&&(t.splice(l,0,"a=ssrc:"+o[c]+" cname:"+a),l++),r&&(t.splice(l,0,"a=ssrc:"+o[c]+" msid:"+r),l++),s&&(t.splice(l,0,"a=ssrc:"+o[c]+" mslabel:"+s),l++),d&&(t.splice(l,0,"a=ssrc:"+o[c]+" label:"+d),l++);return t.splice(l,0,"a=ssrc-group:FID "+n[2]+" "+o[2]),t.splice(l,0,"a=ssrc-group:FID "+n[1]+" "+o[1]),t.splice(l,0,"a=ssrc-group:FID "+n[0]+" "+o[0]),t.splice(l,0,"a=ssrc-group:SIM "+n[0]+" "+n[1]+" "+n[2]),e=t.join("\r\n"),e.endsWith("\r\n")||(e+="\r\n"),e}function Q(e){return Wt.debug("isAudioSendEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function ee(e){return Wt.debug("isAudioSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}function te(e){return Wt.debug("isAudioRecvEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function ie(e){return Wt.debug("isVideoSendEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function ne(e){return Wt.debug("isVideoSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}function oe(e){return Wt.debug("isVideoRecvEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}function ae(e){if(Wt.debug("isScreenSendEnabled:",e),void 0===e||null===e)return!1;if("object"!==c(e.video)||"object"!==c(e.video.mandatory))return!1;var t=e.video.mandatory;return t.chromeMediaSource?"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource:t.mozMediaSource?"window"===t.mozMediaSource||"screen"===t.mozMediaSource:!!t.mediaSource&&("window"===t.mediaSource||"screen"===t.mediaSource)}function re(e){return Wt.debug("isDataEnabled:",e),"edge"==Wt.webRTCAdapter.browserDetails.browser?(Wt.warn("Edge doesn't support data channels yet"),!1):void 0!==e&&null!==e&&!0===e.data}function se(e){return Wt.debug("isTrickleEnabled:",e),void 0===e||null===e||!0===e}R(e),this.getServer=function(){return d},this.isConnected=function(){return b},this.reconnect=function(e){e=e||{},e.success="function"==typeof e.success?e.success:Wt.noop,e.error="function"==typeof e.error?e.error:Wt.noop,e["reconnect"]=!0,R(e)},this.getSessionId=function(){return C},this.destroy=function(e){A(e)},this.attach=function(e){D(e)}}Wt.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,i=e&&e.Promise||Promise,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},extension:e&&e.extension||Gt,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,n){var o={method:n.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===n.verb&&(o.headers["Content-Type"]="application/json"),void 0!==n.withCredentials&&(o.credentials=!0===n.withCredentials?"include":n.withCredentials?n.withCredentials:"omit"),void 0!==n.body&&(o.body=JSON.stringify(n.body));var a=t(e,o)["catch"]((function(e){return i.reject({message:"Probably a network error, is the server down?",error:e})}));if(void 0!==n.timeout){var r=new i((function(e,t){var i=setTimeout((function(){return clearTimeout(i),t({message:"Request timed out",timeout:n.timeout})}),n.timeout)}));a=i.race([a,r])}return a.then((function(e){return e.ok?c(n.success)===c(Wt.noop)?e.json().then((function(e){n.success(e)}))["catch"]((function(t){return i.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:i.reject({message:"API call failed",response:e})}))["catch"]((function(e){c(n.error)===c(Wt.noop)&&n.error(e.message||"<< internal error >>",e)})),a}}},Wt.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,i=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new i(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||Gt,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,i){var n=void 0!==i.body?{contentType:"application/json",data:JSON.stringify(i.body)}:{},o=void 0!==i.withCredentials?{xhrFields:{withCredentials:i.withCredentials}}:{};return t.ajax(t.extend(n,o,{url:e,type:i.verb,cache:!1,dataType:"json",async:i.async,timeout:i.timeout,success:function(e){c(i.success)===c(Wt.noop)&&i.success(e)},error:function(e,t,n){c(i.error)===c(Wt.noop)&&i.error(t,n)}}))}}},Wt.noop=function(){},Wt.dataChanDefaultLabel="JanusDataChannel",Wt.endOfCandidates=null,Wt.init=function(e){if(e=e||{},e.callback="function"==typeof e.callback?e.callback:Wt.noop,!0===Wt.initDone)e.callback();else{if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={log:function(){}}),Wt.trace=Wt.noop,Wt.debug=Wt.noop,Wt.vdebug=Wt.noop,Wt.log=Wt.noop,Wt.warn=Wt.noop,Wt.error=Wt.noop,!0===e.debug||"all"===e.debug)Wt.trace=console.trace.bind(console),Wt.debug=console.debug.bind(console),Wt.vdebug=console.debug.bind(console),Wt.log=console.log.bind(console),Wt.warn=console.warn.bind(console),Wt.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var t in e.debug){var i=e.debug[t];switch(i){case"trace":Wt.trace=console.trace.bind(console);break;case"debug":Wt.debug=console.debug.bind(console);break;case"vdebug":Wt.vdebug=console.debug.bind(console);break;case"log":Wt.log=console.log.bind(console);break;case"warn":Wt.warn=console.warn.bind(console);break;case"error":Wt.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+i+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')");break}}Wt.log("Initializing library");var n=e.dependencies||Wt.useDefaultDependencies();Wt.isArray=n.isArray,Wt.webRTCAdapter=n.webRTCAdapter,Wt.httpAPICall=n.httpAPICall,Wt.newWebSocket=n.newWebSocket,Wt.extension=n.extension,Wt.extension.init(),Wt.listDevices=function(e,t){e="function"==typeof e?e:Wt.noop,null==t&&(t={audio:!0,video:!0}),Wt.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(i){Wt.debug(i),e(i);try{var n=t.getTracks();for(var o in n){var a=n[o];null!==a&&void 0!==a&&a.stop()}}catch(r){}}))}))["catch"]((function(t){Wt.error(t),e([])})):(Wt.warn("navigator.mediaDevices unavailable"),e([]))},Wt.attachMediaStream=function(e,t){if("chrome"===Wt.webRTCAdapter.browserDetails.browser){var i=Wt.webRTCAdapter.browserDetails.version;i>=52?e.srcObject=t:"undefined"!==typeof e.src?e.src=URL.createObjectURL(t):Wt.error("Error attaching stream to element")}else e.srcObject=t},Wt.reattachMediaStream=function(e,t){if("chrome"===Wt.webRTCAdapter.browserDetails.browser){var i=Wt.webRTCAdapter.browserDetails.version;i>=52?e.srcObject=t.srcObject:"undefined"!==typeof e.src?e.src=t.src:Wt.error("Error reattaching stream to element")}else e.srcObject=t.srcObject};var o=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,a=o?"pagehide":"beforeunload",r=window["on"+a];if(window.addEventListener(a,(function(e){for(var t in Wt.log("Closing window"),Wt.sessions)null!==Wt.sessions[t]&&void 0!==Wt.sessions[t]&&Wt.sessions[t].destroyOnUnload&&(Wt.log("Destroying session "+t),Wt.sessions[t].destroy({asyncRequest:!1,notifyDestroyed:!1}));r&&"function"==typeof r&&r()})),Wt.safariVp8=!1,"safari"===Wt.webRTCAdapter.browserDetails.browser&&Wt.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var t in RTCRtpSender.getCapabilities("video").codecs){var s=RTCRtpSender.getCapabilities("video").codecs[t];if(s&&s.mimeType&&"video/vp8"===s.mimeType.toLowerCase()){Wt.safariVp8=!0;break}}Wt.safariVp8?Wt.log("This version of Safari supports VP8"):Wt.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var d=new RTCPeerConnection({},{});d.createOffer({offerToReceiveVideo:!0}).then((function(e){Wt.safariVp8=-1!==e.sdp.indexOf("VP8"),Wt.safariVp8?Wt.log("This version of Safari supports VP8"):Wt.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),d.close(),d=null}))}if(Wt.unifiedPlan=!1,"firefox"===Wt.webRTCAdapter.browserDetails.browser&&Wt.webRTCAdapter.browserDetails.version>=59)Wt.unifiedPlan=!0;else if("chrome"===Wt.webRTCAdapter.browserDetails.browser&&Wt.webRTCAdapter.browserDetails.version<72)Wt.unifiedPlan=!1;else if("currentDirection"in RTCRtpTransceiver.prototype){var l=new RTCPeerConnection;try{l.addTransceiver("audio"),Wt.unifiedPlan=!0}catch(c){}l.close()}else Wt.unifiedPlan=!1;Wt.initDone=!0,e.callback()}},Wt.isWebrtcSupported=function(){return void 0!==window.RTCPeerConnection&&null!==window.RTCPeerConnection},Wt.isGetUserMediaAvailable=function(){return void 0!==navigator.mediaDevices&&null!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia&&null!==navigator.mediaDevices.getUserMedia},Wt.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",n=0;n<e;n++){var o=Math.floor(Math.random()*t.length);i+=t.substring(o,o+1)}return i},window.Janus=Wt;var qt={version:"V1.0",apiDomain:"https://open.ys7.com"},Kt={},Jt=function(e,t){Kt[e]||(Kt[e]=[]),Kt[e].push(t)},$t=function(){var e=Array.prototype.shift.call(arguments),t=Kt[e];if(!t||0===t.length)return!1;for(var i,n=0;i=t[n];n++)i.apply(this,arguments)};function Xt(){var e={};return e.promise=new Promise((function(t,i){e.resolve=t,e.reject=i})),e}var Yt=function(){function e(t){p(this,e),g(this,"subscribe",(function(e){var t=Xt(),i={cmdType:"subremote",streamtype:e.type,customId:e.clientId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId},n=null;return window["ezuikit-webrtc"].opt.janus.attach({plugin:"rtcgw.plugin.sts",opaqueId:window["ezuikit-webrtc"].opt.opaqueId,success:function(o){console.log("pluginHandle",o),8==e.type?window["ezuikit-webrtc"].opt.subscribeScreenHandle=o:(window["ezuikit-webrtc"].opt["".concat(e.clientId)]=o,1==e.type&&window["ezuikit-webrtc"].opt["".concat(e.clientId)].send({message:{cmdType:"unsubremote",streamtype:2,customId:e.clientId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId},success:function(){},error:function(e){}})),n=o,n.createOffer({media:{videoSend:!1,audioSend:!1,audioRecv:!0,videoRecv:!0,audio:!0,video:!0,data:!1},simulcast:!1,simulcast2:!1,success:function(e){Janus.debug("remoteFeed createOffer Got SDP!"),Janus.debug(e),n.send({message:i,jsep:e})},error:function(e){Janus.error("remoteFeed WebRTC error:",e),t.reject(e)}})},error:function(e){console.error("  -- Error attaching plugin...",e),t.reject(e)},consentDialog:function(e){Janus.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){switch(Janus.log("ICE state changed to "+e),e){case"connected":console.log("ice connect success");break;case"disconnected":console.log("ice connect loss");break}},mediaState:function(e,t){Janus.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){Janus.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:function(e,t){Janus.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on this PeerConnection ("+t+" lost packets)")},onmessage:function(e,t){Janus.debug(" ::: Got a message :::"),Janus.debug(e),void 0!==t&&null!==t&&(Janus.debug("Handling SDP as well..."),Janus.debug(t),n.handleRemoteJsep({jsep:t})),"subremoteack"===e["rtcgw"]&&$t("subremoteack",e)},onlocalstream:function(e){},onremotestream:function(i){console.log("remoteStream==================================",i);var n={clientId:e.clientId,stream:i,streamType:e.type};t.resolve(n),$t("remoteStream",n)},ondataopen:function(e){Janus.log("The DataChannel is available!")},ondata:function(e){Janus.debug("We got data from the DataChannel! "+e)},oncleanup:function(){Janus.log(" ::: Got a cleanup notification :::")}}),t.promise})),g(this,"subscribeStream",(function(e){var t=Xt(),i={cmdType:"resumesubremote",streamtype:e.type,customId:e.clientId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};return window["ezuikit-webrtc"].opt["".concat(e.clientId)]&&window["ezuikit-webrtc"].opt["".concat(e.clientId)].send({message:i,success:function(){t.resolve("success")},error:function(e){t.reject(e)}}),t.promise})),g(this,"unsubscribe",(function(e){var t=Xt(),i={cmdType:"unsubremote",streamtype:e.type,customId:e.clientId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};return 8==e.type?window["ezuikit-webrtc"].opt.subscribeScreenHandle.send({message:i,success:function(){window["ezuikit-webrtc"].opt.subscribeScreenHandle.detach({noRequest:!1,success:function(){t.resolve("success")}})},error:function(e){t.reject(e)}}):window["ezuikit-webrtc"].opt["".concat(e.clientId)].send({message:i,success:function(){3==e.type?window["ezuikit-webrtc"].opt["".concat(e.clientId)].detach({noRequest:!1,success:function(){t.resolve("success")}}):t.resolve("success")},error:function(e){t.reject(e)}}),t.promise})),g(this,"unsubscribeStream",(function(e){var t=Xt(),i={cmdType:"pausesubremote",streamtype:e.type,customId:e.clientId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};return window["ezuikit-webrtc"].opt["".concat(e.clientId)].send({message:i,success:function(){t.resolve("success")},error:function(e){t.reject(e)}}),t.promise})),g(this,"listen",(function(){return Jt.apply(void 0,arguments)})),this.initEZWEBPlayer(t)}return f(e,[{key:"initEZWEBPlayer",value:function(e){function t(t){if(console.log("data",t),200==t.meta.code){var i=t.data;i.clientId;var n=i.domain;i.internalRoomId;var o=i.wssPath;window["ezuikit-webrtc"].opt.server="wss://".concat(n,"/").concat(o),window["ezuikit-webrtc"].opt.roomParams.internalRoomId=t.data.internalRoomId,window["ezuikit-webrtc"].opt.roomParams.clientId=t.data.clientId;var a={token:"token=".concat(e.rtctoken,"&userId=").concat(e.userId,"&roomId=").concat(e.roomId,"&appId=").concat(e.appId),authtype:23};Janus.init({debug:"all",callback:function(){window["ezuikit-webrtc"].opt.janus=new Janus({server:window["ezuikit-webrtc"].opt.server,success:function(t){t&&e.onMessage(t)},error:function(t){e.handleError(t)},destroyed:function(){}},a)}})}else e.handleError(t.meta)}console.log("params",e),window["ezuikit-webrtc"]={opt:{roomParams:{room:0,userId:e.userId,video:1,internalRoomId:null,roomId:e.roomId,clientId:null,rtctoken:e.rtctoken},janus:null,mainHandle:null,sts:null,screenHandle:null,subscribeScreenHandle:null,opaqueId:"sts-"+Janus.randomString(12),localStreamType:null,server:null,accessToken:e.accessToken,stream:"",screenStream:null,apiDomain:qt.apiDomain,cln:{local:{username:"",client_id:""}}},videoParams:{},audioParams:{},cameraId:null,microphoneId:null,bitrate:1e5,frameRate:15,width:320,height:240},M("".concat(qt.apiDomain,"/api/v3/rtc/wss"),"POST",{appId:e.appId,roomId:e.roomId,customId:e.userId,accessToken:e.accessToken},{"Content-Type":"application/x-www-form-urlencoded",accessToken:e.accessToken},t)}},{key:"getVersion",value:function(){var e=Xt();return e.resolve(qt.version),e.promise}},{key:"getSupport",value:function(){var e=Xt(),t={isWebrtcSupport:!0,isH264Support:!0},i=document.createElement("video");return i.canPlayType&&(i.canPlayType("video/mp4;codecs=“avc1.64001E”")?t.isH264Support=!0:t.isH264Support=!1),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia?(t.isWebrtcSupport=!0,e.resolve(t)):(t.isWebrtcSupport=!1,e.reject(t)),e.promise}},{key:"getMediaList",value:function(){var e=Xt();return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(t){e.resolve(t)})):e.reject("no devices"),e.promise}},{key:"getCamerasList",value:function(){var e=Xt();return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(t){var i=[];t.map((function(e){"videoinput"==e.kind&&i.push(e)})),e.resolve(i)})):e.reject("no devices"),e.promise}},{key:"getMicrophonesList",value:function(){var e=Xt();return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(t){var i=[];t.map((function(e){"audioinput"==e.kind&&i.push(e)})),e.resolve(i)})):e.reject("no devices"),e.promise}},{key:"getSpeakersList",value:function(){var e=Xt();return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(t){var i=[];t.map((function(e){"audiooutput"==e.kind&&i.push(e)})),e.resolve(i)})):e.reject("no devices"),e.promise}},{key:"play",value:function(e){var t=Xt(),i=document.getElementById(e.domId),n=window["ezuikit-webrtc"].opt.cln.local.stream;return Janus.attachMediaStream(i,n),i.play(),document.getElementById(e.domId)?t.resolve("success"):t.reject("no video dom"),t.promise}},{key:"leaveRoom",value:function(e){var t=Xt(),i={cmdType:"exitRoom",customId:window["ezuikit-webrtc"].opt.roomParams.userId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};return window["ezuikit-webrtc"].opt.mainHandle.send({message:i,success:function(){window["ezuikit-webrtc"].opt.janus.destroy({success:function(){}}),t.resolve("success")},error:function(e){console.error("  -- Error attaching plugin...",e),t.reject(e)}}),t.promise}},{key:"setCameraDevice",value:function(e){var t=Xt();return window["ezuikit-webrtc"].cameraId=e.deviceId,window["ezuikit-webrtc"].opt.sts&&window["ezuikit-webrtc"].opt.sts.createOffer({media:{video:{deviceId:e.deviceId},replaceVideo:!0,audio:1!=window["ezuikit-webrtc"].opt.localStreamType},simulcast:!1,simulcast2:!1,bitrate:window["ezuikit-webrtc"].bitrate,frameRate:window["ezuikit-webrtc"].frameRate,success:function(e){console.log("createOffersuccess"),Janus.debug("Got SDP!"),Janus.debug(e),t.resolve("success")},error:function(e){console.log("createOffererror"),Janus.error("WebRTC error:",e),t.reject(e)}}),t.promise}},{key:"setMicrophoneDevice",value:function(e){var t=Xt();return window["ezuikit-webrtc"].microphoneId=e.deviceId,window["ezuikit-webrtc"].opt.sts&&window["ezuikit-webrtc"].opt.sts.createOffer({media:{audio:{deviceId:e.deviceId},replaceAudio:!0,video:2!=window["ezuikit-webrtc"].opt.localStreamType},simulcast:!1,simulcast2:!1,bitrate:window["ezuikit-webrtc"].bitrate,frameRate:window["ezuikit-webrtc"].frameRate,success:function(e){console.log("createOffersuccess"),Janus.debug("Got SDP!"),Janus.debug(e),t.resolve("success")},error:function(e){console.log("createOffererror"),Janus.error("WebRTC error:",e),t.reject(e)}}),t.promise}},{key:"setVideoProfile",value:function(e){var t=Xt(),i={video:{width:e.video.width||360,height:e.video.height||640,frameRate:e.video.frameRate},bitrate:e.video.bitrate||5e5,id:e.id};return window["ezuikit-webrtc"].videoParams=i.video,window["ezuikit-webrtc"].bitrate=1e3*i.bitrate,window["ezuikit-webrtc"].frameRate=e.video.frameRate,window["ezuikit-webrtc"].width=e.video.width,window["ezuikit-webrtc"].height=e.video.height,t.resolve("success"),t.promise}},{key:"setAudioProfile",value:function(e){var t={audio:{deviceId:window["ezuikit-webrtc"].cameraId,sampleRate:e.audio.sampleRate||"32000HZ",sampleSize:e.audio.sampleSize||16,channelCount:e.audio.channelCount||1},id:e.id};window["ezuikit-webrtc"].audioParams=t.audio,console.log("window['ezuikit-webrtc'].videoParams",window["ezuikit-webrtc"])}},{key:"joinRoom",value:function(e){var t=Xt();return window["ezuikit-webrtc"].opt.janus.attach({plugin:"rtcgw.plugin.sts",opaqueId:window["ezuikit-webrtc"].opt.opaqueId,success:function(e){console.log("pluginHandle",e),window["ezuikit-webrtc"].opt.mainHandle=e,Janus.debug("Trying a createOffer too (audio/video sendrecv)");var i={cmdType:"enterRoom",customId:window["ezuikit-webrtc"].opt.roomParams.userId,clientId:window["ezuikit-webrtc"].opt.roomParams.clientId,strroomId:window["ezuikit-webrtc"].opt.roomParams.roomId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId,authtype:23,authentication:window["ezuikit-webrtc"].opt.roomParams.rtctoken};e.send({message:i}),t.resolve(e.id)},error:function(e){console.error("  -- Error attaching plugin...",e),t.reject(e)},consentDialog:function(e){Janus.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){switch(Janus.log("ICE state changed to "+e),e){case"connected":console.log("ice connect success");break;case"disconnected":console.log("ice connect loss");break}},mediaState:function(e,t){Janus.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){Janus.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:function(e,t){Janus.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on this PeerConnection ("+t+" lost packets)")},onmessage:function(e,t){Janus.debug(" ::: Got a message :::"),Janus.debug(e),void 0!==t&&null!==t&&(Janus.debug("Handling SDP as well..."),Janus.debug(t),window["ezuikit-webrtc"].opt.mainHandle.handleRemoteJsep({jsep:t}));var i=e["result"];if(null!==i&&void 0!==i){if("done"===i)return;i["status"]}"enterRoomack"===e["rtcgw"]&&$t("enterRoomack",e),"clientJoin"===e["rtcgw"]&&$t("clientJoin",e),"clientLeave"===e["rtcgw"]&&$t("clientLeave",e),"stream-added"===e["rtcgw"]&&$t("steam-added",e),"stream-removed"===e["rtcgw"]&&$t("stream-removed",e),"audioleve"===e["rtcgw"]&&$t("audioleve",e),"networkquality"===e["rtcgw"]&&$t("networkquality",e),"error"===e["rtcgw"]&&$t("error",e),"audioleve"===e["rtcgw"]&&$t("audioleve",e),"publishlocalstreamack"===e["rtcgw"]&&$t("publishlocalstreamack",e),"subremoteack"===e["rtcgw"]&&$t("subremoteack",e)},onlocalstream:function(e){console.log("onlocalstream",e),Janus.debug(" ::: Got a local stream :::"),Janus.debug(e),window["ezuikit-webrtc"].opt.cln.local.stream=e},onremotestream:function(e){},ondataopen:function(e){Janus.log("The DataChannel is available!")},ondata:function(e){Janus.debug("We got data from the DataChannel! "+e)},oncleanup:function(){Janus.log(" ::: Got a cleanup notification :::")}}),t.promise}},{key:"getLocalStream",value:function(e){var t=Xt();return window["ezuikit-webrtc"].opt.cln.local.stream?t.resolve(window["ezuikit-webrtc"].opt.cln.local.stream):t.reject("no stream"),t.promise}},{key:"getScreenStream",value:function(e){var t=Xt();return window["ezuikit-webrtc"].opt.screenStream?t.resolve(window["ezuikit-webrtc"].opt.screenStream):t.reject("no stream"),t.promise}},{key:"suspendStream",value:function(e){var t=this;t.controlStream(e,"suspend")}},{key:"controlStream",value:function(e,t){var i=Xt(),n={cmdType:"resume"==t?"resumelocalstream":"pauselocalstream",streamtype:e.type,customId:window["ezuikit-webrtc"].opt.roomParams.userId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};return 2==e.type&&window["ezuikit-webrtc"].opt.cln.local.stream.getTracks().forEach((function(e){"audio"==e.kind&&(e.enabled="resume"==t)})),1==e.type&&window["ezuikit-webrtc"].opt.cln.local.stream.getTracks().forEach((function(e){"video"==e.kind&&(e.enabled="resume"==t)})),8==e.type&&(console.log(" window['ezuikit-webrtc'].opt.screenStream.getTracks()",window["ezuikit-webrtc"].opt.screenStream.getTracks()),window["ezuikit-webrtc"].opt.screenStream.getTracks().forEach((function(e){e.enabled="resume"==t}))),3==e.type&&window["ezuikit-webrtc"].opt.cln.local.stream.getTracks().forEach((function(e){e.enabled="resume"==t})),8==e.type?window["ezuikit-webrtc"].opt.screenHandle.send({message:n,success:function(){i.resolve("success")},error:function(e){i.reject(e)}}):window["ezuikit-webrtc"].opt.sts.send({message:n,success:function(){i.resolve("success")},error:function(e){i.reject(e)}}),i.promise}},{key:"resumeStream",value:function(e){var t=this;t.controlStream(e,"resume")}},{key:"publishStream",value:function(e){var t=Xt(),i={cmdType:"publishlocalstream",streamtype:e.type,customId:window["ezuikit-webrtc"].opt.roomParams.userId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};8!=e.type&&(window["ezuikit-webrtc"].opt.localStreamType=e.type),window["ezuikit-webrtc"].videoParams;var n={videoSend:!0,audioSend:!0,audioRecv:!0,videoRecv:!0,data:!1,video:"stdres",audio:!0};switch(e.type){case 1:n={videoSend:!0,audioSend:!0,audioRecv:!0,videoRecv:!0,data:!1,video:{deviceId:window["ezuikit-webrtc"].cameraId,width:window["ezuikit-webrtc"].width,height:window["ezuikit-webrtc"].height},audio:!1};break;case 2:n={videoSend:!0,audioSend:!0,audioRecv:!0,videoRecv:!0,data:!1,video:!1,audio:{deviceId:window["ezuikit-webrtc"].microphoneId}};break;case 3:n={videoSend:!0,audioSend:!0,audioRecv:!0,videoRecv:!0,data:!1,video:{deviceId:window["ezuikit-webrtc"].cameraId,width:window["ezuikit-webrtc"].width,height:window["ezuikit-webrtc"].height},audio:{deviceId:window["ezuikit-webrtc"].microphoneId}};break;case 8:n={audioRecv:!1,videoRecv:!0,data:!1,audioSend:!1,videoSend:!0,video:"screen",screenshareFrameRate:3};break}return console.log("media-----------",n),console.log("window['ezuikit-webrtc'].bitrate",window["ezuikit-webrtc"].bitrate),console.log("window['ezuikit-webrtc'].opt.sts",window["ezuikit-webrtc"].opt.sts),window["ezuikit-webrtc"].opt.sts&&8!=e.type?window["ezuikit-webrtc"].opt.sts.createOffer({media:n,simulcast:!1,simulcast2:!1,bitrate:window["ezuikit-webrtc"].bitrate,frameRate:window["ezuikit-webrtc"].frameRate,success:function(e){console.log("createOffersuccess"),Janus.debug("Got SDP!"),Janus.debug(e),window["ezuikit-webrtc"].opt.sts.send({message:i,jsep:e}),t.resolve("success")},error:function(e){console.log("createOffererror"),Janus.error("WebRTC error:",e),t.reject(e)}}):window["ezuikit-webrtc"].opt.janus.attach({plugin:"rtcgw.plugin.sts",opaqueId:window["ezuikit-webrtc"].opt.opaqueId,success:function(o){console.log("pluginHandle",o),8==e.type?window["ezuikit-webrtc"].opt.screenHandle=o:window["ezuikit-webrtc"].opt.sts=o,Janus.debug("Trying a createOffer too (audio/video sendrecv)"),o.createOffer({media:n,simulcast:!1,simulcast2:!1,bitrate:window["ezuikit-webrtc"].bitrate,frameRate:window["ezuikit-webrtc"].frameRate,success:function(e){console.log("createOffersuccess"),Janus.debug("Got SDP!"),Janus.debug(e),o.send({message:i,jsep:e}),t.resolve("success")},error:function(e){console.log("createOffererror"),Janus.error("WebRTC error:",e),t.reject(e)}})},error:function(e){console.error("  -- Error attaching plugin...",e),t.reject(e)},consentDialog:function(e){Janus.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){switch(Janus.log("ICE state changed to "+e),e){case"connected":console.log("ice connect success");break;case"disconnected":console.log("ice connect loss");break}},mediaState:function(e,t){Janus.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){Janus.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:function(e,t){Janus.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on this PeerConnection ("+t+" lost packets)")},onmessage:function(t,i){console.log("消息回调+++++++++++++++++++++++++++++++++++++++++",t,i),Janus.debug(" ::: Got a message :::"),Janus.debug(t),void 0!==i&&null!==i&&(Janus.debug("Handling SDP as well..."),Janus.debug(i),8==e.type?window["ezuikit-webrtc"].opt.screenHandle.handleRemoteJsep({jsep:i}):window["ezuikit-webrtc"].opt.sts.handleRemoteJsep({jsep:i}))},onlocalstream:function(t){console.log("onlocalstream",t),Janus.debug(" ::: Got a local stream :::"),Janus.debug(t),8==e.type?(window["ezuikit-webrtc"].opt.screenStream=t,t.getVideoTracks()[0].addEventListener("ended",(function(){console.log("停止了屏幕共享-----------------------");var e={cmdType:"unpublishlocalstream",streamtype:8,customId:window["ezuikit-webrtc"].opt.roomParams.userId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};window["ezuikit-webrtc"].opt.screenHandle&&window["ezuikit-webrtc"].opt.screenHandle.send({message:e,success:function(){window["ezuikit-webrtc"].opt.screenHandle.detach({noRequest:!1}),window["ezuikit-webrtc"].opt.screenHandle=null},error:function(e){}})}))):window["ezuikit-webrtc"].opt.cln.local.stream=t},onremotestream:function(e){},ondataopen:function(e){Janus.log("The DataChannel is available!")},ondata:function(e){Janus.debug("We got data from the DataChannel! "+e)},oncleanup:function(){Janus.log(" ::: Got a cleanup notification :::")}}),t.promise}},{key:"unpublishStream",value:function(e){var t=Xt(),i={cmdType:"unpublishlocalstream",streamtype:3,customId:window["ezuikit-webrtc"].opt.roomParams.userId,roomId:window["ezuikit-webrtc"].opt.roomParams.internalRoomId};return 8==e.type?window["ezuikit-webrtc"].opt.screenHandle.send({message:d(d({},i),{},{streamtype:8}),success:function(){window["ezuikit-webrtc"].opt.screenHandle.detach({noRequest:!1}),window["ezuikit-webrtc"].opt.screenHandle=null,t.resolve("success")},error:function(e){t.reject(e)}}):window["ezuikit-webrtc"].opt.sts.send({message:i,success:function(){window["ezuikit-webrtc"].opt.sts.detach({noRequest:!1}),window["ezuikit-webrtc"].opt.sts=null,t.resolve("success")},error:function(e){t.reject(e)}}),t.promise}},{key:"ezwebTrigger",value:function(e){var t=window["ezuikit-webrtc"].opt.cln.local.stream,i={stream:t,clientId:"cliendId-".concat(20*Math.random())};$t("steam-added",i)}},{key:"playRemoteSteam",value:function(e){var t=document.getElementById(e.domId);Janus.attachMediaStream(t,e.stream),t.load();var i=t.play();void 0!==i&&i.then((function(){t.play()}))["catch"]((function(e){}))}},{key:"getQuality",value:function(e){window["ezuikit-webrtc"].opt["z3"].getNetworkQuality(e.handleId,(function(e){console.log("NetworkQuality",e)}))}}]),e}();(function(e,t){"object"===c(i)&&"object"===c(i.exports)?i.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("EZUIPlayer requires a window with a document");return t(e)}:t(e)})("undefined"!==typeof window?window:void 0,(function(e,t){var i={Core:C,HLS:F,FLV:z,EZUIKitPlayer:Mt,EZUIKitHD:Ht,EZWebRtc:Yt};return e.EZUIKit=i,i}))}).call(this,i("c8ba"),i("62e4")(e))}}]);