(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-769c2225"],{"19c8":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t.readonly?t.isEmpty?a("el-tag",{attrs:{type:"info"}},[t._v("未设置")]):a("p",[t._v(" "+t._s(t.location)+" "),a("el-button",{attrs:{type:"text"},on:{click:t.handleSelect}},[a("i",{staticClass:"el-icon-position el-icon--right"})])],1):a("p",[t.isEmpty?[t._v("设置")]:[t._v(t._s(t.data.location))],a("el-button",{attrs:{type:"text"},on:{click:t.handleSelect}},[a("i",{staticClass:"el-icon-edit el-icon--right"})])],2),a("el-dialog",{staticClass:"mapDialog",attrs:{title:t.readonly?"查看位置":"选择位置",visible:t.openSelector,"append-to-body":""},on:{"update:visible":function(e){t.openSelector=e}}},[t.readonly?""!==t.data.location?a("div",[a("h3",[a("i",{staticClass:"el-icon-position"}),t._v(t._s(t.data.location))])]):a("h3",[t._v("未设置")]):a("el-input",{attrs:{placeholder:"请输入设备位置"},model:{value:t.data.location,callback:function(e){t.$set(t.data,"location",e)},expression:"data.location"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:t.selectDone},slot:"append"},[t._v("确定")])],1),a("div",{staticStyle:{margin:"10px 0px 10px 0px"}},[a("el-tag",[t._v("纬度:"+t._s(t.data.lat))]),a("el-tag",{staticStyle:{"margin-left":"10px"}},[t._v("经度:"+t._s(t.data.lng))])],1),a("div",{staticClass:"amap-wrapper"},[t.readonly?t._e():a("el-amap-search-box",{staticClass:"amap-search-box",attrs:{"search-option":t.searchOption,"on-search-result":t.onSearchResult}}),a("el-amap",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{vid:"amapDev",zoom:t.zoom,"map-style":t.styleName,center:t.center,plugin:t.plugins,"amap-manager":t.amapManager,events:t.events}})],1)],1)],1)},i=[],o=(a("a9e3"),a("ac1f"),a("00b4"),a("b0c0"),a("8f9b")),l=a("870c"),c=new o["AMapManager"],s={components:{},props:{name:{type:String,default:void 0},location:{type:String,default:void 0},lat:{type:Number,default:void 0},lng:{type:Number,default:void 0},readonly:{type:Boolean,default:!1}},computed:{styleName:function(){var t=this.$store.state.settings.sideTheme;return/theme-dark-.+/.test(t)?"amap://styles/blue":"amap://styles/normal"}},data:function(){var t=this;return{loading:!1,title:"",data:{location:void 0,lat:void 0,lng:void 0},isEmpty:!0,amapManager:c,plugins:["ToolBar","Autocomplete","OverView","Geocoder"],zoom:15,center:[121.59996,31.197646],openSelector:!1,searchOption:{city:"",citylimit:!1},events:{complete:function(e){t.data.lat&&t.data.lng&&t.setMarker(t.data)},click:function(e){t.loading=!0,t.data.lat=e.lnglat.lat,t.data.lng=e.lnglat.lng,t.setMarker(e.lnglat);var a=new AMap.Geocoder({});a.getAddress(e.lnglat,(function(e,a){t.loading=!1,"complete"===e&&a.regeocode&&(t.data.country=a.regeocode.addressComponent.country,t.data.province=a.regeocode.addressComponent.province,t.data.district=a.regeocode.addressComponent.district,t.data.location=a.regeocode.formattedAddress,t.setEmpty())}))}}}},created:function(){this.data={location:this.location,lng:this.lng,lat:this.lat},this.setEmpty(),Object(l["e"])(this)},methods:{setEmpty:function(){this.isEmpty=void 0===this.data.location||""===this.data.location},setMarker:function(t){t.Q=t.lat,t.R=t.lng;var e=c.getMap();this.marker&&(e.remove(this.marker),e.setFitView()),this.marker=new AMap.Marker({map:e}),this.center=[t.lng,t.lat],this.marker.setPosition(t)},selectDone:function(){var t=this.data;t.name=this.name,this.$emit("selectDone",t),this.openSelector=!1},handleSelect:function(){this.openSelector=!0},onSearchResult:function(t){if(t.length>0){var e=t[0];this.center=[e.lng,e.lat],this.data.location=e.address,this.data.lat=e.lat,this.data.lng=e.lng}}},watch:{readonly:function(){this.title=this.readonly?"查看位置":"选择位置"},location:function(){this.data={location:this.location,lat:this.lat?this.lat:"-",lng:this.lng?this.lng:"-"},this.setEmpty()}}},r=s,d=(a("2bab"),a("2877")),p=Object(d["a"])(r,n,i,!1,null,"2eae3cf5",null);e["a"]=p.exports},"2bab":function(t,e,a){"use strict";a("c0e8")},"34cf":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[t.buttons.length>0||t.title?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t.title?a("span",{staticStyle:{"font-weight":"bold","line-height":"40px"}},[t._v(t._s(t.title))]):t._e(),a("el-button-group",{staticStyle:{float:"right",padding:"3px 0"}},t._l(t.buttons,(function(e){return a("el-button",{key:e.key,class:e.icon,staticStyle:{"margin-right":"5px"},attrs:{type:"text"},on:{click:function(a){return t.doClick(e)}}},[t._v(t._s(e.title))])})),1)],1):t._e(),t.columns.length>0?a("el-row",{staticClass:"tab-body"},t._l(t.columns,(function(e){return a("el-col",{key:e.key,staticClass:"tab-col",attrs:{xs:24,sm:12,md:8,lg:8,xl:6}},[a("div",{staticClass:"td-title"},[t._v(t._s(e.title))]),a("div",{staticClass:"td-value"},["map"===e.type?[a("MapSelector",{attrs:{name:e.key,location:t.getValue(e),lat:t.getLngLat("lat",e),lng:t.getLngLat("lng",e)},on:{selectDone:t.selectMapDone}})]:"dict"===e.type?[a("dict-tag",{attrs:{options:e.options,value:t.getValue(e)}})]:t.checkEmpty(e)?[t._v("--")]:["href"===e.type?[a("el-link",{attrs:{type:"primary","underline:":"true",href:t.getValue(e),target:"_blank"}},[t._v("访问")])]:"image"===e.type?[a("ImagePreview",{staticStyle:{width:"20px"},attrs:{src:t.getValue(e)}})]:"secret"===e.type?[a("span",{staticClass:"secret-box"},[t._v("******")]),a("el-popover",{attrs:{placement:"bottom",title:e.title+":",width:"200",trigger:"click",content:t.getValue(e)}},[a("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-view"},slot:"reference"})],1)]:[t._v(" "+t._s(t.getValue(e))+" ")]],e.click?a("el-button",{attrs:{type:"text",icon:e.click.icon,circle:""},on:{click:function(a){return t.doClick(e)}}},[e.click.title?[t._v(" "+t._s(e.click.title)+" ")]:t._e()],2):t._e()],2)])})),1):a("el-empty",{attrs:{description:"暂无"+t.title}})],1)},i=[],o=(a("b0c0"),a("4de4"),a("d3b7"),a("a15b"),a("5a0c")),l=a.n(o),c=a("9a2d"),s=a("19c8"),r={components:{MapSelector:s["a"],ImagePreview:c["a"]},props:{title:{type:String,default:void 0},columns:{type:Array,default:function(){return[]}},item:{type:Object,default:function(){return{}}},buttons:{type:Array,default:function(){return[]}}},data:function(){return{}},created:function(){},methods:{checkEmpty:function(t){var e=this.getValue(t);return null===e||void 0===e||""===e},doClick:function(t){this.$emit("click",t)},selectMapDone:function(t){var e=t.name,a=this.columns.filter((function(t){return t.key===e}));if(a.length>0){var n=a[0];this.$emit("selectMapDone",n,t)}},getLngLat:function(t,e){var a=e[t];return this.item[a]},getValue:function(t){var e=t.key,a=t.format,n=this.item[e];if("relation"===t.type){var i=t.on,o=this.item[i];return a?a(e,{field:o,key:n}):o||n?(o=o||"--",n=n||"--",[n,o].join(",")):void 0}return"datetime"===t.type?n?l()(1e3*n).format("YYYY-MM-DD HH:mm:ss"):void 0:a?a(e,n):n}}},d=r,p=(a("d8ff"),a("2877")),u=Object(p["a"])(d,n,i,!1,null,"111fd298",null);e["a"]=u.exports},"4b47":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("TableShow",{attrs:{columns:t.columns,item:t.device},on:{selectMapDone:t.selectMapDone}}),t.device.lng&&t.device.lat?a("div",{staticClass:"amap-wrapper",style:{height:t.height+"px"}},[a("el-amap",{attrs:{vid:"amapScene","amap-manager":t.amapManager,zoom:t.zoom,center:t.center,events:t.events,"map-style":t.styleName,plugin:t.plugins}},[a("el-amap-marker",{attrs:{position:t.center,events:t.events}}),a("el-amap-info-window",{attrs:{position:t.center,content:t.device.location,offset:[0,-35]}})],1)],1):t._e()],1)},i=[],o=(a("a9e3"),a("ac1f"),a("00b4"),a("8f9b")),l=a("870c"),c=a("34cf"),s=a("5a98"),r=new o["AMapManager"],d={components:{TableShow:c["a"]},props:{device:{type:Object,required:!0},height:{type:Number,default:function(){return 500}}},computed:{styleName:function(){var t=this.$store.state.settings.sideTheme;return/theme-dark-.+/.test(t)?"amap://styles/blue":"amap://styles/normal"}},data:function(){var t=this;return{amapManager:r,plugins:["ToolBar","Autocomplete","OverView","Geocoder"],zoom:13,center:[121.59996,31.197646],columns:[{key:"country",title:"国家",type:"text"},{key:"district",title:"区域",type:"text"},{key:"lat",title:"经纬度",type:"relation",on:"lng"},{key:"location",title:"位置",type:"map",lat:"lat",lng:"lng"}],events:{complete:function(e){t.device.lng&&t.device.lat&&(t.center=[t.device.lng,t.device.lat])}}}},created:function(){Object(l["e"])(this)},methods:{selectMapDone:function(t,e){var a=this,n={id:this.device.id,location:e.location,country:e.country,province:e.province,district:e.district,lat:e.lat,lng:e.lng};Object(s["l"])("device",n).then((function(t){a.device.location=e.location,a.device.country=e.country,a.device.province=e.province,a.device.district=e.district,a.device.lat=e.lat,a.device.lng=e.lng,a.$modal.msgSuccess("修改成功!")}))}}},p=d,u=(a("fa36"),a("2877")),m=Object(u["a"])(p,n,i,!1,null,"74ed1f57",null);e["default"]=m.exports},"9b59":function(t,e,a){},c0e8:function(t,e,a){},d8ff:function(t,e,a){"use strict";a("9b59")},e410:function(t,e,a){},fa36:function(t,e,a){"use strict";a("e410")}}]);