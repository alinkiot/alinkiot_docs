(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-007d8743"],{"061b":function(e,n,t){"use strict";var i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],style:"height:"+e.height},[t("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"myFrame",src:e.src,frameborder:"no",scrolling:"auto"}})])},s=[],a={props:{src:{type:String,required:!0}},data:function(){return{height:document.documentElement.clientHeight-94.5+"px;",loading:!0,url:this.src}},mounted:function(){var e=this;setTimeout((function(){e.loading=!1}),300);var n=this;window.onresize=function(){n.height=document.documentElement.clientHeight-94.5+"px;"}}},c=a,o=t("2877"),d=Object(o["a"])(c,i,s,!1,null,null,null);n["a"]=d.exports},"48a91":function(e,n,t){"use strict";t.r(n);var i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"app-container"},[t("h3",{staticClass:"title-dev"},[e._v("组态："+e._s(e.scene.title))]),t("i-frame",{attrs:{src:e.url}})],1)},s=[],a=t("061b"),c=t("84de"),o=t("5a98"),d={name:"ViewEdit",dicts:[],components:{iFrame:a["a"],InputTableSelect:c["a"]},data:function(){return{url:"/view/",scene:{},things:[],loading:!1,bindDev:!1,bindThing:!1,message:void 0,device:void 0,view:void 0}},created:function(){this.url=this.url+"index.html",this.loadPage()},methods:{deviceClick:function(e){this.currentDev=!0},loadPage:function(){var e=this,n=this.$route.query.id;n?(this.loading=!0,Object(o["g"])("scene",n).then((function(n){e.scene=n.data,e.addEventListener()}))):(this.scene=void 0,this.addEventListener(),this.open=!0)},addEventListener:function(){var e=this;window.addEventListener("message",(function(n){e.message=n.data,"scene"===e.message.from&&("done"===e.message.event?(e.sceneDone(e.message),e.loading=!1):"bind"===e.message.event?e.deviceBind():"publish"===e.message.event?(e.view=e.message.view,e.scene&&e.scene.id?e.saveScene(e.view):e.open=!0):"preview"===e.message.event&&(e.scene&&e.scene.id?(e.saveScene(e.message.view),e.openView()):e.open=!0))}))},sceneDone:function(e){this.scene&&this.scene.view&&this.sendMsg({event:"update",view:this.scene.view,callback:e.callback})},sendMsg:function(e){var n=e;n.from="iot";var t=document.getElementById("myFrame");t.contentWindow.postMessage(n,"*")},deviceBind:function(){this.bindDev=!0,this.device=void 0},saveScene:function(e){var n=this,t={id:this.scene.id,view:e};Object(o["l"])("scene",t).then((function(t){n.scene.view=e,n.$modal.msgSuccess("更新成功")}))},openView:function(){var e={id:this.scene.id,token:this.scene.token},n=this.$router.resolve({path:"/scene/monitor",query:e});window.open(n.href,"_blank")}}},r=d,u=t("2877"),l=Object(u["a"])(r,i,s,!1,null,"544c2890",null);n["default"]=l.exports}}]);